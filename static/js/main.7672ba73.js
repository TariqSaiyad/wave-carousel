/*! For license information please see main.7672ba73.js.LICENSE.txt */
!function(){var e={8598:function(e,t,n){var r=n(7401),a=n(3627),i=n(7320),o=n(7220),s=n(4972),u=n(2584),l=n(9638);l.alea=r,l.xor128=a,l.xorwow=i,l.xorshift7=o,l.xor4096=s,l.tychei=u,e.exports=l},7401:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n=function(){var e=4022871197;return function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)}}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function u(e,t){var n=new o(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.alea=u}(0,e=n.nmd(e),n.amdD)},2584:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.tychei=u}(0,e=n.nmd(e),n.amdD)},3627:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor128=u}(0,e=n.nmd(e),n.amdD)},4972:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),a=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;e.w=o,e.X=s,e.i=a}(t,e)}function s(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor4096=u}(0,e=n.nmd(e),n.amdD)},7220:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function s(e,t){return t.x=e.x.slice(),t.i=e.i,t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorshift7=u}(0,e=n.nmd(e),n.amdD)},7320:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorwow=u}(0,e=n.nmd(e),n.amdD)},9638:function(e,t,n){var r;!function(a,i){var o,s=this,u=256,l=i.pow(u,6),c=i.pow(2,52),h=2*c,p=255;function f(e,t,n){var r=[],p=g(m((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(a)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(u):(e=new Uint8Array(u),(s.crypto||s.msCrypto).getRandomValues(e)),y(e)}catch(r){var t=s.navigator,n=t&&t.plugins;return[+new Date,s,n,s.screen,y(a)]}}():e,3),r),f=new d(r),b=function(){for(var e=f.g(6),t=l,n=0;e<c;)e=(e+n)*u,t*=u,n=f.g(1);for(;e>=h;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|f.g(4)},b.quick=function(){return f.g(4)/4294967296},b.double=b,g(y(f.S),a),(t.pass||n||function(e,t,n,r){return r&&(r.S&&v(r,f),e.state=function(){return v(f,{})}),n?(i.random=e,t):e})(b,p,"global"in t?t.global:this==i,t.state)}function d(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<u;)o[a]=a++;for(a=0;a<u;a++)o[a]=o[i=p&i+e[a%n]+(t=o[a])],o[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,o=r.S;e--;)t=o[a=p&a+1],n=n*u+o[p&(o[a]=o[i=p&i+t])+(o[i]=t)];return r.i=a,r.j=i,n})(u)}function v(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function m(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(m(e[n],t-1))}catch(i){}return r.length?r:"string"==a?e:e+"\0"}function g(e,t){for(var n,r=e+"",a=0;a<r.length;)t[p&a]=p&(n^=19*t[p&a])+r.charCodeAt(a++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(i.seedrandom=f,g(i.random(),a),e.exports){e.exports=f;try{o=n(914)}catch(b){}}else void 0===(r=function(){return f}.call(t,n,t,e))||(e.exports=r)}([],Math)},282:function(e,t,n){var r=n(5141),a=n(9619),i=n(6422),o=n(6304),s=n(3410),u=n(5463),l=n(5274);l.alea=r,l.xor128=a,l.xorwow=i,l.xorshift7=o,l.xor4096=s,l.tychei=u,e.exports=l},5141:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n=function(){var e=4022871197;return function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)}}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function u(e,t){var n=new o(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.alea=u}(0,e=n.nmd(e),n.amdD)},5463:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.tychei=u}(0,e=n.nmd(e),n.amdD)},9619:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor128=u}(0,e=n.nmd(e),n.amdD)},3410:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),a=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;e.w=o,e.X=s,e.i=a}(t,e)}function s(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor4096=u}(0,e=n.nmd(e),n.amdD)},6304:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function s(e,t){return t.x=e.x.slice(),t.i=e.i,t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorshift7=u}(0,e=n.nmd(e),n.amdD)},6422:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorwow=u}(0,e=n.nmd(e),n.amdD)},5274:function(e,t,n){var r;!function(a,i){var o,s=this,u=256,l=i.pow(u,6),c=i.pow(2,52),h=2*c,p=255;function f(e,t,n){var r=[],p=g(m((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(a)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(u):(e=new Uint8Array(u),(s.crypto||s.msCrypto).getRandomValues(e)),y(e)}catch(r){var t=s.navigator,n=t&&t.plugins;return[+new Date,s,n,s.screen,y(a)]}}():e,3),r),f=new d(r),b=function(){for(var e=f.g(6),t=l,n=0;e<c;)e=(e+n)*u,t*=u,n=f.g(1);for(;e>=h;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|f.g(4)},b.quick=function(){return f.g(4)/4294967296},b.double=b,g(y(f.S),a),(t.pass||n||function(e,t,n,r){return r&&(r.S&&v(r,f),e.state=function(){return v(f,{})}),n?(i.random=e,t):e})(b,p,"global"in t?t.global:this==i,t.state)}function d(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<u;)o[a]=a++;for(a=0;a<u;a++)o[a]=o[i=p&i+e[a%n]+(t=o[a])],o[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,o=r.S;e--;)t=o[a=p&a+1],n=n*u+o[p&(o[a]=o[i=p&i+t])+(o[i]=t)];return r.i=a,r.j=i,n})(u)}function v(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function m(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(m(e[n],t-1))}catch(i){}return r.length?r:"string"==a?e:e+"\0"}function g(e,t){for(var n,r=e+"",a=0;a<r.length;)t[p&a]=p&(n^=19*t[p&a])+r.charCodeAt(a++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(i.seedrandom=f,g(i.random(),a),e.exports){e.exports=f;try{o=n(5778)}catch(b){}}else void 0===(r=function(){return f}.call(t,n,t,e))||(e.exports=r)}([],Math)},1694:function(e,t){var n;!function(){"use strict";var r={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var i=typeof n;if("string"===i||"number"===i)e.push(n);else if(Array.isArray(n)){if(n.length){var o=a.apply(null,n);o&&e.push(o)}}else if("object"===i)if(n.toString===Object.prototype.toString)for(var s in n)r.call(n,s)&&n[s]&&e.push(s);else e.push(n.toString())}}return e.join(" ")}e.exports?(a.default=a,e.exports=a):void 0===(n=function(){return a}.apply(t,[]))||(e.exports=n)}()},888:function(e,t,n){"use strict";var r=n(9047);function a(){}function i(){}i.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,i,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:a};return n.PropTypes=n,n}},2007:function(e,t,n){e.exports=n(888)()},9047:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},4463:function(e,t,n){"use strict";var r=n(2791),a=n(5296);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function u(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},d={};function v(e,t,n,r,a,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=m.hasOwnProperty(t)?m[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!h.call(d,e)||!h.call(f,e)&&(p.test(e)?d[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),w=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),T=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function F(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var L,P=Object.assign;function z(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var B=!1;function V(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var a=l.stack.split("\n"),i=r.stack.split("\n"),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==i[s]){var u="\n"+a[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=o&&0<=s);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?z(e):""}function W(e){switch(e.tag){case 5:return z(e.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case _:return"Fragment";case w:return"Portal";case I:return"Profiler";case S:return"StrictMode";case E:return"Suspense";case M:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case T:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case N:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return U(e(t))}catch(n){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function G(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function j(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=j(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function X(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=j(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return P({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Z(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=G(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function $(e,t){Q(e,t);var n=G(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,G(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function J(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+G(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return P({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:G(n)}}function ie(e,t){var n=G(t.value),r=G(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ce,he=(ce=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ce(e,t)}))}:ce);function pe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},de=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(fe).forEach((function(e){de.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ge=P({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function ke(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,_e=null,Se=null;function Ie(e){if(e=ba(e)){if("function"!==typeof we)throw Error(i(280));var t=e.stateNode;t&&(t=ka(t),we(e.stateNode,e.type,t))}}function Ce(e){_e?Se?Se.push(e):Se=[e]:_e=e}function Te(){if(_e){var e=_e,t=Se;if(Se=_e=null,Ie(e),t)for(e=0;e<t.length;e++)Ie(t[e])}}function Ne(e,t){return e(t)}function Ee(){}var Me=!1;function Ae(e,t,n){if(Me)return e(t,n);Me=!0;try{return Ne(e,t,n)}finally{Me=!1,(null!==_e||null!==Se)&&(Ee(),Te())}}function De(e,t){var n=e.stateNode;if(null===n)return null;var r=ka(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Re=!1;if(c)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Re=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(ce){Re=!1}function Fe(e,t,n,r,a,i,o,s,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var Le=!1,Pe=null,ze=!1,Be=null,Ve={onError:function(e){Le=!0,Pe=e}};function We(e,t,n,r,a,i,o,s,u){Le=!1,Pe=null,Fe.apply(Ve,arguments)}function Ue(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ge(e){if(Ue(e)!==e)throw Error(i(188))}function je(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return Ge(a),e;if(o===r)return Ge(a),t;o=o.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=o;else{for(var s=!1,u=a.child;u;){if(u===n){s=!0,n=a,r=o;break}if(u===r){s=!0,r=a,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=a;break}if(u===r){s=!0,r=o,n=a;break}u=u.sibling}if(!s)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var Xe=a.unstable_scheduleCallback,Ke=a.unstable_cancelCallback,Ye=a.unstable_shouldYield,Ze=a.unstable_requestPaint,Qe=a.unstable_now,$e=a.unstable_getCurrentPriorityLevel,Je=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var ot=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(st(e)/ut|0)|0},st=Math.log,ut=Math.LN2;var lt=64,ct=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~a;0!==s?r=ht(s):0!==(i&=o)&&(r=ht(i))}else 0!==(o=n&~a)?r=ht(o):0!==i&&(r=ht(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-ot(t)),r|=e[n],t&=~a;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function dt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var kt,wt,_t,St,It,Ct=!1,Tt=[],Nt=null,Et=null,Mt=null,At=new Map,Dt=new Map,Rt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ft(e,t){switch(e){case"focusin":case"focusout":Nt=null;break;case"dragenter":case"dragleave":Et=null;break;case"mouseover":case"mouseout":Mt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Lt(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&wt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Pt(e){var t=ya(e.target);if(null!==t){var n=Ue(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=He(n)))return e.blockedOn=t,void It(e.priority,(function(){_t(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function zt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&wt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function Bt(e,t,n){zt(e)&&n.delete(t)}function Vt(){Ct=!1,null!==Nt&&zt(Nt)&&(Nt=null),null!==Et&&zt(Et)&&(Et=null),null!==Mt&&zt(Mt)&&(Mt=null),At.forEach(Bt),Dt.forEach(Bt)}function Wt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Vt)))}function Ut(e){function t(t){return Wt(t,e)}if(0<Tt.length){Wt(Tt[0],e);for(var n=1;n<Tt.length;n++){var r=Tt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Nt&&Wt(Nt,e),null!==Et&&Wt(Et,e),null!==Mt&&Wt(Mt,e),At.forEach(t),Dt.forEach(t),n=0;n<Rt.length;n++)(r=Rt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Rt.length&&null===(n=Rt[0]).blockedOn;)Pt(n),null===n.blockedOn&&Rt.shift()}var Ht=x.ReactCurrentBatchConfig,Gt=!0;function jt(e,t,n,r){var a=bt,i=Ht.transition;Ht.transition=null;try{bt=1,Xt(e,t,n,r)}finally{bt=a,Ht.transition=i}}function qt(e,t,n,r){var a=bt,i=Ht.transition;Ht.transition=null;try{bt=4,Xt(e,t,n,r)}finally{bt=a,Ht.transition=i}}function Xt(e,t,n,r){if(Gt){var a=Yt(e,t,n,r);if(null===a)Gr(e,t,r,Kt,n),Ft(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Nt=Lt(Nt,e,t,n,r,a),!0;case"dragenter":return Et=Lt(Et,e,t,n,r,a),!0;case"mouseover":return Mt=Lt(Mt,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return At.set(i,Lt(At.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Dt.set(i,Lt(Dt.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Ft(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==a;){var i=ba(a);if(null!==i&&kt(i),null===(i=Yt(e,t,n,r))&&Gr(e,t,r,Kt,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Gr(e,t,r,null,n)}}var Kt=null;function Yt(e,t,n,r){if(Kt=null,null!==(e=ya(e=ke(r))))if(null===(t=Ue(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Zt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Je:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Qt=null,$t=null,Jt=null;function en(){if(Jt)return Jt;var e,t,n=$t,r=n.length,a="value"in Qt?Qt.value:Qt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[i-t];t++);return Jt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return P(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,un,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=an(ln),hn=P({},ln,{view:0,detail:0}),pn=an(hn),fn=P({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:In,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(on=e.screenX-un.screenX,sn=e.screenY-un.screenY):sn=on=0,un=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),dn=an(fn),vn=an(P({},fn,{dataTransfer:0})),mn=an(P({},hn,{relatedTarget:0})),gn=an(P({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=P({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),xn=an(P({},ln,{data:0})),kn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_n={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_n[e])&&!!t[e]}function In(){return Sn}var Cn=P({},hn,{key:function(e){if(e.key){var t=kn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:In,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Tn=an(Cn),Nn=an(P({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),En=an(P({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:In})),Mn=an(P({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=P({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=an(An),Rn=[9,13,27,32],On=c&&"CompositionEvent"in window,Fn=null;c&&"documentMode"in document&&(Fn=document.documentMode);var Ln=c&&"TextEvent"in window&&!Fn,Pn=c&&(!On||Fn&&8<Fn&&11>=Fn),zn=String.fromCharCode(32),Bn=!1;function Vn(e,t){switch(e){case"keyup":return-1!==Rn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Un=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function jn(e,t,n,r){Ce(r),0<(t=qr(t,"onChange")).length&&(n=new cn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var qn=null,Xn=null;function Kn(e){zr(e,0)}function Yn(e){if(X(xa(e)))return e}function Zn(e,t){if("change"===e)return t}var Qn=!1;if(c){var $n;if(c){var Jn="oninput"in document;if(!Jn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Jn="function"===typeof er.oninput}$n=Jn}else $n=!1;Qn=$n&&(!document.documentMode||9<document.documentMode)}function tr(){qn&&(qn.detachEvent("onpropertychange",nr),Xn=qn=null)}function nr(e){if("value"===e.propertyName&&Yn(Xn)){var t=[];jn(t,Xn,e,ke(e)),Ae(Kn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Xn=n,(qn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Xn)}function ir(e,t){if("click"===e)return Yn(t)}function or(e,t){if("input"===e||"change"===e)return Yn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ur(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!h.call(t,a)||!sr(e[a],t[a]))return!1}return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cr(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function pr(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function dr(e){var t=pr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=cr(n,i);var o=cr(n,r);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=c&&"documentMode"in document&&11>=document.documentMode,mr=null,gr=null,yr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==mr||mr!==K(r)||("selectionStart"in(r=mr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&ur(yr,r)||(yr=r,0<(r=qr(gr,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function kr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wr={animationend:kr("Animation","AnimationEnd"),animationiteration:kr("Animation","AnimationIteration"),animationstart:kr("Animation","AnimationStart"),transitionend:kr("Transition","TransitionEnd")},_r={},Sr={};function Ir(e){if(_r[e])return _r[e];if(!wr[e])return e;var t,n=wr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return _r[e]=n[t];return e}c&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete wr.animationend.animation,delete wr.animationiteration.animation,delete wr.animationstart.animation),"TransitionEvent"in window||delete wr.transitionend.transition);var Cr=Ir("animationend"),Tr=Ir("animationiteration"),Nr=Ir("animationstart"),Er=Ir("transitionend"),Mr=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(e,t){Mr.set(e,t),u(t,[e])}for(var Rr=0;Rr<Ar.length;Rr++){var Or=Ar[Rr];Dr(Or.toLowerCase(),"on"+(Or[0].toUpperCase()+Or.slice(1)))}Dr(Cr,"onAnimationEnd"),Dr(Tr,"onAnimationIteration"),Dr(Nr,"onAnimationStart"),Dr("dblclick","onDoubleClick"),Dr("focusin","onFocus"),Dr("focusout","onBlur"),Dr(Er,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fr));function Pr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,s,u,l){if(We.apply(this,arguments),Le){if(!Le)throw Error(i(198));var c=Pe;Le=!1,Pe=null,ze||(ze=!0,Be=c)}}(r,t,void 0,e),e.currentTarget=null}function zr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==i&&a.isPropagationStopped())break e;Pr(a,s,l),i=u}else for(o=0;o<r.length;o++){if(u=(s=r[o]).instance,l=s.currentTarget,s=s.listener,u!==i&&a.isPropagationStopped())break e;Pr(a,s,l),i=u}}}if(ze)throw e=Be,ze=!1,Be=null,e}function Br(e,t){var n=t[va];void 0===n&&(n=t[va]=new Set);var r=e+"__bubble";n.has(r)||(Hr(t,e,2,!1),n.add(r))}function Vr(e,t,n){var r=0;t&&(r|=4),Hr(n,e,r,t)}var Wr="_reactListening"+Math.random().toString(36).slice(2);function Ur(e){if(!e[Wr]){e[Wr]=!0,o.forEach((function(t){"selectionchange"!==t&&(Lr.has(t)||Vr(t,!1,e),Vr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Wr]||(t[Wr]=!0,Vr("selectionchange",!1,t))}}function Hr(e,t,n,r){switch(Zt(t)){case 1:var a=jt;break;case 4:a=qt;break;default:a=Xt}n=a.bind(null,t,n,e),a=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Gr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var u=o.tag;if((3===u||4===u)&&((u=o.stateNode.containerInfo)===a||8===u.nodeType&&u.parentNode===a))return;o=o.return}for(;null!==s;){if(null===(o=ya(s)))return;if(5===(u=o.tag)||6===u){r=i=o;continue e}s=s.parentNode}}r=r.return}Ae((function(){var r=i,a=ke(n),o=[];e:{var s=Mr.get(e);if(void 0!==s){var u=cn,l=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":u=Tn;break;case"focusin":l="focus",u=mn;break;case"focusout":l="blur",u=mn;break;case"beforeblur":case"afterblur":u=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=dn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=En;break;case Cr:case Tr:case Nr:u=gn;break;case Er:u=Mn;break;case"scroll":u=pn;break;case"wheel":u=Dn;break;case"copy":case"cut":case"paste":u=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=Nn}var c=0!==(4&t),h=!c&&"scroll"===e,p=c?null!==s?s+"Capture":null:s;c=[];for(var f,d=r;null!==d;){var v=(f=d).stateNode;if(5===f.tag&&null!==v&&(f=v,null!==p&&(null!=(v=De(d,p))&&c.push(jr(d,v,f)))),h)break;d=d.return}0<c.length&&(s=new u(s,l,null,n,a),o.push({event:s,listeners:c}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===xe||!(l=n.relatedTarget||n.fromElement)||!ya(l)&&!l[da])&&(u||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(l=(l=n.relatedTarget||n.toElement)?ya(l):null)&&(l!==(h=Ue(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(u=null,l=r),u!==l)){if(c=dn,v="onMouseLeave",p="onMouseEnter",d="mouse","pointerout"!==e&&"pointerover"!==e||(c=Nn,v="onPointerLeave",p="onPointerEnter",d="pointer"),h=null==u?s:xa(u),f=null==l?s:xa(l),(s=new c(v,d+"leave",u,n,a)).target=h,s.relatedTarget=f,v=null,ya(a)===r&&((c=new c(p,d+"enter",l,n,a)).target=f,c.relatedTarget=h,v=c),h=v,u&&l)e:{for(p=l,d=0,f=c=u;f;f=Xr(f))d++;for(f=0,v=p;v;v=Xr(v))f++;for(;0<d-f;)c=Xr(c),d--;for(;0<f-d;)p=Xr(p),f--;for(;d--;){if(c===p||null!==p&&c===p.alternate)break e;c=Xr(c),p=Xr(p)}c=null}else c=null;null!==u&&Kr(o,s,u,c,!1),null!==l&&null!==h&&Kr(o,h,l,c,!0)}if("select"===(u=(s=r?xa(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var m=Zn;else if(Gn(s))if(Qn)m=or;else{m=ar;var g=rr}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=ir);switch(m&&(m=m(e,r))?jn(o,m,n,a):(g&&g(e,s,r),"focusout"===e&&(g=s._wrapperState)&&g.controlled&&"number"===s.type&&ee(s,"number",s.value)),g=r?xa(r):window,e){case"focusin":(Gn(g)||"true"===g.contentEditable)&&(mr=g,gr=r,yr=null);break;case"focusout":yr=gr=mr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(o,n,a);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":xr(o,n,a)}var y;if(On)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Un?Vn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Pn&&"ko"!==n.locale&&(Un||"onCompositionStart"!==b?"onCompositionEnd"===b&&Un&&(y=en()):($t="value"in(Qt=a)?Qt.value:Qt.textContent,Un=!0)),0<(g=qr(r,b)).length&&(b=new xn(b,e,null,n,a),o.push({event:b,listeners:g}),y?b.data=y:null!==(y=Wn(n))&&(b.data=y))),(y=Ln?function(e,t){switch(e){case"compositionend":return Wn(t);case"keypress":return 32!==t.which?null:(Bn=!0,zn);case"textInput":return(e=t.data)===zn&&Bn?null:e;default:return null}}(e,n):function(e,t){if(Un)return"compositionend"===e||!On&&Vn(e,t)?(e=en(),Jt=$t=Qt=null,Un=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Pn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=qr(r,"onBeforeInput")).length&&(a=new xn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=y))}zr(o,t)}))}function jr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=De(e,n))&&r.unshift(jr(e,i,a)),null!=(i=De(e,t))&&r.push(jr(e,i,a))),e=e.return}return r}function Xr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kr(e,t,n,r,a){for(var i=t._reactName,o=[];null!==n&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==l&&(s=l,a?null!=(u=De(n,i))&&o.unshift(jr(n,u,s)):a||null!=(u=De(n,i))&&o.push(jr(n,u,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Yr=/\r\n?/g,Zr=/\u0000|\uFFFD/g;function Qr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Zr,"")}function $r(e,t,n){if(t=Qr(t),Qr(e)!==t&&n)throw Error(i(425))}function Jr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(sa)}:ra;function sa(e){setTimeout((function(){throw e}))}function ua(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Ut(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Ut(t)}function la(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ca(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ha=Math.random().toString(36).slice(2),pa="__reactFiber$"+ha,fa="__reactProps$"+ha,da="__reactContainer$"+ha,va="__reactEvents$"+ha,ma="__reactListeners$"+ha,ga="__reactHandles$"+ha;function ya(e){var t=e[pa];if(t)return t;for(var n=e.parentNode;n;){if(t=n[da]||n[pa]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ca(e);null!==e;){if(n=e[pa])return n;e=ca(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[pa]||e[da])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function ka(e){return e[fa]||null}var wa=[],_a=-1;function Sa(e){return{current:e}}function Ia(e){0>_a||(e.current=wa[_a],wa[_a]=null,_a--)}function Ca(e,t){_a++,wa[_a]=e.current,e.current=t}var Ta={},Na=Sa(Ta),Ea=Sa(!1),Ma=Ta;function Aa(e,t){var n=e.type.contextTypes;if(!n)return Ta;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Da(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ra(){Ia(Ea),Ia(Na)}function Oa(e,t,n){if(Na.current!==Ta)throw Error(i(168));Ca(Na,t),Ca(Ea,n)}function Fa(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,H(e)||"Unknown",a));return P({},n,r)}function La(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ta,Ma=Na.current,Ca(Na,e),Ca(Ea,Ea.current),!0}function Pa(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Fa(e,t,Ma),r.__reactInternalMemoizedMergedChildContext=e,Ia(Ea),Ia(Na),Ca(Na,e)):Ia(Ea),Ca(Ea,n)}var za=null,Ba=!1,Va=!1;function Wa(e){null===za?za=[e]:za.push(e)}function Ua(){if(!Va&&null!==za){Va=!0;var e=0,t=bt;try{var n=za;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}za=null,Ba=!1}catch(a){throw null!==za&&(za=za.slice(e+1)),Xe(Je,Ua),a}finally{bt=t,Va=!1}}return null}var Ha=x.ReactCurrentBatchConfig;function Ga(e,t){if(e&&e.defaultProps){for(var n in t=P({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var ja=Sa(null),qa=null,Xa=null,Ka=null;function Ya(){Ka=Xa=qa=null}function Za(e){var t=ja.current;Ia(ja),e._currentValue=t}function Qa(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function $a(e,t){qa=e,Ka=Xa=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ks=!0),e.firstContext=null)}function Ja(e){var t=e._currentValue;if(Ka!==e)if(e={context:e,memoizedValue:t,next:null},null===Xa){if(null===qa)throw Error(i(308));Xa=e,qa.dependencies={lanes:0,firstContext:e}}else Xa=Xa.next=e;return t}var ei=null,ti=!1;function ni(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ri(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ai(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ii(e,t){var n=e.updateQueue;null!==n&&(n=n.shared,tl(e)?(null===(e=n.interleaved)?(t.next=t,null===ei?ei=[n]:ei.push(n)):(t.next=e.next,e.next=t),n.interleaved=t):(null===(e=n.pending)?t.next=t:(t.next=e.next,e.next=t),n.pending=t))}function oi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function si(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ui(e,t,n,r){var a=e.updateQueue;ti=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var u=s,l=u.next;u.next=null,null===o?i=l:o.next=l,o=u;var c=e.alternate;null!==c&&((s=(c=c.updateQueue).lastBaseUpdate)!==o&&(null===s?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=u))}if(null!==i){var h=a.baseState;for(o=0,c=l=u=null,s=i;;){var p=s.lane,f=s.eventTime;if((r&p)===p){null!==c&&(c=c.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var d=e,v=s;switch(p=t,f=n,v.tag){case 1:if("function"===typeof(d=v.payload)){h=d.call(f,h,p);break e}h=d;break e;case 3:d.flags=-65537&d.flags|128;case 0:if(null===(p="function"===typeof(d=v.payload)?d.call(f,h,p):d)||void 0===p)break e;h=P({},h,p);break e;case 2:ti=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(p=a.effects)?a.effects=[s]:p.push(s))}else f={eventTime:f,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===c?(l=c=f,u=h):c=c.next=f,o|=p;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(p=s).next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}if(null===c&&(u=h),a.baseState=u,a.firstBaseUpdate=l,a.lastBaseUpdate=c,null!==(t=a.shared.interleaved)){a=t;do{o|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Ru|=o,e.lanes=o,e.memoizedState=h}}function li(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var ci=(new r.Component).refs;function hi(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:P({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var pi={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Qu(),a=$u(e),i=ai(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),ii(e,i),null!==(t=Ju(e,a,r))&&oi(t,e,a)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Qu(),a=$u(e),i=ai(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),ii(e,i),null!==(t=Ju(e,a,r))&&oi(t,e,a)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Qu(),r=$u(e),a=ai(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),ii(e,a),null!==(t=Ju(e,r,n))&&oi(t,e,r)}};function fi(e,t,n,r,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!ur(n,r)||!ur(a,i))}function di(e,t,n){var r=!1,a=Ta,i=t.contextType;return"object"===typeof i&&null!==i?i=Ja(i):(a=Da(t)?Ma:Na.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Aa(e,a):Ta),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=pi,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function vi(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&pi.enqueueReplaceState(t,t.state,null)}function mi(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=ci,ni(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Ja(i):(i=Da(t)?Ma:Na.current,a.context=Aa(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(hi(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&pi.enqueueReplaceState(a,a.state,null),ui(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}var gi=[],yi=0,bi=null,xi=0,ki=[],wi=0,_i=null,Si=1,Ii="";function Ci(e,t){gi[yi++]=xi,gi[yi++]=bi,bi=e,xi=t}function Ti(e,t,n){ki[wi++]=Si,ki[wi++]=Ii,ki[wi++]=_i,_i=e;var r=Si;e=Ii;var a=32-ot(r)-1;r&=~(1<<a),n+=1;var i=32-ot(t)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,Si=1<<32-ot(t)+a|n<<a|r,Ii=i+e}else Si=1<<i|n<<a|r,Ii=e}function Ni(e){null!==e.return&&(Ci(e,1),Ti(e,1,0))}function Ei(e){for(;e===bi;)bi=gi[--yi],gi[yi]=null,xi=gi[--yi],gi[yi]=null;for(;e===_i;)_i=ki[--wi],ki[wi]=null,Ii=ki[--wi],ki[wi]=null,Si=ki[--wi],ki[wi]=null}var Mi=null,Ai=null,Di=!1,Ri=null;function Oi(e,t){var n=Ml(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function Fi(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,Mi=e,Ai=la(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,Mi=e,Ai=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==_i?{id:Si,overflow:Ii}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ml(18,null,null,0)).stateNode=t,n.return=e,e.child=n,Mi=e,Ai=null,!0);default:return!1}}function Li(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function Pi(e){if(Di){var t=Ai;if(t){var n=t;if(!Fi(e,t)){if(Li(e))throw Error(i(418));t=la(n.nextSibling);var r=Mi;t&&Fi(e,t)?Oi(r,n):(e.flags=-4097&e.flags|2,Di=!1,Mi=e)}}else{if(Li(e))throw Error(i(418));e.flags=-4097&e.flags|2,Di=!1,Mi=e}}}function zi(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Mi=e}function Bi(e){if(e!==Mi)return!1;if(!Di)return zi(e),Di=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=Ai)){if(Li(e)){for(e=Ai;e;)e=la(e.nextSibling);throw Error(i(418))}for(;t;)Oi(e,t),t=la(t.nextSibling)}if(zi(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){Ai=la(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}Ai=null}}else Ai=Mi?la(e.stateNode.nextSibling):null;return!0}function Vi(){Ai=Mi=null,Di=!1}function Wi(e){null===Ri?Ri=[e]:Ri.push(e)}function Ui(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;t===ci&&(t=a.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function Hi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Gi(e){return(0,e._init)(e._payload)}function ji(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Dl(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Ll(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function l(e,t,n,r){var i=n.type;return i===_?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===D&&Gi(i)===t.type)?((r=a(t,n.props)).ref=Ui(e,t,n),r.return=e,r):((r=Rl(n.type,n.key,n.props,null,e.mode,r)).ref=Ui(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Pl(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function h(e,t,n,r,i){return null===t||7!==t.tag?((t=Ol(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function p(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Ll(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case k:return(n=Rl(t.type,t.key,t.props,null,e.mode,n)).ref=Ui(e,null,t),n.return=e,n;case w:return(t=Pl(t,e.mode,n)).return=e,t;case D:return p(e,(0,t._init)(t._payload),n)}if(te(t)||F(t))return(t=Ol(t,e.mode,n,null)).return=e,t;Hi(e,t)}return null}function f(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case k:return n.key===a?l(e,t,n,r):null;case w:return n.key===a?c(e,t,n,r):null;case D:return f(e,t,(a=n._init)(n._payload),r)}if(te(n)||F(n))return null!==a?null:h(e,t,n,r,null);Hi(e,n)}return null}function d(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case k:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a);case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case D:return d(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||F(r))return h(t,e=e.get(n)||null,r,a,null);Hi(t,r)}return null}function v(a,i,s,u){for(var l=null,c=null,h=i,v=i=0,m=null;null!==h&&v<s.length;v++){h.index>v?(m=h,h=null):m=h.sibling;var g=f(a,h,s[v],u);if(null===g){null===h&&(h=m);break}e&&h&&null===g.alternate&&t(a,h),i=o(g,i,v),null===c?l=g:c.sibling=g,c=g,h=m}if(v===s.length)return n(a,h),Di&&Ci(a,v),l;if(null===h){for(;v<s.length;v++)null!==(h=p(a,s[v],u))&&(i=o(h,i,v),null===c?l=h:c.sibling=h,c=h);return Di&&Ci(a,v),l}for(h=r(a,h);v<s.length;v++)null!==(m=d(h,a,v,s[v],u))&&(e&&null!==m.alternate&&h.delete(null===m.key?v:m.key),i=o(m,i,v),null===c?l=m:c.sibling=m,c=m);return e&&h.forEach((function(e){return t(a,e)})),Di&&Ci(a,v),l}function m(a,s,u,l){var c=F(u);if("function"!==typeof c)throw Error(i(150));if(null==(u=c.call(u)))throw Error(i(151));for(var h=c=null,v=s,m=s=0,g=null,y=u.next();null!==v&&!y.done;m++,y=u.next()){v.index>m?(g=v,v=null):g=v.sibling;var b=f(a,v,y.value,l);if(null===b){null===v&&(v=g);break}e&&v&&null===b.alternate&&t(a,v),s=o(b,s,m),null===h?c=b:h.sibling=b,h=b,v=g}if(y.done)return n(a,v),Di&&Ci(a,m),c;if(null===v){for(;!y.done;m++,y=u.next())null!==(y=p(a,y.value,l))&&(s=o(y,s,m),null===h?c=y:h.sibling=y,h=y);return Di&&Ci(a,m),c}for(v=r(a,v);!y.done;m++,y=u.next())null!==(y=d(v,a,m,y.value,l))&&(e&&null!==y.alternate&&v.delete(null===y.key?m:y.key),s=o(y,s,m),null===h?c=y:h.sibling=y,h=y);return e&&v.forEach((function(e){return t(a,e)})),Di&&Ci(a,m),c}return function e(r,i,o,u){if("object"===typeof o&&null!==o&&o.type===_&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case k:e:{for(var l=o.key,c=i;null!==c;){if(c.key===l){if((l=o.type)===_){if(7===c.tag){n(r,c.sibling),(i=a(c,o.props.children)).return=r,r=i;break e}}else if(c.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===D&&Gi(l)===c.type){n(r,c.sibling),(i=a(c,o.props)).ref=Ui(r,c,o),i.return=r,r=i;break e}n(r,c);break}t(r,c),c=c.sibling}o.type===_?((i=Ol(o.props.children,r.mode,u,o.key)).return=r,r=i):((u=Rl(o.type,o.key,o.props,null,r.mode,u)).ref=Ui(r,i,o),u.return=r,r=u)}return s(r);case w:e:{for(c=o.key;null!==i;){if(i.key===c){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(r,i.sibling),(i=a(i,o.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Pl(o,r.mode,u)).return=r,r=i}return s(r);case D:return e(r,i,(c=o._init)(o._payload),u)}if(te(o))return v(r,i,o,u);if(F(o))return m(r,i,o,u);Hi(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,o)).return=r,r=i):(n(r,i),(i=Ll(o,r.mode,u)).return=r,r=i),s(r)):n(r,i)}}var qi=ji(!0),Xi=ji(!1),Ki={},Yi=Sa(Ki),Zi=Sa(Ki),Qi=Sa(Ki);function $i(e){if(e===Ki)throw Error(i(174));return e}function Ji(e,t){switch(Ca(Qi,t),Ca(Zi,e),Ca(Yi,Ki),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ia(Yi),Ca(Yi,t)}function eo(){Ia(Yi),Ia(Zi),Ia(Qi)}function to(e){$i(Qi.current);var t=$i(Yi.current),n=ue(t,e.type);t!==n&&(Ca(Zi,e),Ca(Yi,n))}function no(e){Zi.current===e&&(Ia(Yi),Ia(Zi))}var ro=Sa(0);function ao(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var io=[];function oo(){for(var e=0;e<io.length;e++)io[e]._workInProgressVersionPrimary=null;io.length=0}var so=x.ReactCurrentDispatcher,uo=x.ReactCurrentBatchConfig,lo=0,co=null,ho=null,po=null,fo=!1,vo=!1,mo=0,go=0;function yo(){throw Error(i(321))}function bo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function xo(e,t,n,r,a,o){if(lo=o,co=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,so.current=null===e||null===e.memoizedState?rs:as,e=n(r,a),vo){o=0;do{if(vo=!1,mo=0,25<=o)throw Error(i(301));o+=1,po=ho=null,t.updateQueue=null,so.current=is,e=n(r,a)}while(vo)}if(so.current=ns,t=null!==ho&&null!==ho.next,lo=0,po=ho=co=null,fo=!1,t)throw Error(i(300));return e}function ko(){var e=0!==mo;return mo=0,e}function wo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===po?co.memoizedState=po=e:po=po.next=e,po}function _o(){if(null===ho){var e=co.alternate;e=null!==e?e.memoizedState:null}else e=ho.next;var t=null===po?co.memoizedState:po.next;if(null!==t)po=t,ho=e;else{if(null===e)throw Error(i(310));e={memoizedState:(ho=e).memoizedState,baseState:ho.baseState,baseQueue:ho.baseQueue,queue:ho.queue,next:null},null===po?co.memoizedState=po=e:po=po.next=e}return po}function So(e,t){return"function"===typeof t?t(e):t}function Io(e){var t=_o(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=ho,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}r.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,r=r.baseState;var u=s=null,l=null,c=o;do{var h=c.lane;if((lo&h)===h)null!==l&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var p={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===l?(u=l=p,s=r):l=l.next=p,co.lanes|=h,Ru|=h}c=c.next}while(null!==c&&c!==o);null===l?s=r:l.next=u,sr(r,t.memoizedState)||(ks=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{o=a.lane,co.lanes|=o,Ru|=o,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Co(e){var t=_o(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{o=e(o,s.action),s=s.next}while(s!==a);sr(o,t.memoizedState)||(ks=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function To(){}function No(e,t){var n=co,r=_o(),a=t(),o=!sr(r.memoizedState,a);if(o&&(r.memoizedState=a,ks=!0),r=r.queue,Bo(Ao.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==po&&1&po.memoizedState.tag){if(n.flags|=2048,Oo(9,Mo.bind(null,n,r,a,t),void 0,null),null===Cu)throw Error(i(349));0!==(30&lo)||Eo(n,t,a)}return a}function Eo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=co.updateQueue)?(t={lastEffect:null,stores:null},co.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Mo(e,t,n,r){t.value=n,t.getSnapshot=r,Do(t)&&Ju(e,1,-1)}function Ao(e,t,n){return n((function(){Do(t)&&Ju(e,1,-1)}))}function Do(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Ro(e){var t=wo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:So,lastRenderedState:e},t.queue=e,e=e.dispatch=Qo.bind(null,co,e),[t.memoizedState,e]}function Oo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=co.updateQueue)?(t={lastEffect:null,stores:null},co.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Fo(){return _o().memoizedState}function Lo(e,t,n,r){var a=wo();co.flags|=e,a.memoizedState=Oo(1|t,n,void 0,void 0===r?null:r)}function Po(e,t,n,r){var a=_o();r=void 0===r?null:r;var i=void 0;if(null!==ho){var o=ho.memoizedState;if(i=o.destroy,null!==r&&bo(r,o.deps))return void(a.memoizedState=Oo(t,n,i,r))}co.flags|=e,a.memoizedState=Oo(1|t,n,i,r)}function zo(e,t){return Lo(8390656,8,e,t)}function Bo(e,t){return Po(2048,8,e,t)}function Vo(e,t){return Po(4,2,e,t)}function Wo(e,t){return Po(4,4,e,t)}function Uo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ho(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Po(4,4,Uo.bind(null,t,e),n)}function Go(){}function jo(e,t){var n=_o();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&bo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function qo(e,t){var n=_o();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&bo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Xo(e,t,n){return 0===(21&lo)?(e.baseState&&(e.baseState=!1,ks=!0),e.memoizedState=n):(sr(n,t)||(n=vt(),co.lanes|=n,Ru|=n,e.baseState=!0),t)}function Ko(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=uo.transition;uo.transition={};try{e(!1),t()}finally{bt=n,uo.transition=r}}function Yo(){return _o().memoizedState}function Zo(e,t,n){var r=$u(e);n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},$o(e)?Jo(t,n):(es(e,t,n),null!==(e=Ju(e,r,n=Qu()))&&ts(e,t,r))}function Qo(e,t,n){var r=$u(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if($o(e))Jo(t,a);else{es(e,t,a);var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=i(o,n);if(a.hasEagerState=!0,a.eagerState=s,sr(s,o))return}catch(u){}null!==(e=Ju(e,r,n=Qu()))&&ts(e,t,r)}}function $o(e){var t=e.alternate;return e===co||null!==t&&t===co}function Jo(e,t){vo=fo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function es(e,t,n){tl(e)?(null===(e=t.interleaved)?(n.next=n,null===ei?ei=[t]:ei.push(t)):(n.next=e.next,e.next=n),t.interleaved=n):(null===(e=t.pending)?n.next=n:(n.next=e.next,e.next=n),t.pending=n)}function ts(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var ns={readContext:Ja,useCallback:yo,useContext:yo,useEffect:yo,useImperativeHandle:yo,useInsertionEffect:yo,useLayoutEffect:yo,useMemo:yo,useReducer:yo,useRef:yo,useState:yo,useDebugValue:yo,useDeferredValue:yo,useTransition:yo,useMutableSource:yo,useSyncExternalStore:yo,useId:yo,unstable_isNewReconciler:!1},rs={readContext:Ja,useCallback:function(e,t){return wo().memoizedState=[e,void 0===t?null:t],e},useContext:Ja,useEffect:zo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Lo(4194308,4,Uo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Lo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Lo(4,2,e,t)},useMemo:function(e,t){var n=wo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=wo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Zo.bind(null,co,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},wo().memoizedState=e},useState:Ro,useDebugValue:Go,useDeferredValue:function(e){return wo().memoizedState=e},useTransition:function(){var e=Ro(!1),t=e[0];return e=Ko.bind(null,e[1]),wo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=co,a=wo();if(Di){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Cu)throw Error(i(349));0!==(30&lo)||Eo(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,zo(Ao.bind(null,r,o,e),[e]),r.flags|=2048,Oo(9,Mo.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=wo(),t=Cu.identifierPrefix;if(Di){var n=Ii;t=":"+t+"R"+(n=(Si&~(1<<32-ot(Si)-1)).toString(32)+n),0<(n=mo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=go++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},as={readContext:Ja,useCallback:jo,useContext:Ja,useEffect:Bo,useImperativeHandle:Ho,useInsertionEffect:Vo,useLayoutEffect:Wo,useMemo:qo,useReducer:Io,useRef:Fo,useState:function(){return Io(So)},useDebugValue:Go,useDeferredValue:function(e){return Xo(_o(),ho.memoizedState,e)},useTransition:function(){return[Io(So)[0],_o().memoizedState]},useMutableSource:To,useSyncExternalStore:No,useId:Yo,unstable_isNewReconciler:!1},is={readContext:Ja,useCallback:jo,useContext:Ja,useEffect:Bo,useImperativeHandle:Ho,useInsertionEffect:Vo,useLayoutEffect:Wo,useMemo:qo,useReducer:Co,useRef:Fo,useState:function(){return Co(So)},useDebugValue:Go,useDeferredValue:function(e){var t=_o();return null===ho?t.memoizedState=e:Xo(t,ho.memoizedState,e)},useTransition:function(){return[Co(So)[0],_o().memoizedState]},useMutableSource:To,useSyncExternalStore:No,useId:Yo,unstable_isNewReconciler:!1};function os(e,t){try{var n="",r=t;do{n+=W(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a}}function ss(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var us,ls,cs,hs="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,n){(n=ai(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wu||(Wu=!0,Uu=r),ss(0,t)},n}function fs(e,t,n){(n=ai(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){ss(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){ss(0,t),"function"!==typeof r&&(null===Hu?Hu=new Set([this]):Hu.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ds(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hs;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Sl.bind(null,e,t,n),t.then(e,e))}function vs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ms(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=ai(-1,1)).tag=2,ii(n,t))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}function gs(e,t){if(!Di)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ys(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function bs(e,t,n){var r=t.pendingProps;switch(Ei(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ys(t),null;case 1:case 17:return Da(t.type)&&Ra(),ys(t),null;case 3:return r=t.stateNode,eo(),Ia(Ea),Ia(Na),oo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Bi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==Ri&&(il(Ri),Ri=null))),ys(t),null;case 5:no(t);var a=$i(Qi.current);if(n=t.type,null!==e&&null!=t.stateNode)ls(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return ys(t),null}if(e=$i(Yi.current),Bi(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[pa]=t,r[fa]=o,e=0!==(1&t.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(a=0;a<Fr.length;a++)Br(Fr[a],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":Z(r,o),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Br("invalid",r);break;case"textarea":ae(r,o),Br("invalid",r)}for(var u in ye(n,o),a=null,o)if(o.hasOwnProperty(u)){var l=o[u];"children"===u?"string"===typeof l?r.textContent!==l&&(!0!==o.suppressHydrationWarning&&$r(r.textContent,l,e),a=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(!0!==o.suppressHydrationWarning&&$r(r.textContent,l,e),a=["children",""+l]):s.hasOwnProperty(u)&&null!=l&&"onScroll"===u&&Br("scroll",r)}switch(n){case"input":q(r),J(r,o,!0);break;case"textarea":q(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Jr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{u=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[pa]=t,e[fa]=r,us(e,t),t.stateNode=e;e:{switch(u=be(n,r),n){case"dialog":Br("cancel",e),Br("close",e),a=r;break;case"iframe":case"object":case"embed":Br("load",e),a=r;break;case"video":case"audio":for(a=0;a<Fr.length;a++)Br(Fr[a],e);a=r;break;case"source":Br("error",e),a=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),a=r;break;case"details":Br("toggle",e),a=r;break;case"input":Z(e,r),a=Y(e,r),Br("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=P({},r,{value:void 0}),Br("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Br("invalid",e)}for(o in ye(n,a),l=a)if(l.hasOwnProperty(o)){var c=l[o];"style"===o?me(e,c):"dangerouslySetInnerHTML"===o?null!=(c=c?c.__html:void 0)&&he(e,c):"children"===o?"string"===typeof c?("textarea"!==n||""!==c)&&pe(e,c):"number"===typeof c&&pe(e,""+c):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=c&&"onScroll"===o&&Br("scroll",e):null!=c&&b(e,o,c,u))}switch(n){case"input":q(e),J(e,r,!1);break;case"textarea":q(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+G(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Jr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return ys(t),null;case 6:if(e&&null!=t.stateNode)cs(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=$i(Qi.current),$i(Yi.current),Bi(t)){if(r=t.stateNode,n=t.memoizedProps,r[pa]=t,(o=r.nodeValue!==n)&&null!==(e=Mi))switch(e.tag){case 3:$r(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&$r(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[pa]=t,t.stateNode=r}return ys(t),null;case 13:if(Ia(ro),r=t.memoizedState,Di&&null!==Ai&&0!==(1&t.mode)&&0===(128&t.flags)){for(r=Ai;r;)r=la(r.nextSibling);return Vi(),t.flags|=98560,t}if(null!==r&&null!==r.dehydrated){if(r=Bi(t),null===e){if(!r)throw Error(i(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(i(317));r[pa]=t}else Vi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;return ys(t),null}return null!==Ri&&(il(Ri),Ri=null),0!==(128&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?Bi(t):n=null!==e.memoizedState,r!==n&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ro.current)?0===Au&&(Au=3):dl())),null!==t.updateQueue&&(t.flags|=4),ys(t),null);case 4:return eo(),null===e&&Ur(t.stateNode.containerInfo),ys(t),null;case 10:return Za(t.type._context),ys(t),null;case 19:if(Ia(ro),null===(o=t.memoizedState))return ys(t),null;if(r=0!==(128&t.flags),null===(u=o.rendering))if(r)gs(o,!1);else{if(0!==Au||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=ao(e))){for(t.flags|=128,gs(o,!1),null!==(r=u.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(u=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=u.childLanes,o.lanes=u.lanes,o.child=u.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=u.memoizedProps,o.memoizedState=u.memoizedState,o.updateQueue=u.updateQueue,o.type=u.type,e=u.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ca(ro,1&ro.current|2),t.child}e=e.sibling}null!==o.tail&&Qe()>Bu&&(t.flags|=128,r=!0,gs(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ao(u))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),gs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!u.alternate&&!Di)return ys(t),null}else 2*Qe()-o.renderingStartTime>Bu&&1073741824!==n&&(t.flags|=128,r=!0,gs(o,!1),t.lanes=4194304);o.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=o.last)?n.sibling=u:t.child=u,o.last=u)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Qe(),t.sibling=null,n=ro.current,Ca(ro,r?1&n|2:1&n),t):(ys(t),null);case 22:case 23:return cl(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Eu)&&(ys(t),6&t.subtreeFlags&&(t.flags|=8192)):ys(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}us=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},ls=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,$i(Yi.current);var i,o=null;switch(n){case"input":a=Y(e,a),r=Y(e,r),o=[];break;case"select":a=P({},a,{value:void 0}),r=P({},r,{value:void 0}),o=[];break;case"textarea":a=re(e,a),r=re(e,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Jr)}for(c in ye(n,r),n=null,a)if(!r.hasOwnProperty(c)&&a.hasOwnProperty(c)&&null!=a[c])if("style"===c){var u=a[c];for(i in u)u.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(s.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var l=r[c];if(u=null!=a?a[c]:void 0,r.hasOwnProperty(c)&&l!==u&&(null!=l||null!=u))if("style"===c)if(u){for(i in u)!u.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&u[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(o||(o=[]),o.push(c,n)),n=l;else"dangerouslySetInnerHTML"===c?(l=l?l.__html:void 0,u=u?u.__html:void 0,null!=l&&u!==l&&(o=o||[]).push(c,l)):"children"===c?"string"!==typeof l&&"number"!==typeof l||(o=o||[]).push(c,""+l):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(s.hasOwnProperty(c)?(null!=l&&"onScroll"===c&&Br("scroll",e),o||u===l||(o=[])):(o=o||[]).push(c,l))}n&&(o=o||[]).push("style",n);var c=o;(t.updateQueue=c)&&(t.flags|=4)}},cs=function(e,t,n,r){n!==r&&(t.flags|=4)};var xs=x.ReactCurrentOwner,ks=!1;function ws(e,t,n,r){t.child=null===e?Xi(t,null,n,r):qi(t,e.child,n,r)}function _s(e,t,n,r,a){n=n.render;var i=t.ref;return $a(t,a),r=xo(e,t,n,r,i,a),n=ko(),null===e||ks?(Di&&n&&Ni(t),t.flags|=1,ws(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Gs(e,t,a))}function Ss(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Al(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Rl(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Is(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var o=i.memoizedProps;if((n=null!==(n=n.compare)?n:ur)(o,r)&&e.ref===t.ref)return Gs(e,t,a)}return t.flags|=1,(e=Dl(i,r)).ref=t.ref,e.return=t,t.child=e}function Is(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(ur(i,r)&&e.ref===t.ref){if(ks=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,Gs(e,t,a);0!==(131072&e.flags)&&(ks=!0)}}return Ns(e,t,n,r,a)}function Cs(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ca(Mu,Eu),Eu|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ca(Mu,Eu),Eu|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Ca(Mu,Eu),Eu|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ca(Mu,Eu),Eu|=r;return ws(e,t,a,n),t.child}function Ts(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ns(e,t,n,r,a){var i=Da(n)?Ma:Na.current;return i=Aa(t,i),$a(t,a),n=xo(e,t,n,r,i,a),r=ko(),null===e||ks?(Di&&r&&Ni(t),t.flags|=1,ws(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Gs(e,t,a))}function Es(e,t,n,r,a){if(Da(n)){var i=!0;La(t)}else i=!1;if($a(t,a),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),di(t,n,r),mi(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var u=o.context,l=n.contextType;"object"===typeof l&&null!==l?l=Ja(l):l=Aa(t,l=Da(n)?Ma:Na.current);var c=n.getDerivedStateFromProps,h="function"===typeof c||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||u!==l)&&vi(t,o,r,l),ti=!1;var p=t.memoizedState;o.state=p,ui(t,r,o,a),u=t.memoizedState,s!==r||p!==u||Ea.current||ti?("function"===typeof c&&(hi(t,n,c,r),u=t.memoizedState),(s=ti||fi(t,n,s,r,p,u,l))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=l,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,ri(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:Ga(t.type,s),o.props=l,h=t.pendingProps,p=o.context,"object"===typeof(u=n.contextType)&&null!==u?u=Ja(u):u=Aa(t,u=Da(n)?Ma:Na.current);var f=n.getDerivedStateFromProps;(c="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==h||p!==u)&&vi(t,o,r,u),ti=!1,p=t.memoizedState,o.state=p,ui(t,r,o,a);var d=t.memoizedState;s!==h||p!==d||Ea.current||ti?("function"===typeof f&&(hi(t,n,f,r),d=t.memoizedState),(l=ti||fi(t,n,l,r,p,d,u)||!1)?(c||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,d,u),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,d,u)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=d),o.props=r,o.state=d,o.context=u,r=l):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return Ms(e,t,n,r,i,a)}function Ms(e,t,n,r,a,i){Ts(e,t);var o=0!==(128&t.flags);if(!r&&!o)return a&&Pa(t,n,!1),Gs(e,t,i);r=t.stateNode,xs.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=qi(t,e.child,null,i),t.child=qi(t,null,s,i)):ws(e,t,s,i),t.memoizedState=r.state,a&&Pa(t,n,!0),t.child}function As(e){var t=e.stateNode;t.pendingContext?Oa(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Oa(0,t.context,!1),Ji(e,t.containerInfo)}function Ds(e,t,n,r,a){return Vi(),Wi(a),t.flags|=256,ws(e,t,n,r),t.child}var Rs={dehydrated:null,treeContext:null,retryLane:0};function Os(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fs(e,t){return{baseLanes:e.baseLanes|t,cachePool:null,transitions:e.transitions}}function Ls(e,t,n){var r,a=t.pendingProps,o=ro.current,s=!1,u=0!==(128&t.flags);if((r=u)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ca(ro,1&o),null===e)return Pi(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(o=a.children,e=a.fallback,s?(a=t.mode,s=t.child,o={mode:"hidden",children:o},0===(1&a)&&null!==s?(s.childLanes=0,s.pendingProps=o):s=Fl(o,a,0,null),e=Ol(e,a,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Os(n),t.memoizedState=Rs,e):Ps(t,o));if(null!==(o=e.memoizedState)){if(null!==(r=o.dehydrated)){if(u)return 256&t.flags?(t.flags&=-257,Vs(e,t,n,Error(i(422)))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=a.fallback,o=t.mode,a=Fl({mode:"visible",children:a.children},o,0,null),(s=Ol(s,o,n,null)).flags|=2,a.return=t,s.return=t,a.sibling=s,t.child=a,0!==(1&t.mode)&&qi(t,e.child,null,n),t.child.memoizedState=Os(n),t.memoizedState=Rs,s);if(0===(1&t.mode))t=Vs(e,t,n,null);else if("$!"===r.data)t=Vs(e,t,n,Error(i(419)));else if(a=0!==(n&e.childLanes),ks||a){if(null!==(a=Cu)){switch(n&-n){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(a=0!==(s&(a.suspendedLanes|n))?0:s)&&a!==o.retryLane&&(o.retryLane=a,Ju(e,a,-1))}dl(),t=Vs(e,t,n,Error(i(421)))}else"$?"===r.data?(t.flags|=128,t.child=e.child,t=Cl.bind(null,e),r._reactRetry=t,t=null):(n=o.treeContext,Ai=la(r.nextSibling),Mi=t,Di=!0,Ri=null,null!==n&&(ki[wi++]=Si,ki[wi++]=Ii,ki[wi++]=_i,Si=n.id,Ii=n.overflow,_i=t),(t=Ps(t,t.pendingProps.children)).flags|=4096);return t}return s?(a=Bs(e,t,a.children,a.fallback,n),s=t.child,o=e.child.memoizedState,s.memoizedState=null===o?Os(n):Fs(o,n),s.childLanes=e.childLanes&~n,t.memoizedState=Rs,a):(n=zs(e,t,a.children,n),t.memoizedState=null,n)}return s?(a=Bs(e,t,a.children,a.fallback,n),s=t.child,o=e.child.memoizedState,s.memoizedState=null===o?Os(n):Fs(o,n),s.childLanes=e.childLanes&~n,t.memoizedState=Rs,a):(n=zs(e,t,a.children,n),t.memoizedState=null,n)}function Ps(e,t){return(t=Fl({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zs(e,t,n,r){var a=e.child;return e=a.sibling,n=Dl(a,{mode:"visible",children:n}),0===(1&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n}function Bs(e,t,n,r,a){var i=t.mode,o=(e=e.child).sibling,s={mode:"hidden",children:n};return 0===(1&i)&&t.child!==e?((n=t.child).childLanes=0,n.pendingProps=s,t.deletions=null):(n=Dl(e,s)).subtreeFlags=14680064&e.subtreeFlags,null!==o?r=Dl(o,r):(r=Ol(r,i,a,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function Vs(e,t,n,r){return null!==r&&Wi(r),qi(t,e.child,null,n),(e=Ps(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ws(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Qa(e.return,t,n)}function Us(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Hs(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(ws(e,t,r.children,n),0!==(2&(r=ro.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ws(e,n,t);else if(19===e.tag)Ws(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ca(ro,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===ao(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Us(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===ao(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Us(t,!0,n,null,i);break;case"together":Us(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Gs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ru|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Dl(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Dl(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function js(e,t){switch(Ei(t),t.tag){case 1:return Da(t.type)&&Ra(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return eo(),Ia(Ea),Ia(Na),oo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return no(t),null;case 13:if(Ia(ro),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));Vi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ia(ro),null;case 4:return eo(),null;case 10:return Za(t.type._context),null;case 22:case 23:return cl(),null;default:return null}}var qs=!1,Xs=!1,Ks="function"===typeof WeakSet?WeakSet:Set,Ys=null;function Zs(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){_l(e,t,r)}else n.current=null}function Qs(e,t,n){try{n()}catch(r){_l(e,t,r)}}var $s=!1;function Js(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&Qs(t,n,i)}a=a.next}while(a!==r)}}function eu(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function tu(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function nu(e){var t=e.alternate;null!==t&&(e.alternate=null,nu(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[pa],delete t[fa],delete t[va],delete t[ma],delete t[ga])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ru(e){return 5===e.tag||3===e.tag||4===e.tag}function au(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ru(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function iu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Jr));else if(4!==r&&null!==(e=e.child))for(iu(e,t,n),e=e.sibling;null!==e;)iu(e,t,n),e=e.sibling}function ou(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ou(e,t,n),e=e.sibling;null!==e;)ou(e,t,n),e=e.sibling}var su=null,uu=!1;function lu(e,t,n){for(n=n.child;null!==n;)cu(e,t,n),n=n.sibling}function cu(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(s){}switch(n.tag){case 5:Xs||Zs(n,t);case 6:var r=su,a=uu;su=null,lu(e,t,n),uu=a,null!==(su=r)&&(uu?(e=su,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):su.removeChild(n.stateNode));break;case 18:null!==su&&(uu?(e=su,n=n.stateNode,8===e.nodeType?ua(e.parentNode,n):1===e.nodeType&&ua(e,n),Ut(e)):ua(su,n.stateNode));break;case 4:r=su,a=uu,su=n.stateNode.containerInfo,uu=!0,lu(e,t,n),su=r,uu=a;break;case 0:case 11:case 14:case 15:if(!Xs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&Qs(n,t,o),a=a.next}while(a!==r)}lu(e,t,n);break;case 1:if(!Xs&&(Zs(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){_l(n,t,s)}lu(e,t,n);break;case 21:lu(e,t,n);break;case 22:1&n.mode?(Xs=(r=Xs)||null!==n.memoizedState,lu(e,t,n),Xs=r):lu(e,t,n);break;default:lu(e,t,n)}}function hu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ks),t.forEach((function(t){var r=Tl.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function pu(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var o=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 5:su=u.stateNode,uu=!1;break e;case 3:case 4:su=u.stateNode.containerInfo,uu=!0;break e}u=u.return}if(null===su)throw Error(i(160));cu(o,s,a),su=null,uu=!1;var l=a.alternate;null!==l&&(l.return=null),a.return=null}catch(c){_l(a,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)fu(t,e),t=t.sibling}function fu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pu(t,e),du(e),4&r){try{Js(3,e,e.return),eu(3,e)}catch(v){_l(e,e.return,v)}try{Js(5,e,e.return)}catch(v){_l(e,e.return,v)}}break;case 1:pu(t,e),du(e),512&r&&null!==n&&Zs(n,n.return);break;case 5:if(pu(t,e),du(e),512&r&&null!==n&&Zs(n,n.return),32&e.flags){var a=e.stateNode;try{pe(a,"")}catch(v){_l(e,e.return,v)}}if(4&r&&null!=(a=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,u=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===u&&"radio"===o.type&&null!=o.name&&Q(a,o),be(u,s);var c=be(u,o);for(s=0;s<l.length;s+=2){var h=l[s],p=l[s+1];"style"===h?me(a,p):"dangerouslySetInnerHTML"===h?he(a,p):"children"===h?pe(a,p):b(a,h,p,c)}switch(u){case"input":$(a,o);break;case"textarea":ie(a,o);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var d=o.value;null!=d?ne(a,!!o.multiple,d,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(a,!!o.multiple,o.defaultValue,!0):ne(a,!!o.multiple,o.multiple?[]:"",!1))}a[fa]=o}catch(v){_l(e,e.return,v)}}break;case 6:if(pu(t,e),du(e),4&r){if(null===e.stateNode)throw Error(i(162));c=e.stateNode,h=e.memoizedProps;try{c.nodeValue=h}catch(v){_l(e,e.return,v)}}break;case 3:if(pu(t,e),du(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(v){_l(e,e.return,v)}break;case 4:default:pu(t,e),du(e);break;case 13:pu(t,e),du(e),8192&(c=e.child).flags&&null!==c.memoizedState&&(null===c.alternate||null===c.alternate.memoizedState)&&(zu=Qe()),4&r&&hu(e);break;case 22:if(c=null!==n&&null!==n.memoizedState,1&e.mode?(Xs=(h=Xs)||c,pu(t,e),Xs=h):pu(t,e),du(e),8192&r){h=null!==e.memoizedState;e:for(p=null,f=e;;){if(5===f.tag){if(null===p){p=f;try{a=f.stateNode,h?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(u=f.stateNode,s=void 0!==(l=f.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,u.style.display=ve("display",s))}catch(v){_l(e,e.return,v)}}}else if(6===f.tag){if(null===p)try{f.stateNode.nodeValue=h?"":f.memoizedProps}catch(v){_l(e,e.return,v)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===e)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;null===f.sibling;){if(null===f.return||f.return===e)break e;p===f&&(p=null),f=f.return}p===f&&(p=null),f.sibling.return=f.return,f=f.sibling}if(h&&!c&&0!==(1&e.mode))for(Ys=e,e=e.child;null!==e;){for(c=Ys=e;null!==Ys;){switch(p=(h=Ys).child,h.tag){case 0:case 11:case 14:case 15:Js(4,h,h.return);break;case 1:if(Zs(h,h.return),"function"===typeof(o=h.stateNode).componentWillUnmount){f=h,d=h.return;try{a=f,o.props=a.memoizedProps,o.state=a.memoizedState,o.componentWillUnmount()}catch(v){_l(f,d,v)}}break;case 5:Zs(h,h.return);break;case 22:if(null!==h.memoizedState){yu(c);continue}}null!==p?(p.return=h,Ys=p):yu(c)}e=e.sibling}}break;case 19:pu(t,e),du(e),4&r&&hu(e);case 21:}}function du(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ru(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(pe(a,""),r.flags&=-33),ou(e,au(e),a);break;case 3:case 4:var o=r.stateNode.containerInfo;iu(e,au(e),o);break;default:throw Error(i(161))}}catch(s){_l(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vu(e,t,n){Ys=e,mu(e,t,n)}function mu(e,t,n){for(var r=0!==(1&e.mode);null!==Ys;){var a=Ys,i=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||qs;if(!o){var s=a.alternate,u=null!==s&&null!==s.memoizedState||Xs;s=qs;var l=Xs;if(qs=o,(Xs=u)&&!l)for(Ys=a;null!==Ys;)u=(o=Ys).child,22===o.tag&&null!==o.memoizedState?bu(a):null!==u?(u.return=o,Ys=u):bu(a);for(;null!==i;)Ys=i,mu(i,t,n),i=i.sibling;Ys=a,qs=s,Xs=l}gu(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Ys=i):gu(e)}}function gu(e){for(;null!==Ys;){var t=Ys;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xs||eu(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Xs)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:Ga(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&li(t,o,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}li(t,s,n)}break;case 5:var u=t.stateNode;if(null===n&&4&t.flags){n=u;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var h=c.memoizedState;if(null!==h){var p=h.dehydrated;null!==p&&Ut(p)}}}break;default:throw Error(i(163))}Xs||512&t.flags&&tu(t)}catch(f){_l(t,t.return,f)}}if(t===e){Ys=null;break}if(null!==(n=t.sibling)){n.return=t.return,Ys=n;break}Ys=t.return}}function yu(e){for(;null!==Ys;){var t=Ys;if(t===e){Ys=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Ys=n;break}Ys=t.return}}function bu(e){for(;null!==Ys;){var t=Ys;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{eu(4,t)}catch(u){_l(t,n,u)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(u){_l(t,a,u)}}var i=t.return;try{tu(t)}catch(u){_l(t,i,u)}break;case 5:var o=t.return;try{tu(t)}catch(u){_l(t,o,u)}}}catch(u){_l(t,t.return,u)}if(t===e){Ys=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Ys=s;break}Ys=t.return}}var xu,ku=Math.ceil,wu=x.ReactCurrentDispatcher,_u=x.ReactCurrentOwner,Su=x.ReactCurrentBatchConfig,Iu=0,Cu=null,Tu=null,Nu=0,Eu=0,Mu=Sa(0),Au=0,Du=null,Ru=0,Ou=0,Fu=0,Lu=null,Pu=null,zu=0,Bu=1/0,Vu=null,Wu=!1,Uu=null,Hu=null,Gu=!1,ju=null,qu=0,Xu=0,Ku=null,Yu=-1,Zu=0;function Qu(){return 0!==(6&Iu)?Qe():-1!==Yu?Yu:Yu=Qe()}function $u(e){return 0===(1&e.mode)?1:0!==(2&Iu)&&0!==Nu?Nu&-Nu:null!==Ha.transition?(0===Zu&&(Zu=vt()),Zu):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Zt(e.type)}function Ju(e,t,n){if(50<Xu)throw Xu=0,Ku=null,Error(i(185));var r=el(e,t);return null===r?null:(gt(r,t,n),0!==(2&Iu)&&r===Cu||(r===Cu&&(0===(2&Iu)&&(Ou|=t),4===Au&&ol(r,Nu)),nl(r,n),1===t&&0===Iu&&0===(1&e.mode)&&(Bu=Qe()+500,Ba&&Ua())),r)}function el(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function tl(e){return(null!==Cu||null!==ei)&&0!==(1&e.mode)&&0===(2&Iu)}function nl(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-ot(i),s=1<<o,u=a[o];-1===u?0!==(s&n)&&0===(s&r)||(a[o]=ft(s,t)):u<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var r=pt(e,e===Cu?Nu:0);if(0===r)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){Ba=!0,Wa(e)}(sl.bind(null,e)):Wa(sl.bind(null,e)),oa((function(){0===Iu&&Ua()})),n=null;else{switch(xt(r)){case 1:n=Je;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Nl(n,rl.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rl(e,t){if(Yu=-1,Zu=0,0!==(6&Iu))throw Error(i(327));var n=e.callbackNode;if(kl()&&e.callbackNode!==n)return null;var r=pt(e,e===Cu?Nu:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vl(e,r);else{t=r;var a=Iu;Iu|=2;var o=fl();for(Cu===e&&Nu===t||(Vu=null,Bu=Qe()+500,hl(e,t));;)try{gl();break}catch(u){pl(e,u)}Ya(),wu.current=o,Iu=a,null!==Tu?t=0:(Cu=null,Nu=0,t=Au)}if(0!==t){if(2===t&&(0!==(a=dt(e))&&(r=a,t=al(e,a))),1===t)throw n=Du,hl(e,0),ol(e,r),nl(e,Qe()),n;if(6===t)ol(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!sr(i(),a))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=vl(e,r))&&(0!==(o=dt(e))&&(r=o,t=al(e,o))),1===t))throw n=Du,hl(e,0),ol(e,r),nl(e,Qe()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:xl(e,Pu,Vu);break;case 3:if(ol(e,r),(130023424&r)===r&&10<(t=zu+500-Qe())){if(0!==pt(e,0))break;if(((a=e.suspendedLanes)&r)!==r){Qu(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(xl.bind(null,e,Pu,Vu),t);break}xl(e,Pu,Vu);break;case 4:if(ol(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var s=31-ot(r);o=1<<s,(s=t[s])>a&&(a=s),r&=~o}if(r=a,10<(r=(120>(r=Qe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ku(r/1960))-r)){e.timeoutHandle=ra(xl.bind(null,e,Pu,Vu),r);break}xl(e,Pu,Vu);break;default:throw Error(i(329))}}}return nl(e,Qe()),e.callbackNode===n?rl.bind(null,e):null}function al(e,t){var n=Lu;return e.current.memoizedState.isDehydrated&&(hl(e,t).flags|=256),2!==(e=vl(e,t))&&(t=Pu,Pu=n,null!==t&&il(t)),e}function il(e){null===Pu?Pu=e:Pu.push.apply(Pu,e)}function ol(e,t){for(t&=~Fu,t&=~Ou,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function sl(e){if(0!==(6&Iu))throw Error(i(327));kl();var t=pt(e,0);if(0===(1&t))return nl(e,Qe()),null;var n=vl(e,t);if(0!==e.tag&&2===n){var r=dt(e);0!==r&&(t=r,n=al(e,r))}if(1===n)throw n=Du,hl(e,0),ol(e,t),nl(e,Qe()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xl(e,Pu,Vu),nl(e,Qe()),null}function ul(e,t){var n=Iu;Iu|=1;try{return e(t)}finally{0===(Iu=n)&&(Bu=Qe()+500,Ba&&Ua())}}function ll(e){null!==ju&&0===ju.tag&&0===(6&Iu)&&kl();var t=Iu;Iu|=1;var n=Su.transition,r=bt;try{if(Su.transition=null,bt=1,e)return e()}finally{bt=r,Su.transition=n,0===(6&(Iu=t))&&Ua()}}function cl(){Eu=Mu.current,Ia(Mu)}function hl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Tu)for(n=Tu.return;null!==n;){var r=n;switch(Ei(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ra();break;case 3:eo(),Ia(Ea),Ia(Na),oo();break;case 5:no(r);break;case 4:eo();break;case 13:case 19:Ia(ro);break;case 10:Za(r.type._context);break;case 22:case 23:cl()}n=n.return}if(Cu=e,Tu=e=Dl(e.current,null),Nu=Eu=t,Au=0,Du=null,Fu=Ou=Ru=0,Pu=Lu=null,null!==ei){for(t=0;t<ei.length;t++)if(null!==(r=(n=ei[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var o=i.next;i.next=a,r.next=o}n.pending=r}ei=null}return e}function pl(e,t){for(;;){var n=Tu;try{if(Ya(),so.current=ns,fo){for(var r=co.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}fo=!1}if(lo=0,po=ho=co=null,vo=!1,mo=0,_u.current=null,null===n||null===n.return){Au=1,Du=t,Tu=null;break}e:{var o=e,s=n.return,u=n,l=t;if(t=Nu,u.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var c=l,h=u,p=h.tag;if(0===(1&h.mode)&&(0===p||11===p||15===p)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var d=vs(s);if(null!==d){d.flags&=-257,ms(d,s,u,0,t),1&d.mode&&ds(o,c,t),l=c;var v=(t=d).updateQueue;if(null===v){var m=new Set;m.add(l),t.updateQueue=m}else v.add(l);break e}if(0===(1&t)){ds(o,c,t),dl();break e}l=Error(i(426))}else if(Di&&1&u.mode){var g=vs(s);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),ms(g,s,u,0,t),Wi(l);break e}}o=l,4!==Au&&(Au=2),null===Lu?Lu=[o]:Lu.push(o),l=os(l,u),u=s;do{switch(u.tag){case 3:u.flags|=65536,t&=-t,u.lanes|=t,si(u,ps(0,l,t));break e;case 1:o=l;var y=u.type,b=u.stateNode;if(0===(128&u.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Hu||!Hu.has(b)))){u.flags|=65536,t&=-t,u.lanes|=t,si(u,fs(u,o,t));break e}}u=u.return}while(null!==u)}bl(n)}catch(x){t=x,Tu===n&&null!==n&&(Tu=n=n.return);continue}break}}function fl(){var e=wu.current;return wu.current=ns,null===e?ns:e}function dl(){0!==Au&&3!==Au&&2!==Au||(Au=4),null===Cu||0===(268435455&Ru)&&0===(268435455&Ou)||ol(Cu,Nu)}function vl(e,t){var n=Iu;Iu|=2;var r=fl();for(Cu===e&&Nu===t||(Vu=null,hl(e,t));;)try{ml();break}catch(a){pl(e,a)}if(Ya(),Iu=n,wu.current=r,null!==Tu)throw Error(i(261));return Cu=null,Nu=0,Au}function ml(){for(;null!==Tu;)yl(Tu)}function gl(){for(;null!==Tu&&!Ye();)yl(Tu)}function yl(e){var t=xu(e.alternate,e,Eu);e.memoizedProps=e.pendingProps,null===t?bl(e):Tu=t,_u.current=null}function bl(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=bs(n,t,Eu)))return void(Tu=n)}else{if(null!==(n=js(n,t)))return n.flags&=32767,void(Tu=n);if(null===e)return Au=6,void(Tu=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Tu=t);Tu=t=e}while(null!==t);0===Au&&(Au=5)}function xl(e,t,n){var r=bt,a=Su.transition;try{Su.transition=null,bt=1,function(e,t,n,r){do{kl()}while(null!==ju);if(0!==(6&Iu))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-ot(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,o),e===Cu&&(Tu=Cu=null,Nu=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Gu||(Gu=!0,Nl(tt,(function(){return kl(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Su.transition,Su.transition=null;var s=bt;bt=1;var u=Iu;Iu|=4,_u.current=null,function(e,t){if(ea=Gt,fr(e=pr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(w){n=null;break e}var s=0,u=-1,l=-1,c=0,h=0,p=e,f=null;t:for(;;){for(var d;p!==n||0!==a&&3!==p.nodeType||(u=s+a),p!==o||0!==r&&3!==p.nodeType||(l=s+r),3===p.nodeType&&(s+=p.nodeValue.length),null!==(d=p.firstChild);)f=p,p=d;for(;;){if(p===e)break t;if(f===n&&++c===a&&(u=s),f===o&&++h===r&&(l=s),null!==(d=p.nextSibling))break;f=(p=f).parentNode}p=d}n=-1===u||-1===l?null:{start:u,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Gt=!1,Ys=t;null!==Ys;)if(e=(t=Ys).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ys=e;else for(;null!==Ys;){t=Ys;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var m=v.memoizedProps,g=v.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:Ga(t.type,m),g);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;if(1===x.nodeType)x.textContent="";else if(9===x.nodeType){var k=x.body;null!=k&&(k.textContent="")}break;default:throw Error(i(163))}}catch(w){_l(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Ys=e;break}Ys=t.return}v=$s,$s=!1}(e,n),fu(n,e),dr(ta),Gt=!!ea,ta=ea=null,e.current=n,vu(n,e,a),Ze(),Iu=u,bt=s,Su.transition=o}else e.current=n;if(Gu&&(Gu=!1,ju=e,qu=a),0===(o=e.pendingLanes)&&(Hu=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),nl(e,Qe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)r(t[n]);if(Wu)throw Wu=!1,e=Uu,Uu=null,e;0!==(1&qu)&&0!==e.tag&&kl(),0!==(1&(o=e.pendingLanes))?e===Ku?Xu++:(Xu=0,Ku=e):Xu=0,Ua()}(e,t,n,r)}finally{Su.transition=a,bt=r}return null}function kl(){if(null!==ju){var e=xt(qu),t=Su.transition,n=bt;try{if(Su.transition=null,bt=16>e?16:e,null===ju)var r=!1;else{if(e=ju,ju=null,qu=0,0!==(6&Iu))throw Error(i(331));var a=Iu;for(Iu|=4,Ys=e.current;null!==Ys;){var o=Ys,s=o.child;if(0!==(16&Ys.flags)){var u=o.deletions;if(null!==u){for(var l=0;l<u.length;l++){var c=u[l];for(Ys=c;null!==Ys;){var h=Ys;switch(h.tag){case 0:case 11:case 15:Js(8,h,o)}var p=h.child;if(null!==p)p.return=h,Ys=p;else for(;null!==Ys;){var f=(h=Ys).sibling,d=h.return;if(nu(h),h===c){Ys=null;break}if(null!==f){f.return=d,Ys=f;break}Ys=d}}}var v=o.alternate;if(null!==v){var m=v.child;if(null!==m){v.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(null!==m)}}Ys=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Ys=s;else e:for(;null!==Ys;){if(0!==(2048&(o=Ys).flags))switch(o.tag){case 0:case 11:case 15:Js(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Ys=y;break e}Ys=o.return}}var b=e.current;for(Ys=b;null!==Ys;){var x=(s=Ys).child;if(0!==(2064&s.subtreeFlags)&&null!==x)x.return=s,Ys=x;else e:for(s=b;null!==Ys;){if(0!==(2048&(u=Ys).flags))try{switch(u.tag){case 0:case 11:case 15:eu(9,u)}}catch(w){_l(u,u.return,w)}if(u===s){Ys=null;break e}var k=u.sibling;if(null!==k){k.return=u.return,Ys=k;break e}Ys=u.return}}if(Iu=a,Ua(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(w){}r=!0}return r}finally{bt=n,Su.transition=t}}return!1}function wl(e,t,n){ii(e,t=ps(0,t=os(n,t),1)),t=Qu(),null!==(e=el(e,1))&&(gt(e,1,t),nl(e,t))}function _l(e,t,n){if(3===e.tag)wl(e,e,n);else for(;null!==t;){if(3===t.tag){wl(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Hu||!Hu.has(r))){ii(t,e=fs(t,e=os(n,e),1)),e=Qu(),null!==(t=el(t,1))&&(gt(t,1,e),nl(t,e));break}}t=t.return}}function Sl(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=Qu(),e.pingedLanes|=e.suspendedLanes&n,Cu===e&&(Nu&n)===n&&(4===Au||3===Au&&(130023424&Nu)===Nu&&500>Qe()-zu?hl(e,0):Fu|=n),nl(e,t)}function Il(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=Qu();null!==(e=el(e,t))&&(gt(e,t,n),nl(e,n))}function Cl(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Il(e,n)}function Tl(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Il(e,n)}function Nl(e,t){return Xe(e,t)}function El(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ml(e,t,n,r){return new El(e,t,n,r)}function Al(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dl(e,t){var n=e.alternate;return null===n?((n=Ml(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Rl(e,t,n,r,a,o){var s=2;if(r=e,"function"===typeof e)Al(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case _:return Ol(n.children,a,o,t);case S:s=8,a|=8;break;case I:return(e=Ml(12,n,t,2|a)).elementType=I,e.lanes=o,e;case E:return(e=Ml(13,n,t,a)).elementType=E,e.lanes=o,e;case M:return(e=Ml(19,n,t,a)).elementType=M,e.lanes=o,e;case R:return Fl(n,a,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:s=10;break e;case T:s=9;break e;case N:s=11;break e;case A:s=14;break e;case D:s=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Ml(s,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Ol(e,t,n,r){return(e=Ml(7,e,r,t)).lanes=n,e}function Fl(e,t,n,r){return(e=Ml(22,e,r,t)).elementType=R,e.lanes=n,e.stateNode={},e}function Ll(e,t,n){return(e=Ml(6,e,null,t)).lanes=n,e}function Pl(e,t,n){return(t=Ml(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zl(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Bl(e,t,n,r,a,i,o,s,u){return e=new zl(e,t,n,s,u),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Ml(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ni(i),e}function Vl(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Wl(e){if(!e)return Ta;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Da(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Da(n))return Fa(e,n,t)}return t}function Ul(e,t,n,r,a,i,o,s,u){return(e=Bl(n,r,!0,e,0,i,0,s,u)).context=Wl(null),n=e.current,(i=ai(r=Qu(),a=$u(n))).callback=void 0!==t&&null!==t?t:null,ii(n,i),e.current.lanes=a,gt(e,a,r),nl(e,r),e}function Hl(e,t,n,r){var a=t.current,i=Qu(),o=$u(a);return n=Wl(n),null===t.context?t.context=n:t.pendingContext=n,(t=ai(i,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),ii(a,t),null!==(e=Ju(a,o,i))&&oi(e,a,o),o}function Gl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function jl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function ql(e,t){jl(e,t),(e=e.alternate)&&jl(e,t)}xu=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ea.current)ks=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ks=!1,function(e,t,n){switch(t.tag){case 3:As(t),Vi();break;case 5:to(t);break;case 1:Da(t.type)&&La(t);break;case 4:Ji(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Ca(ja,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ca(ro,1&ro.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ls(e,t,n):(Ca(ro,1&ro.current),null!==(e=Gs(e,t,n))?e.sibling:null);Ca(ro,1&ro.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Hs(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ca(ro,ro.current),r)break;return null;case 22:case 23:return t.lanes=0,Cs(e,t,n)}return Gs(e,t,n)}(e,t,n);ks=0!==(131072&e.flags)}else ks=!1,Di&&0!==(1048576&t.flags)&&Ti(t,xi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps;var a=Aa(t,Na.current);$a(t,n),a=xo(null,t,r,e,a,n);var o=ko();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Da(r)?(o=!0,La(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,ni(t),a.updater=pi,t.stateNode=a,a._reactInternals=t,mi(t,r,e,n),t=Ms(null,t,r,!0,o,n)):(t.tag=0,Di&&o&&Ni(t),ws(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Al(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===N)return 11;if(e===A)return 14}return 2}(r),e=Ga(r,e),a){case 0:t=Ns(null,t,r,e,n);break e;case 1:t=Es(null,t,r,e,n);break e;case 11:t=_s(null,t,r,e,n);break e;case 14:t=Ss(null,t,r,Ga(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Ns(e,t,r,a=t.elementType===r?a:Ga(r,a),n);case 1:return r=t.type,a=t.pendingProps,Es(e,t,r,a=t.elementType===r?a:Ga(r,a),n);case 3:e:{if(As(t),null===e)throw Error(i(387));r=t.pendingProps,a=(o=t.memoizedState).element,ri(e,t),ui(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ds(e,t,r,n,a=Error(i(423)));break e}if(r!==a){t=Ds(e,t,r,n,a=Error(i(424)));break e}for(Ai=la(t.stateNode.containerInfo.firstChild),Mi=t,Di=!0,Ri=null,n=Xi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(Vi(),r===a){t=Gs(e,t,n);break e}ws(e,t,r,n)}t=t.child}return t;case 5:return to(t),null===e&&Pi(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,s=a.children,na(r,a)?s=null:null!==o&&na(r,o)&&(t.flags|=32),Ts(e,t),ws(e,t,s,n),t.child;case 6:return null===e&&Pi(t),null;case 13:return Ls(e,t,n);case 4:return Ji(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=qi(t,null,r,n):ws(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,_s(e,t,r,a=t.elementType===r?a:Ga(r,a),n);case 7:return ws(e,t,t.pendingProps,n),t.child;case 8:case 12:return ws(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,s=a.value,Ca(ja,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===a.children&&!Ea.current){t=Gs(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var u=o.dependencies;if(null!==u){s=o.child;for(var l=u.firstContext;null!==l;){if(l.context===r){if(1===o.tag){(l=ai(-1,n&-n)).tag=2;var c=o.updateQueue;if(null!==c){var h=(c=c.shared).pending;null===h?l.next=l:(l.next=h.next,h.next=l),c.pending=l}}o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Qa(o.return,n,t),u.lanes|=n;break}l=l.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(i(341));s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),Qa(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}ws(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,$a(t,n),r=r(a=Ja(a)),t.flags|=1,ws(e,t,r,n),t.child;case 14:return a=Ga(r=t.type,t.pendingProps),Ss(e,t,r,a=Ga(r.type,a),n);case 15:return Is(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Ga(r,a),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,Da(r)?(e=!0,La(t)):e=!1,$a(t,n),di(t,r,a),mi(t,r,a,n),Ms(null,t,r,!0,e,n);case 19:return Hs(e,t,n);case 22:return Cs(e,t,n)}throw Error(i(156,t.tag))};var Xl="function"===typeof reportError?reportError:function(e){console.error(e)};function Kl(e){this._internalRoot=e}function Yl(e){this._internalRoot=e}function Zl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Ql(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $l(){}function Jl(e,t,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if("function"===typeof a){var s=a;a=function(){var e=Gl(o);s.call(e)}}Hl(t,o,e,a)}else o=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=Gl(o);i.call(e)}}var o=Ul(t,r,e,0,null,!1,0,"",$l);return e._reactRootContainer=o,e[da]=o.current,Ur(8===e.nodeType?e.parentNode:e),ll(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var s=r;r=function(){var e=Gl(u);s.call(e)}}var u=Bl(e,0,!1,null,0,!1,0,"",$l);return e._reactRootContainer=u,e[da]=u.current,Ur(8===e.nodeType?e.parentNode:e),ll((function(){Hl(t,u,n,r)})),u}(n,t,e,a,r);return Gl(o)}Yl.prototype.render=Kl.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Hl(e,t,null,null)},Yl.prototype.unmount=Kl.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;ll((function(){Hl(null,e,null,null)})),t[da]=null}},Yl.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rt.length&&0!==t&&t<Rt[n].priority;n++);Rt.splice(n,0,e),0===n&&Pt(e)}},kt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(yt(t,1|n),nl(t,Qe()),0===(6&Iu)&&(Bu=Qe()+500,Ua()))}break;case 13:var r=Qu();ll((function(){return Ju(e,1,r)})),ql(e,1)}},wt=function(e){13===e.tag&&(Ju(e,134217728,Qu()),ql(e,134217728))},_t=function(e){if(13===e.tag){var t=Qu(),n=$u(e);Ju(e,n,t),ql(e,n)}},St=function(){return bt},It=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},we=function(e,t,n){switch(t){case"input":if($(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=ka(r);if(!a)throw Error(i(90));X(r),$(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ne=ul,Ee=ll;var ec={usingClientEntryPoint:!1,Events:[ba,xa,ka,Ce,Te,ul]},tc={findFiberByHostInstance:ya,bundleType:0,version:"18.1.0",rendererPackageName:"react-dom"},nc={bundleType:tc.bundleType,version:tc.version,rendererPackageName:tc.rendererPackageName,rendererConfig:tc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=je(e))?null:e.stateNode},findFiberByHostInstance:tc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.1.0-next-22edb9f77-20220426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rc.isDisabled&&rc.supportsFiber)try{at=rc.inject(nc),it=rc}catch(ce){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ec,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zl(t))throw Error(i(200));return Vl(e,t,null,n)},t.createRoot=function(e,t){if(!Zl(e))throw Error(i(299));var n=!1,r="",a=Xl;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Bl(e,1,!1,null,0,n,0,r,a),e[da]=t.current,Ur(8===e.nodeType?e.parentNode:e),new Kl(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=je(t))?null:e.stateNode},t.flushSync=function(e){return ll(e)},t.hydrate=function(e,t,n){if(!Ql(t))throw Error(i(200));return Jl(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Zl(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,o="",s=Xl;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Ul(t,null,e,1,null!=n?n:null,a,0,o,s),e[da]=t.current,Ur(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Yl(t)},t.render=function(e,t,n){if(!Ql(t))throw Error(i(200));return Jl(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Ql(e))throw Error(i(40));return!!e._reactRootContainer&&(ll((function(){Jl(null,null,e,!1,(function(){e._reactRootContainer=null,e[da]=null}))})),!0)},t.unstable_batchedUpdates=ul,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Ql(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Jl(e,t,n,!1,r)},t.version="18.1.0-next-22edb9f77-20220426"},1250:function(e,t,n){"use strict";var r=n(4164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4463)},5540:function(e,t,n){var r,a,i;a=[t,n(9233)],r=function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(t);function r(e){return e&&e.__esModule?e:{default:e}}e.default=n.default},void 0===(i="function"===typeof r?r.apply(t,a):r)||(e.exports=i)},9233:function(e,t,n){var r,a,i;a=[t,n(2791),n(2007)],r=function(e,t,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setHasSupportToCaptureOption=f;var r=i(t),a=i(n);function i(e){return e&&e.__esModule?e:{default:e}}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function s(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function h(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=!1;function f(e){p=e}try{addEventListener("test",null,Object.defineProperty({},"capture",{get:function(){f(!0)}}))}catch(g){}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{capture:!0};return p?e:e.capture}function v(e){if("touches"in e){var t=e.touches[0];return{x:t.pageX,y:t.pageY}}return{x:e.screenX,y:e.screenY}}var m=function(e){function t(){var e;u(this,t);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];var i=c(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return i._handleSwipeStart=i._handleSwipeStart.bind(i),i._handleSwipeMove=i._handleSwipeMove.bind(i),i._handleSwipeEnd=i._handleSwipeEnd.bind(i),i._onMouseDown=i._onMouseDown.bind(i),i._onMouseMove=i._onMouseMove.bind(i),i._onMouseUp=i._onMouseUp.bind(i),i._setSwiperRef=i._setSwiperRef.bind(i),i}return h(t,e),l(t,[{key:"componentDidMount",value:function(){this.swiper&&this.swiper.addEventListener("touchmove",this._handleSwipeMove,d({capture:!0,passive:!1}))}},{key:"componentWillUnmount",value:function(){this.swiper&&this.swiper.removeEventListener("touchmove",this._handleSwipeMove,d({capture:!0,passive:!1}))}},{key:"_onMouseDown",value:function(e){this.props.allowMouseEvents&&(this.mouseDown=!0,document.addEventListener("mouseup",this._onMouseUp),document.addEventListener("mousemove",this._onMouseMove),this._handleSwipeStart(e))}},{key:"_onMouseMove",value:function(e){this.mouseDown&&this._handleSwipeMove(e)}},{key:"_onMouseUp",value:function(e){this.mouseDown=!1,document.removeEventListener("mouseup",this._onMouseUp),document.removeEventListener("mousemove",this._onMouseMove),this._handleSwipeEnd(e)}},{key:"_handleSwipeStart",value:function(e){var t=v(e),n=t.x,r=t.y;this.moveStart={x:n,y:r},this.props.onSwipeStart(e)}},{key:"_handleSwipeMove",value:function(e){if(this.moveStart){var t=v(e),n=t.x,r=t.y,a=n-this.moveStart.x,i=r-this.moveStart.y;this.moving=!0,this.props.onSwipeMove({x:a,y:i},e)&&e.cancelable&&e.preventDefault(),this.movePosition={deltaX:a,deltaY:i}}}},{key:"_handleSwipeEnd",value:function(e){this.props.onSwipeEnd(e);var t=this.props.tolerance;this.moving&&this.movePosition&&(this.movePosition.deltaX<-t?this.props.onSwipeLeft(1,e):this.movePosition.deltaX>t&&this.props.onSwipeRight(1,e),this.movePosition.deltaY<-t?this.props.onSwipeUp(1,e):this.movePosition.deltaY>t&&this.props.onSwipeDown(1,e)),this.moveStart=null,this.moving=!1,this.movePosition=null}},{key:"_setSwiperRef",value:function(e){this.swiper=e,this.props.innerRef(e)}},{key:"render",value:function(){var e=this.props,t=(e.tagName,e.className),n=e.style,a=e.children,i=(e.allowMouseEvents,e.onSwipeUp,e.onSwipeDown,e.onSwipeLeft,e.onSwipeRight,e.onSwipeStart,e.onSwipeMove,e.onSwipeEnd,e.innerRef,e.tolerance,s(e,["tagName","className","style","children","allowMouseEvents","onSwipeUp","onSwipeDown","onSwipeLeft","onSwipeRight","onSwipeStart","onSwipeMove","onSwipeEnd","innerRef","tolerance"]));return r.default.createElement(this.props.tagName,o({ref:this._setSwiperRef,onMouseDown:this._onMouseDown,onTouchStart:this._handleSwipeStart,onTouchEnd:this._handleSwipeEnd,className:t,style:n},i),a)}}]),t}(t.Component);m.displayName="ReactSwipe",m.propTypes={tagName:a.default.string,className:a.default.string,style:a.default.object,children:a.default.node,allowMouseEvents:a.default.bool,onSwipeUp:a.default.func,onSwipeDown:a.default.func,onSwipeLeft:a.default.func,onSwipeRight:a.default.func,onSwipeStart:a.default.func,onSwipeMove:a.default.func,onSwipeEnd:a.default.func,innerRef:a.default.func,tolerance:a.default.number.isRequired},m.defaultProps={tagName:"div",allowMouseEvents:!1,onSwipeUp:function(){},onSwipeDown:function(){},onSwipeLeft:function(){},onSwipeRight:function(){},onSwipeStart:function(){},onSwipeMove:function(){},onSwipeEnd:function(){},innerRef:function(){},tolerance:0},e.default=m},void 0===(i="function"===typeof r?r.apply(t,a):r)||(e.exports=i)},2988:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e,t,n){var r=0===e?e:e+t;return"translate3d"+("("+("horizontal"===n?[r,0,0]:[0,r,0]).join(",")+")")}},6080:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fadeAnimationHandler=t.slideStopSwipingHandler=t.slideSwipeAnimationHandler=t.slideAnimationHandler=void 0;var r,a=n(2791),i=(r=n(2988))&&r.__esModule?r:{default:r},o=n(3735);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.slideAnimationHandler=function(e,t){var n={},r=t.selectedItem,s=r,l=a.Children.count(e.children)-1;if(e.infiniteLoop&&(r<0||r>l))return s<0?e.centerMode&&e.centerSlidePercentage&&"horizontal"===e.axis?n.itemListStyle=(0,o.setPosition)(-(l+2)*e.centerSlidePercentage-(100-e.centerSlidePercentage)/2,e.axis):n.itemListStyle=(0,o.setPosition)(100*-(l+2),e.axis):s>l&&(n.itemListStyle=(0,o.setPosition)(0,e.axis)),n;var c=(0,o.getPosition)(r,e),h=(0,i.default)(c,"%",e.axis),p=e.transitionTime+"ms";return n.itemListStyle={WebkitTransform:h,msTransform:h,OTransform:h,transform:h},t.swiping||(n.itemListStyle=u(u({},n.itemListStyle),{},{WebkitTransitionDuration:p,MozTransitionDuration:p,OTransitionDuration:p,transitionDuration:p,msTransitionDuration:p})),n};t.slideSwipeAnimationHandler=function(e,t,n,r){var i={},s="horizontal"===t.axis,u=a.Children.count(t.children),l=(0,o.getPosition)(n.selectedItem,t),c=t.infiniteLoop?(0,o.getPosition)(u-1,t)-100:(0,o.getPosition)(u-1,t),h=s?e.x:e.y,p=h;0===l&&h>0&&(p=0),l===c&&h<0&&(p=0);var f=l+100/(n.itemSize/p),d=Math.abs(h)>t.swipeScrollTolerance;return t.infiniteLoop&&d&&(0===n.selectedItem&&f>-100?f-=100*u:n.selectedItem===u-1&&f<100*-u&&(f+=100*u)),(!t.preventMovementUntilSwipeScrollTolerance||d||n.swipeMovementStarted)&&(n.swipeMovementStarted||r({swipeMovementStarted:!0}),i.itemListStyle=(0,o.setPosition)(f,t.axis)),d&&!n.cancelClick&&r({cancelClick:!0}),i};t.slideStopSwipingHandler=function(e,t){var n=(0,o.getPosition)(t.selectedItem,e);return{itemListStyle:(0,o.setPosition)(n,e.axis)}};t.fadeAnimationHandler=function(e,t){var n=e.transitionTime+"ms",r="ease-in-out",a={position:"absolute",display:"block",zIndex:-2,minHeight:"100%",opacity:0,top:0,right:0,left:0,bottom:0,transitionTimingFunction:r,msTransitionTimingFunction:r,MozTransitionTimingFunction:r,WebkitTransitionTimingFunction:r,OTransitionTimingFunction:r};return t.swiping||(a=u(u({},a),{},{WebkitTransitionDuration:n,MozTransitionDuration:n,OTransitionDuration:n,transitionDuration:n,msTransitionDuration:n})),{slideStyle:a,selectedStyle:u(u({},a),{},{opacity:1,position:"relative"}),prevStyle:u({},a)}}},7594:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==f(e)&&"function"!==typeof e)return{default:e};var t=p();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}n.default=e,t&&t.set(e,n);return n}(n(2791)),a=h(n(5540)),i=h(n(1887)),o=h(n(4625)),s=h(n(149)),u=h(n(3962)),l=n(3735),c=n(6080);function h(e){return e&&e.__esModule?e:{default:e}}function p(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return p=function(){return e},e}function f(e){return f="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function d(){return d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(this,arguments)}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},y(e,t)}function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w(e);if(t){var a=w(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return x(this,n)}}function x(e,t){return!t||"object"!==f(t)&&"function"!==typeof t?k(e):t}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(f,e);var t,n,h,p=b(f);function f(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),_(k(t=p.call(this,e)),"thumbsRef",void 0),_(k(t),"carouselWrapperRef",void 0),_(k(t),"listRef",void 0),_(k(t),"itemsRef",void 0),_(k(t),"timer",void 0),_(k(t),"animationHandler",void 0),_(k(t),"setThumbsRef",(function(e){t.thumbsRef=e})),_(k(t),"setCarouselWrapperRef",(function(e){t.carouselWrapperRef=e})),_(k(t),"setListRef",(function(e){t.listRef=e})),_(k(t),"setItemsRef",(function(e,n){t.itemsRef||(t.itemsRef=[]),t.itemsRef[n]=e})),_(k(t),"autoPlay",(function(){r.Children.count(t.props.children)<=1||(t.clearAutoPlay(),t.props.autoPlay&&(t.timer=setTimeout((function(){t.increment()}),t.props.interval)))})),_(k(t),"clearAutoPlay",(function(){t.timer&&clearTimeout(t.timer)})),_(k(t),"resetAutoPlay",(function(){t.clearAutoPlay(),t.autoPlay()})),_(k(t),"stopOnHover",(function(){t.setState({isMouseEntered:!0},t.clearAutoPlay)})),_(k(t),"startOnLeave",(function(){t.setState({isMouseEntered:!1},t.autoPlay)})),_(k(t),"isFocusWithinTheCarousel",(function(){return!!t.carouselWrapperRef&&!((0,s.default)().activeElement!==t.carouselWrapperRef&&!t.carouselWrapperRef.contains((0,s.default)().activeElement))})),_(k(t),"navigateWithKeyboard",(function(e){if(t.isFocusWithinTheCarousel()){var n="horizontal"===t.props.axis,r=n?37:38;(n?39:40)===e.keyCode?t.increment():r===e.keyCode&&t.decrement()}})),_(k(t),"updateSizes",(function(){if(t.state.initialized&&t.itemsRef&&0!==t.itemsRef.length){var e="horizontal"===t.props.axis,n=t.itemsRef[0];if(n){var r=e?n.clientWidth:n.clientHeight;t.setState({itemSize:r}),t.thumbsRef&&t.thumbsRef.updateSizes()}}})),_(k(t),"setMountState",(function(){t.setState({hasMount:!0}),t.updateSizes()})),_(k(t),"handleClickItem",(function(e,n){0!==r.Children.count(t.props.children)&&(t.state.cancelClick?t.setState({cancelClick:!1}):(t.props.onClickItem(e,n),e!==t.state.selectedItem&&t.setState({selectedItem:e})))})),_(k(t),"handleOnChange",(function(e,n){r.Children.count(t.props.children)<=1||t.props.onChange(e,n)})),_(k(t),"handleClickThumb",(function(e,n){t.props.onClickThumb(e,n),t.moveTo(e)})),_(k(t),"onSwipeStart",(function(e){t.setState({swiping:!0}),t.props.onSwipeStart(e)})),_(k(t),"onSwipeEnd",(function(e){t.setState({swiping:!1,cancelClick:!1,swipeMovementStarted:!1}),t.props.onSwipeEnd(e),t.clearAutoPlay(),t.state.autoPlay&&t.autoPlay()})),_(k(t),"onSwipeMove",(function(e,n){t.props.onSwipeMove(n);var r=t.props.swipeAnimationHandler(e,t.props,t.state,t.setState.bind(k(t)));return t.setState(m({},r)),!!Object.keys(r).length})),_(k(t),"decrement",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;t.moveTo(t.state.selectedItem-("number"===typeof e?e:1))})),_(k(t),"increment",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;t.moveTo(t.state.selectedItem+("number"===typeof e?e:1))})),_(k(t),"moveTo",(function(e){if("number"===typeof e){var n=r.Children.count(t.props.children)-1;e<0&&(e=t.props.infiniteLoop?n:0),e>n&&(e=t.props.infiniteLoop?0:n),t.selectItem({selectedItem:e}),t.state.autoPlay&&!1===t.state.isMouseEntered&&t.resetAutoPlay()}})),_(k(t),"onClickNext",(function(){t.increment(1)})),_(k(t),"onClickPrev",(function(){t.decrement(1)})),_(k(t),"onSwipeForward",(function(){t.increment(1),t.props.emulateTouch&&t.setState({cancelClick:!0})})),_(k(t),"onSwipeBackwards",(function(){t.decrement(1),t.props.emulateTouch&&t.setState({cancelClick:!0})})),_(k(t),"changeItem",(function(e){return function(n){(0,l.isKeyboardEvent)(n)&&"Enter"!==n.key||t.moveTo(e)}})),_(k(t),"selectItem",(function(e){t.setState(m({previousItem:t.state.selectedItem},e),(function(){t.setState(t.animationHandler(t.props,t.state))})),t.handleOnChange(e.selectedItem,r.Children.toArray(t.props.children)[e.selectedItem])})),_(k(t),"getInitialImage",(function(){var e=t.props.selectedItem,n=t.itemsRef&&t.itemsRef[e];return(n&&n.getElementsByTagName("img")||[])[0]})),_(k(t),"getVariableItemHeight",(function(e){var n=t.itemsRef&&t.itemsRef[e];if(t.state.hasMount&&n&&n.children.length){var r=n.children[0].getElementsByTagName("img")||[];if(r.length>0){var a=r[0];if(!a.complete){a.addEventListener("load",(function e(){t.forceUpdate(),a.removeEventListener("load",e)}))}}var i=(r[0]||n.children[0]).clientHeight;return i>0?i:null}return null}));var n={initialized:!1,previousItem:e.selectedItem,selectedItem:e.selectedItem,hasMount:!1,isMouseEntered:!1,autoPlay:e.autoPlay,swiping:!1,swipeMovementStarted:!1,cancelClick:!1,itemSize:1,itemListStyle:{},slideStyle:{},selectedStyle:{},prevStyle:{}};return t.animationHandler="function"===typeof e.animationHandler&&e.animationHandler||"fade"===e.animationHandler&&c.fadeAnimationHandler||c.slideAnimationHandler,t.state=m(m({},n),t.animationHandler(e,n)),t}return t=f,(n=[{key:"componentDidMount",value:function(){this.props.children&&this.setupCarousel()}},{key:"componentDidUpdate",value:function(e,t){e.children||!this.props.children||this.state.initialized||this.setupCarousel(),!e.autoFocus&&this.props.autoFocus&&this.forceFocus(),t.swiping&&!this.state.swiping&&this.setState(m({},this.props.stopSwipingHandler(this.props,this.state))),e.selectedItem===this.props.selectedItem&&e.centerMode===this.props.centerMode||(this.updateSizes(),this.moveTo(this.props.selectedItem)),e.autoPlay!==this.props.autoPlay&&(this.props.autoPlay?this.setupAutoPlay():this.destroyAutoPlay(),this.setState({autoPlay:this.props.autoPlay}))}},{key:"componentWillUnmount",value:function(){this.destroyCarousel()}},{key:"setupCarousel",value:function(){var e=this;this.bindEvents(),this.state.autoPlay&&r.Children.count(this.props.children)>1&&this.setupAutoPlay(),this.props.autoFocus&&this.forceFocus(),this.setState({initialized:!0},(function(){var t=e.getInitialImage();t&&!t.complete?t.addEventListener("load",e.setMountState):e.setMountState()}))}},{key:"destroyCarousel",value:function(){this.state.initialized&&(this.unbindEvents(),this.destroyAutoPlay())}},{key:"setupAutoPlay",value:function(){this.autoPlay();var e=this.carouselWrapperRef;this.props.stopOnHover&&e&&(e.addEventListener("mouseenter",this.stopOnHover),e.addEventListener("mouseleave",this.startOnLeave))}},{key:"destroyAutoPlay",value:function(){this.clearAutoPlay();var e=this.carouselWrapperRef;this.props.stopOnHover&&e&&(e.removeEventListener("mouseenter",this.stopOnHover),e.removeEventListener("mouseleave",this.startOnLeave))}},{key:"bindEvents",value:function(){(0,u.default)().addEventListener("resize",this.updateSizes),(0,u.default)().addEventListener("DOMContentLoaded",this.updateSizes),this.props.useKeyboardArrows&&(0,s.default)().addEventListener("keydown",this.navigateWithKeyboard)}},{key:"unbindEvents",value:function(){(0,u.default)().removeEventListener("resize",this.updateSizes),(0,u.default)().removeEventListener("DOMContentLoaded",this.updateSizes);var e=this.getInitialImage();e&&e.removeEventListener("load",this.setMountState),this.props.useKeyboardArrows&&(0,s.default)().removeEventListener("keydown",this.navigateWithKeyboard)}},{key:"forceFocus",value:function(){var e;null===(e=this.carouselWrapperRef)||void 0===e||e.focus()}},{key:"renderItems",value:function(e){var t=this;return this.props.children?r.Children.map(this.props.children,(function(n,a){var o=a===t.state.selectedItem,s=a===t.state.previousItem,u=o&&t.state.selectedStyle||s&&t.state.prevStyle||t.state.slideStyle||{};t.props.centerMode&&"horizontal"===t.props.axis&&(u=m(m({},u),{},{minWidth:t.props.centerSlidePercentage+"%"})),t.state.swiping&&t.state.swipeMovementStarted&&(u=m(m({},u),{},{pointerEvents:"none"}));var l={ref:function(e){return t.setItemsRef(e,a)},key:"itemKey"+a+(e?"clone":""),className:i.default.ITEM(!0,a===t.state.selectedItem,a===t.state.previousItem),onClick:t.handleClickItem.bind(t,a,n),style:u};return r.default.createElement("li",l,t.props.renderItem(n,{isSelected:a===t.state.selectedItem,isPrevious:a===t.state.previousItem}))})):[]}},{key:"renderControls",value:function(){var e=this,t=this.props,n=t.showIndicators,a=t.labels,i=t.renderIndicator,o=t.children;return n?r.default.createElement("ul",{className:"control-dots"},r.Children.map(o,(function(t,n){return i&&i(e.changeItem(n),n===e.state.selectedItem,n,a.item)}))):null}},{key:"renderStatus",value:function(){return this.props.showStatus?r.default.createElement("p",{className:"carousel-status"},this.props.statusFormatter(this.state.selectedItem+1,r.Children.count(this.props.children))):null}},{key:"renderThumbs",value:function(){return this.props.showThumbs&&this.props.children&&0!==r.Children.count(this.props.children)?r.default.createElement(o.default,{ref:this.setThumbsRef,onSelectItem:this.handleClickThumb,selectedItem:this.state.selectedItem,transitionTime:this.props.transitionTime,thumbWidth:this.props.thumbWidth,labels:this.props.labels,emulateTouch:this.props.emulateTouch},this.props.renderThumbs(this.props.children)):null}},{key:"render",value:function(){var e=this;if(!this.props.children||0===r.Children.count(this.props.children))return null;var t=this.props.swipeable&&r.Children.count(this.props.children)>1,n="horizontal"===this.props.axis,o=this.props.showArrows&&r.Children.count(this.props.children)>1,s=o&&(this.state.selectedItem>0||this.props.infiniteLoop)||!1,u=o&&(this.state.selectedItem<r.Children.count(this.props.children)-1||this.props.infiniteLoop)||!1,l=this.renderItems(!0),c=l.shift(),h=l.pop(),p={className:i.default.SLIDER(!0,this.state.swiping),onSwipeMove:this.onSwipeMove,onSwipeStart:this.onSwipeStart,onSwipeEnd:this.onSwipeEnd,style:this.state.itemListStyle,tolerance:this.props.swipeScrollTolerance},f={};if(n){if(p.onSwipeLeft=this.onSwipeForward,p.onSwipeRight=this.onSwipeBackwards,this.props.dynamicHeight){var v=this.getVariableItemHeight(this.state.selectedItem);f.height=v||"auto"}}else p.onSwipeUp="natural"===this.props.verticalSwipe?this.onSwipeBackwards:this.onSwipeForward,p.onSwipeDown="natural"===this.props.verticalSwipe?this.onSwipeForward:this.onSwipeBackwards,p.style=m(m({},p.style),{},{height:this.state.itemSize}),f.height=this.state.itemSize;return r.default.createElement("div",{"aria-label":this.props.ariaLabel,className:i.default.ROOT(this.props.className),ref:this.setCarouselWrapperRef,tabIndex:this.props.useKeyboardArrows?0:void 0},r.default.createElement("div",{className:i.default.CAROUSEL(!0),style:{width:this.props.width}},this.renderControls(),this.props.renderArrowPrev(this.onClickPrev,s,this.props.labels.leftArrow),r.default.createElement("div",{className:i.default.WRAPPER(!0,this.props.axis),style:f},t?r.default.createElement(a.default,d({tagName:"ul",innerRef:this.setListRef},p,{allowMouseEvents:this.props.emulateTouch}),this.props.infiniteLoop&&h,this.renderItems(),this.props.infiniteLoop&&c):r.default.createElement("ul",{className:i.default.SLIDER(!0,this.state.swiping),ref:function(t){return e.setListRef(t)},style:this.state.itemListStyle||{}},this.props.infiniteLoop&&h,this.renderItems(),this.props.infiniteLoop&&c)),this.props.renderArrowNext(this.onClickNext,u,this.props.labels.rightArrow),this.renderStatus()),this.renderThumbs())}}])&&g(t.prototype,n),h&&g(t,h),f}(r.default.Component);t.default=S,_(S,"displayName","Carousel"),_(S,"defaultProps",{ariaLabel:void 0,axis:"horizontal",centerSlidePercentage:80,interval:3e3,labels:{leftArrow:"previous slide / item",rightArrow:"next slide / item",item:"slide item"},onClickItem:l.noop,onClickThumb:l.noop,onChange:l.noop,onSwipeStart:function(){},onSwipeEnd:function(){},onSwipeMove:function(){return!1},preventMovementUntilSwipeScrollTolerance:!1,renderArrowPrev:function(e,t,n){return r.default.createElement("button",{type:"button","aria-label":n,className:i.default.ARROW_PREV(!t),onClick:e})},renderArrowNext:function(e,t,n){return r.default.createElement("button",{type:"button","aria-label":n,className:i.default.ARROW_NEXT(!t),onClick:e})},renderIndicator:function(e,t,n,a){return r.default.createElement("li",{className:i.default.DOT(t),onClick:e,onKeyDown:e,value:n,key:n,role:"button",tabIndex:0,"aria-label":"".concat(a," ").concat(n+1)})},renderItem:function(e){return e},renderThumbs:function(e){var t=r.Children.map(e,(function(e){var t=e;if("img"!==e.type&&(t=r.Children.toArray(e.props.children).find((function(e){return"img"===e.type}))),t)return t}));return 0===t.filter((function(e){return e})).length?(console.warn("No images found! Can't build the thumb list without images. If you don't need thumbs, set showThumbs={false} in the Carousel. Note that it's not possible to get images rendered inside custom components. More info at https://github.com/leandrowd/react-responsive-carousel/blob/master/TROUBLESHOOTING.md"),[]):t},statusFormatter:l.defaultStatusFormatter,selectedItem:0,showArrows:!0,showIndicators:!0,showStatus:!0,showThumbs:!0,stopOnHover:!0,swipeScrollTolerance:5,swipeable:!0,transitionTime:350,verticalSwipe:"standard",width:"100%",animationHandler:"slide",swipeAnimationHandler:c.slideSwipeAnimationHandler,stopSwipingHandler:c.slideStopSwipingHandler})},8103:function(){},3735:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setPosition=t.getPosition=t.isKeyboardEvent=t.defaultStatusFormatter=t.noop=void 0;var r,a=n(2791),i=(r=n(2988))&&r.__esModule?r:{default:r};t.noop=function(){};t.defaultStatusFormatter=function(e,t){return"".concat(e," of ").concat(t)};t.isKeyboardEvent=function(e){return!!e&&e.hasOwnProperty("key")};t.getPosition=function(e,t){if(t.infiniteLoop&&++e,0===e)return 0;var n=a.Children.count(t.children);if(t.centerMode&&"horizontal"===t.axis){var r=-e*t.centerSlidePercentage,i=n-1;return e&&(e!==i||t.infiniteLoop)?r+=(100-t.centerSlidePercentage)/2:e===i&&(r+=100-t.centerSlidePercentage),r}return 100*-e};t.setPosition=function(e,t){var n={};return["WebkitTransform","MozTransform","MsTransform","OTransform","transform","msTransform"].forEach((function(r){n[r]=(0,i.default)(e,"%",t)})),n}},4625:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==h(e)&&"function"!==typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}n.default=e,t&&t.set(e,n);return n}(n(2791)),a=l(n(1887)),i=n(1970),o=l(n(2988)),s=l(n(5540)),u=l(n(3962));function l(e){return e&&e.__esModule?e:{default:e}}function c(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function h(e){return h="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function p(){return p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p.apply(this,arguments)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y(e);if(t){var a=y(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){return!t||"object"!==h(t)&&"function"!==typeof t?g(e):t}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var x=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(h,e);var t,n,l,c=v(h);function h(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),b(g(t=c.call(this,e)),"itemsWrapperRef",void 0),b(g(t),"itemsListRef",void 0),b(g(t),"thumbsRef",void 0),b(g(t),"setItemsWrapperRef",(function(e){t.itemsWrapperRef=e})),b(g(t),"setItemsListRef",(function(e){t.itemsListRef=e})),b(g(t),"setThumbsRef",(function(e,n){t.thumbsRef||(t.thumbsRef=[]),t.thumbsRef[n]=e})),b(g(t),"updateSizes",(function(){if(t.props.children&&t.itemsWrapperRef&&t.thumbsRef){var e=r.Children.count(t.props.children),n=t.itemsWrapperRef.clientWidth,a=t.props.thumbWidth?t.props.thumbWidth:(0,i.outerWidth)(t.thumbsRef[0]),o=Math.floor(n/a),s=o<e,u=s?e-o:0;t.setState((function(e,n){return{itemSize:a,visibleItems:o,firstItem:s?t.getFirstItem(n.selectedItem):0,lastPosition:u,showArrows:s}}))}})),b(g(t),"handleClickItem",(function(e,n,r){if(!function(e){return e.hasOwnProperty("key")}(r)||"Enter"===r.key){var a=t.props.onSelectItem;"function"===typeof a&&a(e,n)}})),b(g(t),"onSwipeStart",(function(){t.setState({swiping:!0})})),b(g(t),"onSwipeEnd",(function(){t.setState({swiping:!1})})),b(g(t),"onSwipeMove",(function(e){var n=e.x;if(!t.state.itemSize||!t.itemsWrapperRef||!t.state.visibleItems)return!1;var a=r.Children.count(t.props.children),i=-100*t.state.firstItem/t.state.visibleItems;0===i&&n>0&&(n=0),i===100*-Math.max(a-t.state.visibleItems,0)/t.state.visibleItems&&n<0&&(n=0);var s=i+100/(t.itemsWrapperRef.clientWidth/n);return t.itemsListRef&&["WebkitTransform","MozTransform","MsTransform","OTransform","transform","msTransform"].forEach((function(e){t.itemsListRef.style[e]=(0,o.default)(s,"%",t.props.axis)})),!0})),b(g(t),"slideRight",(function(e){t.moveTo(t.state.firstItem-("number"===typeof e?e:1))})),b(g(t),"slideLeft",(function(e){t.moveTo(t.state.firstItem+("number"===typeof e?e:1))})),b(g(t),"moveTo",(function(e){e=(e=e<0?0:e)>=t.state.lastPosition?t.state.lastPosition:e,t.setState({firstItem:e})})),t.state={selectedItem:e.selectedItem,swiping:!1,showArrows:!1,firstItem:0,visibleItems:0,lastPosition:0},t}return t=h,(n=[{key:"componentDidMount",value:function(){this.setupThumbs()}},{key:"componentDidUpdate",value:function(e){this.props.selectedItem!==this.state.selectedItem&&this.setState({selectedItem:this.props.selectedItem,firstItem:this.getFirstItem(this.props.selectedItem)}),this.props.children!==e.children&&this.updateSizes()}},{key:"componentWillUnmount",value:function(){this.destroyThumbs()}},{key:"setupThumbs",value:function(){(0,u.default)().addEventListener("resize",this.updateSizes),(0,u.default)().addEventListener("DOMContentLoaded",this.updateSizes),this.updateSizes()}},{key:"destroyThumbs",value:function(){(0,u.default)().removeEventListener("resize",this.updateSizes),(0,u.default)().removeEventListener("DOMContentLoaded",this.updateSizes)}},{key:"getFirstItem",value:function(e){var t=e;return e>=this.state.lastPosition&&(t=this.state.lastPosition),e<this.state.firstItem+this.state.visibleItems&&(t=this.state.firstItem),e<this.state.firstItem&&(t=e),t}},{key:"renderItems",value:function(){var e=this;return this.props.children.map((function(t,n){var i=a.default.ITEM(!1,n===e.state.selectedItem),o={key:n,ref:function(t){return e.setThumbsRef(t,n)},className:i,onClick:e.handleClickItem.bind(e,n,e.props.children[n]),onKeyDown:e.handleClickItem.bind(e,n,e.props.children[n]),"aria-label":"".concat(e.props.labels.item," ").concat(n+1),style:{width:e.props.thumbWidth}};return r.default.createElement("li",p({},o,{role:"button",tabIndex:0}),t)}))}},{key:"render",value:function(){var e=this;if(!this.props.children)return null;var t,n=r.Children.count(this.props.children)>1,i=this.state.showArrows&&this.state.firstItem>0,u=this.state.showArrows&&this.state.firstItem<this.state.lastPosition,l=-this.state.firstItem*(this.state.itemSize||0),c=(0,o.default)(l,"px",this.props.axis),h=this.props.transitionTime+"ms";return t={WebkitTransform:c,MozTransform:c,MsTransform:c,OTransform:c,transform:c,msTransform:c,WebkitTransitionDuration:h,MozTransitionDuration:h,MsTransitionDuration:h,OTransitionDuration:h,transitionDuration:h,msTransitionDuration:h},r.default.createElement("div",{className:a.default.CAROUSEL(!1)},r.default.createElement("div",{className:a.default.WRAPPER(!1),ref:this.setItemsWrapperRef},r.default.createElement("button",{type:"button",className:a.default.ARROW_PREV(!i),onClick:function(){return e.slideRight()},"aria-label":this.props.labels.leftArrow}),n?r.default.createElement(s.default,{tagName:"ul",className:a.default.SLIDER(!1,this.state.swiping),onSwipeLeft:this.slideLeft,onSwipeRight:this.slideRight,onSwipeMove:this.onSwipeMove,onSwipeStart:this.onSwipeStart,onSwipeEnd:this.onSwipeEnd,style:t,innerRef:this.setItemsListRef,allowMouseEvents:this.props.emulateTouch},this.renderItems()):r.default.createElement("ul",{className:a.default.SLIDER(!1,this.state.swiping),ref:function(t){return e.setItemsListRef(t)},style:t},this.renderItems()),r.default.createElement("button",{type:"button",className:a.default.ARROW_NEXT(!u),onClick:function(){return e.slideLeft()},"aria-label":this.props.labels.rightArrow})))}}])&&f(t.prototype,n),l&&f(t,l),h}(r.Component);t.default=x,b(x,"displayName","Thumbs"),b(x,"defaultProps",{axis:"horizontal",labels:{leftArrow:"previous slide / item",rightArrow:"next slide / item",item:"slide item"},selectedItem:0,thumbWidth:80,transitionTime:350})},1887:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=(r=n(1694))&&r.__esModule?r:{default:r};var i={ROOT:function(e){return(0,a.default)(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({"carousel-root":!0},e||"",!!e))},CAROUSEL:function(e){return(0,a.default)({carousel:!0,"carousel-slider":e})},WRAPPER:function(e,t){return(0,a.default)({"thumbs-wrapper":!e,"slider-wrapper":e,"axis-horizontal":"horizontal"===t,"axis-vertical":"horizontal"!==t})},SLIDER:function(e,t){return(0,a.default)({thumbs:!e,slider:e,animated:!t})},ITEM:function(e,t,n){return(0,a.default)({thumb:!e,slide:e,selected:t,previous:n})},ARROW_PREV:function(e){return(0,a.default)({"control-arrow control-prev":!0,"control-disabled":e})},ARROW_NEXT:function(e){return(0,a.default)({"control-arrow control-next":!0,"control-disabled":e})},DOT:function(e){return(0,a.default)({dot:!0,selected:e})}};t.default=i},1970:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.outerWidth=void 0;t.outerWidth=function(e){var t=e.offsetWidth,n=getComputedStyle(e);return t+=parseInt(n.marginLeft)+parseInt(n.marginRight)}},197:function(e,t,n){"use strict";Object.defineProperty(t,"lr",{enumerable:!0,get:function(){return r.default}});var r=o(n(7594)),a=n(8103),i=o(n(4625));function o(e){return e&&e.__esModule?e:{default:e}}},149:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(){return document}},3962:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(){return window}},6374:function(e,t,n){"use strict";var r=n(2791),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,i={},l=null,c=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,r)&&!u.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:l,ref:c,props:i,_owner:s.current}}t.jsx=l,t.jsxs=l},9117:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.iterator;var d={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,m={};function g(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||d}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||d}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=g.prototype;var x=b.prototype=new y;x.constructor=b,v(x,g.prototype),x.isPureReactComponent=!0;var k=Array.isArray,w=Object.prototype.hasOwnProperty,_={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function I(e,t,r){var a,i={},o=null,s=null;if(null!=t)for(a in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)w.call(t,a)&&!S.hasOwnProperty(a)&&(i[a]=t[a]);var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){for(var l=Array(u),c=0;c<u;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(a in u=e.defaultProps)void 0===i[a]&&(i[a]=u[a]);return{$$typeof:n,type:e,key:o,ref:s,props:i,_owner:_.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var T=/\/+/g;function N(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function E(e,t,a,i,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0}}if(u)return o=o(u=e),e=""===i?"."+N(u,0):i,k(o)?(a="",null!=e&&(a=e.replace(T,"$&/")+"/"),E(o,t,a,"",(function(e){return e}))):null!=o&&(C(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||u&&u.key===o.key?"":(""+o.key).replace(T,"$&/")+"/")+e)),t.push(o)),1;if(u=0,i=""===i?".":i+":",k(e))for(var l=0;l<e.length;l++){var c=i+N(s=e[l],l);u+=E(s,t,a,c,o)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),l=0;!(s=e.next()).done;)u+=E(s=s.value,t,a,c=i+N(s,l++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function M(e,t,n){if(null==e)return e;var r=[],a=0;return E(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},R={transition:null},O={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:R,ReactCurrentOwner:_};t.Children={map:M,forEach:function(e,t,n){M(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return M(e,(function(){t++})),t},toArray:function(e){return M(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=a,t.Profiler=o,t.PureComponent=b,t.StrictMode=i,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=v({},e.props),i=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=_.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(l in t)w.call(t,l)&&!S.hasOwnProperty(l)&&(a[l]=void 0===t[l]&&void 0!==u?u[l]:t[l])}var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){u=Array(l);for(var c=0;c<l;c++)u[c]=arguments[c+2];a.children=u}return{$$typeof:n,type:e.type,key:i,ref:o,props:a,_owner:s}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=I,t.createFactory=function(e){var t=I.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,n){return D.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,n){return D.current.useReducer(e,t,n)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return D.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return D.current.useTransition()},t.version="18.1.0"},2791:function(e,t,n){"use strict";e.exports=n(9117)},184:function(e,t,n){"use strict";e.exports=n(6374)},6813:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var s=2*(r+1)-1,u=e[s],l=s+1,c=e[l];if(0>i(u,n))l<a&&0>i(c,u)?(e[r]=c,e[l]=n,r=l):(e[r]=u,e[s]=n,r=s);else{if(!(l<a&&0>i(c,n)))break e;e[r]=c,e[l]=n,r=l}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var l=[],c=[],h=1,p=null,f=3,d=!1,v=!1,m=!1,g="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(c);null!==t;){if(null===t.callback)a(c);else{if(!(t.startTime<=e))break;a(c),t.sortIndex=t.expirationTime,n(l,t)}t=r(c)}}function k(e){if(m=!1,x(e),!v)if(null!==r(l))v=!0,R(w);else{var t=r(c);null!==t&&O(k,t.startTime-e)}}function w(e,n){v=!1,m&&(m=!1,y(C),C=-1),d=!0;var i=f;try{for(x(n),p=r(l);null!==p&&(!(p.expirationTime>n)||e&&!E());){var o=p.callback;if("function"===typeof o){p.callback=null,f=p.priorityLevel;var s=o(p.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?p.callback=s:p===r(l)&&a(l),x(n)}else a(l);p=r(l)}if(null!==p)var u=!0;else{var h=r(c);null!==h&&O(k,h.startTime-n),u=!1}return u}finally{p=null,f=i,d=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,S=!1,I=null,C=-1,T=5,N=-1;function E(){return!(t.unstable_now()-N<T)}function M(){if(null!==I){var e=t.unstable_now();N=e;var n=!0;try{n=I(!0,e)}finally{n?_():(S=!1,I=null)}}else S=!1}if("function"===typeof b)_=function(){b(M)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,D=A.port2;A.port1.onmessage=M,_=function(){D.postMessage(null)}}else _=function(){g(M,0)};function R(e){I=e,S||(S=!0,_())}function O(e,n){C=g((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||d||(v=!0,R(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,a,i){var o=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:h++,callback:a,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(e.sortIndex=i,n(c,e),null===r(l)&&e===r(c)&&(m?(y(C),C=-1):m=!0,O(k,i-o))):(e.sortIndex=s,n(l,e),v||d||(v=!0,R(w))),e},t.unstable_shouldYield=E,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},5296:function(e,t,n){"use strict";e.exports=n(6813)},6699:function(e,t,n){var r=n(2501),a=n(9112),i=n(2132),o=n(890),s=n(4113),u=n(1725),l=n(3411);l.alea=r,l.xor128=a,l.xorwow=i,l.xorshift7=o,l.xor4096=s,l.tychei=u,e.exports=l},2501:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n=function(){var e=4022871197;return function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)}}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function u(e,t){var n=new o(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.alea=u}(0,e=n.nmd(e),n.amdD)},1725:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.tychei=u}(0,e=n.nmd(e),n.amdD)},9112:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor128=u}(0,e=n.nmd(e),n.amdD)},4113:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),a=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;e.w=o,e.X=s,e.i=a}(t,e)}function s(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor4096=u}(0,e=n.nmd(e),n.amdD)},890:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function s(e,t){return t.x=e.x.slice(),t.i=e.i,t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorshift7=u}(0,e=n.nmd(e),n.amdD)},2132:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorwow=u}(0,e=n.nmd(e),n.amdD)},3411:function(e,t,n){var r;!function(a,i){var o,s=(0,eval)("this"),u=256,l=i.pow(u,6),c=i.pow(2,52),h=2*c,p=255;function f(e,t,n){var r=[],p=g(m((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(a)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(u):(e=new Uint8Array(u),(s.crypto||s.msCrypto).getRandomValues(e)),y(e)}catch(r){var t=s.navigator,n=t&&t.plugins;return[+new Date,s,n,s.screen,y(a)]}}():e,3),r),f=new d(r),b=function(){for(var e=f.g(6),t=l,n=0;e<c;)e=(e+n)*u,t*=u,n=f.g(1);for(;e>=h;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|f.g(4)},b.quick=function(){return f.g(4)/4294967296},b.double=b,g(y(f.S),a),(t.pass||n||function(e,t,n,r){return r&&(r.S&&v(r,f),e.state=function(){return v(f,{})}),n?(i.random=e,t):e})(b,p,"global"in t?t.global:this==i,t.state)}function d(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<u;)o[a]=a++;for(a=0;a<u;a++)o[a]=o[i=p&i+e[a%n]+(t=o[a])],o[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,o=r.S;e--;)t=o[a=p&a+1],n=n*u+o[p&(o[a]=o[i=p&i+t])+(o[i]=t)];return r.i=a,r.j=i,n})(u)}function v(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function m(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(m(e[n],t-1))}catch(i){}return r.length?r:"string"==a?e:e+"\0"}function g(e,t){for(var n,r=e+"",a=0;a<r.length;)t[p&a]=p&(n^=19*t[p&a])+r.charCodeAt(a++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(i.seedrandom=f,g(i.random(),a),e.exports){e.exports=f;try{o=n(5042)}catch(b){}}else void 0===(r=function(){return f}.call(t,n,t,e))||(e.exports=r)}([],Math)},914:function(){},5410:function(){},8628:function(){},5778:function(){},1601:function(){},7792:function(){},5042:function(){}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){"use strict";var e={};n.r(e),n.d(e,{browserFiles:function(){return ji},browserHTTPRequest:function(){return ro},concatenateArrayBuffers:function(){return qa},copyModel:function(){return Mi},decodeWeights:function(){return Va},encodeWeights:function(){return za},fromMemory:function(){return so},getLoadHandlers:function(){return ei},getModelArtifactsInfoForJSON:function(){return Ka},getSaveHandlers:function(){return Ja},http:function(){return no},isHTTPScheme:function(){return eo},listModels:function(){return Ci},loadWeights:function(){return Yi},moveModel:function(){return Di},registerLoadRouter:function(){return $a},registerSaveRouter:function(){return Qa},removeModel:function(){return Ni},weightsLoaderFactory:function(){return Qi},withSaveHandler:function(){return uo}});var t={};n.r(t),n.d(t,{json:function(){return Ub}});var r={};n.r(r),n.d(r,{json:function(){return Hb}});var a={};n.r(a),n.d(a,{json:function(){return Gb}});var i={};n.r(i),n.d(i,{json:function(){return jb}});var o={};n.r(o),n.d(o,{json:function(){return qb}});var s={};n.r(s),n.d(s,{json:function(){return Xb}});var u={};n.r(u),n.d(u,{json:function(){return Kb}});var l={};n.r(l),n.d(l,{json:function(){return Yb}});var c={};n.r(c),n.d(c,{json:function(){return Zb}});var h={};n.r(h),n.d(h,{json:function(){return Qb}});var p={};n.r(p),n.d(p,{json:function(){return $b}});var f={};n.r(f),n.d(f,{json:function(){return Jb}});var d={};n.r(d),n.d(d,{json:function(){return ex}});var v={};n.r(v),n.d(v,{json:function(){return tx}});var m={};n.r(m),n.d(m,{json:function(){return nx}});var g={};n.r(g),n.d(g,{json:function(){return rx}});var y={};n.r(y),n.d(y,{json:function(){return ax}});var b={};n.r(b),n.d(b,{Arc:function(){return NY},BezierCurve:function(){return IY},BoundingRect:function(){return gz},Circle:function(){return WK},CompoundPath:function(){return MY},Ellipse:function(){return GK},Group:function(){return zK},Image:function(){return QW},IncrementalDisplayable:function(){return UY},Line:function(){return xY},LinearGradient:function(){return DY},OrientedBoundingRect:function(){return BY},Path:function(){return GW},Point:function(){return sz},Polygon:function(){return fY},Polyline:function(){return mY},RadialGradient:function(){return RY},Rect:function(){return iU},Ring:function(){return lY},Sector:function(){return oY},Text:function(){return xU},applyTransform:function(){return vZ},clipPointsByRect:function(){return bZ},clipRectByRect:function(){return xZ},createIcon:function(){return kZ},extendPath:function(){return rZ},extendShape:function(){return tZ},getShapeClass:function(){return iZ},getTransform:function(){return dZ},groupTransition:function(){return yZ},initProps:function(){return XY},isElementRemoved:function(){return KY},lineLineIntersect:function(){return _Z},linePolygonIntersect:function(){return wZ},makeImage:function(){return sZ},makePath:function(){return oZ},mergePath:function(){return lZ},registerShape:function(){return aZ},removeElement:function(){return YY},removeElementWithFadeOut:function(){return QY},resizePath:function(){return cZ},setTooltipConfig:function(){return IZ},subPixelOptimize:function(){return fZ},subPixelOptimizeLine:function(){return hZ},subPixelOptimizeRect:function(){return pZ},transformDirection:function(){return mZ},traverseElements:function(){return TZ},updateProps:function(){return qY}});var x=n(2791),k=n(1250);function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function S(e,t){if(e){if("string"===typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}function I(e){return function(e){if(Array.isArray(e))return w(e)}(e)||_(e)||S(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e){if(Array.isArray(e))return e}function T(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function N(e,t){return C(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(u){s=!0,a=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(e,t)||S(e,t)||T()}function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function M(){M=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(C){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var a=t&&t.prototype instanceof h?t:h,i=Object.create(a.prototype),o=new _(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return I()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var s=x(o,n);if(s){if(s===c)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===c)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(e,n,o),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(C){return{type:"throw",arg:C}}}e.wrap=u;var c={};function h(){}function p(){}function f(){}var d={};s(d,a,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==t&&n.call(m,a)&&(d=m);var g=f.prototype=h.prototype=Object.create(d);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function r(a,i,o,s){var u=l(e[a],e,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==E(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,o,s)}),(function(e){r("throw",e,o,s)})):t.resolve(h).then((function(e){c.value=e,o(c)}),(function(e){return r("throw",e,o,s)}))}s(u.arg)}var a;this._invoke=function(e,n){function i(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(i,i):i()}}function x(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method))return c;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var r=l(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,c;var a=r.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,c):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function S(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:I}}function I(){return{value:void 0,done:!0}}return p.prototype=f,s(g,"constructor",f),s(f,"constructor",p),p.displayName=s(f,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,s(e,o,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},y(b.prototype),s(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new b(u(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},y(g),s(g,o,"Generator"),s(g,a,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,c):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),c}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;w(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},e}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t,n){return t&&D(e.prototype,t),n&&D(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function O(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(l){return void n(l)}s.done?t(u):Promise.resolve(u).then(r,a)}function F(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){O(i,r,a,o,s,"next",e)}function s(e){O(i,r,a,o,s,"throw",e)}o(void 0)}))}}function L(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=S(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}var P=function(){function e(t,n){A(this,e),this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return R(e,[{key:"get",value:function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}},{key:"set",value:function(e,t){this.dataIdsCount++,this.data.set(e,t)}},{key:"has",value:function(e){return this.data.has(e)}},{key:"delete",value:function(e){return this.dataIdsCount--,this.data.delete(e)}},{key:"numDataIds",value:function(){return this.dataIdsCount}}]),e}(),z=function(){function e(){A(this,e)}return R(e,[{key:"refCount",value:function(e){return B("refCount")}},{key:"incRef",value:function(e){return B("incRef")}},{key:"timerAvailable",value:function(){return!0}},{key:"time",value:function(e){return B("time")}},{key:"read",value:function(e){return B("read")}},{key:"readSync",value:function(e){return B("readSync")}},{key:"numDataIds",value:function(){return B("numDataIds")}},{key:"disposeData",value:function(e,t){return B("disposeData")}},{key:"write",value:function(e,t,n){return B("write")}},{key:"move",value:function(e,t,n,r,a){return B("move")}},{key:"memory",value:function(){return B("memory")}},{key:"floatPrecision",value:function(){return B("floatPrecision")}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"dispose",value:function(){return B("dispose")}}]),e}();function B(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}function V(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function W(e,t,n){return Math.max(e,Math.min(t,n))}function U(e){return e%2===0?e:e+1}function H(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function G(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function j(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";G(Y(e,t),(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}function q(e){G(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function X(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),Array.isArray(e)||oe(e)&&!n)for(var r=0;r<e.length;++r)X(e[r],t,n);else t.push(e);return t}function K(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function Y(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Z(e){return e%1===0}function Q(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function $(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function J(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return 0},n=arguments.length>2?arguments[2]:void 0;return new Promise((function(r,a){var i=0;!function o(){if(e())r();else{i++;var s=t(i);null!=n&&i>=n?a():setTimeout(o,s)}}()}))}function ee(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found ".concat(e[a]," at dim ").concat(a));if(-1===r){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));var i=e.slice();return i[r]=t/n,i}function te(e,t){var n=t.length;return G((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e)})),G(e.every((function(e){return Z(e)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(e)})),e.map((function(e){return e<0?n+e:e}))}function ne(e,t){for(var n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:te(t,e).sort(),o=0,s=0;s<e.length;++s){if(null!=i){if(i[o]===s&&1!==e[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(e[s],"' is not 1"));(null==i[o]||i[o]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),i[o]<=s&&o++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function re(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type ".concat(e));n=new Uint8Array(t)}return n}function ae(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function ie(e,t){return"complex64"!==t&&(("float32"!==t||"complex64"===e)&&(("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)))}function oe(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function se(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function ue(e){return"string"===typeof e||e instanceof String}function le(e){return"number"===typeof e}function ce(e){return Array.isArray(e)?ce(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":le(e)?"float32":ue(e)?"string":"boolean"===typeof e?"bool":"float32"}function he(e){return!!(e&&e.constructor&&e.call&&e.apply)}function pe(e,t){for(var n=t;n<e;++n)if(e%n===0)return n;return e}function fe(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function de(e,t,n){var r=new Array;if(1===t.length)for(var a=t[0],i=0;i<a;i++)r[i]=n[e+i];else for(var o=t[0],s=t.slice(1),u=s.reduce((function(e,t){return e*t})),l=0;l<o;l++)r[l]=de(e+l*u,s,n);return r}function ve(e,t){if(0===e.length)return t[0];var n=e.reduce((function(e,t){return e*t}));if(0===n)return[];if(n!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length,"."));return de(0,e,t)}function me(e,t){for(var n=ge(e,t),r=0;r<n.length;r++)n[r]=1;return n}function ge(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function ye(e,t){var n=e.reduce((function(e,t){return e*t}),1);if(null==t||"float32"===t)return ve(e,new Float32Array(n));if("int32"===t)return ve(e,new Int32Array(n));if("bool"===t)return ve(e,new Uint8Array(n));throw new Error("Unknown data type ".concat(t))}function be(e){e.forEach((function(t){G(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"].")}))}))}function xe(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function ke(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function we(e){return e&&e.then&&"function"===typeof e.then}var _e="tfjsflags",Se=function(){function e(t){A(this,e),this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return R(e,[{key:"setPlatform",value:function(e,t){null!=this.platform&&console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(t,".")),this.platformName=e,this.platform=t}},{key:"registerFlag",value:function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];console.warn("Setting feature override from URL ".concat(e,": ").concat(r,".")),this.set(e,r)}}},{key:"getAsync",value:function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in this.flags)){e.next=2;break}return e.abrupt("return",this.flags[t]);case 2:return e.next=4,this.evaluateFlag(t);case 4:return this.flags[t]=e.sent,e.abrupt("return",this.flags[t]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(e){if(e in this.flags)return this.flags[e];var t=this.evaluateFlag(e);if(we(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}},{key:"getNumber",value:function(e){return this.get(e)}},{key:"getBool",value:function(e){return this.get(e)}},{key:"getFlags",value:function(){return this.flags}},{key:"features",get:function(){return this.flags}},{key:"set",value:function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}},{key:"evaluateFlag",value:function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}},{key:"setFlags",value:function(e){this.flags=Object.assign({},e)}},{key:"reset",value:function(){this.flags={},this.urlFlags={},this.populateURLFlags()}},{key:"populateURLFlags",value:function(){var e=this;if("undefined"!==typeof this.global&&"undefined"!==typeof this.global.location&&"undefined"!==typeof this.global.location.search){var t=function(e){var t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return Ie(t,r[0],r[1]),r.join("=")})),t}(this.global.location.search);if(_e in t)t.tfjsflags.split(",").forEach((function(t){var n=N(t.split(":"),2),r=n[0],a=n[1];e.urlFlags[r]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if("".concat(+t)===t)return+t;throw new Error("Could not parse value flag value ".concat(t," for flag ").concat(e,"."))}(r,a)}))}}}]),e}();function Ie(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function Ce(){return Ne}var Te,Ne=null;function Ee(){if(null==Te){var e;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof n.g)e=n.g;else if("undefined"!==typeof process)e=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");e=self}Te=e}return Te}function Me(e,t){var n=function(){var e=Ee();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);var r=t();return n.set(e,r),n.get(e)}var Ae="Abs",De="Acos",Re="Acosh",Oe="Add",Fe="AddN",Le="All",Pe="Any",ze="ArgMax",Be="ArgMin",Ve="Asin",We="Asinh",Ue="Atan",He="Atanh",Ge="Atan2",je="AvgPool",qe="AvgPoolGrad",Xe="AvgPool3D",Ke="AvgPool3DGrad",Ye="BatchMatMul",Ze="BatchToSpaceND",Qe="Bincount",$e="Cast",Je="Ceil",et="ClipByValue",tt="Complex",nt="ComplexAbs",rt="Concat",at="Conv2D",it="Conv2DBackpropFilter",ot="Conv2DBackpropInput",st="Conv3D",ut="Conv3DBackpropFilterV2",lt="Conv3DBackpropInputV2",ct="Cos",ht="Cosh",pt="Cumsum",ft="CropAndResize",dt="DenseBincount",vt="DepthToSpace",mt="DepthwiseConv2dNative",gt="DepthwiseConv2dNativeBackpropFilter",yt="DepthwiseConv2dNativeBackpropInput",bt="Diag",xt="Dilation2D",kt="Dilation2DBackpropInput",wt="Dilation2DBackpropFilter",_t="RealDiv",St="Elu",It="EluGrad",Ct="Erf",Tt="Equal",Nt="Exp",Et="ExpandDims",Mt="Expm1",At="FFT",Dt="Fill",Rt="FlipLeftRight",Ot="Floor",Ft="FloorDiv",Lt="FusedBatchNorm",Pt="GatherV2",zt="GatherNd",Bt="Greater",Vt="GreaterEqual",Wt="Identity",Ut="IFFT",Ht="Imag",Gt="IsFinite",jt="IsInf",qt="IsNan",Xt="LeakyRelu",Kt="Less",Yt="LessEqual",Zt="LinSpace",Qt="Log",$t="Log1p",Jt="LogicalAnd",en="LogicalNot",tn="LogicalOr",nn="LRN",rn="LRNGrad",an="Max",on="Maximum",sn="MaxPool",un="MaxPoolGrad",ln="MaxPool3D",cn="MaxPool3DGrad",hn="MaxPoolWithArgmax",pn="Mean",fn="Min",dn="Minimum",vn="MirrorPad",mn="Mod",gn="Multinomial",yn="Multiply",bn="Neg",xn="NotEqual",kn="NonMaxSuppressionV3",wn="NonMaxSuppressionV4",_n="NonMaxSuppressionV5",Sn="OnesLike",In="OneHot",Cn="Pack",Tn="PadV2",Nn="Pow",En="Prelu",Mn="Prod",An="Range",Dn="Real",Rn="Reciprocal",On="Relu",Fn="Reshape",Ln="ResizeNearestNeighbor",Pn="ResizeNearestNeighborGrad",zn="ResizeBilinear",Bn="ResizeBilinearGrad",Vn="Relu6",Wn="Reverse",Un="Round",Hn="Rsqrt",Gn="ScatterNd",jn="Select",qn="Selu",Xn="Slice",Kn="Sin",Yn="Sinh",Zn="Sign",Qn="Sigmoid",$n="Softplus",Jn="Sqrt",er="Sum",tr="SpaceToBatchND",nr="SplitV",rr="Softmax",ar="SquaredDifference",ir="Square",or="Sub",sr="SparseToDense",ur="StridedSlice",lr="Tan",cr="Tanh",hr="Tile",pr="TopK",fr="Transform",dr="Transpose",vr="Unique",mr="Unpack",gr="UnsortedSegmentSum",yr="ZerosLike",br="Step",xr="FromPixels",kr="RotateWithOffset",wr="_FusedMatMul",_r="FusedConv2D",Sr="FusedDepthwiseConv2D",Ir=Me("kernelRegistry",(function(){return new Map})),Cr=Me("gradRegistry",(function(){return new Map}));function Tr(e,t){var n=Dr(e,t);return Ir.get(n)}function Nr(e){return Cr.get(e)}function Er(e){for(var t=Ir.entries(),n=[];;){var r=t.next(),a=r.done,i=r.value;if(a)break;var o=N(i,2),s=o[0],u=o[1];N(s.split("_"),1)[0]===e&&n.push(u)}return n}function Mr(e){var t=e.kernelName,n=e.backendName,r=Dr(t,n);Ir.has(r)&&console.warn("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),Ir.set(r,e)}function Ar(e){var t=e.kernelName;Cr.has(t)&&Ce().getBool("DEBUG")&&console.warn("Overriding the gradient for '".concat(t,"'")),Cr.set(t,e)}function Dr(e,t){return"".concat(t,"_").concat(e)}function Rr(e,t){return"string"===t?Lr(e):Or([e],t)}function Or(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=X(e)),Ce().getBool("DEBUG")&&function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var n=new Uint8Array(e.length),r=0;r<n.length;++r)0!==Math.round(e[r])&&(n[r]=1);return n}throw new Error("Unknown data type ".concat(t))}function Fr(){return Ce().platform.now()}function Lr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",Ce().platform.encode(e,t)}function Pr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",Ce().platform.decode(e,t)}var zr=function(){function e(t,n){A(this,e),this.backendTimer=t,this.logger=n,null==n&&(this.logger=new Br)}return R(e,[{key:"profileKernel",value:function(e,t,n){var r,a,i=function(){r=n()},o=Fr();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(i);else{i();var s,u=L(r);try{for(u.s();!(s=u.n()).done;){s.value.dataSync()}}catch(h){u.e(h)}finally{u.f()}a=Promise.resolve({kernelMs:Fr()-o})}if(Ce().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(var l=function(t){var n=r[t];n.data().then((function(t){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(n,"'")),!0}}(t,n.dtype,e)}))},c=0;c<r.length;c++)l(c);return{kernelName:e,outputs:r,inputs:t,timeMs:a.then((function(e){return e.kernelMs})),extraInfo:a.then((function(e){return null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""}))}}},{key:"logKernelProfile",value:function(e){var t=this,n=e.kernelName,r=e.outputs,a=e.timeMs,i=e.inputs,o=e.extraInfo;r.forEach((function(e){Promise.all([e.data(),a,o]).then((function(r){t.logger.logKernelProfile(n,e,r[0],r[1],i,r[2])}))}))}}]),e}();var Br=function(){function e(){A(this,e)}return R(e,[{key:"logKernelProfile",value:function(e,t,n,r,a,i){var o="number"===typeof r?$("".concat(r,"ms"),9):r.error,s=$(e,25),u=t.rank,l=t.size,c=$(t.shape.toString(),14),h="";for(var p in a){var f=a[p];if(null!=f){var d=f.shape||t.shape,v=d.length;h+="".concat(p,": ").concat(v,"D ").concat(v>0?d:""," ")}}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(u,"D ").concat(c,"\t%c").concat(l,"\t%c").concat(h,"\t%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}]),e}();function Vr(e,t,n){for(var r={},a={},i=0;i<t.length;i++)r[t[i].id]=!0;for(var o=0;o<e.length;o++){var s=e[o],u=s.inputs;for(var l in u){for(var c=u[l],h=!1,p=0;p<t.length;p++)if(r[c.id]){s.outputs.forEach((function(e){return r[e.id]=!0})),h=!0,a[s.id]=!0;break}if(h)break}}var f={};f[n.id]=!0;for(var d={},v=e.length-1;v>=0;v--)for(var m=e[v],g=m.inputs,y=0;y<m.outputs.length;y++)if(f[m.outputs[y].id]){for(var b in g)f[g[b].id]=!0,d[m.id]=!0;break}for(var x=[],k=0;k<e.length;k++){var w=e[k];if(a[w.id]&&d[w.id]){var _={};for(var S in w.inputs){var I=w.inputs[S];r[I.id]&&(_[S]=I)}var C=Object.assign({},w);C.inputs=_,C.outputs=w.outputs,x.push(C)}}return x}function Wr(e,t,n,r){for(var a=function(a){var i=t[a],o=[];if(i.outputs.forEach((function(t){var n=e[t.id];null!=n?o.push(n):o.push(null)})),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(i.kernelName,"."));var s=i.gradient(o),u=function(t){if(!(t in s))throw new Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(s),"."));var a=n((function(){return s[t]()}));if("float32"!==a.dtype)throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(a.dtype,"'"));var o=i.inputs[t];if(!Y(a.shape,o.shape))throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(a.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==e[o.id])e[o.id]=a;else{var u=e[o.id];e[o.id]=r(u,a),u.dispose()}};for(var l in i.inputs)u(l)},i=t.length-1;i>=0;i--)a(i)}function Ur(e,t){return Ur=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ur(e,t)}function Hr(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ur(e,t)}function Gr(e){return Gr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Gr(e)}function jr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(tY){return!1}}function qr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xr(e,t){if(t&&("object"===E(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return qr(e)}function Kr(e){var t=jr();return function(){var n,r=Gr(e);if(t){var a=Gr(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Xr(this,n)}}function Yr(e,t,n,r){var a=fe(t),i=function(e,t,n,r){var a=K(t),i=r[r.length-1],o=new Array(i).fill(0),s=t.length,u="complex64"===n?Jr(e):e;if(s>1)for(var l=0;l<a/i;l++)for(var c=l*i,h=0;h<i;h++)o[h]=Math.max(o[h],Zr(u[c+h],0,n).length);return o}(e,t,n,a),o=t.length,s=$r(e,t,n,a,i),u=["Tensor"];return r&&(u.push("  dtype: ".concat(n)),u.push("  rank: ".concat(o)),u.push("  shape: [".concat(t,"]")),u.push("  values:")),u.push(s.map((function(e){return"    "+e})).join("\n")),u.join("\n")}function Zr(e,t,n){return $(Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(7))," + ")+"".concat(parseFloat(e[1].toFixed(7)),"j"):ue(e)?"'".concat(e,"'"):"bool"===n?Qr(e):parseFloat(e.toFixed(7)).toString(),t)}function Qr(e){return 0===e?"false":"true"}function $r(e,t,n,r,a){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o="complex64"===n?2:1,s=t[0],u=t.length;if(0===u){if("complex64"===n){var l=Jr(e);return[Zr(l[0],0,n)]}return"bool"===n?[Qr(e[0])]:[e[0].toString()]}if(1===u){if(s>20){var c=3*o,h=Array.from(e.slice(0,c)),p=Array.from(e.slice((s-3)*o,s*o));return"complex64"===n&&(h=Jr(h),p=Jr(p)),["["+h.map((function(e,t){return Zr(e,a[t],n)})).join(", ")+", ..., "+p.map((function(e,t){return Zr(e,a[s-3+t],n)})).join(", ")+"]"]}var f="complex64"===n?Jr(e):Array.from(e);return["["+f.map((function(e,t){return Zr(e,a[t],n)})).join(", ")+"]"]}var d=t.slice(1),v=r.slice(1),m=r[0]*o,g=[];if(s>20){for(var y=0;y<3;y++){var b=y*m,x=b+m;g.push.apply(g,I($r(e.slice(b,x),d,n,v,a,!1)))}g.push("...");for(var k=s-3;k<s;k++){var w=k*m,_=w+m;g.push.apply(g,I($r(e.slice(w,_),d,n,v,a,k===s-1)))}}else for(var S=0;S<s;S++){var C=S*m,T=C+m;g.push.apply(g,I($r(e.slice(C,T),d,n,v,a,S===s-1)))}var N=2===u?",":"";g[0]="["+g[0]+N;for(var E=1;E<g.length-1;E++)g[E]=" "+g[E]+N;for(var M=",\n",A=2;A<u;A++)M+="\n";return g[g.length-1]=" "+g[g.length-1]+"]"+(i?"":M),g}function Jr(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var ea=function(){function e(t,n,r){var a=this;if(A(this,e),this.dtype=n,this.shape=t.slice(),this.size=K(t),null!=r){var i=r.length;G(i===this.size,(function(){return"Length of values '".concat(i,"' does not match the size ")+"inferred by the shape '".concat(a.size,"'.")}))}if("complex64"===n)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||ae(n,this.size),this.strides=fe(t)}return R(e,[{key:"set",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];0===r.length&&(r=[0]),G(r.length===this.rank,(function(){return"The number of provided coordinates (".concat(r.length,") must ")+"match the rank (".concat(t.rank,")")}));var i=this.locToIndex(r);this.values[i]=e}},{key:"get",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);for(var r=0,a=0,i=t;a<i.length;a++){var o=i[a];if(o<0||o>=this.shape[r]){var s="Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape);throw new Error(s)}r++}for(var u=t[t.length-1],l=0;l<t.length-1;++l)u+=this.strides[l]*t[l];return this.values[u]}},{key:"locToIndex",value:function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}},{key:"indexToLoc",value:function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}},{key:"rank",get:function(){return this.shape.length}},{key:"toTensor",value:function(){return ta().makeTensor(this.values,this.shape,this.dtype)}}]),e}(),ta=null,na=null;var ra=function(){function e(t,n,r,a){A(this,e),this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=K(t),this.strides=fe(t),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return R(e,[{key:"rank",get:function(){return this.shape.length}},{key:"buffer",value:function(){var e=F(M().mark((function e(){var t;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",na.buffer(this.shape,this.dtype,t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"bufferSync",value:function(){return na.buffer(this.shape,this.dtype,this.dataSync())}},{key:"array",value:function(){var e=F(M().mark((function e(){var t;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",ve(this.shape,t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"arraySync",value:function(){return ve(this.shape,this.dataSync())}},{key:"data",value:function(){var e=F(M().mark((function e(){var t,n;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.throwIfDisposed(),t=ta().read(this.dataId),"string"!==this.dtype){e.next=13;break}return e.next=5,t;case 5:return n=e.sent,e.prev=6,e.abrupt("return",n.map((function(e){return Pr(e)})));case 10:throw e.prev=10,e.t0=e.catch(6),new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().");case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[6,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"dataSync",value:function(){this.throwIfDisposed();var e=ta().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return Pr(e)}))}catch(KG){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}},{key:"bytes",value:function(){var e=F(M().mark((function e(){var t;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfDisposed(),e.next=3,ta().read(this.dataId);case 3:if(t=e.sent,"string"!==this.dtype){e.next=8;break}return e.abrupt("return",t);case 8:return e.abrupt("return",new Uint8Array(t.buffer));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){this.isDisposed||(ta().disposeTensor(this),this.isDisposedInternal=!0)}},{key:"isDisposed",get:function(){return this.isDisposedInternal}},{key:"throwIfDisposed",value:function(){if(this.isDisposed)throw new Error("Tensor is disposed.")}},{key:"print",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return na.print(this,e)}},{key:"clone",value:function(){return this.throwIfDisposed(),na.clone(this)}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.dataSync();return Yr(t,this.shape,this.dtype,e)}},{key:"cast",value:function(e){return this.throwIfDisposed(),na.cast(this,e)}},{key:"variable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),ta().makeVariable(this,e,t,n)}}]),e}();function aa(){return Me("Tensor",(function(){return ra}))}Object.defineProperty(ra,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}}),aa();var ia,oa,sa,ua,la,ca=function(e){Hr(n,e);var t=Kr(n);function n(e,r,a,i){var o;return A(this,n),(o=t.call(this,e.shape,e.dtype,e.dataId,i)).trainable=r,o.name=a,o}return R(n,[{key:"assign",value:function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!Y(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));ta().disposeTensor(this),this.dataId=e.dataId,ta().incRef(this,null)}},{key:"dispose",value:function(){ta().disposeVariable(this),this.isDisposedInternal=!0}}]),n}(ra);Object.defineProperty(ca,Symbol.hasInstance,{value:function(e){return e instanceof ra&&null!=e.assign&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(ia||(ia={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(oa||(oa={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(sa||(sa={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(ua||(ua={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(la||(la={}));var ha={float32:ua,int32:oa,bool:sa,complex64:la};function pa(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return ha[e][t]}function fa(e){return pa(e,"int32")}function da(e,t){if(e.dtype===t.dtype)return[e,t];var n=pa(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function va(e,t){return t.some((function(t){return t.id===e.id}))}function ma(e){var t=[];return ga(e,t,new Set),t}function ga(e,t,n){if(null!=e)if(e instanceof ra)t.push(e);else if(r=e,Array.isArray(r)||"object"===typeof r){var r,a=e;for(var i in a){var o=a[i];n.has(o)||(n.add(o),ga(o,t,n))}}}function ya(e){return null!=e.kernelName}var ba=function(){function e(){A(this,e),this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((function(e){return e.name}))))}}}return R(e,[{key:"dispose",value:function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()}}]),e}(),xa=function(){function e(t){A(this,e),this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new ba}return R(e,[{key:"ready",value:function(){var e=F(M().mark((function e(){var t,n,r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.pendingBackendInit){e.next=2;break}return e.abrupt("return",this.pendingBackendInit.then((function(){})));case 2:if(null==this.backendInstance){e.next=4;break}return e.abrupt("return");case 4:t=this.getSortedBackends(),n=0;case 6:if(!(n<t.length)){e.next=18;break}return r=t[n],e.next=10,this.initializeBackend(r).success;case 10:if(!e.sent){e.next=15;break}return e.next=14,this.setBackend(r);case 14:return e.abrupt("return");case 15:n++,e.next=6;break;case 18:throw new Error("Could not initialize any backends, all backend initializations failed.");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"backend",get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '".concat(t,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}},{key:"backendNames",value:function(){return Object.keys(this.registryFactory)}},{key:"findBackend",value:function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]}},{key:"findBackendFactory",value:function(e){return e in this.registryFactory?this.registryFactory[e].factory:null}},{key:"registerBackend",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(console.warn("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}},{key:"setBackend",value:function(){var e=F(M().mark((function e(t){var n,r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.registryFactory[t]){e.next=2;break}throw new Error("Backend name '".concat(t,"' not found in registry"));case 2:if(this.backendName=t,null!=this.registry[t]){e.next=16;break}if(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,!n.asyncInit){e.next=12;break}return e.next=9,r;case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=r;case 13:if(e.t0){e.next=16;break}return e.abrupt("return",!1);case 16:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new zr(this.backendInstance),e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupRegisteredKernels",value:function(){var e=this;Er(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))}},{key:"disposeRegisteredKernels",value:function(e){var t=this;Er(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))}},{key:"initializeBackend",value:function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{var r=n.factory();if(!r||r instanceof z||"function"!==typeof r.then)return this.registry[e]=r,{success:!0,asyncInit:!1};var a=++this.pendingBackendInitId,i=r.then((function(n){return!(a<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)})).catch((function(n){return a<t.pendingBackendInitId||(t.pendingBackendInit=null,console.warn("Initialization of backend ".concat(e," failed")),console.warn(n.stack||n.message)),!1}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}catch(o){return console.warn("Initialization of backend ".concat(e," failed")),console.warn(o.stack||o.message),{success:!1,asyncInit:!1}}}},{key:"removeBackend",value:function(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}},{key:"getSortedBackends",value:function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))}},{key:"initializeBackendsAndReturnBest",value:function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}},{key:"moveData",value:function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t),i=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}},{key:"tidy",value:function(e,t){var n,r=this,a=null;if(null==t){if("function"!==typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!==typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))}},{key:"scopedRun",value:function(e,t,n){e();try{var r=n();return t(),r}catch(a){throw t(),a}}},{key:"nextTensorId",value:function(){return e.nextTensorId++}},{key:"nextVariableId",value:function(){return e.nextVariableId++}},{key:"clone",value:function(e){var t=_a.runKernel(Wt,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(function(e){return{x:function(){var t={x:e},n={dtype:"float32"};return _a.runKernel($e,t,n)}}}),[],{}),t}},{key:"runKernel",value:function(e,t,n){if(!(null!=Tr(e,this.backendName)))throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}},{key:"shouldCheckForMemLeaks",value:function(){return this.ENV.getBool("IS_TEST")}},{key:"checkKernelForMemLeak",value:function(e,t,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(e){a+="complex64"===e.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-i;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(e,"'"))}},{key:"runKernelFunc",value:function(e){var t,n,r,a=this,i=[],o=this.isTapeOn(),s=this.state.numBytes,u=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;var l=ya(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(ya(e)){var c=e.kernelName,h=e.inputs,p=e.attrs;null==this.backendName&&this.backend;var f=Tr(c,this.backendName);G(null!=f,(function(){return"Cannot find registered kernel '".concat(c,"' for backend '").concat(a.backendName,"'")})),n=function(){var e=a.backend.numDataIds();r=f.kernelFunc({inputs:h,attrs:p,backend:a.backend});var t=Array.isArray(r)?r:[r];a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(c,e,t);var n=t.map((function(e){if(null!=e.rank)return e;var t=e.dataId,n=e.shape,r=e.dtype;return a.makeTensorFromDataId(t,n,r)}));if(o){var s=a.getTensorsForGradient(c,h,n);i=a.saveTensorsForBackwardMode(s)}return n}}else{var d=e.forwardFunc,v=function(e){o&&(i=e.map((function(e){return a.keep(a.clone(e))})))};n=function(){var e=a.backend.numDataIds();r=a.tidy((function(){return d(a.backend,v)}));var t=Array.isArray(r)?r:[r];return a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(l,e,t),t}}var m,g=e.inputs,y=e.attrs,b=ya(e)?null:e.backwardsFunc;return this.scopedRun((function(){return a.state.kernelDepth++}),(function(){return a.state.kernelDepth--}),(function(){a.ENV.getBool("DEBUG")||a.state.profiling?(m=a.profiler.profileKernel(l,g,(function(){return n()})),a.ENV.getBool("DEBUG")&&a.profiler.logKernelProfile(m),t=m.outputs):t=n()})),o&&this.addTapeNode(l,g,t,b,i,y),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-u,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(g).map((function(e){return null!=g[e]?g[e].shape:null})),outputShapes:t.map((function(e){return e.shape})),kernelTimeMs:m.timeMs,extraInfo:m.extraInfo}),Array.isArray(r)?t:t[0]}},{key:"saveTensorsForBackwardMode",value:function(e){var t=this;return e.map((function(e){return t.keep(t.clone(e))}))}},{key:"getTensorsForGradient",value:function(e,t,n){var r=Nr(e);if(null!=r){var a,i=r.inputsToSave||[],o=r.outputsToSave||[];r.saveAllInputs?(G(Array.isArray(t),(function(){return"saveAllInputs is true, expected inputs to be an array."})),a=Object.keys(t).map((function(e){return t[e]}))):a=i.map((function(e){return t[e]}));var s=n.filter((function(e,t){return o[t]}));return a.concat(s)}return[]}},{key:"makeTensor",value:function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=e;"string"===n&&ue(e[0])&&(a=e.map((function(e){return Lr(e)})));var i=r.write(a,t,n),o=new ra(t,n,i,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){var s=this.state.tensorInfo.get(i),u=function(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}(a);this.state.numBytes+=u-s.bytes,s.bytes=u}return o}},{key:"makeTensorFromDataId",value:function(e,t,n,r){var a=new ra(t,n=n||"float32",e,this.nextTensorId());return this.trackTensor(a,r),a}},{key:"makeVariable",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));var a=new ca(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}},{key:"trackTensor",value:function(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;var n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*se(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof ca||this.track(e)}},{key:"incRef",value:function(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}},{key:"removeDataId",value:function(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}},{key:"disposeTensor",value:function(e){if(this.state.tensorInfo.has(e.dataId)){var t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){var n=e.size*se(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}}},{key:"disposeVariables",value:function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}}},{key:"disposeVariable",value:function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}},{key:"memory",value:function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}},{key:"profile",value:function(){var e=F(M().mark((function e(t){var n,r,a,i,o;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],e.next=6,t();case 6:this.state.activeProfile.result=e.sent,this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,I(this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot})))),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,a=L(this.state.activeProfile.kernels),e.prev=12,a.s();case 14:if((i=a.n()).done){e.next=24;break}return o=i.value,e.next=18,o.kernelTimeMs;case 18:return o.kernelTimeMs=e.sent,e.next=21,o.extraInfo;case 21:o.extraInfo=e.sent;case 22:e.next=14;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(12),a.e(e.t0);case 29:return e.prev=29,a.f(),e.finish(29);case 32:return e.abrupt("return",this.state.activeProfile);case 33:case"end":return e.stop()}}),e,this,[[12,26,29,32]])})));return function(t){return e.apply(this,arguments)}}()},{key:"isTapeOn",value:function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}},{key:"addTapeNode",value:function(e,t,n,r,a,i){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},u=Nr(e);null!=u&&(r=u.gradFunc),null!=r&&(s.gradient=function(e){return e=e.map((function(e,t){if(null==e){var r=n[t],a=ge(r.size,r.dtype);return o.makeTensor(a,r.shape,r.dtype)}return e})),r(e.length>1?e:e[0],a,i)}),this.state.activeTape.push(s)}},{key:"keep",value:function(e){return e.kept=!0,e}},{key:"startTape",value:function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}},{key:"endTape",value:function(){this.state.gradientDepth--}},{key:"startScope",value:function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}},{key:"endScope",value:function(e){for(var t=this,n=ma(e),r=new Set(n.map((function(e){return e.id}))),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==o.id||t.track(e)}))}},{key:"gradients",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(G(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var i=this.scopedRun((function(){return r.startTape()}),(function(){return r.endTape()}),(function(){return r.tidy("forward",e)}));G(i instanceof ra,(function(){return"The result y returned by f() must be a tensor."}));var o=Vr(this.state.activeTape,t,i);if(!a&&0===o.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e={};e[i.id]=null==n?ka(i.shape):n,Wr(e,o,(function(e){return r.tidy(e)}),Sa);var a=t.map((function(t){return e[t.id]}));return 0===r.state.gradientDepth&&(r.state.activeTape.forEach((function(e){var t,n=L(e.saved);try{for(n.s();!(t=n.n()).done;){t.value.dispose()}}catch(r){n.e(r)}finally{n.f()}})),r.state.activeTape=null),{value:i,grads:a}}))}},{key:"customGrad",value:function(e){var t=this;return G(he(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i;G(r.every((function(e){return e instanceof ra})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};r.forEach((function(e,t){o[t]=e}));var s=function(t,n){return G((i=e.apply(void 0,[].concat(r,[n]))).value instanceof ra,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),G(he(i.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),i.value},u=function(e,t){var n=i.gradFunc(e,t),a=Array.isArray(n)?n:[n];G(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),G(a.every((function(e){return e instanceof ra})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(e,t){o[t]=function(){return e}})),o};return t.runKernelFunc({forwardFunc:s,backwardsFunc:u,inputs:o})}}},{key:"readSync",value:function(e){return this.state.tensorInfo.get(e).backend.readSync(e)}},{key:"read",value:function(e){return this.state.tensorInfo.get(e).backend.read(e)}},{key:"time",value:function(){var e=F(M().mark((function e(t){var n,r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Fr(),e.next=3,this.backend.time(t);case 3:return(r=e.sent).wallMs=Fr()-n,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"track",value:function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}},{key:"registeredVariables",get:function(){return this.state.registeredVariables}},{key:"reset",value:function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new ba,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}]),e}();function ka(e){var t=me(K(e),"float32");return _a.makeTensor(t,e,"float32")}function wa(){var e=Ee();if(null==e._tfengine){var t=new Se(e);e._tfengine=new xa(t)}return function(e){Ne=e}(e._tfengine.ENV),ta=function(){return e._tfengine},e._tfengine}xa.nextTensorId=0,xa.nextVariableId=0;var _a=wa();function Sa(e,t){var n={a:e,b:t};return _a.runKernel(Oe,n)}function Ia(){if("undefined"!==typeof navigator&&null!=navigator){var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function Ca(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}var Ta=Ce();function Na(e,t){var n=e;if(oe(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||oe(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&Ce().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Ea(e,r,[]),r}function Ea(e,t,n){if(n=n||[],Array.isArray(e)||oe(e)){G(t.length>0,(function(){return"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(e.length," elements")})),G(e.length===t[0],(function(){return"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," ")+"elements, but has ".concat(e.length," elements")}));for(var r=t.slice(1),a=0;a<e.length;++a)Ea(e[a],r,n.concat(a))}else G(0===t.length,(function(){return"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(t[0]," elements")}))}function Ma(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}}function Aa(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof ra)return Ma(r,e.dtype,t,n),e;var a=ce(e);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),Ma(r,a,t,n),null==e||!oe(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e){var i=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(i,"'"))}var o=Na(e,a);oe(e)||Array.isArray(e)||(e=[e]);var s=!0,u="string"!==a?Or(e,a):X(e,[],s);return _a.makeTensor(u,o,a)}function Da(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");var a=e;return a.map((function(e,a){return Aa(e,"".concat(t,"[").concat(a,"]"),n,r)}))}Ta.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),Ta.registerFlag("IS_BROWSER",(function(){return Ca()})),Ta.registerFlag("IS_NODE",(function(){return"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node})),Ta.registerFlag("IS_CHROME",(function(){return"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),Ta.registerFlag("PROD",(function(){return!1})),Ta.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return Ta.getBool("DEBUG")})),Ta.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),Ta.registerFlag("IS_TEST",(function(){return!1})),Ta.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(function(){return!0})),Ta.registerFlag("WRAP_TO_IMAGEBITMAP",(function(){return!1}));function Ra(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+="__op";var a=function(){_a.startScope(n);try{var e=r.apply(void 0,arguments);return we(e)&&console.error("Cannot return a Promise inside of tidy."),_a.endScope(e),e}catch(t){throw _a.endScope(null),t}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}var Oa=Ra({complex_:function(e,t){var n=Aa(e,"real","complex"),r=Aa(t,"imag","complex");j(n.shape,r.shape,"real and imag shapes, ".concat(n.shape," and ").concat(r.shape,", ")+"must match in call to tf.complex().");var a={real:n,imag:r};return _a.runKernel(tt,a)}});function Fa(e,t,n,r){if(null==r&&(r=ce(e)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!oe(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){be(t);var a=K(t),i=K(n);G(a===i,(function(){return"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(a," values but has ").concat(i)}));for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==K(t.slice(o));G(n[o]===t[o]||!u,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). ")}))}}return oe(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?Or(e,r):X(e,[],!0),_a.makeTensor(e,t,r)}function La(e,t,n){return Fa(e,t,Na(e,n),n)}var Pa={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};function za(e,t){return Ba.apply(this,arguments)}function Ba(){return Ba=F(M().mark((function e(t,n){var r,a,i,o,s,u;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=[],a=[],i=Array.isArray(t)?t.map((function(e){return e.name})):Object.keys(t),o=function(e){var o=i[e],s=Array.isArray(t)?t[e].tensor:t[o];if("float32"!==s.dtype&&"int32"!==s.dtype&&"bool"!==s.dtype&&"string"!==s.dtype&&"complex64"!==s.dtype)throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(s.dtype));var u={name:o,shape:s.shape,dtype:s.dtype};if("string"===s.dtype){var l=new Promise(function(){var e=F(M().mark((function e(t){var n,r,a,i,o,u,l;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.bytes();case 2:for(n=e.sent,r=n.reduce((function(e,t){return e+t.length}),0)+4*n.length,a=new Uint8Array(r),i=0,o=0;o<n.length;o++)u=n[o],l=new Uint8Array(new Uint32Array([u.length]).buffer),a.set(l,i),i+=4,a.set(u,i),i+=u.length;t(a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());a.push(l)}else a.push(s.data());null!=n&&(u.group=n),r.push(u)},s=0;s<i.length;++s)o(s);return e.next=7,Promise.all(a);case 7:return u=e.sent,e.abrupt("return",{data:Wa(u),specs:r});case 9:case"end":return e.stop()}}),e)}))),Ba.apply(this,arguments)}function Va(e,t){var n,r,a={},i=0,o=L(t);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=s.name,l=s.dtype,c=s.shape,h=K(c),p=void 0;if("quantization"in s){var f=s.quantization;if("uint8"===f.dtype||"uint16"===f.dtype){if(!("min"in f)||!("scale"in f))throw new Error("Weight ".concat(s.name," with quantization ").concat(f.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==f.dtype)throw new Error("Weight ".concat(s.name," has unknown ")+"quantization dtype ".concat(f.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==l)throw new Error("Weight ".concat(s.name," is quantized with ").concat(f.dtype," ")+"which only supports weights of type float32 not ".concat(l,"."))}var d=Pa[f.dtype],v=e.slice(i,i+h*d),m="uint8"===f.dtype?new Uint8Array(v):new Uint16Array(v);if("float32"===l)if("uint8"===f.dtype||"uint16"===f.dtype){p=new Float32Array(m.length);for(var g=0;g<m.length;g++){var y=m[g];p[g]=y*f.scale+f.min}}else{if("float16"!==f.dtype)throw new Error("Unsupported quantization type ".concat(f.dtype," ")+"for weight type float32.");void 0===n&&(n=Ya()),p=n(m)}else{if("int32"!==l)throw new Error("Unsupported dtype in weight '".concat(u,"': ").concat(l));if("uint8"!==f.dtype&&"uint16"!==f.dtype)throw new Error("Unsupported quantization type ".concat(f.dtype," ")+"for weight type int32.");p=new Int32Array(m.length);for(var b=0;b<m.length;b++){var x=m[b];p[b]=Math.round(x*f.scale+f.min)}}i+=h*d}else if("string"===l){var k=K(s.shape);p=[];for(var w=0;w<k;w++){var _=new Uint32Array(e.slice(i,i+4))[0];i+=4;var S=new Uint8Array(e.slice(i,i+_));p.push(S),i+=_}}else{var I=Pa[l],C=e.slice(i,i+h*I);if("float32"===l)p=new Float32Array(C);else if("int32"===l)p=new Int32Array(C);else if("bool"===l)p=new Uint8Array(C);else{if("complex64"!==l)throw new Error("Unsupported dtype in weight '".concat(u,"': ").concat(l));p=new Float32Array(C);for(var T=new Float32Array(p.length/2),N=new Float32Array(p.length/2),E=0;E<T.length;E++)T[E]=p[2*E],N[E]=p[2*E+1];var M=La(T,c,"float32"),A=La(N,c,"float32");a[u]=Oa(M,A),M.dispose(),A.dispose()}i+=h*I}"complex64"!==l&&(a[u]=La(p,c,l))}}catch(D){o.e(D)}finally{o.f()}return a}function Wa(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))}));var r=new Uint8Array(t),a=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),a),a+=e.byteLength})),r.buffer}var Ua="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function Ha(e){return Ua?Buffer.byteLength(e):new Blob([e]).size}function Ga(e){if(Ua)return Buffer.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function ja(e){if(Ua){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}function qa(e){if(1===e.length)return e[0];var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function Xa(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function Ka(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:Ha(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:Ha(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}function Ya(){var e=function(){var e=function(e){for(var t=e<<13,n=0;0===(8388608&t);)n-=8388608,t<<=1;return(t&=-8388609)|n+947912704},t=new Uint32Array(2048);t[0]=0;for(var n=1;n<1024;n++)t[n]=e(n);for(var r=1024;r<2048;r++)t[r]=939524096+(r-1024<<13);return t}(),t=function(){var e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(var t=1;t<31;t++)e[t]=t<<23;for(var n=33;n<63;n++)e[n]=2147483648+(n-32<<23);return e}(),n=function(){for(var e=new Uint32Array(64),t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return function(r){for(var a=new ArrayBuffer(4*r.length),i=new Uint32Array(a),o=0;o<r.length;o++){var s=r[o],u=e[n[s>>10]+(1023&s)]+t[s>>10];i[o]=u}return new Float32Array(a)}}var Za=function(){function e(){A(this,e),this.saveRouters=[],this.loadRouters=[]}return R(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerSaveRouter",value:function(t){e.getInstance().saveRouters.push(t)}},{key:"registerLoadRouter",value:function(t){e.getInstance().loadRouters.push(t)}},{key:"getSaveHandlers",value:function(t){return e.getHandlers(t,"save")}},{key:"getLoadHandlers",value:function(t,n){return e.getHandlers(t,"load",n)}},{key:"getHandlers",value:function(t,n,r){var a=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&a.push(n)})),a}}]),e}(),Qa=function(e){return Za.registerSaveRouter(e)},$a=function(e){return Za.registerLoadRouter(e)},Ja=function(e){return Za.getSaveHandlers(e)},ei=function(e,t){return Za.getLoadHandlers(e,t)},ti="tensorflowjs",ni="models_store",ri="model_info_store";function ai(){if(!Ce().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e="undefined"===typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function ii(e){var t=e.result;t.createObjectStore(ni,{keyPath:"modelPath"}),t.createObjectStore(ri,{keyPath:"modelPath"})}var oi=function(){function e(t){if(A(this,e),this.indexedDB=ai(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return R(e,[{key:"save",value:function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return e.abrupt("return",this.databaseAction(this.modelPath,t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=F(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.databaseAction(this.modelPath));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"databaseAction",value:function(e,t){var n=this;return new Promise((function(e,r){var a=n.indexedDB.open(ti,1);a.onupgradeneeded=function(){return ii(a)},a.onsuccess=function(){var i=a.result;if(null==t){var o=i.transaction(ni,"readonly"),s=o.objectStore(ni).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '".concat(n.modelPath,"' ")+"in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return i.close(),r(s.error)},o.oncomplete=function(){return i.close()}}else{var u,l=Ka(t),c=i.transaction(ri,"readwrite"),h=c.objectStore(ri),p=h.put({modelPath:n.modelPath,modelArtifactsInfo:l});p.onsuccess=function(){var a=(u=i.transaction(ni,"readwrite")).objectStore(ni).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:l});a.onsuccess=function(){return e({modelArtifactsInfo:l})},a.onerror=function(e){var t=(h=c.objectStore(ri)).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(a.error)},t.onerror=function(e){return i.close(),r(a.error)}}},p.onerror=function(e){return i.close(),r(p.error)},c.oncomplete=function(){null==u?i.close():u.oncomplete=function(){return i.close()}}}},a.onerror=function(e){return r(a.error)}}))}}]),e}();oi.URL_SCHEME="indexeddb://";var si=function(e){return Ce().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(oi.URL_SCHEME)?(t=e.slice(oi.URL_SCHEME.length),new oi(t)):null;var t};Za.registerSaveRouter(si),Za.registerLoadRouter(si);var ui=function(){function e(){A(this,e),this.indexedDB=ai()}return R(e,[{key:"listModels",value:function(){var e=F(M().mark((function e(){var t=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.indexedDB.open(ti,1);r.onupgradeneeded=function(){return ii(r)},r.onsuccess=function(){var t=r.result,a=t.transaction(ri,"readonly"),i=a.objectStore(ri).getAll();i.onsuccess=function(){var t,n={},r=L(i.result);try{for(r.s();!(t=r.n()).done;){var a=t.value;n[a.modelPath]=a.modelArtifactsInfo}}catch(o){r.e(o)}finally{r.f()}e(n)},i.onerror=function(e){return t.close(),n(i.error)},a.oncomplete=function(){return t.close()}},r.onerror=function(e){return n(r.error)}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=F(M().mark((function e(t){var n=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(r=t).startsWith(oi.URL_SCHEME)?r.slice(oi.URL_SCHEME.length):r,e.abrupt("return",new Promise((function(e,r){var a=n.indexedDB.open(ti,1);a.onupgradeneeded=function(){return ii(a)},a.onsuccess=function(){var n,i=a.result,o=i.transaction(ri,"readwrite"),s=o.objectStore(ri),u=s.get(t);u.onsuccess=function(){if(null==u.result)return i.close(),r(new Error("Cannot find model with path '".concat(t,"' ")+"in IndexedDB."));var a=s.delete(t),o=function(){var a=(n=i.transaction(ni,"readwrite")).objectStore(ni).delete(t);a.onsuccess=function(){return e(u.result.modelArtifactsInfo)},a.onerror=function(e){return r(u.error)}};a.onsuccess=o,a.onerror=function(e){return o(),i.close(),r(u.error)}},u.onerror=function(e){return i.close(),r(u.error)},o.oncomplete=function(){null==n?i.close():n.oncomplete=function(){return i.close()}}},a.onerror=function(e){return r(a.error)}})));case 2:case"end":return e.stop()}var r}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),li="/",ci="tensorflowjs_models",hi="info",pi="model_topology",fi="weight_specs",di="weight_data",vi="model_metadata";function mi(e){return{info:[ci,e,hi].join(li),topology:[ci,e,pi].join(li),weightSpecs:[ci,e,fi].join(li),weightData:[ci,e,di].join(li),modelMetadata:[ci,e,vi].join(li)}}function gi(e){var t=e.split(li);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(li)}var yi=function(){function e(t){if(A(this,e),!Ce().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=mi(this.modelPath)}return R(e,[{key:"save",value:function(){var e=F(M().mark((function e(t){var n,r,a,i;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=4;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 4:return n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=Ka(t),e.prev=7,this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,Ga(t.weightData)),i={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy},null!=t.signature&&(i.signature=t.signature),null!=t.userDefinedMetadata&&(i.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(i.modelInitializer=t.modelInitializer),this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),e.abrupt("return",{modelArtifactsInfo:a});case 20:throw e.prev=20,e.t0=e.catch(7),this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."));case 28:case"end":return e.stop()}}),e,this,[[7,20]])})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=F(M().mark((function e(){var t,n,r,a,i,o,s;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=JSON.parse(this.LS.getItem(this.keys.info)))){e.next=3;break}throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));case 3:if("JSON"===t.modelTopologyType){e.next=5;break}throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");case 5:if(n={},null!=(r=JSON.parse(this.LS.getItem(this.keys.topology)))){e.next=9;break}throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");case 9:if(n.modelTopology=r,null!=(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))){e.next=13;break}throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");case 13:if(n.weightSpecs=a,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,null!=o.signature&&(n.signature=o.signature),null!=o.userDefinedMetadata&&(n.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(n.modelInitializer=o.modelInitializer)),null!=(s=this.LS.getItem(this.keys.weightData))){e.next=19;break}throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));case 19:return n.weightData=ja(s),e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();yi.URL_SCHEME="localstorage://";var bi=function(e){return Ce().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(yi.URL_SCHEME)?(t=e.slice(yi.URL_SCHEME.length),new yi(t)):null;var t};Za.registerSaveRouter(bi),Za.registerLoadRouter(bi);var xi=function(){function e(){A(this,e),G(Ce().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),G("undefined"===typeof window||"undefined"!==typeof window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return R(e,[{key:"listModels",value:function(){var e=F(M().mark((function e(){var t,n,r,a,i,o;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={},n=ci+li,r=li+hi,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(n)&&i.endsWith(r)&&(o=gi(i),t[o]=JSON.parse(this.LS.getItem(i)));return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=F(M().mark((function e(t){var n,r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(a=t).startsWith(yi.URL_SCHEME)?a.slice(yi.URL_SCHEME.length):a,n=mi(t),null!=this.LS.getItem(n.info)){e.next=4;break}throw new Error("Cannot find model at path '".concat(t,"'"));case 4:return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),e.abrupt("return",r);case 10:case"end":return e.stop()}var a}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ki="://",wi=function(){function e(){A(this,e),this.managers={}}return R(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerManager",value:function(t,n){G(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith(ki)&&(t=t.slice(0,t.indexOf(ki))),G(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();G(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '".concat(t,"'.")})),r.managers[t]=n}},{key:"getManager",value:function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '".concat(e,"'"));return t}},{key:"getSchemes",value:function(){return Object.keys(this.getInstance().managers)}}]),e}();function _i(e){if(-1===e.indexOf(ki))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(wi.getSchemes().join(",")));return{scheme:e.split(ki)[0],path:e.split(ki)[1]}}function Si(e,t){return Ii.apply(this,arguments)}function Ii(){return Ii=F(M().mark((function e(t,n){var r,a,i,o,s,u,l,c,h,p,f=arguments;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=f.length>2&&void 0!==f[2]&&f[2],G(t!==n,(function(){return"Old path and new path are the same: '".concat(t,"'")})),G((a=Za.getLoadHandlers(t)).length>0,(function(){return"Copying failed because no load handler is found for source URL ".concat(t,".")})),G(a.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"load handlers for source URL ".concat(t,".")})),i=a[0],G((o=Za.getSaveHandlers(n)).length>0,(function(){return"Copying failed because no save handler is found for destination "+"URL ".concat(n,".")})),G(o.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"save handlers for destination URL ".concat(n,".")})),s=o[0],u=_i(t).scheme,l=_i(t).path,c=u===_i(t).scheme,e.next=15,i.load();case 15:if(h=e.sent,!r||!c){e.next=19;break}return e.next=19,wi.getManager(u).removeModel(l);case 19:return e.next=21,s.save(h);case 21:if(p=e.sent,!r||c){e.next=25;break}return e.next=25,wi.getManager(u).removeModel(l);case 25:return e.abrupt("return",p.modelArtifactsInfo);case 26:case"end":return e.stop()}}),e)}))),Ii.apply(this,arguments)}function Ci(){return Ti.apply(this,arguments)}function Ti(){return Ti=F(M().mark((function e(){var t,n,r,a,i,o,s;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=wi.getSchemes(),n={},r=L(t),e.prev=3,r.s();case 5:if((a=r.n()).done){e.next=13;break}return i=a.value,e.next=9,wi.getManager(i).listModels();case 9:for(s in o=e.sent)n[i+ki+s]=o[s];case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",n);case 22:case"end":return e.stop()}}),e,null,[[3,15,18,21]])}))),Ti.apply(this,arguments)}function Ni(e){return Ei.apply(this,arguments)}function Ei(){return(Ei=F(M().mark((function e(t){var n,r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=_i(t),r=wi.getManager(n.scheme),e.abrupt("return",r.removeModel(n.path));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Mi(e,t){return Ai.apply(this,arguments)}function Ai(){return(Ai=F(M().mark((function e(t,n){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!1,e.abrupt("return",Si(t,n,false));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Di(e,t){return Ri.apply(this,arguments)}function Ri(){return(Ri=F(M().mark((function e(t,n){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!0,e.abrupt("return",Si(t,n,true));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Oi=function(){function e(){A(this,e)}return R(e,[{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return fetch(e,t)}))},{key:"now",value:function(){return performance.now()}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return new TextDecoder(t).decode(e)}}]),e}();if(Ce().get("IS_BROWSER")){Ce().setPlatform("browser",new Oi);try{wi.registerManager(yi.URL_SCHEME,new xi)}catch($8){}try{wi.registerManager(oi.URL_SCHEME,new ui)}catch($8){}}var Fi,Li=function(){return n(5410)};var Pi=function(){function e(){A(this,e),this.util=n(8628),this.textEncoder=new this.util.TextEncoder}return R(e,[{key:"fetch",value:function(e,t){return null!=Ce().global.fetch?Ce().global.fetch(e,t):(null==Fi&&(Fi=Li()),Fi(e,t))}},{key:"now",value:function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}}]),e}();function zi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",be(e),new ea(e,t,n)}Ce().get("IS_NODE")&&Ce().setPlatform("node",new Pi);var Bi=Ra({cast_:function(e,t){var n=Aa(e,"x","cast");if(!function(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={x:n},a={dtype:t};return _a.runKernel($e,r,a)}});var Vi=Ra({clone_:function(e){var t={x:Aa(e,"x","clone","string_or_numeric")};return _a.runKernel(Wt,t)}});wa();var Wi={buffer:zi,cast:Bi,clone:Vi,print:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}};na=Wi;function Ui(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var Hi=function(){function e(t){if(A(this,e),!Ce().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}return R(e,[{key:"save",value:function(){var e=F(M().mark((function e(t){var n,r,a,i,o,s;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!==typeof document){e.next=2;break}throw new Error("Browser downloads are not supported in this environment since `document` is not present");case 2:if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer)){e.next=7;break}throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 7:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},null!=t.signature&&(a.signature=t.signature),null!=t.userDefinedMetadata&&(a.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(a.modelInitializer=t.modelInitializer),i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(o=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,o.href=i,e.next=18,Ui((function(){return o.dispatchEvent(new MouseEvent("click"))}));case 18:if(null==t.weightData){e.next=24;break}return(s=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,e.next=24,Ui((function(){return s.dispatchEvent(new MouseEvent("click"))}));case 24:return e.abrupt("return",{modelArtifactsInfo:Ka(t)});case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();Hi.URL_SCHEME="downloads://";var Gi=function(){function e(t){if(A(this,e),null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(t));this.files=t}return R(e,[{key:"load",value:function(){var e=F(M().mark((function e(){var t,n,r=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.files[0],n=this.files.slice(1),e.abrupt("return",new Promise((function(e,a){var i=new FileReader;i.onload=function(i){var o=JSON.parse(i.target.result),s=o.modelTopology;if(null!=s){0===n.length&&e({modelTopology:s});var u=o.weightsManifest;if(null!=u){var l;try{l=r.checkManifestAndWeightFiles(u,n)}catch($8){return void a($8)}var c=[],h=[],p=[];u.forEach((function(e){e.paths.forEach((function(e){h.push(e),p.push(null)})),c.push.apply(c,I(e.weights))})),u.forEach((function(t){t.paths.forEach((function(t){var n=new FileReader;n.onload=function(n){var r=n.target.result,a=h.indexOf(t);if(p[a]=r,-1===p.indexOf(null)){var i={modelTopology:s,weightSpecs:c,weightData:qa(p),format:o.format,generatedBy:o.generatedBy,convertedBy:o.convertedBy};null!=o.signature&&(i.signature=o.signature),null!=o.userDefinedMetadata&&(i.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(i.modelInitializer=o.modelInitializer),e(i)}},n.onerror=function(e){return a("Failed to weights data from file of path '".concat(t,"'."))},n.readAsArrayBuffer(l[t])}))}))}else a(new Error("weightManifest field is missing from file ".concat(t.name)))}else a(new Error("modelTopology field is missing from file ".concat(t.name)))},i.onerror=function(e){return a("Failed to read model topology and weights manifest JSON "+"from file '".concat(t.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only.")},i.readAsText(t)})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkManifestAndWeightFiles",value:function(e,t){var n,r=[],a=t.map((function(e){return Xa(e.name)})),i={},o=L(e);try{for(o.s();!(n=o.n()).done;){n.value.paths.forEach((function(e){var n=Xa(e);if(-1!==r.indexOf(n))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(n,"'"));if(r.push(n),-1===a.indexOf(n))throw new Error("Weight file with basename '".concat(n,"' is not provided."));i[e]=t[a.indexOf(n)]}))}}catch($8){o.e($8)}finally{o.f()}if(r.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(r.length,") and the number of weight files provided ")+"(".concat(t.length,")."));return i}}]),e}();function ji(e){return new Gi(e)}function qi(e,t,n,r){!function(e){G(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){G(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(e)})),G(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(t)})),G(t>=e,(function(){return"startFraction must be no more than endFraction, but "+"got startFraction ".concat(e," and endFraction ")+"".concat(t)}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(e.map((function(i){return i.then((function(i){var o=n+ ++a/e.length*(r-n);return t(o),i})),i})))}function Xi(e,t){return Ki.apply(this,arguments)}function Ki(){return(Ki=F(M().mark((function e(t,n){var r,a,i,o,s,u,l,c,h;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&(n={}),r=null==n.fetchFunc?Ce().platform.fetch:n.fetchFunc,a=t.map((function(e){return r(e,n.requestInit,{isBinary:!0})})),i=0,o=.5,null!=n.onProgress){e.next=11;break}return e.next=8,Promise.all(a);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,qi(a,n.onProgress,i,o);case 13:e.t0=e.sent;case 14:if(s=e.t0,u=s.map((function(e){return e.arrayBuffer()})),l=.5,c=1,null!=n.onProgress){e.next=24;break}return e.next=21,Promise.all(u);case 21:e.t1=e.sent,e.next=27;break;case 24:return e.next=26,qi(u,n.onProgress,l,c);case 26:e.t1=e.sent;case 27:return h=e.t1,e.abrupt("return",h);case 29:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Yi(e){return Zi.apply(this,arguments)}function Zi(){return Zi=F(M().mark((function e(t){var n,r,a,i,o=arguments;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"",r=o.length>2?o[2]:void 0,a=o.length>3?o[3]:void 0,i=Qi((function(e){return Xi(e,{requestInit:a})})),e.abrupt("return",i(t,n,r));case 6:case"end":return e.stop()}}),e)}))),Zi.apply(this,arguments)}function Qi(e){return function(){var t=F(M().mark((function t(n){var r,a,i,o,s,u,l,c,h,p,f,d,v=arguments;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=v.length>1&&void 0!==v[1]?v[1]:"",a=v.length>2?v[2]:void 0,i=n.map((function(){return!1})),o={},s=null!=a?a.map((function(){return!1})):[],u=[],n.forEach((function(e,t){var n=0;e.weights.forEach((function(e){var r="quantization"in e?e.quantization.dtype:e.dtype,l=Pa[r]*K(e.shape),c=function(){i[t]=!0,null==o[t]&&(o[t]=[]),o[t].push({manifestEntry:e,groupOffset:n,sizeBytes:l})};null!=a?a.forEach((function(t,n){t===e.name&&(c(),s[n]=!0)})):c(),u.push(e.name),n+=l}))})),s.every((function(e){return e}))){t.next=10;break}throw l=a.filter((function(e,t){return!s[t]})),new Error("Could not find weights in manifest with names: "+"".concat(l.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(u.join(", "),"."));case 10:return c=i.reduce((function(e,t,n){return t&&e.push(n),e}),[]),h=[],c.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;h.push(t)}))})),t.next=15,e(h);case 15:return p=t.sent,f={},d=0,c.forEach((function(e){for(var t=n[e].paths.length,r=0,a=0;a<t;a++)r+=p[d+a].byteLength;for(var i=new ArrayBuffer(r),s=new Uint8Array(i),u=0,l=0;l<t;l++){var c=new Uint8Array(p[d+l]);s.set(c,u),u+=c.byteLength}o[e].forEach((function(e){var t=Va(i.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(var n in t)f[n]=t[n]})),d+=t})),t.abrupt("return",f);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}Za.registerSaveRouter((function(e){return Ce().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Hi.URL_SCHEME)?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new Hi(e)}(e.slice(Hi.URL_SCHEME.length)):null}));var $i=function(){function e(t,n){if(A(this,e),this.DEFAULT_METHOD="POST",null==n&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,null!=n.fetchFunc?(G("function"===typeof n.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=n.fetchFunc):this.fetch=Ce().platform.fetch,G(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&G(2===t.length,(function(){return"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,").")})),this.path=t,null!=n.requestInit&&null!=n.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return R(e,[{key:"save",value:function(){var e=F(M().mark((function e(t){var n,r,a,i;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");case 2:return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},null!=t.signature&&(a.signature=t.signature),null!=t.userDefinedMetadata&&(a.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(a.modelInitializer=t.modelInitializer),n.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),null!=t.weightData&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),e.next=13,this.fetch(this.path,n);case 13:if(!(i=e.sent).ok){e.next=18;break}return e.abrupt("return",{modelArtifactsInfo:Ka(t),responses:[i]});case 18:throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(i.status,"."));case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=F(M().mark((function e(){var t,n,r,a,i,o,s,u,l,c,h,p,f,d,v,m;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch(this.path,this.requestInit);case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");case 5:return e.prev=5,e.next=8,t.json();case 8:n=e.sent,e.next=16;break;case 11:throw e.prev=11,e.t0=e.catch(5),r="Failed to parse model JSON of response from ".concat(this.path,"."),this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 16:if(a=n.modelTopology,i=n.weightsManifest,o=n.generatedBy,s=n.convertedBy,u=n.format,l=n.signature,c=n.userDefinedMetadata,null!=a||null!=i){e.next=25;break}throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");case 25:if(null==i){e.next=32;break}return e.next=28,this.loadWeights(i);case 28:f=e.sent,d=N(f,2),h=d[0],p=d[1];case 32:return v={modelTopology:a,weightSpecs:h,weightData:p,generatedBy:o,convertedBy:s,format:u},null!=l&&(v.signature=l),null!=c&&(v.userDefinedMetadata=c),(m=n.modelInitializer)&&(v.modelInitializer=m),e.abrupt("return",v);case 38:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"loadWeights",value:function(){var e=F(M().mark((function e(t){var n,r,a,i,o,s,u,l,c,h,p,f,d,v,m,g,y,b,x;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Array.isArray(this.path)?this.path[1]:this.path,r=Ji(n),a=N(r,2),i=a[0],o=a[1],s=this.weightPathPrefix||i,u=[],l=L(t);try{for(l.s();!(c=l.n()).done;)h=c.value,u.push.apply(u,I(h.weights))}catch($8){l.e($8)}finally{l.f()}p=[],f=[],d=L(t);try{for(d.s();!(v=d.n()).done;){m=v.value,g=L(m.paths);try{for(g.s();!(y=g.n()).done;)b=y.value,null!=this.weightUrlConverter?f.push(this.weightUrlConverter(b)):p.push(s+b+o)}catch($8){g.e($8)}finally{g.f()}}}catch($8){d.e($8)}finally{d.f()}if(!this.weightUrlConverter){e.next=19;break}return e.t0=p.push,e.t1=p,e.t2=I,e.next=16,Promise.all(f);case 16:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t0.apply.call(e.t0,e.t1,e.t4);case 19:return e.next=21,Xi(p,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});case 21:return x=e.sent,e.abrupt("return",[u,qa(x)]);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Ji(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}function eo(e){return null!=e.match($i.URL_SCHEME_REGEX)}$i.URL_SCHEME_REGEX=/^https?:\/\//;var to=function(e,t){if("undefined"===typeof fetch&&(null==t||null==t.fetchFunc))return null;return(Array.isArray(e)?e.every((function(e){return eo(e)})):eo(e))?no(e,t):null};function no(e,t){return new $i(e,t)}function ro(e,t){return no(e,t)}Za.registerSaveRouter(to),Za.registerLoadRouter(to);var ao,io=function(){function e(t){A(this,e),this.modelArtifacts=t}return R(e,[{key:"load",value:function(){var e=F(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.modelArtifacts);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),oo=function(){function e(t){A(this,e),this.saveHandler=t}return R(e,[{key:"save",value:function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.saveHandler(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function so(e,t,n,r){if(1===arguments.length){var a=null!=e.modelTopology||null!=e.weightSpecs;return a?new io(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new io({modelTopology:e}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new io({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r})}function uo(e){return new oo(e)}function lo(e,t,n){if(q(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var r=Na(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Fa(e,t,r,n)}function co(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,a=!1,i=!1,o=!1,s=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement)a=!0;else if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else if(null!=e.getContext)o=!0;else{if(!("undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(e.constructor.name));s=!0}if(a){var u=2;if(a&&e.readyState<u)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}var l=Tr(xr,_a.backendName);if(null!=l){var c={pixels:e},h={numChannels:t};return _a.runKernel(xr,c,h)}var p,f,d=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],v=N(d,2),m=v[0],g=v[1];if(o?p=e.getContext("2d").getImageData(0,0,m,g).data:r||n?p=e.data:(i||a||s)&&(null==ao&&(ao=document.createElement("canvas").getContext("2d")),ao.canvas.width=m,ao.canvas.height=g,ao.drawImage(e,0,0,m,g),p=ao.getImageData(0,0,m,g).data),4===t)f=new Int32Array(p);else{var y=m*g;f=new Int32Array(y*t);for(var b=0;b<y;b++)for(var x=0;x<t;++x)f[b*t+x]=p[4*b+x]}var k=[g,m,t];return lo(f,k,"int32")}var ho=Ra({fromPixels_:co});function po(e,t,n){var r=e.shape.length;G(r===t.length,(function(){return"Error in slice".concat(r,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(r,").")})),G(r===n.length,(function(){return"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,").")}));for(var a=function(a){G(t[a]+n[a]<=e.shape[a],(function(){return"Error in slice".concat(r,"D: begin[").concat(a,"] + size[").concat(a,"] ")+"(".concat(t[a]+n[a],") would overflow input.shape[").concat(a,"] (").concat(e.shape[a],")")}))},i=0;i<r;++i)a(i)}function fo(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function vo(e,t,n){return n<=e?n:n-(t-1)}function mo(e,t){for(var n=[],r=0;r<e;r++)n.push(t+r);return n}function go(e,t,n,r,a,i,o,s,u){var l=e.length,c=new Array(l),h=new Array(l),p=new Array(l);if(t.length&&n>0){var f=t[0],d=n+1;c=function(e,t,n,r,a){for(var i=I(a),o=mo(n,t),s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=0;else{var u=vo(t,n,s),l=r[u];e&1<<u&&(l=0),i[s]=l}return i}(o,f,d,r,e),h=function(e,t,n,r,a){for(var i=I(a),o=mo(n,t),s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=Number.MAX_SAFE_INTEGER;else{var u=vo(t,n,s),l=r[u];e&1<<u&&(l=Number.MAX_SAFE_INTEGER),i[s]=l}for(var c=0;c<i.length;c++){var h=a[c];i[c]<0&&(i[c]+=h),i[c]=W(0,i[c],a[c])}return i}(s,f,d,a,e),p=function(e,t,n,r){for(var a=I(e),i=a.length;i<r.length;i++)a.push(1);for(var o=0;o<n;o++)0===o?a[t]=1:(a.splice(t,0,1),a.pop());return a}(i,f,d,e)}else for(var v=0;v<l;v++)c[v]=bo(o,r,i,e,v,u),h[v]=xo(s,a,i,e,v,u),p[v]=yo(i,v,u);return{begin:c,end:h,strides:p}}function yo(e,t,n){var r=e[t];return(n&1<<t||null==r)&&(r=1),r}function bo(e,t,n,r,a,i){var o=t[a],s=n[a]||1;(e&1<<a||i&1<<a||null==o)&&(o=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var u=r[a];return o<0&&(o+=u),o=W(0,o,u-1)}function xo(e,t,n,r,a,i){var o=t[a],s=n[a]||1;(e&1<<a||i&1<<a||null==o)&&(o=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var u=r[a];return o<0&&(o+=u),o=s>0?W(0,o,u):W(-1,o,u-1)}function ko(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(var i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function wo(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function _o(e,t,n){var r,a,i=e.shape.length;return(r="number"===typeof t?[t].concat(I(new Array(i-1).fill(0))):t.length<i?t.concat(new Array(i-t.length).fill(0)):t.slice()).forEach((function(e){G(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),a=(a=null==n?new Array(i).fill(-1):"number"===typeof n?[n].concat(I(new Array(i-1).fill(-1))):n.length<i?n.concat(new Array(i-n.length).fill(-1)):n).map((function(t,n){return t>=0?t:(G(-1===t,(function(){return"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(n,".")})),e.shape[n]-r[n])})),[r,a]}function So(e,t,n,r,a,i,o,s,u){var l=t.slice(),c=n.slice(),h=r;null==r&&(h=new Array(l.length));var p=fo(o);if(p.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(0!==o&&0!==s)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(0!==o&&0!==u)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");var f=e.length-l.length,d=fo(s),v=e.slice();d.forEach((function(e){l[e]=0,c[e]=1,v.splice(e,0,1)}));var m=go(v,p,f,l,c,h,a,i,o),g=m.begin,y=m.end,b=m.strides;l=g,c=y,h=b;var x=fo(u);x.forEach((function(e){c[e]=l[e]+1,h[e]=1}));var k=function(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}(l,c,h),w=k.filter((function(e,t){return-1===x.indexOf(t)}));return{nonStrided:h.every((function(e){return 1===e})),$begin:l,$end:c,$strides:h,size:k,newShape:v,outShape:w}}var Io=function(){function e(){A(this,e)}return R(e,[{key:"getClassName",value:function(){return this.constructor.className}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),e}(),Co=function(){function e(){A(this,e),this.classNameMap={}}return R(e,null,[{key:"getMap",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"register",value:function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]}}]),e}();function To(e){G(null!=e.className,(function(){return"Class being registered does not have the static className property defined."})),G("string"===typeof e.className,(function(){return"className is required to be a string, but got type "+typeof e.className})),G(e.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),Co.register(e)}function No(){return _a}function Eo(){return _a.memory()}function Mo(e,t){return _a.tidy(e,t)}function Ao(e){ma(e).forEach((function(e){return e.dispose()}))}function Do(e){return _a.keep(e)}function Ro(e){return _a.setBackend(e)}function Oo(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return _a.registerBackend(e,t,n)}function Fo(e){return _a.customGrad(e)}function Lo(e,t){if((oe(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&oe(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Fa(e,[],[],t)}var Po=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"minimize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.computeGradients(e,n),a=r.value,i=r.grads;if(null!=n){var o=n.map((function(e){return{name:e.name,tensor:i[e.name]}}));this.applyGradients(o)}else this.applyGradients(i);return Ao(i),t?a:(a.dispose(),null)}},{key:"iterations",get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}},{key:"incrementIterations",value:function(){this.iterations_=this.iterations+1}},{key:"computeGradients",value:function(e,t){return function(e,t){G(he(e),(function(){return"The f passed in variableGrads(f) must be a function"})),G(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof ca})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=t;if(!n)for(var r in t=[],_a.registeredVariables)t.push(_a.registeredVariables[r]);var a=n?t.filter((function(e){return!e.trainable})):null,i=t.length;t=t.filter((function(e){return e.trainable})),G(t.length>0,(function(){return"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(i," variables is ")+"trainable."}));var o=_a.gradients(e,t,null,!0),s=o.value,u=o.grads;G(u.some((function(e){return null!=e})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),G(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(s.rank," tensor")}));var l={};return t.forEach((function(e,t){null!=u[t]&&(l[e.name]=u[t])})),null!=a&&a.forEach((function(e){return l[e.name]=null})),{value:s,grads:l}}(e,t)}},{key:"dispose",value:function(){null!=this.iterations_&&Ao(this.iterations_)}},{key:"saveIterations",value:function(){var e=F(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==this.iterations_&&(this.iterations_=0),e.abrupt("return",{name:"iter",tensor:Lo(this.iterations_,"int32")});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getWeights",value:function(){var e=F(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for this optimizer yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"extractIterations",value:function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t[0].tensor.data();case 2:return this.iterations_=e.sent[0],e.abrupt("return",t.slice(1));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Io);Object.defineProperty(Po,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var zo=Ra({abs_:function(e){var t=Aa(e,"x","abs");if("complex64"===t.dtype){var n={x:t};return _a.runKernel(nt,n)}var r={x:t};return _a.runKernel(Ae,r)}});var Bo=Ra({add_:function(e,t){var n=Aa(e,"a","add"),r=Aa(t,"b","add"),a=N(da(n,r),2),i={a:n=a[0],b:r=a[1]};return _a.runKernel(Oe,i)}});var Vo=Ra({all_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Aa(e,"x","all","bool"),a={x:r},i={axis:t,keepDims:n};return _a.runKernel(Le,a,i)}});var Wo=Ra({any_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Aa(e,"x","any","bool"),a={x:r},i={axis:t,keepDims:n};return _a.runKernel(Pe,a,i)}});var Uo=Ra({argMax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Aa(e,"x","argMax"),r={x:n},a={axis:t};return _a.runKernel(ze,r,a)}});function Ho(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5?arguments[5]:void 0,o=e[3],s=[].concat(I(t),[o]),u=rs(a);return qo(e,s,n,i,r,null,null,u)}function Go(e,t,n,r,a,i){var o,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",u=Yo(t),l=N(u,2),c=l[0],h=l[1];if("channelsLast"===s)o=[c,h,e[3],e[3]];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));o=[c,h,e[1],e[1]]}return qo(e,o,n,r,a,i,!1,s)}function jo(e,t,n,r,a,i){var o,s,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",l=Zo(t),c=N(l,3),h=c[0],p=c[1],f=c[2];if("NDHWC"===u)s="channelsLast",o=[h,p,f,e[4],e[4]];else{if("NCDHW"!==u)throw new Error("Unknown dataFormat ".concat(u));s="channelsFirst",o=[h,p,f,e[1],e[1]]}return Xo(e,o,n,r,a,!1,s,i)}function qo(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",u=-1,l=-1,c=-1,h=-1;if("channelsLast"===s){var p=N(e,4);u=p[0],l=p[1],c=p[2],h=p[3]}else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));var f=N(e,4);u=f[0],h=f[1],l=f[2],c=f[3]}var d,v=N(t,4),m=v[0],g=v[1],y=v[3],b=Yo(n),x=N(b,2),k=x[0],w=x[1],_=Yo(r),S=N(_,2),I=S[0],C=S[1],T=Qo(m,I),E=Qo(g,C),M=$o(a,l,c,k,w,T,E,i,s),A=M.padInfo,D=M.outHeight,R=M.outWidth,O=o?y*h:y;return"channelsFirst"===s?d=[u,O,D,R]:"channelsLast"===s&&(d=[u,D,R,O]),{batchSize:u,dataFormat:s,inHeight:l,inWidth:c,inChannels:h,outHeight:D,outWidth:R,outChannels:O,padInfo:A,strideHeight:k,strideWidth:w,filterHeight:m,filterWidth:g,effectiveFilterHeight:T,effectiveFilterWidth:E,dilationHeight:I,dilationWidth:C,inShape:e,outShape:d,filterShape:t}}function Xo(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=arguments.length>7?arguments[7]:void 0,u=-1,l=-1,c=-1,h=-1,p=-1;if("channelsLast"===o){var f=N(e,5);u=f[0],l=f[1],c=f[2],h=f[3],p=f[4]}else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));var d=N(e,5);u=d[0],p=d[1],l=d[2],c=d[3],h=d[4]}var v,m=N(t,5),g=m[0],y=m[1],b=m[2],x=m[4],k=Zo(n),w=N(k,3),_=w[0],S=w[1],I=w[2],C=Zo(r),T=N(C,3),E=T[0],M=T[1],A=T[2],D=Qo(g,E),R=Qo(y,M),O=Qo(b,A),F=Jo(a,l,c,h,_,S,I,D,R,O,s),L=F.padInfo,P=F.outDepth,z=F.outHeight,B=F.outWidth,V=i?x*p:x;return"channelsFirst"===o?v=[u,V,P,z,B]:"channelsLast"===o&&(v=[u,P,z,B,V]),{batchSize:u,dataFormat:o,inDepth:l,inHeight:c,inWidth:h,inChannels:p,outDepth:P,outHeight:z,outWidth:B,outChannels:V,padInfo:L,strideDepth:_,strideHeight:S,strideWidth:I,filterDepth:g,filterHeight:y,filterWidth:b,effectiveFilterDepth:D,effectiveFilterHeight:R,effectiveFilterWidth:O,dilationDepth:E,dilationHeight:M,dilationWidth:A,inShape:e,outShape:v,filterShape:t}}function Ko(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=Qo(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function Yo(e){return"number"===typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function Zo(e){return"number"===typeof e?[e,e,e]:e}function Qo(e,t){return t<=1?e:e+(e-1)*(t-1)}function $o(e,t,n,r,a,i,o,s,u){var l,c,h;if("number"===typeof e){l={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var p=function(e,t,n,r,a){null==r&&(r=Ko(e,t,n));var i=e[0],o=e[1];return[es((i-t+2*r)/n+1,a),es((o-t+2*r)/n+1,a)]}([t,n],i,r,e,s);c=p[0],h=p[1]}else if("same"===e){c=Math.ceil(t/r),h=Math.ceil(n/a);var f=Math.max(0,(c-1)*r+i-t),d=Math.max(0,(h-1)*a+o-n),v=Math.floor(f/2),m=f-v,g=Math.floor(d/2);l={top:v,bottom:m,left:g,right:d-g,type:"SAME"}}else if("valid"===e)l={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-i+1)/r),h=Math.ceil((n-o+1)/a);else{if("object"!==typeof e)throw Error("Unknown padding parameter: ".concat(e));var y="channelsLast"===u?e[1][0]:e[2][0],b="channelsLast"===u?e[1][1]:e[2][1],x="channelsLast"===u?e[2][0]:e[3][0],k="channelsLast"===u?e[2][1]:e[3][1];l={top:y,bottom:b,left:x,right:k,type:0===y&&0===b&&0===x&&0===k?"VALID":"EXPLICIT"},c=es((t-i+y+b)/r+1,s),h=es((n-o+x+k)/a+1,s)}return{padInfo:l,outHeight:c,outWidth:h}}function Jo(e,t,n,r,a,i,o,s,u,l,c){var h,p,f,d;if("number"===typeof e){h={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var v=function(e,t,n,r,a,i){null==a&&(a=Ko(e,t,r));var o=e[0],s=e[1],u=e[2];return[es((o-t+2*a)/r+1,i),es((s-t+2*a)/r+1,i),es((u-t+2*a)/r+1,i),n]}([t,n,r,1],s,1,a,e,c);p=v[0],f=v[1],d=v[2]}else if("same"===e){var m=((p=Math.ceil(t/a))-1)*a+s-t,g=((f=Math.ceil(n/i))-1)*i+u-n,y=((d=Math.ceil(r/o))-1)*o+l-r,b=Math.floor(m/2),x=m-b,k=Math.floor(g/2),w=g-k,_=Math.floor(y/2);h={top:k,bottom:w,left:_,right:y-_,front:b,back:x,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: ".concat(e));h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},p=Math.ceil((t-s+1)/a),f=Math.ceil((n-u+1)/i),d=Math.ceil((r-l+1)/o)}return{padInfo:h,outDepth:p,outHeight:f,outWidth:d}}function es(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function ts(e){var t=N(Yo(e),3),n=t[0],r=t[1],a=t[2];return 1===n&&1===r&&1===a}function ns(e,t){return ts(e)||ts(t)}function rs(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}var as=Ra({reshape_:function(e,t){var n={x:Aa(e,"x","reshape","string_or_numeric")},r={shape:t};return _a.runKernel(Fn,n,r)}});var is=Ra({avgPool_:function(e,t,n,r,a){var i=Aa(e,"x","avgPool","float32");G(ns(n,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")}));var o=i,s=!1;3===i.rank&&(s=!0,o=as(i,[1,i.shape[0],i.shape[1],i.shape[2]])),G(4===o.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(o.rank,".")})),null!=a&&G(Z(r),(function(){return"Error in avgPool: pad must be an integer when using, "+"dimRoundingMode ".concat(a," but got pad ").concat(r,".")}));var u={x:o},l={filterSize:t,strides:n,pad:r,dimRoundingMode:a},c=_a.runKernel(je,u,l);return c=Bi(c,i.dtype),s?as(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});var os=Ra({avgPool3d_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=Aa(e,"x","avgPool3d","float32"),s=o,u=!1;4===o.rank&&(u=!0,s=as(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),G(5===s.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(s.rank,".")})),G("NDHWC"===i,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)})),null!=a&&G(Z(r),(function(){return"Error in avgPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(a," but got pad ").concat(r,".")}));var l={x:s},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},h=_a.runKernel(Xe,l,c);return h=Bi(h,s.dtype),u?as(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});var ss=Ra({batchNorm_:function(e,t,n,r,a,i){null==i&&(i=.001);var o,s,u=Aa(e,"x","batchNorm"),l=Aa(t,"mean","batchNorm"),c=Aa(n,"variance","batchNorm");null!=a&&(o=Aa(a,"scale","batchNorm")),null!=r&&(s=Aa(r,"offset","batchNorm")),G(l.rank===c.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),G(null==s||l.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),G(null==o||l.rank===o.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var h=function(e){return 0===e.rank||1===e.rank?as(e,[1,1,1,e.size]):2===e.rank?as(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?as(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e}(u),p={x:h,scale:o,offset:s,mean:l,variance:c},f={varianceEpsilon:i},d=_a.runKernel(Lt,p,f);return as(d,u.shape)}});var us=Ra({batchNorm2d_:function(e,t,n,r,a,i){var o,s,u=Aa(e,"x","batchNorm"),l=Aa(t,"mean","batchNorm"),c=Aa(n,"variance","batchNorm");return null!=a&&(o=Aa(a,"scale","batchNorm")),null!=r&&(s=Aa(r,"offset","batchNorm")),G(2===u.rank,(function(){return"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(u.rank,".")})),G(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(l.rank,".")})),G(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(c.rank,".")})),null!=o&&G(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&G(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(s.rank,".")})),ss(u,l,c,s,o,i)}});var ls=Ra({batchNorm3d_:function(e,t,n,r,a,i){var o,s,u=Aa(e,"x","batchNorm"),l=Aa(t,"mean","batchNorm"),c=Aa(n,"variance","batchNorm");return null!=a&&(o=Aa(a,"scale","batchNorm")),null!=r&&(s=Aa(r,"offset","batchNorm")),G(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(u.rank,".")})),G(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(l.rank,".")})),G(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(c.rank,".")})),null!=o&&G(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&G(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(s.rank,".")})),ss(u,l,c,s,o,i)}});var cs=Ra({batchNorm4d_:function(e,t,n,r,a,i){var o,s,u=Aa(e,"x","batchNorm"),l=Aa(t,"mean","batchNorm"),c=Aa(n,"variance","batchNorm");return null!=a&&(o=Aa(a,"scale","batchNorm")),null!=r&&(s=Aa(r,"offset","batchNorm")),G(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(u.rank,".")})),G(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(l.rank,".")})),G(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(c.rank,".")})),null!=o&&G(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&G(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(s.rank,".")})),ss(u,l,c,s,o,i)}});var hs=Ra({clipByValue_:function(e,t,n){var r=Aa(e,"x","clipByValue");G(t<=n,(function(){return"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,").")}));var a={x:r},i={clipValueMin:t,clipValueMax:n};return _a.runKernel(et,a,i)}});var ps=Ra({concat_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;G(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=Da(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))})),1===n.length)return Vi(n[0]);var r=n,a={axis:t};return _a.runKernel(rt,r,a)}});var fs=Ra({concat1d_:function(e){return ps(e,0)}});var ds=Ra({concat2d_:function(e,t){return ps(e,t)}});var vs=Ra({concat3d_:function(e,t){return ps(e,t)}});var ms=Ra({concat4d_:function(e,t){return ps(e,t)}});var gs=Ra({conv2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=Aa(e,"x","conv2d"),u=Aa(t,"filter","conv2d"),l=s,c=!1;3===s.rank&&(c=!0,l=as(s,[1,s.shape[0],s.shape[1],s.shape[2]])),G(4===l.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(l.rank,".")})),G(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")})),null!=o&&G(Z(r),(function(){return"Error in conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(r,".")}));var h="NHWC"===a?l.shape[3]:l.shape[1];G(h===u.shape[2],(function(){return"Error in conv2d: depth of input (".concat(h,") must match ")+"input depth for filter ".concat(u.shape[2],".")})),G(ns(n,i),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")}));var p={x:l,filter:u},f={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},d=_a.runKernel(at,p,f);return c?as(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});var ys=Ra({conv1d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0,s=Aa(e,"x","conv1d"),u=Aa(t,"filter","conv1d"),l=s,c=!1;2===s.rank&&(c=!0,l=as(s,[1,s.shape[0],s.shape[1]])),G(3===l.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(l.rank,".")})),G(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+"".concat(u.rank,".")})),null!=o&&G(Z(r),(function(){return"Error in conv1d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(r,".")})),G(l.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input (".concat(l.shape[2],") must match ")+"input depth for filter ".concat(u.shape[1],".")})),G(ns(n,i),(function(){return"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(i,"'")})),G("NWC"===a,(function(){return"Error in conv1d: got dataFormat of ".concat(a," but only NWC is currently supported.")}));var h=as(u,[1,u.shape[0],u.shape[1],u.shape[2]]),p=as(l,[l.shape[0],1,l.shape[1],l.shape[2]]),f=[1,n],d=[1,i],v="NHWC",m=gs(p,h,f,r,v,d,o);return as(m,c?[m.shape[2],m.shape[3]]:[m.shape[0],m.shape[2],m.shape[3]])}});var bs=Ra({conv2DBackpropInput_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0;G(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var s=e,u=t,l=!1;3===t.rank&&(l=!0,u=as(t,[1,t.shape[0],t.shape[1],t.shape[2]]),s=[1,e[0],e[1],e[2]]),G(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(s.length,".")})),G(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(u.rank)})),G(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var c="NHWC"===i?s[3]:s[1],h="NHWC"===i?u.shape[3]:u.shape[1];G(c===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(c,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),G(h===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),null!=o&&G(Z(a),(function(){return"Error in conv2dDerInput: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(a,".")}));var p={dy:u,filter:n},f={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,inputShape:s},d=_a.runKernel(ot,p,f);return l?as(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});var xs=Ra({conv2dTranspose_:function(e,t,n,r,a,i){var o=Aa(e,"x","conv2dTranspose"),s=Aa(t,"filter","conv2dTranspose");return bs(n,o,s,r,a,"NHWC",i)}});var ks=Ra({conv3d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],o=Aa(e,"x","conv3d"),s=Aa(t,"filter","conv3d"),u=o,l=!1;4===o.rank&&(l=!0,u=as(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),G(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(u.rank,".")})),G(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+"".concat(s.rank,".")})),G(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input (".concat(u.shape[4],") must match ")+"input depth for filter ".concat(s.shape[3],".")})),G(ns(n,i),(function(){return"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")})),G("NDHWC"===a,(function(){return"Error in conv3d: got dataFormat of ".concat(a," but only NDHWC is currently supported.")}));var c={x:u,filter:s},h={strides:n,pad:r,dataFormat:a,dilations:i},p=_a.runKernel(st,c,h);return l?as(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}});var ws=Ra({depthwiseConv2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=Aa(e,"x","depthwiseConv2d"),u=Aa(t,"filter","depthwiseConv2d"),l=s,c=!1;3===s.rank&&(c=!0,l=as(s,[1,s.shape[0],s.shape[1],s.shape[2]])),G(4===l.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(l.rank,".")})),G(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")})),G(l.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels "+"(".concat(l.shape[3],") must match the inChannels dimension in ")+"filter ".concat(u.shape[2],".")})),null!=o&&G(Z(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(r,".")}));var h={x:l,filter:u},p={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},f=_a.runKernel(mt,h,p);return c?as(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});var _s=Ra({floorDiv_:function(e,t){var n=Aa(e,"a","floorDiv"),r=Aa(t,"b","floorDiv"),a=N(da(n,r),2),i={a:n=a[0],b:r=a[1]};return _a.runKernel(Ft,i)}});var Ss=Ra({div_:function(e,t){var n=Aa(e,"a","div"),r=Aa(t,"b","div"),a=N(da(n,r),2);if(n=a[0],r=a[1],"int32"===n.dtype&&"int32"===r.dtype)return _s(n,r);var i={a:n,b:r};return _a.runKernel(_t,i,{})}});var Is=Ra({elu_:function(e){var t={x:Aa(e,"x","elu")};return _a.runKernel(St,t)}});function Cs(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function Ts(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function Ns(e,t){for(var n=[],r=Math.max(e.length,t.length),a=0;a<r;a++){var i=e[e.length-a-1];null==i&&(i=1);var o=t[t.length-a-1];if(null==o&&(o=1),1===i)n.unshift(o);else if(1===o)n.unshift(i);else{if(i!==o){var s="Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,".");throw Error(s)}n.unshift(i)}}return n}var Es=Ra({equal_:function(e,t){var n=Aa(e,"a","equal"),r=Aa(t,"b","equal"),a=N(da(n,r),2);n=a[0],r=a[1],Ns(n.shape,r.shape);var i={a:n,b:r};return _a.runKernel(Tt,i)}});var Ms=Ra({expandDims_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Aa(e,"x","expandDims","string_or_numeric");G(t<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r={input:n},a={dim:t};return _a.runKernel(Et,r,a)}});var As=Ra({tile_:function(e,t){var n=Aa(e,"x","tile","string_or_numeric");G(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,".")}));var r={x:n},a={reps:t};return _a.runKernel(hr,r,a)}});var Ds=Ra({eye_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";null==t&&(t=e);for(var a=zi([e,t],r),i=e<=t?e:t,o=0;o<i;++o)a.set(1,o,o);var s=as(a.toTensor(),[e,t]);if(null==n)return s;if(1===n.length)return As(Ms(s,0),[n[0],1,1]);if(2===n.length)return As(Ms(Ms(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return As(Ms(Ms(Ms(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});function Rs(e,t,n){var r={shape:e,value:t,dtype:n};return _a.runKernel(Dt,{},r)}var Os=Ra({floor_:function(e){var t={x:Aa(e,"x","floor")};return _a.runKernel(Ot,t)}});var Fs=Ra({gather_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=Aa(e,"x","gather"),i=Aa(t,"indices","gather","int32"),o={x:a,indices:i},s={axis:n,batchDims:r};return _a.runKernel(Pt,o,s)}});var Ls=Ra({greater_:function(e,t){var n=Aa(e,"a","greater"),r=Aa(t,"b","greater"),a=N(da(n,r),2);n=a[0],r=a[1],Ns(n.shape,r.shape);var i={a:n,b:r};return _a.runKernel(Bt,i)}});var Ps=Ra({greaterEqual_:function(e,t){var n=Aa(e,"a","greaterEqual"),r=Aa(t,"b","greaterEqual"),a=N(da(n,r),2);n=a[0],r=a[1],Ns(n.shape,r.shape);var i={a:n,b:r};return _a.runKernel(Vt,i)}});var zs=Ra({leakyRelu_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=Aa(e,"x","leakyRelu"),r={x:n},a={alpha:t};return _a.runKernel(Xt,r,a)}});var Bs=Ra({log_:function(e){var t={x:Aa(e,"x","log")};return _a.runKernel(Qt,t)}});var Vs=Ra({exp_:function(e){var t={x:Aa(e,"x","exp")};return _a.runKernel(Nt,t)}});var Ws=Ra({max_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Aa(e,"x","max"),a={x:r},i={reductionIndices:t,keepDims:n};return _a.runKernel(an,a,i)}});var Us=Ra({mul_:function(e,t){var n=Aa(e,"a","mul"),r=Aa(t,"b","mul"),a=N(da(n,r),2),i={a:n=a[0],b:r=a[1]};return _a.runKernel(yn,i)}});var Hs=Ra({sub_:function(e,t){var n=Aa(e,"a","sub"),r=Aa(t,"b","sub"),a=N(da(n,r),2),i={a:n=a[0],b:r=a[1]};return _a.runKernel(or,i)}});var Gs=Ra({sum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Aa(e,"x","sum");"bool"===r.dtype&&(r=Bi(r,"int32"));var a={x:r},i={axis:t,keepDims:n};return _a.runKernel(er,a,i)}});var js=Ra({logSoftmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Aa(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));var r=Fo((function(e,n){var r=Ws(e,t,!0),a=Hs(e,r),i=Hs(Bi(a,"float32"),Bs(Gs(Vs(a),t,!0)));n([i]);return{value:i,gradFunc:function(e,n){var r=N(n,1)[0],a=Vs(r);return Hs(e,Us(Gs(e,t,!0),a))}}}));return r(n)}});var qs=Ra({logicalAnd_:function(e,t){var n=Aa(e,"a","logicalAnd","bool"),r=Aa(t,"b","logicalAnd","bool");Ns(n.shape,r.shape);var a={a:n,b:r};return _a.runKernel(Jt,a)}});var Xs=Ra({maxPool_:function(e,t,n,r,a){var i=Aa(e,"x","maxPool"),o=i,s=!1;3===i.rank&&(s=!0,o=as(i,[1,i.shape[0],i.shape[1],i.shape[2]])),G(4===o.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(o.rank,".")})),G(ns(n,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")})),null!=a&&G(Z(r),(function(){return"Error in maxPool: pad must be an integer when using, "+"dimRoundingMode ".concat(a," but got pad ").concat(r,".")}));var u={x:o},l={filterSize:t,strides:n,pad:r,dimRoundingMode:a},c=_a.runKernel(sn,u,l);return s?as(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});var Ks=Ra({maxPool3d_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=Aa(e,"x","maxPool3d"),s=o,u=!1;4===o.rank&&(u=!0,s=as(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),G(5===s.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(s.rank,".")})),G("NDHWC"===i,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)})),null!=a&&G(Z(r),(function(){return"Error in maxPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(a," but got pad ").concat(r,".")}));var l={x:s},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},h=_a.runKernel(ln,l,c);return u?as(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});var Ys=Ra({maximum_:function(e,t){var n=Aa(e,"a","maximum"),r=Aa(t,"b","maximum"),a=N(da(n,r),2);n=a[0],r=a[1],"bool"===n.dtype&&(n=Bi(n,"int32"),r=Bi(r,"int32")),Ns(n.shape,r.shape);var i={a:n,b:r};return _a.runKernel(on,i)}});var Zs=Ra({mean_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Aa(e,"x","mean"),a={x:r},i={axis:t,keepDims:n};return _a.runKernel(pn,a,i)}});var Qs=Ra({min_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Aa(e,"x","min"),a={x:r},i={axis:t,keepDims:n};return _a.runKernel(fn,a,i)}});var $s=Ra({minimum_:function(e,t){var n=Aa(e,"a","minimum"),r=Aa(t,"b","minimum"),a=N(da(n,r),2);n=a[0],r=a[1],"bool"===n.dtype&&(n=Bi(n,"int32"),r=Bi(r,"int32")),Ns(n.shape,r.shape);var i={a:n,b:r};return _a.runKernel(dn,i)}});function Js(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function eu(e,t){for(var n=[],r=e.length,a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);var i=t.map((function(t){return e[t]}));return[n,i]}function tu(e,t){return function(e,t,n){for(var r=e.length+t.length,a=[],i=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?a.push(e[i++]):a.push(t[o++]);return a}(e,t.map((function(e){return 1})),t)}function nu(e,t,n){G(Js(t,n),(function(){return"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input.")}))}function ru(e,t){if(Js(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function au(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function iu(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}var ou=Ra({square_:function(e){var t=Aa(e,"x","square");return _a.runKernel("Square",{x:t},{})}});var su=Ra({moments_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=te(t,(e=Aa(e,"x","moments")).shape),a=Zs(e,r,n),i=a.shape;n||(i=tu(a.shape,r));var o=ou(Hs(Bi(e,"float32"),as(a,i))),s=Zs(o,r,n);return{mean:a,variance:s}}});var uu=Ra({neg_:function(e){var t={x:Aa(e,"x","neg")};return _a.runKernel(bn,t)}});var lu=Ra({notEqual_:function(e,t){var n=Aa(e,"a","notEqual"),r=Aa(t,"b","notEqual"),a=N(da(n,r),2);n=a[0],r=a[1],Ns(n.shape,r.shape);var i={a:n,b:r};return _a.runKernel(xn,i)}});var cu=Ra({oneHot_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));var a=Aa(e,"indices","oneHot","int32"),i={indices:a},o={depth:t,onValue:n,offValue:r};return _a.runKernel(In,i,o)}});function hu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===t){var n=hu(e,"float32"),r=hu(e,"float32");return Oa(n,r)}var a=ge(K(e),t);return _a.makeTensor(a,e,t)}function pu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===t){var n=pu(e,"float32"),r=hu(e,"float32");return Oa(n,r)}var a=me(K(e),t);return _a.makeTensor(a,e,t)}var fu=Ra({onesLike_:function(e){var t={x:Aa(e,"x","onesLike")};return _a.runKernel(Sn,t)}});var du=Ra({pad_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Aa(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:t,constantValue:n},i={x:r};return _a.runKernel(Tn,i,a)}});var vu=Ra({prelu_:function(e,t){var n={x:Aa(e,"x","prelu"),alpha:Aa(t,"alpha","prelu")};return _a.runKernel(En,n)}}),mu=n(282),gu=function(){function e(t,n,r,a,i){A(this,e),this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=mu.alea(o.toString())}return R(e,[{key:"nextValue",value:function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*a*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)}},{key:"convertValue",value:function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}},{key:"isValidTruncated",value:function(e){return e<=this.upper&&e>=this.lower}}]),e}(),yu=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(A(this,e),this.canReturnFloat=function(){return null==t.dtype||"float32"===t.dtype},this.min=n,this.range=r-n,this.dtype=a,null==i&&(i=Math.random()),"number"===typeof i&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(n," - ").concat(r," <= 1 and dtype is not float"));this.random=mu.alea(i)}return R(e,[{key:"convertValue",value:function(e){return this.canReturnFloat()?e:Math.round(e)}},{key:"nextValue",value:function(){return this.convertValue(this.min+this.range*this.random())}}]),e}();var bu=Ra({randomNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));for(var i=new gu(t,n,r,!1,a),o=zi(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});var xu=Ra({randomUniform_:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0,i=zi(e,r),o=new yu(t,n,null,a),s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}});var ku=Ra({relu_:function(e){var t={x:Aa(e,"x","relu")};return _a.runKernel(On,t)}});var wu=Ra({reverse_:function(e,t){var n={x:Aa(e,"x","reverse")},r={dims:t};return _a.runKernel(Wn,n,r)}});var _u=Ra({selu_:function(e){var t={x:Aa(e,"x","selu")};return _a.runKernel(qn,t)}});var Su=Ra({separableConv2d_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",s=Aa(e,"x","separableConv2d"),u=Aa(t,"depthwiseFilter","separableConv2d"),l=Aa(n,"pointwiseFilter","separableConv2d"),c=s,h=!1;if(3===s.rank&&(h=!0,c=as(s,[1,s.shape[0],s.shape[1],s.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");G(4===c.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(c.rank,".")})),G(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),G(4===l.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),G(1===l.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(l.shape[0],".")})),G(1===l.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(l.shape[1],".")}));var p=u.shape[2],f=u.shape[3];G(l.shape[2]===p*f,(function(){return"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(p*f,", ")+"but got ".concat(l.shape[2],".")}));var d=ws(c,u,r,a,o,i),v=1,m=gs(d,l,v,"valid",o);return h?as(m,[m.shape[1],m.shape[2],m.shape[3]]):m}});var Iu=Ra({sigmoid_:function(e){var t={x:Aa(e,"x","sigmoid")};return _a.runKernel(Qn,t)}});var Cu=Ra({slice_:function(e,t,n){var r=Aa(e,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");var a={x:r},i={begin:t,size:n};return _a.runKernel(Xn,a,i)}});var Tu=Ra({slice1d_:function(e,t,n){var r=Aa(e,"x","slice1d");return G(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")})),Cu(r,[t],[n])}});var Nu=Ra({slice2d_:function(e,t,n){var r=Aa(e,"x","slice2d");return G(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")})),Cu(r,t,n)}});var Eu=Ra({slice3d_:function(e,t,n){var r=Aa(e,"x","slice3d");return G(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")})),Cu(r,t,n)}});var Mu=Ra({slice4d_:function(e,t,n){var r=Aa(e,"x","slice4d");return G(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")})),Cu(r,t,n)}});var Au=Ra({softmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Aa(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));var r={logits:n},a={dim:t};return _a.runKernel(rr,r,a)}});var Du=Ra({softplus_:function(e){var t={x:Aa(e,"x","softplus")};return _a.runKernel($n,t)}});var Ru=Ra({split_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Aa(e,"x","split"),a={x:r},i={numOrSizeSplits:t,axis:n};return _a.runKernel(nr,a,i)}});var Ou=Ra({sqrt_:function(e){var t={x:Aa(e,"x","sqrt")};return _a.runKernel(Jn,t)}});var Fu=Ra({squeeze_:function(e,t){var n=Aa(e,"x","squeeze");return as(n,ne(n.shape,t).newShape)}});var Lu=Ra({stack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Da(e,"tensors","stack","string_or_numeric");G(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),n.length>0&&G(t<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n,a={axis:t};return _a.runKernel(Cn,r,a)}});var Pu=Ra({tanh_:function(e){var t={x:Aa(e,"x","tanh")};return _a.runKernel(cr,t)}});function zu(e,t){q(e);var n=Na(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Fa(e,null,n,t)}function Bu(e,t,n){if(q(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=Na(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Fa(e,t,r,n)}var Vu=Ra({truncatedNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");for(var i=new gu(t,n,r,!0,a),o=zi(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});var Wu=Ra({unstack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Aa(e,"x","unstack","string_or_numeric");G(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")}));var r={value:n},a={axis:t};return _a.runKernel(mr,r,a)}});function Uu(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return _a.makeVariable(e,t,n,r)}var Hu=Ra({broadcastTo_:function(e,t){var n=Aa(e,"broadcastTo","x"),r=n.shape;if(t.some((function(e){return!(e>0)||e%1!==0})))throw new Error("broadcastTo(): Invalid broadcast shape [".concat(t,"]."));if(t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){for(var a=n.shape.slice();a.length<t.length;)a.unshift(1);n=as(n,a)}for(var i=n.shape,o=Array.from(t),s=t.length-1;s>=0;s--)if(i[s]===t[s])o[s]=1;else if(1!==n.shape[s])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(t,"]."));var u=o.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0}));if(0===u.length)return Vi(n);var l={x:n},c={reps:o};return _a.runKernel(hr,l,c)}});var Gu=Ra({where_:function(e,t,n){var r=Aa(t,"a","where"),a=Aa(n,"b","where"),i=Aa(e,"condition","where","bool"),o=Ns(r.shape,a.shape),s=Hu(r,o),u=Hu(a,o);1===i.rank&&G(i.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})),1!==i.rank&&j(i.shape,u.shape,"Error in where: ");var l={condition:i,t:s,e:u};return _a.runKernel(jn,l)}});var ju=Ra({zerosLike_:function(e){var t={x:Aa(e,"x","zerosLike")};return _a.runKernel(yr,t)}});var qu=Ra({transpose_:function(e,t){var n=Aa(e,"x","transpose");if(null==t&&(t=n.shape.map((function(e,t){return t})).reverse()),G(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of perm ".concat(t,".")})),t.forEach((function(e){G(e>=0&&e<n.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(n.rank-1)+" but got ".concat(t)}))})),n.rank<=1)return n.clone();var r={x:n},a={perm:t};return _a.runKernel(dr,r,a)}});var Xu=Ra({dropout_:function(e,t,n,r){var a=Aa(e,"x","dropout");if(G("float32"===a.dtype,(function(){return"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(a.dtype," tensor instead.")})),G(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got ".concat(t,".")})),0===t)return e instanceof ra?a.clone():a;var i=function(e,t){if(null==t)return e.shape.slice();if(Y(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(a,n),o=1-t,s=Ss(Os(Bo(xu(i,0,1,"float32",r),o)),o);return Us(a,s)}});var Ku=Ra({imag_:function(e){var t={input:Aa(e,"input","imag")};return _a.runKernel(Ht,t)}});var Yu=Ra({real_:function(e){var t={input:Aa(e,"input","real")};return _a.runKernel(Dn,t)}});var Zu=Ra({fft_:function(e){G("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return _a.runKernel(At,t)}});var Qu=Ra({rfft_:function(e,t){G("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got ".concat(e.dtype)}));var n,r=e.shape[e.shape.length-1],a=e.size/r;if(null!=t&&t<r){var i=e.shape.map((function(e){return 0})),o=e.shape.map((function(e){return e}));o[e.shape.length-1]=t,n=Cu(e,i,o),r=t}else if(null!=t&&t>r){var s=e.shape.map((function(e){return e}));s[e.shape.length-1]=t-r,n=ps([e,hu(s)],e.shape.length-1),r=t}else n=e;var u=ju(n),l=as(Oa(n,u),[a,r]),c=Zu(l),h=Math.floor(r/2)+1,p=Yu(c),f=Ku(c),d=Ru(p,[h,r-h],p.shape.length-1),v=Ru(f,[h,r-h],f.shape.length-1),m=n.shape.slice();return m[n.shape.length-1]=h,as(Oa(d[0],v[0]),m)}});var $u=Ra({ifft_:function(e){G("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return _a.runKernel(Ut,t)}});var Ju=Ra({irfft_:function(e){var t,n=e.shape[e.shape.length-1],r=e.size/n;if(n<=2){var a=as(e,[r,n]);t=$u(a)}else{var i=[r,2*(n-1)],o=as(Yu(e),[r,n]),s=as(Ku(e),[r,n]),u=wu(Cu(o,[0,1],[r,n-2]),1),l=Us(wu(Cu(s,[0,1],[r,n-2]),1),Lo(-1)),c=ps([o,u],1),h=ps([s,l],1),p=as(Oa(c,h),[i[0],i[1]]);t=$u(p)}if(t=Yu(t),3===e.rank&&0!==e.shape[0]){var f=t,d=e.shape[0];t=as(t,[d,t.shape[0]/d,t.shape[1]]),f.dispose()}return t}});var el=Ra({conv2DBackpropFilter_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=as(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var u=t;3===u.rank&&(u=as(t,[1,t.shape[0],t.shape[1],t.shape[2]])),G(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(s.shape,".")})),G(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(u.shape,".")})),G(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var l="NHWC"===i?s.shape[3]:s.shape[1],c="NHWC"===i?u.shape[3]:u.shape[1];G(l===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(l,") must ")+"match input depth in filter (".concat(n[2],".")})),G(c===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(c,") must ")+"match output depth for filter (".concat(n[3],").")})),null!=o&&G(Z(a),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(a,".")}));var h={x:s,dy:u},p={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,filterShape:n};return _a.runKernel(it,h,p)}});var tl=Ra({relu6_:function(e){var t={x:Aa(e,"x","relu6")};return _a.runKernel(Vn,t)}});var nl=Ra({step_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Aa(e,"x","step"),r={x:n},a={alpha:t};return _a.runKernel(br,r,a)}});function rl(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return Us(e,nl(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function al(e,t){var n=t,r=Ts(e.shape,t.shape);return r.length>0&&(n=Gs(n,r)),as(n,e.shape)}function il(e,t,n,r){if("linear"===t)return e;if("relu"===t)return ku(e);if("elu"===t)return Is(e);if("relu6"===t)return tl(e);if("prelu"===t)return vu(e,n);if("leakyrelu"===t)return zs(e,r);throw new Error("Unknown fused activation ".concat(t,"."))}var ol=function(e,t){return!(e>0)||"linear"===t};var sl=Ra({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,l=e.dimRoundingMode,c=e.bias,h=e.activation,p=void 0===h?"linear":h,f=e.preluActivationWeights,d=e.leakyreluAlpha;if(p=p||"linear",!1===ol(_a.state.gradientDepth,p)){var v=gs(t,n,r,a,o,u,l);return null!=c&&(v=Bo(v,c)),il(v,p,f,d)}var m=Aa(t,"x","conv2d"),g=Aa(n,"filter","conv2d"),y=m,b=!1;3===m.rank&&(b=!0,y=as(m,[1,m.shape[0],m.shape[1],m.shape[2]])),G(4===y.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(y.rank,".")})),G(4===g.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(g.rank,".")})),null!=l&&G(Z(a),(function(){return"Error in fused conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(a,".")})),G(y.shape[3]===g.shape[2],(function(){return"Error in conv2d: depth of input (".concat(y.shape[3],") must match ")+"input depth for filter ".concat(g.shape[2],".")})),G(ns(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(u,"'")})),G("NHWC"===o,(function(){return"Error in conv2d: got dataFormat of ".concat(o," but only NHWC is currently supported.")}));var x,k,w=qo(y.shape,g.shape,r,u,a,l);null!=c&&(x=N(da(x=Aa(c,"bias","fused conv2d"),m),1)[0],Ns(w.outShape,x.shape)),null!=f&&(k=Aa(f,"prelu weights","fused conv2d"));var _=function(e,t){var n=N(t,4),i=n[0],o=n[1],s=n[2],l=n[3],c=rl(e,s,p);G(ts(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(u,"'")}));var h=[bs(o.shape,c,i,r,a),el(o,c,i.shape,r,a)];if(null!=l){var f=al(l,c);h.push(f)}return h},S={x:y,filter:g,bias:x,preluActivationWeights:k},I={strides:r,pad:a,dataFormat:o,dilations:u,dimRoundingMode:l,activation:p,leakyreluAlpha:d};if(null==c){var C=Fo((function(e,t,n){var r=_a.runKernel(_r,S,I);return n([t,e,r]),b&&(r=as(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:_}}));return C(y,g)}var T=Fo((function(e,t,n,r){var a=_a.runKernel(_r,S,I);return r([t,e,a,n]),b&&(a=as(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:_}}));return T(y,g,x)}});var ul=Ra({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=as(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var u=t;3===u.rank&&(u=as(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var l={x:s,dy:u},c={strides:r,pad:a,dimRoundingMode:o,dilations:i,filterShape:n};return _a.runKernel(gt,l,c)}});var ll=Ra({depthwiseConv2dNativeBackpropInput_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=t,u=!1;3===t.rank&&(u=!0,s=as(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var l={dy:s,filter:n},c={strides:r,pad:a,dimRoundingMode:o,dilations:i,inputShape:e},h=_a.runKernel(yt,l,c);return u?as(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});var cl=Ra({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,l=e.dimRoundingMode,c=e.bias,h=e.activation,p=void 0===h?"linear":h,f=e.preluActivationWeights,d=e.leakyreluAlpha;if(!1===ol(_a.state.gradientDepth,p)){var v=ws(t,n,r,a,o,u,l);return null!=c&&(v=Bo(v,c)),il(v,p,f,d)}var m=Aa(t,"x","depthwiseConv2d"),g=Aa(n,"filter","depthwiseConv2d"),y=m,b=!1;3===m.rank&&(b=!0,y=as(m,[1,m.shape[0],m.shape[1],m.shape[2]])),G(4===y.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(y.rank,".")})),G(4===g.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(g.rank,".")})),G(y.shape[3]===g.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels "+"(".concat(y.shape[3],") must match the inChannels dimension in ")+"filter ".concat(g.shape[2],".")})),null==u&&(u=[1,1]),G(ns(r,u),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(r," and dilations '").concat(u,"'")})),null!=l&&G(Z(a),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when "+"using dimRoundingMode ".concat(l," but got pad ").concat(a,".")}));var x,k,w=qo(y.shape,g.shape,r,u,a,l,!0);if(null!=c){var _=N(da(x=Aa(c,"bias","fused conv2d"),m),1);x=_[0],Ns(w.outShape,x.shape)}null!=f&&(k=Aa(f,"prelu weights","fused depthwiseConv2d"));var S=function(e,t){G(ts(u),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(u,"'")}));var n=N(t,4),i=n[0],o=n[1],s=n[2],c=n[3],h=rl(e,s,p),f=ll(o.shape,h,i,r,a,u,l),d=ul(o,h,i.shape,r,a,u,l);return null!=c?[f,d,al(x,h)]:[f,d]},I={x:y,filter:g,bias:x,preluActivationWeights:k},C={strides:r,pad:a,dataFormat:o,dilations:u,dimRoundingMode:l,activation:p,leakyreluAlpha:d};if(null==c){var T=Fo((function(e,t,n){var r=_a.runKernel(Sr,I,C);return n([t,e,r]),b&&(r=as(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:S}}));return T(y,g)}var E=Fo((function(e,t,n,r){var a=_a.runKernel(Sr,I,C);return r([t,e,a,n]),b&&(a=as(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:S}}));return E(y,g,x)}});var hl=Ra({matMul_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Aa(e,"a","matMul"),i=Aa(t,"b","matMul"),o=da(a,i),s=N(o,2),u={a:a=s[0],b:i=s[1]},l={transposeA:n,transposeB:r};return _a.runKernel(Ye,u,l)}});var pl=Ra({fusedMatMul_:function(e){var t=e.a,n=e.b,r=e.transposeA,a=void 0!==r&&r,i=e.transposeB,o=void 0!==i&&i,s=e.bias,u=e.activation,l=void 0===u?"linear":u,c=e.preluActivationWeights,h=e.leakyreluAlpha;if(!1===ol(_a.state.gradientDepth,l)){var p=hl(t,n,a,o);return null!=s&&(p=Bo(p,s)),il(p,l,c,h)}var f=Aa(t,"a","fused matMul"),d=Aa(n,"b","fused matMul"),v=N(da(f,d),2);f=v[0],d=v[1];var m=a?f.shape[f.rank-2]:f.shape[f.rank-1],g=o?d.shape[d.rank-1]:d.shape[d.rank-2],y=a?f.shape[f.rank-1]:f.shape[f.rank-2],b=o?d.shape[d.rank-2]:d.shape[d.rank-1],x=f.shape.slice(0,-2),k=d.shape.slice(0,-2),w=K(x),_=K(k);G(f.rank>=2&&d.rank>=2&&f.rank===d.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at "+"least 2, got ranks ".concat(f.rank," and ").concat(d.rank,".")})),G(Y(x,k),(function(){return"Error in fused matMul: outer dimensions (".concat(x,") and (")+"".concat(k,") of Tensors with shapes ").concat(f.shape," and ")+"".concat(d.shape," must match.")})),G(m===g,(function(){return"Error in fused matMul: inner shapes (".concat(m,") and (")+"".concat(g,") of Tensors with shapes ").concat(f.shape," and ")+"".concat(d.shape," and transposeA=").concat(a)+" and transposeB=".concat(o," must match.")}));var S,I,C=f.shape.slice(0,-2).concat([y,b]),T=as(f,a?[w,m,y]:[w,y,m]),E=as(d,o?[_,b,g]:[_,g,b]);null!=s&&(S=N(da(S=Aa(s,"bias","fused matMul"),f),1)[0],Ns(C,S.shape)),null!=c&&(I=Aa(c,"prelu weights","fused matMul"));var M=function(e,t){var n,r,i=N(t,4),u=i[0],c=i[1],h=i[2],p=i[3],f=rl(as(e,h.shape),h,l);return a||o?!a&&o?(n=hl(f,c,!1,!1),r=hl(f,u,!0,!1)):a&&!o?(n=hl(c,f,!1,!0),r=hl(u,f,!1,!1)):(n=hl(c,f,!0,!0),r=hl(f,u,!0,!0)):(n=hl(f,c,!1,!0),r=hl(u,f,!0,!1)),null!=s?[n,r,al(p,f)]:[n,r]},A={a:T,b:E,bias:S,preluActivationWeights:I},D={transposeA:a,transposeB:o,activation:l,leakyreluAlpha:h};if(null==s){var R=Fo((function(e,t,n){var r=_a.runKernel(wr,A,D);return n([e,t,r]),{value:as(r,C),gradFunc:M}}));return R(T,E)}var O=Fo((function(e,t,n,r){var a=_a.runKernel(wr,A,D);return r([e,t,a,n]),{value:as(a,C),gradFunc:M}}));return O(T,E,S)}});function fl(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function dl(e,t,n){for(var r=1-e%2,a=new Float32Array(e),i=0;i<e;++i){var o=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(o)}return zu(a,"float32")}Ra({hammingWindow_:function(e){return dl(e,.54,.46)}});var vl=Ra({hannWindow_:function(e){return dl(e,.5,.5)}});var ml=Ra({frame_:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=0,o=[];i+t<=e.size;)o.push(Cu(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,u=ps([Cu(e,i,t-s),Rs([s],a)]);o.push(u),i+=n}return 0===o.length?Bu([],[0,t]):as(ps(o),[o.length,t])}});Ra({stft_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:vl;null==r&&(r=fl(t));for(var i=ml(e,t,n),o=Us(i,a(t)),s=[],u=0;u<i.shape[0];u++)s.push(Qu(Cu(o,[u,0],[1,t]),r));return ps(s)}});var gl=Ra({cropAndResize_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=Aa(e,"image","cropAndResize"),s=Aa(t,"boxes","cropAndResize","float32"),u=Aa(n,"boxInd","cropAndResize","int32"),l=s.shape[0];G(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),G(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(l,",4] ")+"but had shape ".concat(s.shape,".")})),G(1===u.rank&&u.shape[0]===l,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(l,"] ")+"but had shape ".concat(s.shape,".")})),G(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")})),G(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was ".concat(r)})),G("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was ".concat(a)}));var c={image:o,boxes:s,boxInd:u},h={method:a,extrapolationValue:i,cropSize:r},p=_a.runKernel(ft,c,h);return p}});var yl=Ra({flipLeftRight_:function(e){var t=Aa(e,"image","flipLeftRight","float32");G(4===t.rank,(function(){return"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(t.rank,".")}));var n={image:t};return _a.runKernel(Rt,n,{})}});var bl=Ra({rotateWithOffset_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=Aa(e,"image","rotateWithOffset","float32");G(4===a.rank,(function(){return"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,".")}));var i={image:a},o={radians:t,fillValue:n,center:r},s=_a.runKernel(kr,i,o);return s}});function xl(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);var o=e.shape[0];return n=Math.min(n,o),G(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(r,"'")})),G(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")})),G(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])})),G(1===t.rank,(function(){return"scores must be a 1D tensor"})),G(t.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(t.shape[0])})),G(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(i,"'")})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var kl=Ra({nonMaxSuppression_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=Aa(e,"boxes","nonMaxSuppression"),o=Aa(t,"scores","nonMaxSuppression"),s=xl(i,o,n,r,a),u={maxOutputSize:n=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:a=s.scoreThreshold};return _a.runKernel(kn,{boxes:i,scores:o},u)}});function wl(e,t,n){var r=function(e,t,n){return function(e,t,n){var r=0,a=e.length,i=0,o=!1;for(;r<a;){var s=n(t,e[i=r+(a-r>>>1)]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}(e,t,n||_l)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function _l(e,t){return e>t?1:e<t?-1:0}function Sl(e,t,n,r,a){return Tl(e,t,n,r,a,0)}function Il(e,t,n,r,a,i){return Tl(e,t,n,r,a,0,!1,i,!0)}function Cl(e,t,n,r,a,i){return Tl(e,t,n,r,a,i,!0)}function Tl(e,t,n,r,a,i){for(var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],l=[],c=0;c<t.length;c++)t[c]>a&&l.push({score:t[c],boxIndex:c,suppressBeginIndex:0});l.sort(Ml);for(var h=i>0?-.5/i:0,p=[],f=[];p.length<n&&l.length>0;){var d=l.pop(),v=d.score,m=d.boxIndex,g=d.suppressBeginIndex;if(v<a)break;for(var y=!1,b=p.length-1;b>=g;--b){var x=Nl(e,m,p[b]);if(x>=r){y=!0;break}if(d.score=d.score*El(r,h,x),d.score<=a)break}d.suppressBeginIndex=p.length,y||(d.score===v?(p.push(m),f.push(d.score)):d.score>a&&wl(l,d,Ml))}var k=p.length,w=n-k;s&&w>0&&(p.push.apply(p,I(new Array(w).fill(0))),f.push.apply(f,I(new Array(w).fill(0))));var _={selectedIndices:p};return o&&(_.selectedScores=f),u&&(_.validOutputs=k),_}function Nl(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(a[0],a[2]),c=Math.min(a[1],a[3]),h=Math.max(a[0],a[2]),p=Math.max(a[1],a[3]),f=(s-i)*(u-o),d=(h-l)*(p-c);if(f<=0||d<=0)return 0;var v=Math.max(i,l),m=Math.max(o,c),g=Math.min(s,h),y=Math.min(u,p),b=Math.max(g-v,0)*Math.max(y-m,0);return b/(f+d-b)}function El(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function Ml(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function Al(){return Al=F(M().mark((function e(t,n,r){var a,i,o,s,u,l,c,h,p,f,d=arguments;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=d.length>3&&void 0!==d[3]?d[3]:.5,i=d.length>4&&void 0!==d[4]?d[4]:Number.NEGATIVE_INFINITY,o=Aa(t,"boxes","nonMaxSuppressionAsync"),s=Aa(n,"scores","nonMaxSuppressionAsync"),u=xl(o,s,r,a,i),r=u.maxOutputSize,a=u.iouThreshold,i=u.scoreThreshold,e.next=10,Promise.all([o.data(),s.data()]);case 10:return l=e.sent,c=l[0],h=l[1],p=Sl(c,h,r,a,i),f=p.selectedIndices,o!==t&&o.dispose(),s!==n&&s.dispose(),e.abrupt("return",zu(f,"int32"));case 17:case"end":return e.stop()}}),e)}))),Al.apply(this,arguments)}var Dl=function(e,t,n){return Al.apply(this,arguments)};var Rl=Ra({nonMaxSuppressionWithScore_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=Aa(e,"boxes","nonMaxSuppression"),s=Aa(t,"scores","nonMaxSuppression"),u=xl(o,s,n,r,a,i),l={boxes:o,scores:s},c={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:a=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},h=_a.runKernel(_n,l,c);return{selectedIndices:h[0],selectedScores:h[1]}}});function Ol(){return Ol=F(M().mark((function e(t,n,r){var a,i,o,s,u,l,c,h,p,f,d,v,m=arguments;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=m.length>3&&void 0!==m[3]?m[3]:.5,i=m.length>4&&void 0!==m[4]?m[4]:Number.NEGATIVE_INFINITY,o=m.length>5&&void 0!==m[5]?m[5]:0,s=Aa(t,"boxes","nonMaxSuppressionAsync"),u=Aa(n,"scores","nonMaxSuppressionAsync"),l=xl(s,u,r,a,i,o),r=l.maxOutputSize,a=l.iouThreshold,i=l.scoreThreshold,o=l.softNmsSigma,e.next=12,Promise.all([s.data(),u.data()]);case 12:return c=e.sent,h=c[0],p=c[1],f=Cl(h,p,r,a,i,o),d=f.selectedIndices,v=f.selectedScores,s!==t&&s.dispose(),u!==n&&u.dispose(),e.abrupt("return",{selectedIndices:zu(d,"int32"),selectedScores:zu(v)});case 19:case"end":return e.stop()}}),e)}))),Ol.apply(this,arguments)}var Fl=function(e,t,n){return Ol.apply(this,arguments)};var Ll=Ra({nonMaxSuppressionPadded_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=Aa(e,"boxes","nonMaxSuppression"),s=Aa(t,"scores","nonMaxSuppression"),u=xl(o,s,n,r,a,null),l=u.maxOutputSize,c=u.iouThreshold,h=u.scoreThreshold,p={boxes:o,scores:s},f={maxOutputSize:l,iouThreshold:c,scoreThreshold:h,padToMaxOutputSize:i},d=_a.runKernel(wn,p,f);return{selectedIndices:d[0],validOutputs:d[1]}}});function Pl(){return Pl=F(M().mark((function e(t,n,r){var a,i,o,s,u,l,c,h,p,f,d,v,m,g,y,b,x=arguments;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=x.length>3&&void 0!==x[3]?x[3]:.5,i=x.length>4&&void 0!==x[4]?x[4]:Number.NEGATIVE_INFINITY,o=x.length>5&&void 0!==x[5]&&x[5],s=Aa(t,"boxes","nonMaxSuppressionAsync"),u=Aa(n,"scores","nonMaxSuppressionAsync"),l=xl(s,u,r,a,i,null),c=l.maxOutputSize,h=l.iouThreshold,p=l.scoreThreshold,e.next=11,Promise.all([s.data(),u.data()]);case 11:return f=e.sent,d=N(f,2),v=d[0],m=d[1],g=Il(v,m,c,h,p,o),y=g.selectedIndices,b=g.validOutputs,s!==t&&s.dispose(),u!==n&&u.dispose(),e.abrupt("return",{selectedIndices:zu(y,"int32"),validOutputs:Lo(b,"int32")});case 19:case"end":return e.stop()}}),e)}))),Pl.apply(this,arguments)}var zl=function(e,t,n){return Pl.apply(this,arguments)};function Bl(e){return C(e)||_(e)||S(e)||T()}var Vl=Ra({resizeBilinear_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Aa(e,"images","resizeBilinear");G(3===a.rank||4===a.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")})),G(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,".")})),G(!1===r||!1===n,(function(){return"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."}));var i=a,o=!1;3===a.rank&&(o=!0,i=as(a,[1,a.shape[0],a.shape[1],a.shape[2]])),Bl(t);var s={images:i},u={alignCorners:n,halfPixelCenters:r,size:t},l=_a.runKernel(zn,s,u);return o?as(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});var Wl=Ra({resizeNearestNeighbor_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Aa(e,"images","resizeNearestNeighbor");G(3===a.rank||4===a.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")})),G(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,".")})),G("float32"===a.dtype||"int32"===a.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"})),G(!1===r||!1===n,(function(){return"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."}));var i=a,o=!1;3===a.rank&&(o=!0,i=as(a,[1,a.shape[0],a.shape[1],a.shape[2]])),Bl(t);var s={images:i},u={alignCorners:n,halfPixelCenters:r,size:t},l=_a.runKernel(Ln,s,u);return o?as(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});var Ul=Ra({transform_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0,o=Aa(e,"image","transform","float32"),s=Aa(t,"transforms","transform","float32");G(4===o.rank,(function(){return"Error in transform: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),G(2===s.rank&&(s.shape[0]===o.shape[0]||1===s.shape[0])&&8===s.shape[1],(function(){return"Error in transform: Input transform should be batch x 8 or 1 x 8"})),G(null==i||2===i.length,(function(){return"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(i,".")}));var u={image:o,transforms:s},l={interpolation:n,fillMode:r,fillValue:a,outputShape:i};return _a.runKernel(fr,u,l)}});var Hl=Ra({lessEqual_:function(e,t){var n=Aa(e,"a","lessEqual"),r=Aa(t,"b","lessEqual"),a=N(da(n,r),2);n=a[0],r=a[1],Ns(n.shape,r.shape);var i={a:n,b:r};return _a.runKernel(Yt,i)}});function Gl(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");var a={start:e,stop:t,step:n,dtype:r};return _a.runKernel(An,{},a)}var jl=Ra({bandPart_:function(e,t,n){G(t%1===0,(function(){return"bandPart(): numLower must be an integer, got ".concat(t,".")})),G(n%1===0,(function(){return"bandPart(): numUpper must be an integer, got ".concat(n,".")}));var r=Aa(e,"a","bandPart");G(r.rank>=2,(function(){return"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")}));var a=r.shape,i=N(r.shape.slice(-2),2),o=i[0],s=i[1];if(!(t<=o))throw new Error("bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(o,")."));if(!(n<=s))throw new Error("bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(s,")."));t<0&&(t=o),n<0&&(n=s);var u=as(Gl(0,o,1,"int32"),[-1,1]),l=Gl(0,s,1,"int32"),c=Hs(u,l),h=qs(Hl(c,Lo(+t,"int32")),Ps(c,Lo(-n,"int32"))),p=hu([o,s],r.dtype);return as(Lu(Wu(as(r,[-1,o,s])).map((function(e){return Gu(h,e,p)}))),a)}});var ql=Ra({pow_:function(e,t){var n=Aa(e,"base","pow"),r=Aa(t,"exp","pow"),a=N(da(n,r),2),i={a:n=a[0],b:r=a[1]};return _a.runKernel(Nn,i)}});function Xl(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return zo(e);if(1!==e.rank&&null===n)return Xl(as(e,[-1]),t,n);if(1===e.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===t)return Gs(zo(e),n);if(t===1/0)return Ws(zo(e),n);if(t===-1/0)return Qs(zo(e),n);if("euclidean"===t||2===t)return Ou(Gs(ql(zo(e),Lo(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return Ws(Gs(zo(e),n[0]),n[1]-1);if(t===1/0)return Ws(Gs(zo(e),n[1]),n[0]);if(t===-1/0)return Qs(Gs(zo(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return Ou(Gs(ou(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}var Kl=Ra({norm_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Xl(e=Aa(e,"x","norm"),t,n),i=a.shape;if(r){var o=te(n,e.shape);i=tu(a.shape,o)}return as(a,i)}});var Yl=Ra({gramSchmidt_:function(e){var t;Array.isArray(e)?function(){t=!1,G(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){G(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(n,")")}))},a=1;a<e.length;++a)r(a)}():(t=!0,e=Ru(e,e.shape[0],0).map((function(e){return Fu(e,[0])}))),G(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],").")}));for(var n=[],r=e,a=function(e){n.push(_a.tidy((function(){var t=r[e];if(e>0)for(var a=0;a<e;++a){var i=Us(Gs(Us(n[a],t)),n[a]);t=Hs(t,i)}return Ss(t,Kl(t,"euclidean"))})))},i=0;i<e.length;++i)a(i);return t?Lu(n,0):n}});function Zl(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return _a.tidy((function(){G(2===e.shape.length,(function(){return"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor.")}));for(var n=e.shape[0],r=e.shape[1],a=Ds(n),i=Vi(e),o=Bu([[1]],[1,1]),s=Vi(o),u=n>=r?r:n,l=function(e){var t=i,u=s,l=a,c=N(_a.tidy((function(){var t=Cu(i,[e,e],[n-e,1]),u=Kl(t),l=Cu(i,[e,e],[1,1]),c=Gu(Ls(l,0),Bu([[-1]]),Bu([[1]])),h=Hs(l,Us(c,u)),p=Ss(t,h);s=1===p.shape[0]?Vi(o):ps([o,Cu(p,[1,0],[p.shape[0]-1,p.shape[1]])],0);var f=uu(Ss(hl(c,h),u)),d=Cu(i,[e,0],[n-e,r]),v=Us(f,s),m=qu(s);if(0===e)i=Hs(d,hl(v,hl(m,d)));else{var g=Hs(d,hl(v,hl(m,d)));i=ps([Cu(i,[0,0],[e,r]),g],0)}var y=qu(v),b=Cu(a,[0,e],[n,a.shape[1]-e]);if(0===e)a=Hs(b,hl(hl(b,s),y));else{var x=Hs(b,hl(hl(b,s),y));a=ps([Cu(a,[0,0],[n,e]),x],1)}return[s,i,a]})),3);s=c[0],i=c[1],a=c[2],Ao([t,u,l])},c=0;c<u;++c)l(c);return!t&&n>r&&(a=Cu(a,[0,0],[n,r]),i=Cu(i,[0,0],[r,r])),[a,i]}))}var Ql,$l=Ra({qr_:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(G(e.rank>=2,(function(){return"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)})),2===e.rank)return Zl(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=Wu(as(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];r.forEach((function(e){var n=N(Zl(e,t),2),r=n[0],o=n[1];a.push(r),i.push(o)}));var o=as(Lu(a,0),e.shape),s=as(Lu(i,0),e.shape);return[o,s]}});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Ql||(Ql={}));var Jl=Ra({computeWeightedLoss_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ql.SUM_BY_NONZERO_WEIGHTS,r=Aa(e,"losses","computeWeightedLoss"),a=null;null!=t&&(a=Aa(t,"weights","computeWeightedLoss"));var i=null==a?r:Us(r,a);if(n===Ql.NONE)return i;if(n===Ql.SUM)return Gs(i);if(n===Ql.MEAN){if(null==a)return Zs(i);var o=r.size/a.size,s=Ss(Gs(i),Gs(a));return o>1?Ss(s,Lo(o)):s}if(n===Ql.SUM_BY_NONZERO_WEIGHTS){if(null==a)return Ss(Gs(i),Lo(r.size));var u=Us(a,pu(r.shape)),l=Bi(Gs(lu(u,Lo(0))),"float32");return Ss(Gs(i),l)}throw Error("Unknown reduction: ".concat(n))}});Ra({absoluteDifference_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ql.SUM_BY_NONZERO_WEIGHTS,a=Aa(e,"labels","absoluteDifference"),i=Aa(t,"predictions","absoluteDifference"),o=null;null!=n&&(o=Aa(n,"weights","absoluteDifference")),j(a.shape,i.shape,"Error in absoluteDifference: ");var s=zo(Hs(a,i));return Jl(s,o,r)}});Ra({cosineDistance_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ql.SUM_BY_NONZERO_WEIGHTS,i=Aa(e,"labels","cosineDistance"),o=Aa(t,"predictions","cosineDistance"),s=null;null!=r&&(s=Aa(r,"weights","cosineDistance")),j(i.shape,o.shape,"Error in cosineDistance: ");var u=Lo(1),l=Hs(u,Gs(Us(i,o),n,!0));return Jl(l,s,a)}});Ra({hingeLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ql.SUM_BY_NONZERO_WEIGHTS,a=Aa(e,"labels","hingeLoss"),i=Aa(t,"predictions","hingeLoss"),o=null;null!=n&&(o=Aa(n,"weights","hingeLoss")),j(a.shape,i.shape,"Error in hingeLoss: ");var s=Lo(1);a=Hs(Us(Lo(2),a),s);var u=ku(Hs(s,Us(a,i)));return Jl(u,o,r)}});Ra({huberLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ql.SUM_BY_NONZERO_WEIGHTS,i=Aa(e,"labels","huberLoss"),o=Aa(t,"predictions","huberLoss"),s=null;null!=n&&(s=Aa(n,"weights","huberLoss")),j(i.shape,o.shape,"Error in huberLoss: ");var u=Lo(r),l=zo(Hs(o,i)),c=$s(l,u),h=Hs(l,c),p=Bo(Us(Lo(.5),ou(c)),Us(u,h));return Jl(p,s,a)}});Ra({logLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ql.SUM_BY_NONZERO_WEIGHTS,i=Aa(e,"labels","logLoss"),o=Aa(t,"predictions","logLoss"),s=null;null!=n&&(s=Aa(n,"weights","logLoss")),j(i.shape,o.shape,"Error in logLoss: ");var u=Lo(1),l=Lo(r),c=uu(Us(i,Bs(Bo(o,l)))),h=Us(Hs(u,i),Bs(Bo(Hs(u,o),l))),p=Hs(c,h);return Jl(p,s,a)}});var ec=Ra({squaredDifference_:function(e,t){var n=Aa(e,"a","squaredDifference"),r=Aa(t,"b","squaredDifference"),a=N(da(n,r),2);n=a[0],r=a[1],Ns(n.shape,r.shape);var i={a:n,b:r};return _a.runKernel(ar,i,{})}});Ra({meanSquaredError_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ql.SUM_BY_NONZERO_WEIGHTS,a=Aa(e,"labels","meanSquaredError"),i=Aa(t,"predictions","meanSquaredError"),o=null;null!=n&&(o=Aa(n,"weights","meanSquaredError")),j(a.shape,i.shape,"Error in meanSquaredError: ");var s=ec(a,i);return Jl(s,o,r)}});var tc=Ra({log1p_:function(e){var t={x:Aa(e,"x","log1p")};return _a.runKernel($t,t)}});function nc(e,t){var n=Aa(e,"labels","sigmoidCrossEntropyWithLogits"),r=Aa(t,"logits","sigmoidCrossEntropyWithLogits");j(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var a=ku(r),i=Us(r,n),o=tc(Vs(uu(zo(r))));return Bo(Hs(a,i),o)}Ra({sigmoidCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ql.SUM_BY_NONZERO_WEIGHTS,i=Aa(e,"multiClassLabels","sigmoidCrossEntropy"),o=Aa(t,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=Aa(n,"weights","sigmoidCrossEntropy")),j(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=Lo(r),l=Lo(1),c=Lo(.5);i=Bo(Us(i,Hs(l,u)),Us(c,u))}var h=nc(i,o);return Jl(h,s,a)}});var rc=Ra({logSumExp_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Aa(e,"x","logSumExp"),a=te(t,r.shape),i=Ws(r,a,!0),o=Hs(r,i),s=Vs(o),u=Gs(s,a),l=Bs(u),c=Bo(as(i,l.shape),l);if(n){var h=tu(c.shape,a);return as(c,h)}return c}});function ac(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(t.rank," ")+"and dim was ".concat(n));var r=Fo((function(e,t,r){var a=rc(t,[n],!0),i=Hs(Bi(t,"float32"),a);r([e,i]);var o=uu(Us(i,e));return{value:Gs(o,[n]),gradFunc:function(e,t){var r=N(t,2),a=r[0],i=r[1],o=tu(e.shape,[n]);return[Us(as(e,o),Hs(Bi(a,"float32"),Vs(i))),Us(as(e,o),Hs(Vs(i),Bi(a,"float32")))]}}}));return r(e,t)}Ra({softmaxCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ql.SUM_BY_NONZERO_WEIGHTS,i=Aa(e,"onehotLabels","softmaxCrossEntropy"),o=Aa(t,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=Aa(n,"weights","softmaxCrossEntropy")),j(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var u=Lo(r),l=Lo(1),c=Lo(i.shape[1]);i=Bo(Us(i,Hs(l,u)),Ss(u,c))}var h=ac(i,o);return Jl(h,s,a)}});var ic={flipLeftRight:yl,resizeNearestNeighbor:Wl,resizeBilinear:Vl,rotateWithOffset:bl,cropAndResize:gl,nonMaxSuppression:kl,nonMaxSuppressionAsync:Dl,nonMaxSuppressionWithScore:Rl,nonMaxSuppressionWithScoreAsync:Fl,nonMaxSuppressionPadded:Ll,nonMaxSuppressionPaddedAsync:zl,transform:Ul},oc={bandPart:jl,gramSchmidt:Yl,qr:$l},sc=function(e){Hr(n,e);var t=Kr(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return A(this,n),(a=t.call(this)).learningRate=e,a.rho=r,a.epsilon=i,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==i&&(a.epsilon=_a.backend.epsilon()),a}return R(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=_a.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:"".concat(n,"/accum_grad"),variable:Mo((function(){return ju(a).variable(false)}))}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:"".concat(n,"/accum_var"),variable:Mo((function(){return ju(a).variable(false)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable,s=t.accumulatedUpdates[r].variable;Mo((function(){var e=Bo(Us(o,t.rho),Us(ou(i),1-t.rho)),n=Us(Ss(Ou(Bo(s,t.epsilon)),Ou(Bo(o,t.epsilon))),i),r=Bo(Us(s,t.rho),Us(ou(n),1-t.rho));o.assign(e),s.assign(r);var u=Bo(Us(n,-t.learningRate),a);a.assign(u)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedUpdates&&(Ao(this.accumulatedGrads.map((function(e){return e.variable}))),Ao(this.accumulatedUpdates.map((function(e){return e.variable}))))}},{key:"getWeights",value:function(){var e=F(M().mark((function e(){var t;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(I(this.accumulatedGrads),I(this.accumulatedUpdates)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=F(M().mark((function e(t){var n;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=t.length/2,!1,this.accumulatedGrads=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedUpdates=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}]),n}(Po);sc.className="Adadelta",To(sc);var uc=function(e){Hr(n,e);var t=Kr(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return A(this,n),(r=t.call(this)).learningRate=e,r.initialAccumulatorValue=a,r.accumulatedGrads=[],r}return R(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=_a.registeredVariables[n];if(null==t.accumulatedGrads[r]){t.accumulatedGrads[r]={originalName:"".concat(n,"/accumulator"),variable:Mo((function(){return Rs(a.shape,t.initialAccumulatorValue).variable(false)}))}}var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable;Mo((function(){var e=Bo(o,ou(i));o.assign(e);var n=Bo(Us(Ss(i,Ou(Bo(e,_a.backend.epsilon()))),-t.learningRate),a);a.assign(n)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedGrads&&Ao(this.accumulatedGrads.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=F(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulatedGrads.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulatedGrads=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}]),n}(Po);uc.className="Adagrad",To(uc);var lc=function(e){Hr(n,e);var t=Kr(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return A(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],Mo((function(){i.accBeta1=Lo(r).variable(),i.accBeta2=Lo(a).variable()})),null==o&&(i.epsilon=_a.backend.epsilon()),i}return R(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);Mo((function(){var r=Hs(1,t.accBeta1),a=Hs(1,t.accBeta2);n.forEach((function(n,i){var o=_a.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:Mo((function(){return ju(o).variable(false)}))}),null==t.accumulatedSecondMoment[i]&&(t.accumulatedSecondMoment[i]={originalName:"".concat(n,"/v"),variable:Mo((function(){return ju(o).variable(false)}))});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,l=t.accumulatedSecondMoment[i].variable,c=Bo(Us(u,t.beta1),Us(s,1-t.beta1)),h=Bo(Us(l,t.beta2),Us(ou(s),1-t.beta2)),p=Ss(c,r),f=Ss(h,a);u.assign(c),l.assign(h);var d=Bo(Us(Ss(p,Bo(Ou(f),t.epsilon)),-t.learningRate),o);o.assign(d)}})),t.accBeta1.assign(Us(t.accBeta1,t.beta1)),t.accBeta2.assign(Us(t.accBeta2,t.beta2))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Ao(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedSecondMoment&&Ao(this.accumulatedSecondMoment.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=F(M().mark((function e(){var t;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(I(this.accumulatedFirstMoment),I(this.accumulatedSecondMoment)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=F(M().mark((function e(t){var n,r=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,Mo((function(){r.accBeta1.assign(ql(r.beta1,r.iterations_+1)),r.accBeta2.assign(ql(r.beta2,r.iterations_+1))})),n=t.length/2,!1,this.accumulatedFirstMoment=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedSecondMoment=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}]),n}(Po);lc.className="Adam",To(lc);var cc=function(e){Hr(n,e);var t=Kr(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return A(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.decay=s,i.accumulatedFirstMoment=[],i.accumulatedWeightedInfNorm=[],Mo((function(){i.iteration=Lo(0).variable(),i.accBeta1=Lo(r).variable()})),null==o&&(i.epsilon=_a.backend.epsilon()),i}return R(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);Mo((function(){var r=Hs(1,t.accBeta1),a=Ss(-t.learningRate,Bo(Us(t.iteration,t.decay),1));n.forEach((function(n,i){var o=_a.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:ju(o).variable(false)}),null==t.accumulatedWeightedInfNorm[i]&&(t.accumulatedWeightedInfNorm[i]={originalName:"".concat(n,"/v"),variable:ju(o).variable(false)});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,l=t.accumulatedWeightedInfNorm[i].variable,c=Bo(Us(u,t.beta1),Us(s,1-t.beta1)),h=Us(l,t.beta2),p=zo(s),f=Ys(h,p);u.assign(c),l.assign(f);var d=Bo(Us(Ss(a,r),Ss(c,Bo(f,t.epsilon))),o);o.assign(d)}})),t.iteration.assign(Bo(t.iteration,1)),t.accBeta1.assign(Us(t.accBeta1,t.beta1))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Ao(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedWeightedInfNorm&&Ao(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=F(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}]),n}(Po);cc.className="Adamax",To(cc);var hc=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this)).learningRate=e,r.setLearningRate(e),r}return R(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=Array.isArray(e)?e[r].tensor:e[n];if(null!=a){var i=_a.registeredVariables[n];Mo((function(){var e=Bo(Us(t.c,a),i);i.assign(e)}))}})),this.incrementIterations()}},{key:"setLearningRate",value:function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=Do(Lo(-e))}},{key:"dispose",value:function(){this.c.dispose()}},{key:"getWeights",value:function(){var e=F(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0]);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:if(0===(t=e.sent).length){e.next=5;break}throw new Error("SGD optimizer does not have settable weights.");case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate)}}]),n}(Po);hc.className="SGD",To(hc);var pc=function(e){Hr(n,e);var t=Kr(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return A(this,n),(a=t.call(this,e)).learningRate=e,a.momentum=r,a.useNesterov=i,a.accumulations=[],a.m=Lo(a.momentum),a}return R(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=_a.registeredVariables[n];if(null==t.accumulations[r]){t.accumulations[r]={originalName:"".concat(n,"/momentum"),variable:Mo((function(){return ju(a).variable(false)}))}}var i=t.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[n];null!=o&&Mo((function(){var e,n=Bo(Us(t.m,i),o);e=t.useNesterov?Bo(Us(t.c,Bo(o,Us(n,t.m))),a):Bo(Us(t.c,n),a),i.assign(n),a.assign(e)}))})),this.incrementIterations()}},{key:"dispose",value:function(){this.m.dispose(),null!=this.accumulations&&Ao(this.accumulations.map((function(e){return e.variable})))}},{key:"setMomentum",value:function(e){this.momentum=e}},{key:"getWeights",value:function(){var e=F(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulations.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulations=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}]),n}(hc);pc.className="Momentum",To(pc);var fc=function(e){Hr(n,e);var t=Kr(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(A(this,n),(r=t.call(this)).learningRate=e,r.decay=a,r.momentum=i,r.epsilon=o,r.accumulatedMeanSquares=[],r.accumulatedMoments=[],r.accumulatedMeanGrads=[],r.centered=s,null==o&&(r.epsilon=_a.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return r}return R(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=_a.registeredVariables[n],i=!1;null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:"".concat(n,"/rms"),variable:Mo((function(){return ju(a).variable(i)}))}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:"".concat(n,"/momentum"),variable:Mo((function(){return ju(a).variable(i)}))}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:"".concat(n,"/mg"),variable:Mo((function(){return ju(a).variable(i)}))});var o=Array.isArray(e)?e[r].tensor:e[n];if(null!=o){var s=t.accumulatedMeanSquares[r].variable,u=t.accumulatedMoments[r].variable;Mo((function(){var e=Bo(Us(s,t.decay),Us(ou(o),1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,i=Bo(Us(n,t.decay),Us(o,1-t.decay)),l=Ss(Us(o,t.learningRate),Ou(Hs(e,Bo(ou(i),t.epsilon)))),c=Bo(Us(u,t.momentum),l);s.assign(e),n.assign(i),u.assign(c);var h=Hs(a,c);a.assign(h)}else{var p=Bo(Us(s,t.decay),Us(ou(o),1-t.decay)),f=Bo(Us(u,t.momentum),Ss(Us(o,t.learningRate),Ou(Bo(p,t.epsilon))));s.assign(p),u.assign(f);var d=Hs(a,f);a.assign(d)}}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedMeanSquares&&Ao(this.accumulatedMeanSquares.map((function(e){return e.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&Ao(this.accumulatedMeanGrads.map((function(e){return e.variable}))),null!=this.accumulatedMoments&&Ao(this.accumulatedMoments.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=F(M().mark((function e(){var t;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(I(this.accumulatedMeanSquares),I(this.accumulatedMoments)),this.centered&&t.push.apply(t,I(this.accumulatedMeanGrads)),e.next=4,this.saveIterations();case 4:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=F(M().mark((function e(t){var n,r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=this.centered?t.length/3:t.length/2,r=!1,this.accumulatedMeanSquares=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.accumulatedMoments=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*n,3*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}]),n}(Po);fc.className="RMSProp",To(fc);var dc=function(){function e(){A(this,e)}return R(e,null,[{key:"sgd",value:function(e){return new hc(e)}},{key:"momentum",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new pc(e,t,n)}},{key:"rmsprop",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return new fc(e,t,n,r,a)}},{key:"adam",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new lc(e,t,n,r)}},{key:"adadelta",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new sc(e,t,n)}},{key:"adamax",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return new cc(e,t,n,r,a)}},{key:"adagrad",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return new uc(e,t)}}]),e}(),vc={sgd:dc.sgd,momentum:dc.momentum,adadelta:dc.adadelta,adagrad:dc.adagrad,rmsprop:dc.rmsprop,adamax:dc.adamax,adam:dc.adam},mc="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:function(e){return e()};function gc(){return new Promise((function(e){return mc((function(){return e()}))}))}function yc(e,t){var n=e[0].length;e.forEach((function(e,t){G(e.length===n,(function(){return"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")")}))})),G(t>=0&&t<n,(function(){return"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")}));var r=e[0];e.forEach((function(e,a){for(var i=0;i<n;i++)G(i===t||e[i]===r[i],(function(){return"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(a,".")}))}))}function bc(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function xc(e){return e<=30?e:pe(e,Math.floor(Math.sqrt(e)))}function kc(e,t,n){return[n*("number"===typeof e?e:e[0]),t*("number"===typeof e?e:e[1])]}function wc(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];if(r)(a=a.concat(t.slice(0))).push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);for(var i=t.length,o=0;o<i;++o)a=a.concat([e[o+1]/t[o],t[o]]);a=a.concat(e.slice(i+1))}return a}function _c(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[];if(n){r.push(t);for(var a=t+1;a<e;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{for(var i=[],o=[],s=1;s<e;++s)s>=2*t+1||s%2===1?o.push(s):i.push(s);r.push.apply(r,i),r.push(0),r.push.apply(r,o)}return r}function Sc(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function Ic(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function Cc(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}function Tc(e,t){var n=e.shape.length,r=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[r-1]," vs. ").concat(n));if(0===K(e.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));for(var a=t.shape,i=a[a.length-1],o=1,s=0;s<a.length-1;++s)o*=a[s];var u=e.shape,l=a.slice();l.pop();for(var c=1,h=i;h<n;++h)c*=u[h],l.push(u[h]);var p=[].concat(I(fe(e.shape).map((function(e){return e/c}))),[1]).slice(0,i);return[l,o,c,p]}function Nc(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(0===e.size)throw new Error("Updates specified for empty output. updates shape: ".concat(e.shape))}!function(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(t.shape,", shape: ").concat(e)+", sliceDim: ".concat(r,", and batchDim: ").concat(a,".");if(n.rank<a)throw new Error(i+" update.rank < ".concat(a,". "));if(e.length<r+(n.rank-a))throw new Error(i+" Output shape length < ".concat(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(i+" update.rank != ".concat(a+e.length-r));for(var o=0;o<a;++o)if(n.shape[o]!==t.shape[o])throw new Error(i+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(t.shape[o],")."));for(var s=0;s<n.rank-a;++s)if(n.shape[s+a]!==e[s+r])throw new Error(i+" updates.shape[".concat(s+a,"] (").concat(n.shape[s+a],") != shape[").concat(s+a,"] (").concat(e[s+a],")"))}(n,t,e)}function Ec(e,t,n){for(var r=t.shape.length,a=r>1?t.shape[r-1]:1,i=n.length,o=1,s=a;s<i;++s)o*=n[s];var u=a<1?1:a;return{sliceRank:a,numUpdates:K(t.shape)/u,sliceSize:o,strides:[].concat(I(fe(n.slice(0,a))),[1]),outputSize:K(n)}}var Mc=1.7580993408473768,Ac=1.0507009873554805,Dc=.3275911,Rc=.254829592,Oc=-.284496736,Fc=1.421413741,Lc=-1.453152027,Pc=1.061405429;function zc(){var e;Ce().getBool("IS_TEST")||(e=console).warn.apply(e,arguments)}function Bc(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function Vc(e,t){return{real:e[2*t],imag:e[2*t+1]}}function Wc(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function Uc(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function Hc(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof t)G(e.shape[n]%t===0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(t).fill(e.shape[n]/t);else{var a=t.reduce((function(e,t){return-1===t&&(e+=1),e}),0);G(a<=1,(function(){return"There should be only one negative value in split array."}));var i=t.indexOf(-1);if(-1!==i){var o=t.reduce((function(e,t){return t>0?e+t:e}));t[i]=e.shape[n]-o}G(e.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=t}return r}function Gc(e,t,n,r){var a=t.shape.length,i=e.shape.length;if(0!==r&&(r<-a||r>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(r));if(r<0&&(r+=a),r>i)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(i,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(var o=0;o<r;++o)if(e.shape[o]!==t.shape[o])throw new Error("x.shape[".concat(o,"]: ").concat(e.shape[o]," should be equal to indices.shape[").concat(o,"]: ").concat(t.shape[o],"."));for(var s=e.shape[n],u=[],l=1,c=1,h=1,p=0;p<r;++p)u.push(e.shape[p]),l*=e.shape[p];for(var f=r;f<n;f++)u.push(e.shape[f]),c*=e.shape[f];for(var d=r;d<a;d++)u.push(t.shape[d]);for(var v=n+1;v<i;v++)u.push(e.shape[v]),h*=e.shape[v];return{batchSize:l,sliceSize:h,outerSize:c,dimSize:s,outputShape:u}}function jc(e){try{return e.map((function(e){return Pr(e)}))}catch($8){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat($8))}}function qc(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);for(var a=zi(e,"int32"),i=zi([n.length,e.length],"int32"),o=0;o<n.length;o++){var s=a.indexToLoc(n[o]),u=o*e.length;i.values.set(s,u)}return i.toTensor()}var Xc={kernelName:Ae,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Us(e,nl(Bi(n,"float32"),-1))}}}},Kc={kernelName:De,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){var t=ou(Bi(n,"float32")),r=Ou(Hs(Lo(1),t));return uu(Ss(e,r))}}}},Yc={kernelName:Re,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){var t=Ou(Hs(ou(Bi(n,"float32")),1));return Ss(e,t)}}}},Zc={kernelName:Oe,inputsToSave:["a","b"],gradFunc:function(e,t){var n=N(t,2),r=n[0],a=n[1],i=Ns(r.shape,a.shape);return{a:function(){var t=e,n=Ts(r.shape,i);return n.length>0&&(t=Gs(t,n)),as(t,r.shape)},b:function(){var t=e,n=Ts(a.shape,i);return n.length>0&&(t=Gs(t,n)),as(t,a.shape)}}}},Qc={kernelName:Fe,saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}},$c={kernelName:ze,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return ju(n)}}}},Jc={kernelName:Be,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return ju(n)}}}},eh={kernelName:Ve,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Ss(e,Ou(Hs(Lo(1),ou(Bi(n,"float32")))))}}}},th={kernelName:We,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){var t=Ou(Bo(Lo(1),ou(Bi(n,"float32"))));return Ss(e,t)}}}},nh={kernelName:Ge,inputsToSave:["a","b"],gradFunc:function(e,t){var n=N(t,2),r=n[0],a=n[1],i=Ns(r.shape,a.shape);return{a:function(){var t=Bo(ou(r),ou(a)),n=Us(e,Ss(a,t)),o=Ts(r.shape,i);return o.length>0&&(n=Gs(n,o)),as(n,r.shape)},b:function(){var t=Bo(ou(r),ou(a)),n=uu(Us(e,Ss(r,t))),o=Ts(a.shape,i);return o.length>0&&(n=Gs(n,o)),as(n,a.shape)}}}},rh={kernelName:Ue,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Ss(e,Bo(ou(Bi(n,"float32")),1))}}}},ah={kernelName:He,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Ss(e,Hs(Lo(1),ou(Bi(n,"float32"))))}}}};var ih=Ra({avgPool3dGrad_:function(e,t,n,r,a,i){var o=Aa(e,"dy","avgPool3dGrad"),s=Aa(t,"input","avgPool3dGrad"),u=o,l=s,c=!1;4===s.rank&&(c=!0,u=as(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),l=as(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),G(5===u.rank,(function(){return"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(u.rank,".")})),G(5===l.rank,(function(){return"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(l.rank,".")})),null!=i&&G(Z(a),(function(){return"Error in avgPool3dGrad: pad must be an integer when "+"using, dimRoundingMode ".concat(i," but got pad ").concat(a,".")}));var h={dy:u,input:l},p={filterSize:n,strides:r,pad:a,dimRoundingMode:i},f=_a.runKernel(Ke,h,p);return c?as(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}}),oh={kernelName:Xe,inputsToSave:["x"],gradFunc:function(e,t,n){var r=N(t,1)[0],a=n.filterSize,i=n.strides,o=n.pad,s=n.dimRoundingMode;return{x:function(){return ih(e,r,a,i,o,s)}}}};var sh=Ra({avgPoolGrad_:function(e,t,n,r,a){var i=Aa(e,"dy","avgPoolGrad"),o=Aa(t,"input","avgPoolGrad");G(o.rank===i.rank,(function(){return"Rank of input (".concat(o.rank,") does not match rank of dy (").concat(i.rank,")")}));var s=o,u=i,l=!1;3===o.rank&&(l=!0,s=as(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=as(i,[1,i.shape[0],i.shape[1],i.shape[2]])),G(4===u.rank,(function(){return"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(u.rank,".")})),G(4===s.rank,(function(){return"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(s.rank,".")}));var c={dy:u,input:s},h={filterSize:n,strides:r,pad:a},p=_a.runKernel(qe,c,h);return l?as(p,[p.shape[1],p.shape[2],p.shape[3]]):p}}),uh={kernelName:je,inputsToSave:["x"],gradFunc:function(e,t,n){var r=N(t,1)[0],a=n.filterSize,i=n.strides,o=n.pad;return{x:function(){return sh(e,r,a,i,o)}}}},lh={kernelName:Ye,inputsToSave:["a","b"],gradFunc:function(e,t,n){var r=N(t,2),a=r[0],i=r[1],o=n.transposeA,s=n.transposeB;return o||s?!o&&s?{a:function(){return hl(e,i,!1,!1)},b:function(){return hl(e,a,!0,!1)}}:o&&!s?{a:function(){return hl(i,e,!1,!0)},b:function(){return hl(a,e,!1,!1)}}:{a:function(){return hl(i,e,!0,!0)},b:function(){return hl(e,a,!0,!0)}}:{a:function(){return hl(e,i,!1,!0)},b:function(){return hl(a,e,!0,!1)}}}};var ch=Ra({spaceToBatchND_:function(e,t,n){var r=Aa(e,"x","spaceToBatchND");G(r.rank>=1+t.length,(function(){return"input rank ".concat(r.rank," should be > than [blockShape] ").concat(t.length)})),G(n.length===t.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)})),G(r.shape.reduce((function(e,r,a){return a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]===0:e}),!0),(function(){return"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString())}));var a={x:r},i={blockShape:t,paddings:n};return _a.runKernel(tr,a,i)}}),hh={kernelName:Ze,gradFunc:function(e,t,n){var r=n.blockShape,a=n.crops;return{x:function(){return ch(e,r,a)}}}},ph={kernelName:"BroadcastTo",gradFunc:function(e,t,n){for(var r=n,a=r.inputShape,i=r.shape,o=Array.from(i),s=a.length-1;s>=0;s--)if(a[s]===i[s])o[s]=1;else if(1!==a[s])throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(i,"]."));for(var u=[],l=0;l<o.length;l++)o[l]>1&&u.push(l);return{x:function(){return Gs(e,u,!0)}}}},fh={kernelName:$e,gradFunc:function(e){return{x:function(){return e.clone()}}}},dh={kernelName:Je,gradFunc:function(e){return{x:function(){return ju(e)}}}},vh={kernelName:et,inputsToSave:["x"],gradFunc:function(e,t,n){var r=N(t,1)[0],a=n.clipValueMin,i=n.clipValueMax;return{x:function(){return Gu(qs(Ps(r,a),Hl(r,i)),e,ju(e))}}}},mh={kernelName:nt,inputsToSave:["x"],gradFunc:Xc.gradFunc},gh={kernelName:rt,saveAllInputs:!0,gradFunc:function(e,t,n){var r=t.map((function(e){return e.shape})),a=te(n.axis,t[0].shape)[0],i=r.map((function(e){return e[a]}));return Ru(e,i,a).map((function(e){return function(){return e}}))}},yh={kernelName:at,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=N(t,2),a=r[0],i=r[1],o=n.dilations,s=n.strides,u=n.pad,l=n.dataFormat;return G(ts(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(o,"'")})),{x:function(){return bs(a.shape,e,i,s,u,l)},filter:function(){return el(a,e,i.shape,s,u,l)}}}},bh={kernelName:ot,inputsToSave:["dy","filter"],gradFunc:function(e,t,n){var r=N(t,2),a=r[0],i=r[1],o=n.strides,s=n.pad,u=n.dataFormat,l=n.dimRoundingMode;return{dy:function(){return gs(e,i,o,s,u,1,l)},filter:function(){return el(e,a,i.shape,o,s,u,l)}}}};var xh=Ra({conv3DBackpropFilter_:function(e,t,n,r,a){var i=e;4===e.rank&&(i=as(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));var o=t;4===o.rank&&(o=as(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),G(5===i.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(i.shape,".")})),G(5===o.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(o.shape,".")})),G(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,".")})),G(i.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input ".concat(i.shape[4],") must ")+"match input depth in filter (".concat(n[3],".")})),G(o.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy (".concat(o.shape[4],") must ")+"match output depth for filter (".concat(n[4],").")}));var s={x:i,dy:o},u={strides:r,pad:a,filterShape:n};return _a.runKernel(ut,s,u)}});var kh=Ra({conv3DBackpropInput_:function(e,t,n,r,a){G(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var i=e,o=t,s=!1;4===t.rank&&(s=!0,o=as(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],l=o.shape[4];G(5===i.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(i.length,".")})),G(5===o.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(o.rank)})),G(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)})),G(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[3],".")})),G(l===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(l,") must ")+"match output depth for filter ".concat(n.shape[4],".")}));var c={dy:o,filter:n},h={pad:a,strides:r,inputShape:i},p=_a.runKernel(lt,c,h);return s?as(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),wh={kernelName:st,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,i=n.pad;G(ts(r),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(r,"'")}));var o=N(t,2),s=o[0],u=o[1];return{x:function(){return kh(s.shape,e,u,a,i)},filter:function(){return xh(s,e,u.shape,a,i)}}}};var _h=Ra({sin_:function(e){var t={x:Aa(e,"x","sin")};return _a.runKernel(Kn,t)}}),Sh={kernelName:ct,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Us(uu(_h(Bi(n,"float32"))),e)}}}};var Ih=Ra({sinh_:function(e){var t={x:Aa(e,"x","sinh")};return _a.runKernel(Yn,t)}}),Ch={kernelName:ht,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Us(Ih(Bi(n,"float32")),e)}}}};var Th=Ra({cumsum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Aa(e,"x","cumsum"),i={x:a},o={axis:t,exclusive:n,reverse:r};return _a.runKernel(pt,i,o)}}),Nh={kernelName:pt,inputsToSave:["x"],gradFunc:function(e,t,n){var r=N(t,1)[0],a=n.axis,i=n.exclusive,o=n.reverse;return{x:function(){var t=ru([a],r.rank),n=Th(e,a,i,!o);return null!=t&&(n=qu(n,t)),n}}}},Eh={kernelName:mt,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,i=n.pad,o=n.dimRoundingMode,s=null==r?[1,1]:r;G(ts(s),(function(){return"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(s,"'")}));var u=N(t,2),l=u[0],c=u[1];return G(4===l.rank,(function(){return"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(l.rank,".")})),G(4===c.rank,(function(){return"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(c.rank,".")})),G(l.shape[3]===c.shape[2],(function(){return"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(l.shape[3],") must match the inChannels dimension ")+"in filter ".concat(c.shape[2],".")})),G(ns(a,s),(function(){return"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(a," and dilations ")+"'".concat(s,"'.")})),null!=o&&G(Z(i),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(i,".")})),{x:function(){return ll(l.shape,e,c,a,i,r,o)},filter:function(){return ul(l,e,c.shape,a,i,r,o)}}}},Mh={kernelName:xt,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=N(t,2),a=r[0],i=r[1],o={x:a,filter:i,dy:e},s={x:a,filter:i,dy:e};return{x:function(){return _a.runKernel(kt,o,n)},filter:function(){return _a.runKernel(wt,s,n)}}}},Ah={kernelName:St,outputsToSave:[!0],gradFunc:function(e,t){var n={dy:e,y:N(t,1)[0]};return{x:function(){return _a.runKernel(It,n)}}}},Dh={kernelName:Ct,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0],r=Us(Vs(uu(ou(n))),2/Math.sqrt(Math.PI));return{x:function(){return Us(e,r)}}}},Rh={kernelName:Nt,outputsToSave:[!0],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Us(e,n)}}}},Oh={kernelName:Et,inputsToSave:["input"],gradFunc:function(e,t){var n=N(t,1)[0];return{input:function(){return as(e,n.shape)}}}},Fh={kernelName:Mt,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Us(e,Vs(n))}}}},Lh={kernelName:Ot,gradFunc:function(e){return{x:function(){return ju(e)}}}},Ph={kernelName:Ft,inputsToSave:["a","b"],gradFunc:function(e,t){var n=N(t,2),r=n[0],a=n[1],i=Ns(r.shape,a.shape);return{a:function(){var t=Ss(e,Bi(a,"float32")),n=Ts(r.shape,i);return n.length>0?as(Gs(t,n),r.shape):t},b:function(){var t=Us(e,Bi(r,"float32")),n=Ts(a.shape,i);n.length>0&&(t=as(Gs(t,n),a.shape));var o=ou(a);return uu(Ss(t,Bi(o,"float32")))}}}};var zh=Ra({rsqrt_:function(e){var t={x:Aa(e,"x","rsqrt")};return _a.runKernel(Hn,t)}}),Bh={kernelName:Lt,inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var r=n.varianceEpsilon,a=N(t,4),i=a[0],o=a[1],s=a[2],u=a[3],l=null==u?Lo(1):u,c=Ts(o.shape,i.shape),h=[];if(1===o.rank){for(var p=0;p<i.shape.length-1;++p)h.push(i.shape[p]);h.push(1)}var f=Hs(i,o),d=Us(e,l),v=zh(Bo(s,Lo(r))),m=Us(Us(Us(v,v),v),Lo(-.5));return{x:function(){return 1===o.rank?as(Us(Us(e,As(as(v,[1,1,1,o.shape[0]]),h)),l),i.shape):as(Us(Us(e,v),l),i.shape)},mean:function(){var e=Us(Us(v,Lo(-1)),d);return 1===o.rank&&(e=Gs(e,c)),as(e,o.shape)},variance:function(){var e=Us(Us(m,f),d);return 1===o.rank&&(e=Gs(e,c)),as(e,o.shape)},scale:function(){var t=Us(f,v),n=Us(e,t);return 1===o.rank&&(n=Gs(n,c)),as(n,o.shape)},offset:function(){var t=e;return 1===o.rank&&(t=Gs(t,c)),as(t,o.shape)}}}};var Vh=Ra({unsortedSegmentSum_:function(e,t,n){var r=Aa(e,"x","unsortedSegmentSum"),a=Aa(t,"segmentIds","unsortedSegmentSum","int32");G(Z(n),(function(){return"numSegments must be of dtype int"}));var i={x:r,segmentIds:a},o={numSegments:n};return _a.runKernel(gr,i,o)}}),Wh={kernelName:Pt,inputsToSave:["x","indices"],gradFunc:function(e,t,n){var r=N(t,2),a=r[0],i=r[1],o=n.axis,s=te(o,a.shape)[0];return{x:function(){var t=a.shape,n=i.size,r=t.slice(0,s),u=r.length,l=t.slice(o,t.length).slice(1),c=l.length,h=Uh(0,u),p=Uh(u+1,u+1+c),f=Hh([r,[n],l]),d=as(e,f),v=as(i,[n]),m=Hh([[u],h,p]),g=qu(d,m),y=Vh(g,v,a.shape[s]),b=au(m);return y=qu(y,b)},indices:function(){return i}}}};function Uh(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function Hh(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var Gh={kernelName:Vt,inputsToSave:["a","b"],gradFunc:function(e,t){var n=N(t,2),r=n[0],a=n[1];return{a:function(){return ju(r)},b:function(){return ju(a)}}}},jh={kernelName:Wt,gradFunc:function(e){return{x:function(){return Bi(e,"float32")}}}},qh={kernelName:Gt,gradFunc:function(e){return{x:function(){return ju(e)}}}},Xh={kernelName:jt,gradFunc:function(e){return{x:function(){return ju(e)}}}},Kh={kernelName:qt,gradFunc:function(e){return{x:function(){return ju(e)}}}},Yh={kernelName:Xt,inputsToSave:["x"],gradFunc:function(e,t,n){var r=N(t,1)[0],a=n.alpha,i=Ls(r,0);return{x:function(){return Gu(i,e,Us(e,a))}}}},Zh={kernelName:$t,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Ss(e,Bo(n,1))}}}},Qh={kernelName:Qt,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Ss(e,Bi(n,"float32"))}}}},$h={kernelName:"LogSoftmax",inputsToSave:[],outputsToSave:[!0],gradFunc:function(e,t,n){var r=N(t,1)[0],a=n.axis;return{logits:function(){var t=Vs(r);return Hs(e,Us(Gs(e,a,!0),t))}}}};var Jh=Ra({localResponseNormalizationBackprop_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5,s={x:e,y:t,dy:n},u={depthRadius:r,bias:a,alpha:i,beta:o};return _a.runKernel(rn,s,u)}}),ep={kernelName:nn,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=N(t,2),a=r[0],i=r[1],o=n.depthRadius,s=n.bias,u=n.alpha,l=n.beta;return{x:function(){return Jh(a,i,e,o,s,u,l)}}}};function tp(e,t,n,r){return t.rank<n.rank&&(t=as(t,tu(t.shape,r))),e.rank<n.rank&&(e=as(e,tu(e.shape,r))),{x:function(){return Us(e,Bi(Es(n,t),e.dtype))}}}var np={kernelName:an,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.reductionIndices,a=t[0],i=tp(e,t[1],a,te(r,a.shape));return{x:function(){return i.x()}}}};var rp=Ra({less_:function(e,t){var n=Aa(e,"a","less"),r=Aa(t,"b","less"),a=N(da(n,r),2);n=a[0],r=a[1],Ns(n.shape,r.shape);var i={a:n,b:r};return _a.runKernel(Kt,i)}}),ap={kernelName:on,inputsToSave:["a","b"],gradFunc:function(e,t){var n=N(t,2),r=n[0],a=n[1];return{a:function(){return Us(e,Bi(Ps(r,a),"float32"))},b:function(){return Us(e,Bi(rp(r,a),"float32"))}}}};var ip=Ra({maxPool3dGrad_:function(e,t,n,r,a,i,o){var s=Aa(e,"dy","maxPool3dGrad"),u=Aa(t,"input","maxPool3dGrad"),l=Aa(n,"output","maxPool3dGrad"),c=s,h=u,p=l,f=!1;4===u.rank&&(f=!0,c=as(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),h=as(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),p=as(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),G(5===c.rank,(function(){return"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(c.rank,".")})),G(5===h.rank,(function(){return"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(h.rank,".")})),G(5===p.rank,(function(){return"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(p.rank,".")})),null!=o&&G(Z(i),(function(){return"Error in maxPool3dGrad: pad must be an integer when "+"using, dimRoundingMode ".concat(o," but got pad ").concat(i,".")}));var d={dy:c,input:h,output:p},v={filterSize:r,strides:a,pad:i,dimRoundingMode:o},m=_a.runKernel(cn,d,v);return f?as(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}}),op={kernelName:ln,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=N(t,2),a=r[0],i=r[1],o=n.filterSize,s=n.strides,u=n.pad,l=n.dimRoundingMode;return{x:function(){return ip(e,a,i,o,s,u,l)}}}};var sp=Ra({maxPoolGrad_:function(e,t,n,r,a,i,o){var s=Aa(e,"dy","maxPoolGrad"),u=Aa(t,"input","maxPoolGrad"),l=Aa(n,"output","maxPoolGrad");G(u.rank===s.rank,(function(){return"Rank of input (".concat(u.rank,") does not match rank of dy ")+"(".concat(s.rank,")")})),G(4===s.rank,(function(){return"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(s.rank,".")})),G(4===u.rank,(function(){return"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(u.rank,".")})),null!=o&&G(Z(i),(function(){return"Error in maxPoolGrad: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(i,".")}));var c={dy:s,input:u,output:l},h={filterSize:r,strides:a,pad:i,dimRoundingMode:o};return _a.runKernel(un,c,h)}}),up={kernelName:sn,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=N(t,2),a=r[0],i=r[1],o=n.filterSize,s=n.strides,u=n.pad;return{x:function(){return sp(e,a,i,o,s,u)}}}},lp={kernelName:pn,inputsToSave:["x"],gradFunc:function(e,t,n){var r=N(t,1)[0],a=te(n.axis,r.shape),i=K(eu(r.shape,a)[1]);return{x:function(){var t=r.shape.slice();a.forEach((function(e){t[e]=1}));var n=as(e,t);return Ss(Us(n,pu(r.shape,"float32")),i)}}}},cp={kernelName:fn,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.axis,a=N(t,2),i=a[0],o=tp(e,a[1],i,te(r,i.shape));return{x:function(){return o.x()}}}},hp={kernelName:dn,inputsToSave:["a","b"],gradFunc:function(e,t){var n=N(t,2),r=n[0],a=n[1];return{a:function(){return Us(e,Bi(Hl(r,a),"float32"))},b:function(){return Us(e,Bi(Ls(r,a),"float32"))}}}},pp={kernelName:vn,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return Cu(e,a,r.shape)}}}},fp={kernelName:mn,inputsToSave:["a","b"],gradFunc:function(e,t){var n=N(t,2),r=n[0],a=n[1],i=Ns(r.shape,a.shape);return{a:function(){var t=Ts(r.shape,i);return t.length>0?as(Gs(e,t),r.shape):e},b:function(){var t=Us(e,uu(Os(Ss(r,a)))),n=Ts(a.shape,i);return n.length>0?as(Gs(t,n),a.shape):t}}}},dp={kernelName:yn,inputsToSave:["a","b"],gradFunc:function(e,t){var n=N(t,2),r=n[0],a=n[1],i=Ns(r.shape,a.shape);return{a:function(){var t=Us(e,Bi(a,"float32")),n=Ts(r.shape,i);return n.length>0?as(Gs(t,n),r.shape):t},b:function(){var t=Us(e,Bi(r,"float32")),n=Ts(a.shape,i);return n.length>0?as(Gs(t,n),a.shape):t}}}},vp={kernelName:bn,gradFunc:function(e){return{x:function(){return uu(e)}}}},mp={kernelName:In,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return hu(n.shape,"float32")}}}},gp={kernelName:Sn,gradFunc:function(e){return{x:function(){return ju(e)}}}},yp={kernelName:Cn,saveAllInputs:!0,gradFunc:function(e,t,n){var r=n.axis;return Wu(e,r).map((function(e){return function(){return e}}))}},bp={kernelName:Tn,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return Cu(e,a,r.shape)}}}},xp={kernelName:Nn,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:function(e,t){var n=N(t,3),r=n[0],a=n[1],i=n[2],o=r,s=a,u=Ns(o.shape,s.shape);return{a:function(){var t=Bi(s,"float32"),n=Us(e,Us(t,ql(o,Hs(t,Lo(1))))),r=Ts(o.shape,u);return r.length>0&&(n=Gs(n,r)),as(n,o.shape)},b:function(){var t=Ls(o,0),n=Gu(t,Bs(o),ju(o)),r=Us(e,Us(i,n)),a=Ts(s.shape,u);return a.length>0&&(r=Gs(r,a)),as(r,s.shape)}}}},kp={kernelName:En,inputsToSave:["x","alpha"],gradFunc:function(e,t){var n=N(t,2),r=n[0],a=n[1],i=Ls(r,0);return{x:function(){return Gu(i,e,Us(e,a))},alpha:function(){var t=Gu(i,ju(e),Us(e,r)),n=Ts(a.shape,e.shape);return n.length>0&&(t=Gs(t,n)),as(t,a.shape)}}}},wp={kernelName:_t,inputsToSave:["a","b"],gradFunc:function(e,t){var n=N(t,2),r=n[0],a=n[1],i=Ns(r.shape,a.shape);return{a:function(){var t=Ss(e,Bi(a,"float32")),n=Ts(r.shape,i);return n.length>0?as(Gs(t,n),r.shape):t},b:function(){var t=Us(e,Bi(r,"float32")),n=Ts(a.shape,i);n.length>0&&(t=as(Gs(t,n),a.shape));var o=ou(a);return uu(Ss(t,Bi(o,"float32")))}}}},_p={kernelName:Rn,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Ss(e,uu(ou(n)))}}}},Sp={kernelName:Vn,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0],r=Us(Hl(n,6),nl(n));return{x:function(){return Us(e,Bi(r,"float32"))}}}},Ip={kernelName:On,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Us(e,Bi(nl(n),"float32"))}}}},Cp={kernelName:Fn,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return as(e,n.shape)}}}},Tp={kernelName:zn,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:N(t,1)[0]};return{images:function(){return _a.runKernel(Bn,r,n)}}}},Np={kernelName:Ln,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:N(t,1)[0]};return{images:function(){return _a.runKernel(Pn,r,n)}}}},Ep={kernelName:Wn,gradFunc:function(e,t,n){var r=te(n.dims,e.shape);return{x:function(){return wu(e,r)}}}},Mp={kernelName:Un,gradFunc:function(e){return{x:function(){return ju(e)}}}},Ap={kernelName:Hn,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return uu(Ss(e,Us(ql(n,1.5),2)))}}}};var Dp=Ra({logicalNot_:function(e){var t={x:Aa(e,"x","logicalNot","bool")};return _a.runKernel(en,t)}}),Rp={kernelName:jn,inputsToSave:["condition"],gradFunc:function(e,t){var n=N(t,1)[0];return{condition:function(){return Bi(ju(n),"float32")},t:function(){return Us(e,Bi(n,e.dtype))},e:function(){return Us(e,Bi(Dp(n),e.dtype))}}}},Op={kernelName:qn,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){var t=Ls(n,Lo(0)),r=Lo(Mc),a=Lo(Ac),i=Us(e,a),o=Us(Us(e,r),Vs(Bi(n,"float32")));return Gu(t,i,o)}}}},Fp={kernelName:Qn,outputsToSave:[!0],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Us(e,Us(n,Hs(Lo(1),n)))}}}},Lp={kernelName:Zn,gradFunc:function(e){return{x:function(){return ju(e)}}}};var Pp=Ra({cos_:function(e){var t={x:Aa(e,"x","cos")};return _a.runKernel(ct,t)}}),zp={kernelName:Kn,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Us(Pp(Bi(n,"float32")),e)}}}};var Bp=Ra({cosh_:function(e){var t={x:Aa(e,"x","cosh")};return _a.runKernel(ht,t)}}),Vp={kernelName:Yn,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Us(Bp(Bi(n,"float32")),e)}}}},Wp={kernelName:Xn,inputsToSave:["x"],gradFunc:function(e,t,n){for(var r=N(t,1)[0],a=n.begin,i=n.size,o=r.shape,s=N(_o(r,a,i),2),u=s[0],l=s[1],c=[],h=0;h<e.rank;h++)c.push([u[h],o[h]-u[h]-l[h]]);return{x:function(){return du(e,c)}}}},Up={kernelName:rr,outputsToSave:[!0],gradFunc:function(e,t,n){var r=N(t,1)[0],a=n.dim,i=Us(e,r);return{logits:function(){return Hs(i,Us(Gs(i,[a],true),r))}}}},Hp={kernelName:$n,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Us(e,Iu(n))}}}};var Gp=Ra({batchToSpaceND_:function(e,t,n){var r=Aa(e,"x","batchToSpaceND"),a=t.reduce((function(e,t){return e*t}));G(r.rank>=1+t.length,(function(){return"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(t.length)})),G(n.length===t.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)})),G(r.shape[0]%a===0,(function(){return"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(a)}));var i={x:r},o={blockShape:t,crops:n};return _a.runKernel(Ze,i,o)}}),jp={kernelName:tr,gradFunc:function(e,t,n){var r=n.blockShape,a=n.paddings;return{x:function(){return Gp(e,r,a)}}}},qp={kernelName:nr,gradFunc:function(e,t,n){var r=n.axis;return{x:function(){return ps(e,r)}}}},Xp={kernelName:hr,inputsToSave:["x"],gradFunc:function(e,t,n){var r=N(t,1)[0],a=n.reps;return{x:function(){var t=ju(r);if(1===r.rank)for(var n=0;n<a[0];++n)t=Bo(t,Cu(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(var i=0;i<a[0];++i)for(var o=0;o<a[1];++o)t=Bo(t,Cu(e,[i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(var s=0;s<a[0];++s)for(var u=0;u<a[1];++u)for(var l=0;l<a[2];++l)t=Bo(t,Cu(e,[s*r.shape[0],u*r.shape[1],l*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(r.rank," tensors yet."));for(var c=0;c<a[0];++c)for(var h=0;h<a[1];++h)for(var p=0;p<a[2];++p)for(var f=0;f<a[3];++f)t=Bo(t,Cu(e,[c*r.shape[0],h*r.shape[1],p*r.shape[2],f*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}};for(var Kp=0,Yp=[Xc,Kc,Yc,Zc,Qc,$c,Jc,eh,th,nh,rh,ah,oh,uh,lh,hh,ph,fh,dh,vh,mh,gh,bh,yh,wh,Sh,Ch,Nh,Eh,Mh,wp,Ah,Dh,Rh,Oh,Fh,Ph,Lh,Bh,Wh,Gh,jh,qh,Xh,Kh,Yh,Zh,Qh,$h,ep,np,np,ap,op,up,lp,cp,hp,pp,fp,dp,vp,mp,gp,yp,bp,bp,xp,kp,_p,Sp,Ip,Cp,Tp,Np,Ep,Mp,Ap,Rp,Op,Fp,Lp,zp,Vp,Wp,Up,Hp,jp,jp,qp,qp,{kernelName:Jn,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Ss(e,Us(Ou(Bi(n,"float32")),2))}}}},{kernelName:ar,inputsToSave:["a","b"],gradFunc:function(e,t){var n=N(t,2),r=n[0],a=n[1],i=Lo(2);return{a:function(){return Us(e,Us(i,Hs(r,a)))},b:function(){return Us(e,Us(i,Hs(a,r)))}}}},{kernelName:ir,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Us(e,Us(Bi(n,"float32"),2))}}}},{kernelName:br,gradFunc:function(e){return{x:function(){return ju(e)}}}},{kernelName:or,inputsToSave:["a","b"],gradFunc:function(e,t){var n=N(t,2),r=n[0],a=n[1],i=Ns(r.shape,a.shape);return{a:function(){var t=e,n=Ts(r.shape,i);return n.length>0&&(t=Gs(t,n)),as(t,r.shape)},b:function(){var t=e,n=Ts(a.shape,i);return n.length>0&&(t=Gs(t,n)),as(uu(t),a.shape)}}}},{kernelName:er,inputsToSave:["x"],gradFunc:function(e,t,n){var r=N(t,1)[0],a=r.shape.slice();te(n.axis,r.shape).forEach((function(e){a[e]=1}));var i=as(e,a),o=Us(i,pu(r.shape,"float32"));return{x:function(){return o}}}},{kernelName:lr,inputsToSave:["x"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Ss(e,ou(Pp(n)))}}}},{kernelName:cr,outputsToSave:[!0],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return Us(Hs(Lo(1),ou(n)),e)}}}},Xp,{kernelName:dr,gradFunc:function(e,t,n){var r=au(n.perm);return{x:function(){return qu(e,r)}}}},{kernelName:mr,gradFunc:function(e,t,n){var r=n.axis;return{value:function(){return Lu(e,r)}}}},{kernelName:gr,inputsToSave:["segmentIds"],gradFunc:function(e,t){var n=N(t,1)[0];return{x:function(){return function(e,t){for(var n=Ys(t,ju(t)),r=Fs(e,n),a=Ps(t,Lo(0,"int32")),i=r.rank-a.rank,o=0;o<i;++o)a=Ms(a,o+1);a=qs(a,pu(r.shape,"bool"));var s=ju(r);return Gu(a,r,s)}(e,n)}}}},{kernelName:yr,gradFunc:function(e){return{x:function(){return ju(e)}}}}];Kp<Yp.length;Kp++){Ar(Yp[Kp])}aa().prototype.abs=function(){return this.throwIfDisposed(),zo(this)};var Zp=Ra({acos_:function(e){var t={x:Aa(e,"x","acos")};return _a.runKernel(De,t)}});aa().prototype.acos=function(){return this.throwIfDisposed(),Zp(this)};var Qp=Ra({acosh_:function(e){var t={x:Aa(e,"x","acosh")};return _a.runKernel(Re,t)}});aa().prototype.acosh=function(){return this.throwIfDisposed(),Qp(this)},aa().prototype.add=function(e){return this.throwIfDisposed(),Bo(this,e)},aa().prototype.all=function(e,t){return this.throwIfDisposed(),Vo(this,e,t)},aa().prototype.any=function(e,t){return this.throwIfDisposed(),Wo(this,e,t)},aa().prototype.argMax=function(e){return this.throwIfDisposed(),Uo(this,e)};var $p=Ra({argMin_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Aa(e,"x","argMin"),r={x:n},a={axis:t};return _a.runKernel(Be,r,a)}});aa().prototype.argMin=function(e){return this.throwIfDisposed(),$p(this,e)},aa().prototype.asScalar=function(){return this.throwIfDisposed(),G(1===this.size,(function(){return"The array must have only 1 element."})),as(this,[])},aa().prototype.asType=function(e){return this.throwIfDisposed(),Bi(this,e)},aa().prototype.as1D=function(){return this.throwIfDisposed(),as(this,[this.size])},aa().prototype.as2D=function(e,t){return this.throwIfDisposed(),as(this,[e,t])},aa().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),as(this,[e,t,n])},aa().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),as(this,[e,t,n,r])},aa().prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),as(this,[e,t,n,r,a])};var Jp=Ra({asin_:function(e){var t={x:Aa(e,"x","asin")};return _a.runKernel(Ve,t)}});aa().prototype.asin=function(){return this.throwIfDisposed(),Jp(this)};var ef=Ra({asinh_:function(e){var t={x:Aa(e,"x","asinh")};return _a.runKernel(We,t)}});aa().prototype.asinh=function(){return this.throwIfDisposed(),ef(this)};var tf=Ra({atan_:function(e){var t={x:Aa(e,"x","atan")};return _a.runKernel(Ue,t)}});aa().prototype.atan=function(){return this.throwIfDisposed(),tf(this)};var nf=Ra({atan2_:function(e,t){var n=Aa(e,"a","atan2"),r=Aa(t,"b","atan2"),a=N(da(n,r),2),i={a:n=a[0],b:r=a[1]};return _a.runKernel(Ge,i)}});aa().prototype.atan2=function(e){return this.throwIfDisposed(),nf(this,e)};var rf=Ra({atanh_:function(e){var t={x:Aa(e,"x","atanh")};return _a.runKernel(He,t)}});aa().prototype.atanh=function(){return this.throwIfDisposed(),rf(this)},aa().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),is(this,e,t,n,r)},aa().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),Gp(this,e,t)},aa().prototype.batchNorm=function(e,t,n,r,a){return this.throwIfDisposed(),ss(this,e,t,n,r,a)},aa().prototype.broadcastTo=function(e){return this.throwIfDisposed(),Hu(this,e)},aa().prototype.cast=function(e){return this.throwIfDisposed(),Bi(this,e)};var af=Ra({ceil_:function(e){var t={x:Aa(e,"x","ceil")};return _a.runKernel(Je,t)}});aa().prototype.ceil=function(){return this.throwIfDisposed(),af(this)},aa().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),hs(this,e,t)},aa().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof ra&&(e=[e]),ps([this].concat(I(e)),t)},aa().prototype.conv1d=function(e,t,n,r,a,i){return this.throwIfDisposed(),ys(this,e,t,n,r,a,i)},aa().prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),xs(this,e,t,n,r,a)},aa().prototype.conv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),gs(this,e,t,n,r,a,i)},aa().prototype.cos=function(){return this.throwIfDisposed(),Pp(this)},aa().prototype.cosh=function(){return this.throwIfDisposed(),Bp(this)},aa().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),Th(this,e,t,n)};var of=Ra({depthToSpace_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",r=Aa(e,"x","depthToSpace"),a="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];G(a*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(r.shape)})),G(i*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(i," and ").concat(t," for depthToSpace with input shape\n        ").concat(r.shape)})),G(o%(t*t)===0,(function(){return"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(o," for depthToSpace with input shape ").concat(r.shape)}));var s={x:r},u={blockSize:t,dataFormat:n};return _a.runKernel(vt,s,u)}});aa().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),of(this,e,t)},aa().prototype.depthwiseConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),ws(this,e,t,n,r,a,i)};var sf=Ra({dilation2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=Aa(e,"x","dilation2d"),s=Aa(t,"filter","dilation2d");G(3===o.rank||4===o.rank,(function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(o.rank,".")})),G(3===s.rank,(function(){return"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(s.rank,".")})),G("NHWC"===i,(function(){return"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(i)}));var u=o,l=!1;3===o.rank&&(u=as(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=!0);var c={x:u,filter:s},h={strides:n,pad:r,dilations:a},p=_a.runKernel(xt,c,h);return l?as(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});aa().prototype.dilation2d=function(e,t,n,r,a){return this.throwIfDisposed(),sf(this,e,t,n,r,a)};var uf=Ra({divNoNan_:function(e,t){var n=Aa(e,"a","div"),r=Aa(t,"b","div"),a=N(da(n,r),2);n=a[0],r=a[1];var i=Ss(n,r),o=ju(i),s=Es(r,o);return Gu(s,o,i)}});aa().prototype.divNoNan=function(e){return this.throwIfDisposed(),uf(this,e)},aa().prototype.div=function(e){return this.throwIfDisposed(),Ss(this,e)};var lf=Ra({dot_:function(e,t){var n=Aa(e,"t1","dot"),r=Aa(t,"t2","dot");G((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];if(G(a===i,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+"".concat(a," and ").concat(i,".")})),1===n.rank&&1===r.rank){var o=as(n,[1,-1]),s=as(r,[-1,1]),u=hl(o,s);return as(u,[])}if(1===n.rank&&2===r.rank){var l=as(n,[1,-1]),c=as(r,[r.shape[0],r.shape[1]]),h=hl(l,c);return as(h,[h.size])}if(2===n.rank&&1===r.rank){var p=as(r,[-1,1]),f=hl(n,p);return as(f,[f.size])}var d=as(r,[r.shape[0],r.shape[1]]);return hl(n,d)}});aa().prototype.dot=function(e){return this.throwIfDisposed(),lf(this,e)},aa().prototype.elu=function(){return this.throwIfDisposed(),Is(this)},aa().prototype.equal=function(e){return this.throwIfDisposed(),Es(this,e)};var cf=Ra({erf_:function(e){var t=Aa(e,"x","erf");G("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=Bi(t,"float32"));var n={x:t};return _a.runKernel(Ct,n)}});aa().prototype.erf=function(){return this.throwIfDisposed(),cf(this)},aa().prototype.exp=function(){return this.throwIfDisposed(),Vs(this)},aa().prototype.expandDims=function(e){return this.throwIfDisposed(),Ms(this,e)};var hf=Ra({expm1_:function(e){var t={x:Aa(e,"x","expm1")};return _a.runKernel(Mt,t)}});aa().prototype.expm1=function(){return this.throwIfDisposed(),hf(this)},aa().prototype.fft=function(){return this.throwIfDisposed(),Zu(this)},aa().prototype.flatten=function(){return this.throwIfDisposed(),as(this,[this.size])},aa().prototype.floor=function(){return this.throwIfDisposed(),Os(this)},aa().prototype.floorDiv=function(e){return this.throwIfDisposed(),_s(this,e)},aa().prototype.gather=function(e,t){return this.throwIfDisposed(),Fs(this,e,t)},aa().prototype.greaterEqual=function(e){return this.throwIfDisposed(),Ps(this,e)},aa().prototype.greater=function(e){return this.throwIfDisposed(),Ls(this,e)},aa().prototype.ifft=function(){return this.throwIfDisposed(),$u(this)},aa().prototype.irfft=function(){return this.throwIfDisposed(),Ju(this)};var pf=Ra({isFinite_:function(e){var t={x:Aa(e,"x","isFinite")};return _a.runKernel(Gt,t)}});aa().prototype.isFinite=function(){return this.throwIfDisposed(),pf(this)};var ff=Ra({isInf_:function(e){var t={x:Aa(e,"x","isInf")};return _a.runKernel(jt,t)}});aa().prototype.isInf=function(){return this.throwIfDisposed(),ff(this)};var df=Ra({isNaN_:function(e){var t={x:Aa(e,"x","isNaN")};return _a.runKernel(qt,t)}});aa().prototype.isNaN=function(){return this.throwIfDisposed(),df(this)},aa().prototype.leakyRelu=function(e){return this.throwIfDisposed(),zs(this,e)},aa().prototype.lessEqual=function(e){return this.throwIfDisposed(),Hl(this,e)},aa().prototype.less=function(e){return this.throwIfDisposed(),rp(this,e)};var vf=Ra({localResponseNormalization_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,i=Aa(e,"x","localResponseNormalization");G(4===i.rank||3===i.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(i.rank,".")})),G(Z(t),(function(){return"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,".")}));var o=i,s=!1;3===i.rank&&(s=!0,o=as(i,[1,i.shape[0],i.shape[1],i.shape[2]]));var u={x:o},l={depthRadius:t,bias:n,alpha:r,beta:a},c=_a.runKernel(nn,u,l);return s?as(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});aa().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),vf(this,e,t,n,r)};var mf=Ra({logSigmoid_:function(e){var t=Aa(e,"x","logSigmoid"),n=Fo((function(e){return{value:uu(Du(uu(e))),gradFunc:function(t){return Us(t,Iu(uu(e)))}}}));return n(t)}});aa().prototype.logSigmoid=function(){return this.throwIfDisposed(),mf(this)},aa().prototype.logSoftmax=function(e){return this.throwIfDisposed(),js(this,e)},aa().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),rc(this,e,t)},aa().prototype.log=function(){return this.throwIfDisposed(),Bs(this)},aa().prototype.log1p=function(){return this.throwIfDisposed(),tc(this)},aa().prototype.logicalAnd=function(e){return this.throwIfDisposed(),qs(this,e)},aa().prototype.logicalNot=function(){return this.throwIfDisposed(),Dp(this)};var gf=Ra({logicalOr_:function(e,t){var n=Aa(e,"a","logicalOr","bool"),r=Aa(t,"b","logicalOr","bool");Ns(n.shape,r.shape);var a={a:n,b:r};return _a.runKernel(tn,a)}});aa().prototype.logicalOr=function(e){return this.throwIfDisposed(),gf(this,e)};var yf=Ra({logicalXor_:function(e,t){var n=Aa(e,"a","logicalXor","bool"),r=Aa(t,"b","logicalXor","bool");return Ns(n.shape,r.shape),qs(gf(e,t),Dp(qs(e,t)))}});aa().prototype.logicalXor=function(e){return this.throwIfDisposed(),yf(this,e)},aa().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),hl(this,e,t,n)},aa().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),Xs(this,e,t,n,r)},aa().prototype.max=function(e,t){return this.throwIfDisposed(),Ws(this,e,t)},aa().prototype.maximum=function(e){return this.throwIfDisposed(),Ys(this,e)},aa().prototype.mean=function(e,t){return this.throwIfDisposed(),Zs(this,e,t)},aa().prototype.min=function(e,t){return this.throwIfDisposed(),Qs(this,e,t)},aa().prototype.minimum=function(e){return this.throwIfDisposed(),$s(this,e)};var bf=Ra({mirrorPad_:function(e,t,n){G("reflect"===n||"symmetric"===n,(function(){return"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")}));var r=Aa(e,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");G(t.length===r.rank,(function(){return"Padding doesn't match input. Must be ".concat(r.rank,". ")+"Got ".concat(t.length,".")}));for(var a="reflect"===n?1:0,i=function(e){G(2===t[e].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),G(t[e][0]>=0&&t[e][0]<=r.shape[e]-a&&t[e][1]>=0&&t[e][1]<=r.shape[e]-a,(function(){return"Padding in dimension ".concat(e," cannot be greater than or equal ")+"to ".concat(r.shape[e]-a," or less than 0 for input of ")+"shape ".concat(r.shape)}))},o=0;o<r.rank;o++)i(o);var s={paddings:t,mode:n},u={x:r};return _a.runKernel(vn,u,s)}});aa().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),bf(this,e,t)};var xf=Ra({mod_:function(e,t){var n=Aa(e,"a","mod"),r=Aa(t,"b","mod"),a=N(da(n,r),2),i={a:n=a[0],b:r=a[1]};return _a.runKernel(mn,i)}});aa().prototype.mod=function(e){return this.throwIfDisposed(),xf(this,e)},aa().prototype.mul=function(e){return this.throwIfDisposed(),Us(this,e)},aa().prototype.neg=function(){return this.throwIfDisposed(),uu(this)},aa().prototype.norm=function(e,t,n){return this.throwIfDisposed(),Kl(this,e,t,n)},aa().prototype.notEqual=function(e){return this.throwIfDisposed(),lu(this,e)},aa().prototype.oneHot=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),cu(this,e,t,n)},aa().prototype.onesLike=function(){return this.throwIfDisposed(),fu(this)},aa().prototype.pad=function(e,t){return this.throwIfDisposed(),du(this,e,t)};var kf=Ra({pool_:function(e,t,n,r,a,i){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");var o=Aa(e,"x","maxPool"),s=o,u=!1;3===o.rank&&(u=!0,s=as(o,[1,o.shape[0],o.shape[1],o.shape[2]])),G(ns(i,a),(function(){return"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(a,"'")}));var l,c=Go(s.shape,t,i,a,r),h=[c.dilationHeight,c.dilationWidth];l="same"===r?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})).map((function(e){return e-1})),r=n.map((function(e){return Math.floor(e/2)})),a=n.map((function(e,t){return e-r[t]}));return n.map((function(e,t){return[r[t],a[t]]}))}([c.filterHeight,c.filterWidth],h):[[0,0],[0,0]];var p=1===h[0]&&1===h[1],f=function(e,t,n){var r=n.map((function(e){return e[0]})),a=n.map((function(e){return e[1]})),i=e.concat(r,a),o=t.map((function(e,t){return(e-i[t]%e)%e})),s=a.map((function(e,t){return e+o[t]})),u=t.map((function(e,t){return[r[t],s[t]]})),l=t.map((function(e,t){return[0,o[t]]}));return[u,l]}([c.inHeight,c.inWidth],h,l),d=N(f,2),v=d[0],m=d[1],g=p?r:"valid",y=p?s:ch(s,h,v),b=("avg"===n?function(){return is(y,t,i,g)}:function(){return Xs(y,t,i,g)})(),x=p?b:Gp(b,h,m);return u?as(x,[x.shape[1],x.shape[2],x.shape[3]]):x}});aa().prototype.pool=function(e,t,n,r,a){return this.throwIfDisposed(),kf(this,e,t,n,r,a)},aa().prototype.pow=function(e){return this.throwIfDisposed(),ql(this,e)},aa().prototype.prelu=function(e){return this.throwIfDisposed(),vu(this,e)};var wf=Ra({prod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Aa(e,"x","prod");"bool"===r.dtype&&(r=Bi(r,"int32"));var a={x:r},i={axis:t,keepDims:n};return _a.runKernel(Mn,a,i)}});aa().prototype.prod=function(e,t){return this.throwIfDisposed(),wf(this,e,t)};var _f=Ra({reciprocal_:function(e){var t={x:Aa(e,"x","reciprocal")};return _a.runKernel(Rn,t)}});aa().prototype.reciprocal=function(){return this.throwIfDisposed(),_f(this)},aa().prototype.relu=function(){return this.throwIfDisposed(),ku(this)},aa().prototype.relu6=function(){return this.throwIfDisposed(),tl(this)},aa().prototype.reshapeAs=function(e){return this.throwIfDisposed(),as(this,e.shape)},aa().prototype.reshape=function(e){return this.throwIfDisposed(),as(this,e)},aa().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),Vl(this,e,t,n)},aa().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),Wl(this,e,t,n)},aa().prototype.reverse=function(e){return this.throwIfDisposed(),wu(this,e)},aa().prototype.rfft=function(){return this.throwIfDisposed(),Qu(this)};var Sf=Ra({round_:function(e){var t={x:Aa(e,"x","round")};return _a.runKernel(Un,t)}});aa().prototype.round=function(){return this.throwIfDisposed(),Sf(this)},aa().prototype.rsqrt=function(){return this.throwIfDisposed(),zh(this)},aa().prototype.selu=function(){return this.throwIfDisposed(),_u(this)},aa().prototype.separableConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Su(this,e,t,n,r,a,i)},aa().prototype.sigmoid=function(){return this.throwIfDisposed(),Iu(this)};var If=Ra({sign_:function(e){var t={x:Aa(e,"x","sign")};return _a.runKernel(Zn,t)}});aa().prototype.sign=function(){return this.throwIfDisposed(),If(this)},aa().prototype.sin=function(){return this.throwIfDisposed(),_h(this)},aa().prototype.sinh=function(){return this.throwIfDisposed(),Ih(this)},aa().prototype.slice=function(e,t){return this.throwIfDisposed(),Cu(this,e,t)},aa().prototype.softmax=function(e){return this.throwIfDisposed(),Au(this,e)},aa().prototype.softplus=function(){return this.throwIfDisposed(),Du(this)},aa().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),ch(this,e,t)},aa().prototype.split=function(e,t){return this.throwIfDisposed(),Ru(this,e,t)},aa().prototype.sqrt=function(){return this.throwIfDisposed(),Ou(this)},aa().prototype.square=function(){return this.throwIfDisposed(),ou(this)},aa().prototype.squaredDifference=function(e){return this.throwIfDisposed(),ec(this,e)},aa().prototype.squeeze=function(e){return this.throwIfDisposed(),Fu(this,e)},aa().prototype.stack=function(e,t){this.throwIfDisposed();var n=e instanceof ra?[this,e]:[this].concat(I(e));return Lu(n,t)},aa().prototype.step=function(e){return this.throwIfDisposed(),nl(this,e)};var Cf=Ra({stridedSlice_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,l=Aa(e,"x","stridedSlice"),c={x:l},h={begin:t,end:n,strides:r,beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:u};return _a.runKernel(ur,c,h)}});aa().prototype.stridedSlice=function(e,t,n,r,a,i,o,s){return this.throwIfDisposed(),Cf(this,e,t,n,r,a,i,o,s)},aa().prototype.sub=function(e){return this.throwIfDisposed(),Hs(this,e)},aa().prototype.sum=function(e,t){return this.throwIfDisposed(),Gs(this,e,t)};var Tf=Ra({tan_:function(e){var t={x:Aa(e,"x","tan")};return _a.runKernel(lr,t)}});aa().prototype.tan=function(){return this.throwIfDisposed(),Tf(this)},aa().prototype.tanh=function(){return this.throwIfDisposed(),Pu(this)},aa().prototype.tile=function(e){return this.throwIfDisposed(),As(this,e)},aa().prototype.toBool=function(){return this.throwIfDisposed(),Bi(this,"bool")},aa().prototype.toFloat=function(){return this.throwIfDisposed(),Bi(this,"float32")},aa().prototype.toInt=function(){return this.throwIfDisposed(),Bi(this,"int32")};var Nf=Ra({topk_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Aa(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var a=r.shape[r.shape.length-1];if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(a,") ")+"but got ".concat(t));var i={x:r},o={k:t,sorted:n},s=_a.runKernel(pr,i,o),u=N(s,2),l=u[0],c=u[1];return{values:l,indices:c}}});aa().prototype.topk=function(e,t){return this.throwIfDisposed(),Nf(this,e,t)},aa().prototype.transpose=function(e){return this.throwIfDisposed(),qu(this,e)};var Ef,Mf=Ra({unique_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Aa(e,"x","unique","string_or_numeric");G(n.rank>0,(function(){return"The input tensor must be at least 1D"}));var r={x:n},a={axis:t},i=_a.runKernel(vr,r,a),o=N(i,2),s=o[0],u=o[1];return{values:s,indices:u}}});function Af(){return null==Ef&&(Ef=_a.backend.epsilon()),Ef}function Df(e,t,n){return Df=jr()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&Ur(a,n.prototype),a},Df.apply(null,arguments)}function Rf(e){var t="function"===typeof Map?new Map:void 0;return Rf=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return Df(e,arguments,Gr(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Ur(n,e)},Rf(e)}aa().prototype.unique=function(e){return this.throwIfDisposed(),Mf(this,e)},aa().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),Vh(this,e,t)},aa().prototype.unstack=function(e){return this.throwIfDisposed(),Wu(this,e)},aa().prototype.where=function(e,t){return this.throwIfDisposed(),Gu(e,this,t)},aa().prototype.zerosLike=function(){return this.throwIfDisposed(),ju(this)};var Of=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),r=t.call(this,e),Object.setPrototypeOf(qr(r),n.prototype),r}return R(n)}(Rf(Error)),Ff=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),r=t.call(this,e),Object.setPrototypeOf(qr(r),n.prototype),r}return R(n)}(Rf(Error)),Lf=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),r=t.call(this,e),Object.setPrototypeOf(qr(r),n.prototype),r}return R(n)}(Rf(Error)),Pf=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),r=t.call(this,e),Object.setPrototypeOf(qr(r),n.prototype),r}return R(n)}(Rf(Error)),zf=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),r=t.call(this,e),Object.setPrototypeOf(qr(r),n.prototype),r}return R(n)}(Rf(Error));Error;function Bf(e,t){if(Array.isArray(e)){for(var n=[],r=0;r<t;r++)n=n.concat(e);return n}var a=new Array(t);return a.fill(e),a}function Vf(e,t){if(!e)throw new zf(t)}function Wf(e,t){var n,r=0,a=L(e);try{for(a.s();!(n=a.n()).done;){n.value===t&&r++}}catch($8){a.e($8)}finally{a.f()}return r}function Uf(e){return 1===e.length?e[0]:e}function Hf(e){return Array.isArray(e)?e:[e]}function Gf(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function jf(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(function(e,t){return t.toUpperCase()}))}var qf={};function Xf(e){if(null===e||void 0===e)return null;var t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function Kf(e){if(null!=e&&"object"===typeof e)if(Array.isArray(e))e.forEach((function(e){return Kf(e)}));else for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],a=e[r];null!=a&&"object"===typeof a&&(Array.isArray(a)||"ndarray"!==a.type||"number"!==typeof a.value?Kf(a):e[r]=a.value)}}function Yf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"===typeof e){var i,o=e;if(o in n)i=n[o];else if(o in qf)i=qf[o];else if(null==(i=t[o]))throw new Lf("Unknown ".concat(r,": ").concat(e,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return i}var s=e;if(null==s.className||null==s.config)throw new Lf("".concat(r,": Improper config format: ")+"".concat(JSON.stringify(s),".\n")+"'className' and 'config' must set.");var u,l,c=s.className;if(c in n){var h=N(n[c],2);u=h[0],l=h[1]}else if(c in qf){var p=N(qf.className,2);u=p[0],l=p[1]}else if(c in t){var f=N(t[c],2);u=f[0],l=f[1]}if(null==u)throw new Lf("Unknown ".concat(r,": ").concat(c,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=l){for(var d={},v=0,m=Object.keys(qf);v<m.length;v++){var g=m[v];d[g]=qf[g]}for(var y=0,b=Object.keys(n);y<b.length;y++){var x=b[y];d[x]=n[x]}var k=s.config;k.customObjects=d;for(var w=Object.assign({},qf),_=0,S=Object.keys(n);_<S.length;_++){var I=S[_];qf[I]=n[I]}Kf(s.config);var C=l(u,s.config,n,a);return qf=Object.assign({},w),C}for(var T=Object.assign({},qf),E=0,M=Object.keys(n);E<M.length;E++){var A=M[E];qf[A]=n[A]}var D=new u(s.config);return qf=Object.assign({},T),D}function Zf(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function Qf(e){if(null==e)return e;var t,n=[],r=L(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;-1===n.indexOf(a)&&n.push(a)}}catch($8){r.e($8)}finally{r.f()}return n}function $f(e){if(null==e)throw new Lf("Invalid value in obj: ".concat(JSON.stringify(e)));for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function Jf(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new Lf("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function ed(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return Vf(n>=0),Vf(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every((function(e){return typeof e===t}))}function td(e,t){Array.isArray(e)?(G(e.length>0,(function(){return"".concat(t," is unexpectedly an empty array.")})),e.forEach((function(e,n){return td(e,"element ".concat(n+1," of ").concat(t))}))):G(Number.isInteger(e)&&e>0,(function(){return"Expected ".concat(t," to be a positive integer, but got ")+"".concat(nd(e),".")}))}function nd(e){return null===e?"null":Array.isArray(e)?"["+e.map((function(e){return nd(e)})).join(",")+"]":"string"===typeof e?'"'.concat(e,'"'):"".concat(e)}function rd(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}function ad(e,t){return Mo((function(){return Ou(Gs(Us(e,e),t,!0))}))}var id=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"getConfig",value:function(){return{}}}]),n}(Io),od=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this)).defaultMaxValue=2,r.defaultAxis=0,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return R(n,[{key:"apply",value:function(e){var t=this;return Mo((function(){var n=ad(e,t.axis),r=hs(n,0,t.maxValue);return Us(e,Ss(r,Bo(Af(),n)))}))}},{key:"getConfig",value:function(){return{maxValue:this.maxValue,axis:this.axis}}}]),n}(id);od.className="MaxNorm",To(od);var sd=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this)).defaultAxis=0,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return R(n,[{key:"apply",value:function(e){var t=this;return Mo((function(){return Ss(e,Bo(Af(),ad(e,t.axis)))}))}},{key:"getConfig",value:function(){return{axis:this.axis}}}]),n}(id);sd.className="UnitNorm",To(sd);var ud=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"apply",value:function(e){return ku(e)}}]),n}(id);ud.className="NonNeg",To(ud);var ld=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this)).defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=null!=e.minValue?e.minValue:r.defaultMinValue,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.rate=null!=e.rate?e.rate:r.defaultRate,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return R(n,[{key:"apply",value:function(e){var t=this;return Mo((function(){var n=ad(e,t.axis),r=Bo(Us(t.rate,hs(n,t.minValue,t.maxValue)),Us(1-t.rate,n));return Us(e,Ss(r,Bo(Af(),n)))}))}},{key:"getConfig",value:function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}]),n}(id);ld.className="MinMaxNorm",To(ld);var cd={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function hd(e){return Xf(e)}function pd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Yf(e,Co.getMap().classNameMap,t,"constraint")}function fd(e){return null==e?null:"string"===typeof e?pd({className:e in cd?cd[e]:e,config:{}}):e instanceof id?e:pd(e)}var dd=["channelsFirst","channelsLast"],vd=["nearest","bilinear"],md=["valid","same","causal"],gd=["max","avg"],yd=["sum","mul","concat","ave"],bd=new Map;function xd(e){Jf(dd,"DataFormat",e)}function kd(e){Jf(md,"PaddingMode",e)}function wd(e){Jf(gd,"PoolMode",e)}var _d=[];function Sd(e,t){_d.push(e);try{var n=t();return _d.pop(),n}catch(tY){throw _d.pop(),tY}}function Id(e){if(!Nd(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===_d.length?"":_d.join("/")+"/")+e}function Cd(e){if(!Nd(e))throw new Error("Not a valid tensor name: '"+e+"'");bd.has(e)||bd.set(e,0);var t=bd.get(e);if(bd.set(e,bd.get(e)+1),t>0){var n="".concat(e,"_").concat(t);return bd.set(n,1),n}return e}var Td=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function Nd(e){return!!e.match(Td)}function Ed(e,t,n){null==t&&(t=0),null==n&&(n=e.length);for(var r=1,a=t;a<n;++a)r*=e[a];return r}function Md(e){return zu(e=Array.isArray(e)?new Float32Array(e):e)}function Ad(e){return Qs(Md(e)).dataSync()[0]}function Dd(e){return Ws(Md(e)).dataSync()[0]}function Rd(e,t){if(t<e)throw new Lf("end (".concat(t,") < begin (").concat(e,") is forbidden."));for(var n=[],r=e;r<t;++r)n.push(r);return n}function Od(e,t){return e.asType(t)}function Fd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),e.reshape(n)}function Ld(e){var t=[Ed(e.shape)];return e.reshape(t)}function Pd(e,t,n){return Mo((function(){switch(e.rank){case 1:return Tu(e,t,n);case 2:return Nu(e,[t,0],[n,e.shape[1]]);case 3:return Eu(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return Mu(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return Cu(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return Cu(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new Lf("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function zd(e,t,n){return Mo((function(){switch(e.rank){case 1:return Tu(e,t,n);case 2:return Nu(e,[0,t],[e.shape[0],n]);case 3:return Eu(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return Mu(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new Lf("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function Bd(e,t,n,r){return Mo((function(){switch(e.rank){case 1:return Tu(e,t,n);case 2:switch(r){case 1:return Pd(e,t,n);case 2:return zd(e,t,n);default:throw new Lf("The axis is not within the rank of the tensor "+"".concat(r))}case 3:switch(r){case 1:return Pd(e,t,n);case 2:return Eu(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return zd(e,t,n);default:throw new Lf("The axis is not within the rank of the tensor "+"".concat(r))}case 4:switch(r){case 1:return Pd(e,t,n);case 2:return Mu(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return Mu(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return zd(e,t,n);default:throw new Lf("The axis is not within the rank of the tensor "+"".concat(r))}default:throw new Lf("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function Vd(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(n=0!==(t=e[0].rank)?t:0),n===e[0].rank&&(n=-1),ps(e,n)}function Wd(e,t){switch(e.rank){case 1:return fs([e,t]);case 2:return ds([e,t],0);case 3:return vs([e,t],0);case 4:return ms([e,t],0);default:throw new Lf("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(e.rank))}}function Ud(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new Lf("The length of input n (".concat(t.length,") does not match ")+"the number of dimensions in input x (".concat(e.rank,")"));return As(e,t)}function Hd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;return bu(e,t,n,r,a)}function Gd(e,t,n,r){if(e.rank<2||t.rank<2)throw new Pf("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3&&e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new Pf("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(e.shape," and ")+" y shape = ".concat(t.shape));if(2===e.rank&&2===t.rank){return pl({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?Xd(e.rank,r,"channelsLast"):null,activation:n})}var a=e.shape.slice(),i=a.pop();e=e.reshape([-1,i]);var o=t.shape.slice(),s=o.pop(),u=o.pop(),l=[].concat(I(o),[s]),c=Array.from({length:t.rank},(function(e,n){return 0===n?t.rank-2:n<=t.rank-2?n-1:n}));t=t.transpose(c).reshape([u,-1]);var h=[].concat(I(a),I(l));return pl({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?Xd(e.rank,r,"channelsLast"):null,activation:n}).reshape(h)}function jd(e,t,n){return Mo((function(){return t=Array.isArray(t)?zu(t,"int32"):t.toInt(),Fs(e,t,n)}))}function qd(e){return Us(e,e)}function Xd(e,t,n){var r=t.shape;if(1!==t.rank&&t.rank!==e)throw new Lf("Unexpected bias dimensions: ".concat(t.rank)+"; expected it to be 1 or ".concat(e));if(5===e){if("channelsFirst"===n)return 1===r.length?t.reshape([1,r[0],1,1,1]):t.reshape([1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?t.reshape([1,1,1,1,r[0]]):t.reshape([1].concat(r))}else if(4===e){if("channelsFirst"===n)return 1===r.length?t.reshape([1,r[0],1,1]):t.reshape([1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?t.reshape([1,1,1,r[0]]):t.reshape([1].concat(r))}else if(3===e){if("channelsFirst"===n)return 1===r.length?t.reshape([1,r[0],1]):t.reshape([1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?t.reshape([1,1,r[0]]):t.reshape([1].concat(r))}else if(e<3)return t;throw new Lf("Unsupported input rank by biasAdd: ".concat(t.rank))}function Kd(e,t,n){return Mo((function(){return null==n&&(n="channelsLast"),xd(n),e.add(Xd(e.rank,t,n))}))}function Yd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new Pf("Support for alpha values other than 1 (".concat(t,") is not implemented ")+"yet.");return Is(e)}function Zd(e,t,n,r){return Mo((function(){return Xu(e,t,n,r)}))}function Qd(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?e():t()}var $d=["fanIn","fanOut","fanAvg"],Jd=["normal","uniform","truncatedNormal"];var ev=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"fromConfigUsesCustomObjects",value:function(){return!1}},{key:"getConfig",value:function(){return{}}}]),n}(Io),tv=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"apply",value:function(e,t){return hu(e,t)}}]),n}(ev);tv.className="Zeros",To(tv);var nv=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"apply",value:function(e,t){return pu(e,t)}}]),n}(ev);nv.className="Ones",To(nv);var rv=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;if(A(this,n),r=t.call(this),"object"!==typeof e)throw new Lf("Expected argument of type ConstantConfig but got ".concat(e));if(void 0===e.value)throw new Lf("config must have value set but got ".concat(e));return r.value=e.value,r}return R(n,[{key:"apply",value:function(e,t){var n=this;return Mo((function(){return Us(Lo(n.value),pu(e,t))}))}},{key:"getConfig",value:function(){return{value:this.value}}}]),n}(ev);rv.className="Constant",To(rv);var av=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this)).DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=e.minval||r.DEFAULT_MINVAL,r.maxval=e.maxval||r.DEFAULT_MAXVAL,r.seed=e.seed,r}return R(n,[{key:"apply",value:function(e,t){return xu(e,this.minval,this.maxval,t)}},{key:"getConfig",value:function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}]),n}(ev);av.className="RandomUniform",To(av);var iv=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return R(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new Pf("randomNormal does not support dType ".concat(t,"."));return Hd(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(ev);iv.className="RandomNormal",To(iv);var ov=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return R(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new Pf("truncatedNormal does not support dType ".concat(t,"."));return Vu(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(ev);ov.className="TruncatedNormal",To(ov);var sv=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this)).gain=null!=e.gain?e.gain:1,r}return R(n,[{key:"apply",value:function(e,t){var n=this;return Mo((function(){if(2!==e.length||e[0]!==e[1])throw new Lf("Identity matrix initializer can only be used for 2D square matrices.");return Us(n.gain,Ds(e[0]))}))}},{key:"getConfig",value:function(){return{gain:this.gain}}}]),n}(ev);sv.className="Identity",To(sv);var uv=function(e){Hr(n,e);var t=Kr(n);function n(e){var r,a;if(A(this,n),r=t.call(this),e.scale<0)throw new Lf("scale must be a positive float. Got: ".concat(e.scale));return r.scale=null==e.scale?1:e.scale,r.mode=null==e.mode?"fanIn":e.mode,a=r.mode,Jf($d,"FanMode",a),r.distribution=null==e.distribution?"normal":e.distribution,function(e){Jf(Jd,"Distribution",e)}(r.distribution),r.seed=e.seed,r}return R(n,[{key:"apply",value:function(e,t){var n=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(xd(r),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===r){var a=Ed(e,2);t=e[1]*a,n=e[0]*a}else if("channelsLast"===r){var i=Ed(e,0,e.length-2);t=e[e.length-2]*i,n=e[e.length-1]*i}}else{var o=Ed(e);t=Math.sqrt(o),n=Math.sqrt(o)}return[t,n]}(e),r=n[0],a=n[1],i=this.scale;if("fanIn"===this.mode?i/=Math.max(1,r):"fanOut"===this.mode?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),"normal"===this.distribution){var o=Math.sqrt(i);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new Pf("".concat(this.getClassName()," does not support dType ").concat(t,"."));return Vu(e,0,o,t,this.seed)}var s=Math.sqrt(3*i);return xu(e,-s,s,t)}},{key:"getConfig",value:function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}]),n}(ev);uv.className="VarianceScaling",To(uv);var lv=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}return R(n,[{key:"getClassName",value:function(){return uv.className}}]),n}(uv);lv.className="GlorotUniform",To(lv);var cv=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}return R(n,[{key:"getClassName",value:function(){return uv.className}}]),n}(uv);cv.className="GlorotNormal",To(cv);var hv=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return R(n,[{key:"getClassName",value:function(){return uv.className}}]),n}(uv);hv.className="HeNormal",To(hv);var pv=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return R(n,[{key:"getClassName",value:function(){return uv.className}}]),n}(uv);pv.className="HeUniform",To(pv);var fv=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return R(n,[{key:"getClassName",value:function(){return uv.className}}]),n}(uv);fv.className="LeCunNormal",To(fv);var dv=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return R(n,[{key:"getClassName",value:function(){return uv.className}}]),n}(uv);dv.className="LeCunNormal",To(dv);var vv=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;if(A(this,n),(r=t.call(this)).DEFAULT_GAIN=1,r.gain=null==e.gain?r.DEFAULT_GAIN:e.gain,r.seed=e.seed,null!=r.seed)throw new Pf("Random seed is not implemented for Orthogonal Initializer yet.");return r}return R(n,[{key:"apply",value:function(e,t){var n=this;return Mo((function(){if(e.length<2)throw new Pf("Shape must be at least 2D.");e[0]*e[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than 2000 (".concat(e[0]*e[1],") elements: ")+"Slowness may result.");var t=Hd(e[0]>e[1]?[e[1],e[0]]:e,0,1,"float32"),r=oc.gramSchmidt(t);return e[0]>e[1]&&(r=r.transpose()),Us(n.gain,r)}))}},{key:"getConfig",value:function(){return{gain:this.gain,seed:this.seed}}}]),n}(ev);vv.className="Orthogonal",To(vv);var mv={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function gv(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Yf(e,Co.getMap().classNameMap,t,"initializer")}function yv(e){return Xf(e)}function bv(e){if("string"===typeof e){var t=e in mv?mv[e]:e;if("GlorotNormal"===t)return new cv;if("GlorotUniform"===t)return new lv;if("HeNormal"===t)return new hv;if("HeUniform"===t)return new pv;if("LeCunNormal"===t)return new fv;if("LeCunUniform"===t)return new dv;var n={};return n.className=t,n.config={},gv(n)}return e instanceof ev?e:gv(e)}var xv=0;function kv(){return xv++}var wv={};function _v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in wv||(wv[e]=0),wv[e]+=1,e+wv[e].toString()}function Sv(e){return Array.isArray(e)&&Array.isArray(e[0])}function Iv(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function Cv(e){var t;if(Array.isArray(e)){if(1!==e.length)throw new Lf("Expected Tensor length to be 1; got ".concat(e.length));t=e[0]}else t=e;return t}function Tv(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return e[0];throw new Lf("Expected exactly 1 Shape; got ".concat(e.length))}return e}function Nv(e){var t,n=0,r=L(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;0===a.shape.length?n+=1:n+=a.shape.reduce((function(e,t){return e*t}))}}catch($8){r.e($8)}finally{r.f()}return n}var Ev="Variable",Mv=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ev,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;A(this,e),this.dtype=null==n?"float32":n,this.shape=t.shape,this.id=kv(),r=null==r?Ev:r,this.originalName=Id(r),this.name=Cd(this.originalName),this.trainable_=a,this.constraint=i,this.val=Uu(t,this.trainable_,this.name,this.dtype)}return R(e,[{key:"read",value:function(){return this.assertNotDisposed(),this.val}},{key:"write",value:function(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}},{key:"dispose",value:function(){this.assertNotDisposed(),this.val.dispose()}},{key:"assertNotDisposed",value:function(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.trainable_=e,this.val.trainable=e}}]),e}();function Av(e){return e.map((function(e){return e.read()}))}function Dv(e){e.forEach((function(e){e[0].write(e[1])}))}var Rv=R((function e(t){A(this,e),this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}})),Ov=R((function e(t,n,r,a,i,o,s){A(this,e),this.dtype=t,this.shape=n,this.sourceLayer=r,this.inputs=a,this.callArgs=i,this.outputTensorIndex=s,this.id=kv(),null!=o&&(this.originalName=Id(o),this.name=Cd(this.originalName)),this.rank=n.length})),Fv=0,Lv=function(){function e(t,n){A(this,e),this.callArgs=n,this.id=Fv++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;var r,a=L(t.inboundLayers);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&i.outboundNodes.push(this)}}catch($8){a.e($8)}finally{a.f()}t.outboundLayer.inboundNodes.push(this)}return R(e,[{key:"getConfig",value:function(){var e,t=[],n=L(this.inboundLayers);try{for(n.s();!(e=n.n()).done;){var r=e.value;null!=r?t.push(r.name):t.push(null)}}catch($8){n.e($8)}finally{n.f()}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}]),e}(),Pv=0,zv=function(e){Hr(n,e);var t=Kr(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};A(this,n),(e=t.call(this))._callHook=null,e._addedWeightNames=[],e._stateful=!1,e.id=Pv++,e.activityRegularizer=null,e.inputSpec=null,e.supportsMasking=!1,e._trainableWeights=[],e._nonTrainableWeights=[],e._losses=[],e._updates=[],e._built=!1,e.inboundNodes=[],e.outboundNodes=[];var a=r.name;if(!a){var i=e.getClassName();a=Gf(i)+"_"+_v(i)}if(e.name=a,e.trainable_=null==r.trainable||r.trainable,null!=r.inputShape||null!=r.batchInputShape){var o;if(null!=r.batchInputShape)o=r.batchInputShape;else if(null!=r.inputShape){var s=null;null!=r.batchSize&&(s=r.batchSize),o=[s].concat(r.inputShape)}e.batchInputShape=o;var u=r.dtype;null==u&&(u=r.inputDType),null==u&&(u="float32"),e.dtype=u}return null!=r.weights?e.initialWeights=r.weights:e.initialWeights=null,e._refCount=null,e.fastWeightInitDuringBuild=!1,e}return R(n,[{key:"getNodeAtIndex",value:function(e,t){if(0===this.inboundNodes.length)throw new Ff("The layer has never been called "+"and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new Lf("Asked to get ".concat(t," at node ").concat(e,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}},{key:"getInputAt",value:function(e){return Uf(this.getNodeAtIndex(e,"input").inputTensors)}},{key:"getOutputAt",value:function(e){return Uf(this.getNodeAtIndex(e,"output").outputTensors)}},{key:"input",get:function(){if(this.inboundNodes.length>1)throw new Of("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new Of("Layer ".concat(this.name)+" is not connected, no input to return.");return Uf(this.getNodeAtIndex(0,"input").inputTensors)}},{key:"output",get:function(){if(0===this.inboundNodes.length)throw new Of("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new Of("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return Uf(this.getNodeAtIndex(0,"output").outputTensors)}},{key:"losses",get:function(){return this._losses}},{key:"calculateLosses",value:function(){return this.losses.map((function(e){return e()}))}},{key:"updates",get:function(){return this._updates}},{key:"built",get:function(){return this._built},set:function(e){this._built=e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this._trainableWeights.forEach((function(t){return t.trainable=e})),this.trainable_=e}},{key:"trainableWeights",get:function(){return this.trainable_?this._trainableWeights.filter((function(e){return e.trainable})):[]},set:function(e){this._trainableWeights=e}},{key:"nonTrainableWeights",get:function(){return this.trainable?this._trainableWeights.filter((function(e){return!e.trainable})).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(e){this._nonTrainableWeights=e}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"stateful",get:function(){return this._stateful}},{key:"resetStates",value:function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}},{key:"assertInputCompatibility",value:function(e){if(e=Hf(e),null!=this.inputSpec&&0!==this.inputSpec.length){var t=Hf(this.inputSpec);if(e.length!==t.length)throw new Lf("Layer ".concat(this.name," expects ").concat(t.length," inputs, ")+"but it received ".concat(e.length," input tensors. ")+"Input received: ".concat(e));for(var n=0;n<e.length;n++){var r=e[n],a=t[n];if(null!=a){var i=r.rank;if(null!=a.ndim&&i!==a.ndim)throw new Lf("Input ".concat(n," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(a.ndim,", found ndim=").concat(i));if(null!=a.maxNDim&&i>a.maxNDim)throw new Lf("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(a.maxNDim,", found ndim=").concat(i));if(null!=a.minNDim&&i<a.minNDim)throw new Lf("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(a.minNDim,", found ndim=").concat(i,"."));if(null!=a.dtype&&r.dtype!==a.dtype)throw new Lf("Input ".concat(n," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(a.dtype,", found dtype=").concat(r.dtype,"."));if(a.axes){var o=r.shape;for(var s in a.axes){var u=Number(s),l=a.axes[s],c=u>=0?o[u]:o[o.length+u];if(null!=l&&-1===[l,null].indexOf(c))throw new Lf("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(u," of input shape to ")+"have value ".concat(l," but got shape ").concat(o,"."))}}if(null!=a.shape)for(var h=0;h<a.shape.length;++h){var p=a.shape[h],f=r.shape[h];if(null!=p&&null!=f&&p!==f)throw new Lf("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(a.shape,", ")+"found shape=".concat(r.shape,"."))}}}}}},{key:"call",value:function(e,t){return e}},{key:"invokeCallHook",value:function(e,t){null!=this._callHook&&this._callHook(e,t)}},{key:"setCallHook",value:function(e){this._callHook=e}},{key:"clearCallHook",value:function(){this._callHook=null}},{key:"apply",value:function(e,t){var n=this;t=t||{},this.assertNotDisposed();var r,a=Hf(e),i=!0,o=L(a);try{for(o.s();!(r=o.n()).done;){if(!(r.value instanceof Ov)){i=!1;break}}}catch($8){o.e($8)}finally{o.f()}var s,u=!0,l=L(a);try{for(l.s();!(s=l.n()).done;){if(s.value instanceof Ov){u=!1;break}}}catch($8){l.e($8)}finally{l.f()}if(i===u)throw new Lf("Arguments to apply() must be all SymbolicTensors or all Tensors");return Sd(this.name,(function(){if(!n.built){n.assertInputCompatibility(e);var r,i=[],o=L(Hf(e));try{for(o.s();!(r=o.n()).done;){var s=r.value;i.push(s.shape)}}catch($8){o.e($8)}finally{o.f()}n.build(Uf(i)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights),null===n._refCount&&u&&(n._refCount=1)}if(n.assertInputCompatibility(e),u){var l,c=n.call(e,t),h=[],p=L(Hf(c));try{for(p.s();!(l=p.n()).done;){var f=l.value;-1!==a.indexOf(f)&&(f=f.clone()),h.push(f)}}catch($8){p.e($8)}finally{p.f()}if(c=Uf(h),null!=n.activityRegularizer)throw new Pf("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return c}var d,v=function(e){e=Hf(e);var t,n=[],r=L(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push(a.shape)}}catch($8){r.e($8)}finally{r.f()}return Uf(n)}(e),m=n.computeOutputShape(v),g="float32";if(n.warnOnIncompatibleInputShape(Array.isArray(e)?v[0]:v),d=null!=m&&m.length>0&&Array.isArray(m[0])?m.map((function(r,a){return new Ov(g,r,n,Hf(e),t,n.name,a)})):new Ov(g,m,n,Hf(e),t,n.name),n.addInboundNode(e,d,null,null,v,m,t),n._refCount++,null!=n.activityRegularizer)throw new Pf("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return d}))}},{key:"warnOnIncompatibleInputShape",value:function(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(e),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{var t=!1;this.batchInputShape.forEach((function(n,r){null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)})),t&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(e),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}},{key:"outputShape",get:function(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new Of("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");var e,t=[],n=L(this.inboundNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=JSON.stringify(r.outputShapes);-1===t.indexOf(a)&&t.push(a)}}catch($8){n.e($8)}finally{n.f()}if(1===t.length){var i=this.inboundNodes[0].outputShapes;return Array.isArray(i)&&Array.isArray(i[0])&&1===i.length?i[0]:i}throw new Of("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}},{key:"countParams",value:function(){if(!this.built)throw new Ff("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return Nv(this.weights)}},{key:"build",value:function(e){this.built=!0}},{key:"getWeights",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Av(e?this.trainableWeights:this.weights)}},{key:"setWeights",value:function(e){var t=this;Mo((function(){var n=t.weights;if(n.length!==e.length)throw new Lf('You called setWeights(weights) on layer "'.concat(t.name,'" ')+"with a weight list of length ".concat(e.length,", ")+"but the layer was expecting ".concat(n.length," weights. ")+"Provided weights: ".concat(e,"..."));if(0!==n.length){for(var r=[],a=Av(n),i=0;i<a.length;++i){var o=a[i],s=n[i],u=e[i];if(!Y(o.shape,u.shape))throw new Lf("Layer weight shape ".concat(o.shape," ")+"not compatible with provided weight shape ".concat(u.shape));r.push([s,u])}Dv(r)}}))}},{key:"addWeight",value:function(e,t,n,r,a,i,o){if(-1!==this._addedWeightNames.indexOf(e))throw new Lf("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=bv("zeros"));var s=r.apply(t,n),u=new Mv(s,n,e,i,o);return s.dispose(),null!=a&&this.addLoss((function(){return a.apply(u.read())})),null==i&&(i=!0),i?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}},{key:"setFastWeightInitDuringBuild",value:function(e){this.fastWeightInitDuringBuild=e}},{key:"addLoss",value:function(e){var t;null==e||Array.isArray(e)&&0===e.length||(e=Hf(e),void 0!==this._losses&&null!==this._losses&&(t=this.losses).push.apply(t,I(e)))}},{key:"computeOutputShape",value:function(e){return e}},{key:"computeMask",value:function(e,t){var n=this;if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");t.forEach((function(e){if(null!=e)throw new TypeError("Layer ".concat(n.name," does not support masking, ")+"but was passed an inputMask.")}))}return null}return t}},{key:"addInboundNode",value:function(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=Hf(e);t=Hf(t),n=Hf(n),r=Hf(r),a=Iv(a),i=Iv(i);var u,l=[],c=[],h=[],p=L(s);try{for(p.s();!(u=p.n()).done;){var f=u.value;l.push(f.sourceLayer),c.push(f.nodeIndex),h.push(f.tensorIndex)}}catch($8){p.e($8)}finally{p.f()}new Lv({outboundLayer:this,inboundLayers:l,nodeIndices:c,tensorIndices:h,inputTensors:s,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},o);for(var d=0;d<t.length;d++)t[d].sourceLayer=this,t[d].nodeIndex=this.inboundNodes.length-1,t[d].tensorIndex=d}},{key:"getConfig",value:function(){var e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}},{key:"disposeWeights",value:function(){return this.weights.forEach((function(e){return e.dispose()})),this.weights.length}},{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();var e=0;return 0===--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}],[{key:"nodeKey",value:function(e,t){return e.name+"_ib-"+t.toString()}}]),n}(Io);function Bv(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];var r=t.inboundNodes[n];if(0===r.inboundLayers.length)return r.inputTensors;for(var a=[],i=0;i<r.inboundLayers.length;i++){var o,s=L(Bv(r.inputTensors[i],r.inboundLayers[i],r.nodeIndices[i]));try{for(s.s();!(o=s.n()).done;){var u=o.value;-1===a.indexOf(u)&&a.push(u)}}catch($8){s.e($8)}finally{s.f()}}return a}var Vv,Wv=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;if(A(this,n),r=t.call(this,{dtype:e.dtype,name:null!=e.name?e.name:_v("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new Lf("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var a=e.batchInputShape;if(null==a){if(null==e.inputShape)throw new Lf("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");a=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new Lf("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var i=e.dtype||"float32";r.batchInputShape=a,r.dtype=i,r.inputSpec=[{shape:a}];var o=new Ov(r.dtype,r.batchInputShape,qr(r),[],{},r.name);return o.nodeIndex=0,o.tensorIndex=0,new Lv({outboundLayer:qr(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[a],outputShapes:[a]}),r}return R(n,[{key:"apply",value:function(e,t){throw new Lf("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}},{key:"dispose",value:function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}},{key:"getConfig",value:function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}]),n}(zv);function Uv(e){return Hv.apply(this,arguments)}function Hv(){return Hv=F(M().mark((function e(t){var n,r,a,i,o,s,u,l;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}return e.abrupt("return");case 2:for(i in n=[],r=[],a=[],t)"number"!==typeof(o=t[i])&&(s=o,n.push(s.data()),r.push(i),a.push(s));if(!(n.length>0)){e.next=12;break}return e.next=9,Promise.all(n);case 9:for(u=e.sent,l=0;l<u.length;++l)t[r[l]]=u[l][0];Ao(a);case 12:case"end":return e.stop()}}),e)}))),Hv.apply(this,arguments)}function Gv(e){if(null!=e)for(var t in e){var n=e[t];"number"!==typeof n&&n.dispose()}}Wv.className="InputLayer",To(Wv),function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(Vv||(Vv={}));var jv=function(){function e(){A(this,e),this.validationData=null}return R(e,[{key:"setParams",value:function(e){this.params=e}},{key:"onEpochBegin",value:function(){var e=F(M().mark((function e(t,n){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=F(M().mark((function e(t,n){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=F(M().mark((function e(t,n){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=F(M().mark((function e(t,n){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"setModel",value:function(e){}}]),e}(),qv=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;A(this,e),null==t&&(t=[]),this.callbacks=t,this.queueLength=n}return R(e,[{key:"append",value:function(e){this.callbacks.push(e)}},{key:"setParams",value:function(e){var t,n=L(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setParams(e)}}catch($8){n.e($8)}finally{n.f()}}},{key:"setModel",value:function(e){var t,n=L(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setModel(e)}}catch($8){n.e($8)}finally{n.f()}}},{key:"onEpochBegin",value:function(){var e=F(M().mark((function e(t,n){var r,a,i;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=L(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=F(M().mark((function e(t,n){var r,a,i;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=L(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=F(M().mark((function e(t,n){var r,a,i;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=L(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=F(M().mark((function e(t,n){var r,a,i;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=L(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=F(M().mark((function e(t){var n,r,a;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=L(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainBegin(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=F(M().mark((function e(t){var n,r,a;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=L(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainEnd(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Xv=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.call(this)}return R(n,[{key:"onEpochBegin",value:function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.seen=0,this.totals={};case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=F(M().mark((function e(t,n){var r,a,i,o=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i in null==n&&(n={}),r=null==n.size?0:n.size,this.seen+=r,a=function(e){var t=n[e];if("number"===typeof t)o.totals.hasOwnProperty(e)||(o.totals[e]=0),o.totals[e]=o.totals[e]+t*r;else{var a;e in o.totals?a=o.totals[e]:o.totals[e]=0;var i=Mo((function(){return Bo(o.totals[e],Us(t,r))}));o.totals[e]=i,null!=a&&a.dispose()}},n)a(i);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=F(M().mark((function e(t,n){var r,a,i,o=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n){e.next=19;break}r=L(this.params.metrics),e.prev=2,i=function(){var e=a.value;if(null==o.totals[e])return"continue";"number"===typeof o.totals[e]?n[e]=o.totals[e]/o.seen:Mo((function(){var t=Us(Ss(1,o.seen),o.totals[e]);n[e]=t,o.totals[e].dispose(),Do(n[e])}))},r.s();case 5:if((a=r.n()).done){e.next=11;break}if("continue"!==i()){e.next=9;break}return e.abrupt("continue",9);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[2,13,16,19]])})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(jv),Kv=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"onTrainBegin",value:function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.epoch=[],this.history={};case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=F(M().mark((function e(t,n){var r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in null==n&&(n={}),this.epoch.push(t),n)null==this.history[r]&&(this.history[r]=[]),this.history[r].push(n[r]);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"syncData",value:function(){var e=F(M().mark((function e(){var t,n,r,a,i,o,s,u,l;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in t=[],n=[],r=[],this.history)for(i=this.history[a],o=0;o<i.length;++o)"number"!==typeof i[o]&&(s=i[o],t.push(s.data()),n.push(a),r.push(o));return e.next=6,Promise.all(t);case 6:for(u=e.sent,l=0;l<u.length;++l)this.history[n[l]][r[l]].dispose(),this.history[n[l]][r[l]]=u[l][0];case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(jv),Yv=function(e){Hr(n,e);var t=Kr(n);function n(e,r){var a;if(A(this,n),(a=t.call(this)).currentEpoch=0,a.yieldEvery=r||"auto","auto"===a.yieldEvery&&(a.yieldEvery=125),"never"===a.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return le(a.yieldEvery)&&(a.maybeWait=function(e,t){var n,r=Fr();return function(){var a=Fr();return a-r<t?n:(r=a,n=e.apply(void 0,arguments))}}(a.maybeWait.bind(qr(a)),a.yieldEvery)),a.trainBegin=e.onTrainBegin,a.trainEnd=e.onTrainEnd,a.epochBegin=e.onEpochBegin,a.epochEnd=e.onEpochEnd,a.batchBegin=e.onBatchBegin,a.batchEnd=e.onBatchEnd,a.yield=e.onYield,a}return R(n,[{key:"maybeWait",value:function(){var e=F(M().mark((function e(t,n,r){var a;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],null==this.yield){e.next=5;break}return e.next=4,Uv(r);case 4:a.push(this.yield(t,n,r));case 5:return a.push(gc()),e.next=8,Promise.all(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"onEpochBegin",value:function(){var e=F(M().mark((function e(t,n){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentEpoch=t,null==this.epochBegin){e.next=6;break}return e.next=4,Uv(n);case 4:return e.next=6,this.epochBegin(t,n);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=F(M().mark((function e(t,n){var r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],null==this.epochEnd){e.next=5;break}return e.next=4,Uv(n);case 4:r.push(this.epochEnd(t,n));case 5:return"epoch"===this.yieldEvery&&r.push(gc()),e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=F(M().mark((function e(t,n){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.batchBegin){e.next=5;break}return e.next=3,Uv(n);case 3:return e.next=5,this.batchBegin(t,n);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=F(M().mark((function e(t,n){var r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],null==this.batchEnd){e.next=5;break}return e.next=4,Uv(n);case 4:r.push(this.batchEnd(t,n));case 5:return"batch"===this.yieldEvery?r.push(gc()):le(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,t,n)),e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.trainBegin){e.next=5;break}return e.next=3,Uv(t);case 3:return e.next=5,this.trainBegin(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.trainEnd){e.next=5;break}return e.next=3,Uv(t);case 3:return e.next=5,this.trainEnd(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(jv);function Zv(e,t){return null==e&&(e={}),e instanceof jv?[e]:Array.isArray(e)&&e[0]instanceof jv?e:Hf(e).map((function(e){return new Yv(e,t)}))}var Qv=function(){function e(){A(this,e)}return R(e,null,[{key:"registerCallbackConstructor",value:function(t,n){G(t>=0&&Number.isInteger(t),(function(){return"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(t)})),e.checkForDuplicate(n),null==e.constructors[t]&&(e.constructors[t]=[]),e.constructors[t].push(n)}},{key:"checkForDuplicate",value:function(t){for(var n in e.constructors){e.constructors[+n].forEach((function(e){if(e===t)throw new Lf("Duplicate callback constructor.")}))}}},{key:"clear",value:function(){e.constructors={}}},{key:"createCallbacks",value:function(t){var n=[];for(var r in e.constructors){var a=+r;t>=a&&n.push.apply(n,I(e.constructors[a]))}return n.map((function(e){return new e}))}}]),e}();function $v(e,t,n,r,a,i,o,s,u){var l=new Kv,c=[new Xv].concat(I(Qv.createCallbacks(t)));null!=e&&c.push.apply(c,I(e)),c.push(l);var h=new qv(c);return h.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:o,verbose:t,doValidation:s,metrics:u}),{callbackList:h,history:l}}function Jv(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Gr(e)););return e}function em(){return em="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Jv(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},em.apply(this,arguments)}function tm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Yf(e,Co.getMap().classNameMap,t,"layer",n)}function nm(e,t){return Mo((function(){"float32"!==e.dtype&&(e=e.asType("float32"));var n=Gs(qd(e),t,!0),r=Rs(n.shape,Af()),a=Ou(Ys(n,r));return Ss(e,a)}))}function rm(e,t){return Mo((function(){return Zs(qd(Hs(t,e)),-1)}))}function am(e,t){return Mo((function(){return Zs(zo(Hs(t,e)),-1)}))}function im(e,t){return Mo((function(){var n=Hs(e,t),r=hs(zo(e),Af(),Number.MAX_VALUE),a=zo(Ss(n,r));return Us(100,Zs(a,-1))}))}function om(e,t){return Mo((function(){var n=hs(t,Af(),Number.MAX_VALUE),r=Bs(Bo(1,n)),a=hs(e,Af(),Number.MAX_VALUE),i=Bs(Bo(1,a));return Zs(qd(Hs(r,i)),-1)}))}function sm(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Mo((function(){if(n)t=Au(t);else{var r=Gs(t,t.shape.length-1,!0);t=Ss(t,r)}return t=hs(t,Af(),1-Af()),uu(Gs(Us(e.toFloat(),Bs(t)),t.shape.length-1))}))}function um(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Mo((function(){var r=Os(Ld(e)).toInt(),a=(t=hs(t,Af(),1-Af())).shape;return sm(cu(r,a[a.length-1]).reshape(a),t,n)}))}function lm(e,t){return Mo((function(){var n;return n=hs(t,Af(),1-Af()),n=Bs(Ss(n,Hs(1,n))),Zs(function(e,t){if(!Y(e.shape,t.shape))throw new Lf("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return Mo((function(){var n=t.relu(),r=t.abs().neg();return n.sub(t.mul(e)).add(r.exp().log1p())}))}(e,n),-1)}))}function cm(e,t){return Mo((function(){var n=hs(e,Af(),1),r=hs(t,Af(),1);return Gs(Us(e,Bs(Ss(n,r))),-1)}))}function hm(e,t){return Mo((function(){var n=nm(e,-1),r=nm(t,-1),a=Us(n,r);return uu(Gs(a,-1))}))}Qv.constructors={};var pm={meanSquaredError:rm,meanAbsoluteError:am,meanAbsolutePercentageError:im,meanSquaredLogarithmicError:om,squaredHinge:function(e,t){return Mo((function(){var n=Ys(0,Hs(1,Us(e,t)));return Zs(qd(n),-1)}))},hinge:function(e,t){return Mo((function(){var n=Ys(0,Hs(1,Us(e,t)));return Zs(n,-1)}))},categoricalHinge:function(e,t){return Mo((function(){var n=Gs(Us(e,t),-1),r=Ws(Us(Hs(1,e),t),-1);return Ys(0,Bo(1,Hs(r,n)))}))},logcosh:function(e,t){return Mo((function(){var n=Math.log(2),r=Hs(t,e),a=Hs(Bo(r,Du(Us(-2,r))),n);return Zs(a,-1)}))},categoricalCrossentropy:sm,sparseCategoricalCrossentropy:um,binaryCrossentropy:lm,kullbackLeiblerDivergence:cm,poisson:function(e,t){return Mo((function(){var n=Bs(Bo(Af(),t));return Zs(Hs(t,Us(e,n)),-1)}))},cosineProximity:hm};function fm(e){if("string"===typeof e){if(e in pm)return pm[e];var t="Unknown loss ".concat(e);throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new Lf(t)}return e}function dm(e,t){return Mo((function(){var n=Us(.5,fu(t)),r=Od(Ls(t,n),e.dtype);return Zs(Es(e,r),-1)}))}function vm(e,t){return Mo((function(){return Od(Es(Uo(e,-1),Uo(t,-1)),"float32")}))}function mm(e,t){return Mo((function(){return qs(e.equal(1),t.equal(1)).sum().cast("float32")}))}function gm(e,t){return lm(e,t)}function ym(e,t){return e.rank===t.rank&&(e=e.squeeze([e.rank-1])),(t=t.argMax(-1)).dtype!==e.dtype&&(t=t.asType(e.dtype)),Es(e,t).asType("float32")}var bm=sm,xm=um,km={binaryAccuracy:dm,categoricalAccuracy:vm,precision:function(e,t){return Mo((function(){var n=mm(e,t),r=function(e,t){return Mo((function(){return qs(e.equal(0),t.equal(1)).sum().cast("float32")}))}(e,t),a=n.add(r);return Gu(Ls(a,0),n.div(a),0).cast("float32")}))},categoricalCrossentropy:bm,sparseCategoricalCrossentropy:xm,mse:rm,MSE:rm,mae:am,MAE:am,mape:im,MAPE:im,cosine:hm};function wm(e){if("string"===typeof e&&e in km)return km[e];if("string"!==typeof e&&null!=e)return e;throw new Lf("Unknown metric ".concat(e))}function _m(e){if(Vf(null!==e,"Unknown LossOrMetricFn ".concat(e)),"string"===typeof e)return e;for(var t,n=0,r=Object.keys(pm);n<r.length;n++){var a=r[n];if(pm[a]===e){t=a;break}}if(void 0!==t)return t;for(var i=0,o=Object.keys(km);i<o.length;i++){var s=o[i];if(km[s]===e){t=s;break}}return void 0!==t?t:e.name}var Sm=1048576;function Im(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!==typeof e||Object.getPrototypeOf(e)!==Object.prototype||!Cm(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(e);r.length>Sm&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in ')+"size (length=".concat(r.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(Sm,"."))}}function Cm(e){if(null===e)return!0;if("object"===typeof e){if(Object.getPrototypeOf(e)===Object.prototype){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];if("string"!==typeof r)return!1;if(!Cm(e[r]))return!1}return!0}if(Array.isArray(e)){var a,i=L(e);try{for(i.s();!(a=i.n()).done;){if(!Cm(a.value))return!1}}catch($8){i.e($8)}finally{i.f()}return!0}return!1}var o=typeof e;return"string"===o||"number"===o||"boolean"===o}function Tm(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log,i=Em(e),o=["Layer (type)","Output shape","Param #"];if(i?(t=t||65,n=n||[.45,.85,1]):(t=t||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map((function(e){return Math.floor(t*e)}))),!i)for(var s in o.push("Receives inputs"),r=[],e.nodesByDepth){var u;(u=r).push.apply(u,I(e.nodesByDepth[s]))}a("_".repeat(t)),Mm(o,n,a),a("=".repeat(t));for(var l=e.layers,c=0;c<l.length;++c)i?Am(l[c],n,a):Dm(l[c],n,r,a),a((c===l.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();var h=Nm(e),p=Nv(e.nonTrainableWeights);a("Total params: ".concat(h+p)),a("Trainable params: ".concat(h)),a("Non-trainable params: ".concat(p)),a("_".repeat(t))}function Nm(e){return null!=e.collectedTrainableWeights?Nv(e.collectedTrainableWeights):Nv(e.trainableWeights)}function Em(e){var t=!0,n=[],r=[];for(var a in e.nodesByDepth)n.push(e.nodesByDepth[a]);for(var i=0,o=n;i<o.length;i++){var s=o[i];if(s.length>1||1===s.length&&s[0].inboundLayers.length>1){t=!1;break}r.push.apply(r,I(s))}if(t){var u,l=L(e.layers);try{for(l.s();!(u=l.n()).done;){var c,h=u.value,p=!1,f=L(h.inboundNodes);try{for(f.s();!(c=f.n()).done;){var d=c.value;if(-1!==r.indexOf(d)){if(p){t=!1;break}p=!0}}}catch($8){f.e($8)}finally{f.f()}if(!t)break}}catch($8){l.e($8)}finally{l.f()}}return t}function Mm(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="",a=0;a<e.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=e[a]).slice(0,t[a]),r+=" ".repeat(t[a]-r.length);n(r)}function Am(e,t,n){var r;try{r=JSON.stringify(e.outputShape)}catch($8){r="multiple"}var a=e.name,i=e.getClassName();Mm(["".concat(a," (").concat(i,")"),r,e.countParams().toString()],t,n)}function Dm(e,t,n,r){var a;try{a=JSON.stringify(e.outputShape)}catch($8){a="multiple"}var i,o=[],s=L(e.inboundNodes);try{for(s.s();!(i=s.n()).done;){var u=i.value;if(!(null!=n&&n.length>0&&-1===n.indexOf(u)))for(var l=0;l<u.inboundLayers.length;++l){var c=u.inboundLayers[l].name,h=u.nodeIndices[l],p=u.tensorIndices[l];o.push("".concat(c,"[").concat(h,"][").concat(p,"]"))}}}catch($8){s.e($8)}finally{s.f()}var f=e.name,d=e.getClassName(),v=0===o.length?"":o[0];Mm(["".concat(f," (").concat(d,")"),a,e.countParams().toString(),v],t,r);for(var m=1;m<o.length;++m)Mm(["","","",o[m]],t,r)}function Rm(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"===typeof n}function Om(e,t){if(null===e)return null;if("string"===typeof e)return jf(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];Rm(t,a,i)?n.push(i):n.push(Om(i,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var l=u[s],c=e[l];if("name"===l&&"string"===typeof c)o[l]=c;else{var h=jf(l);o[h]=Om(c,h)}}return o}function Fm(e,t){if(null===e||void 0===e)return null;if("string"===typeof e)return Gf(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];Rm(t,a,i)?n.push(i):n.push(Fm(i,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var l=u[s],c=e[l],h=Gf(l);o[h]="name"!==l&&"className"!==l||"string"!==typeof c?Fm(c,l):c}return o}var Lm="3.3.0";var Pm=function(){function e(t){if(A(this,e),this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(null==t)return;var r,a=L(t);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.add(i.key,i.value)}}catch($8){a.e($8)}finally{a.f()}}}return R(e,[{key:"add",value:function(e,t,n){if(null!=this.id2Value[e.id])throw new Lf("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return Bi(t,e.dtype)}catch($8){throw new Lf("The dtype of the feed (".concat(t.dtype,") can not be cast to the dtype ")+"of the key '".concat(e.name,"' (").concat(e.dtype,")."))}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}},{key:"addFeed",value:function(e){this.add(e.key,e.value)}},{key:"hasKey",value:function(e){return null!=this.id2Value[e.id]}},{key:"names",value:function(){return Object.keys(this.name2Id)}},{key:"getValue",value:function(e){if(e instanceof Ov){if(null==this.id2Value[e.id])throw new Lf("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}var t=this.name2Id[e];if(null==t)throw new Lf("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}},{key:"getMask",value:function(e){if(e instanceof Ov){if(null==this.id2Value[e.id])throw new Lf("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}var t=this.name2Id[e];if(null==t)throw new Lf("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}},{key:"disposeMasks",value:function(){null!=this.id2Mask&&Ao(this.id2Mask)}}]),e}(),zm={},Bm={};function Vm(e,t,n,r){var a,i=null!=n&&n.training,o=Array.isArray(e),s=o?e:[e],u=s.map((function(e){return e.name})),l=[],c=t.names(),h=L(u);try{for(h.s();!(a=h.n()).done;){var p=a.value;-1!==c.indexOf(p)?l.push(t.getValue(p)):l.push(null)}}catch($8){h.e($8)}finally{h.f()}null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var f,d,v=u.join(",")+"|"+t.names().join(",");if(null==zm[v]){var m=function(e,t){G(null!=e&&e.length>0,(function(){return"Expected at least one fetch, got none"}));var n=[],r={};if(1===e.length){var a=Um(e[0],t);n=a.sorted,r=a.recipientMap}else{var i,o=new Set,s=L(e);try{for(s.s();!(i=s.n()).done;){var u,l=Um(i.value,t),c=l.sorted,h=l.recipientMap,p=L(c);try{for(p.s();!(u=p.n()).done;){var f=u.value;o.has(f.name)||(n.push(f),o.add(f.name))}}catch($8){p.e($8)}finally{p.f()}var d=function(e){null==r[e]&&(r[e]=new Set),h[e].forEach((function(t){return r[e].add(t)}))};for(var v in h)d(v)}}catch($8){s.e($8)}finally{s.f()}}return{sorted:n,recipientCounts:Wm(r)}}(s,t);f=m.sorted,d=m.recipientCounts,zm[v]=f,Bm[v]=d}f=zm[v],d={},i||Object.assign(d,Bm[v]);for(var g=new Pm(t),y=0;y<f.length;++y){if(null!=r){var b=Eo().numTensors;b>r.maxNumTensors&&(r.maxNumTensors=b),b<r.minNumTensors&&(r.minNumTensors=b)}var x=f[y],k=x.sourceLayer;if(!(k instanceof Wv)){var w,_=[],S=[],I=[],C=!1,T=L(x.inputs);try{for(T.s();!(w=T.n()).done;){var N=w.value,E=g.getValue(N),M=g.getMask(N);_.push(E),S.push(M),null!=M&&(C=!0),i||(d[N.name]--,0!==d[N.name]||t.hasKey(N)||-1!==u.indexOf(N.name)||E.isDisposed||!0===N.sourceLayer.stateful||I.push(E))}}catch($8){T.e($8)}finally{T.f()}C&&((n=n||{}).mask=S[0]);var A=Hf(k.apply(_,n)),D=null;k.supportsMasking&&(D=k.computeMask(_,S));for(var R=Hm(x),O=Array.isArray(R)?R:[R],F=0;F<O.length;++F){g.hasKey(O[F])||g.add(O[F],A[F],Array.isArray(D)?D[0]:D);var P=u.indexOf(O[F].name);-1!==P&&(l[P]=A[F])}i||Ao(I)}}return g.disposeMasks(),o?l:l[0]}function Wm(e){var t={};for(var n in e)t[n]=e[n].size;return t}function Um(e,t){var n,r=new Set,a=[],i={},o=L(t.names());try{for(o.s();!(n=o.n()).done;){var s=n.value;r.add(s)}}catch($8){o.e($8)}finally{o.f()}var u=[],l=[];for(u.push(e);u.length>0;){var c=u[u.length-1];if(r.has(c.name))u.pop();else{var h=l[l.length-1]===u.length-1;if(0===c.inputs.length||h)u.pop(),a.push(c),r.add(c.name),h&&l.pop();else{l.push(u.length-1);var p,f=L(c.inputs);try{for(f.s();!(p=f.n()).done;){var d=p.value;null==i[d.name]&&(i[d.name]=new Set),i[d.name].add(c.name),r.has(d.name)||u.push(d)}}catch($8){f.e($8)}finally{f.f()}}}}return{sorted:a,recipientMap:i}}function Hm(e){var t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{for(var n=null,r=0;r<e.sourceLayer.inboundNodes.length;++r){var a,i=L(e.sourceLayer.inboundNodes[r].outputTensors);try{for(i.s();!(a=i.n()).done;){if(a.value.id===e.id){n=r;break}}}catch($8){i.e($8)}finally{i.f()}}t=e.sourceLayer.getOutputAt(n)}return t}var Gm=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;if(A(this,n),(r=t.call(this,{})).containerNodes=new Set,r.name=e.name,null==r.name){var a=r.getClassName().toLowerCase();r.name=_v(a)}if(r.supportsMasking=!1,r.trainable_=!0,Array.isArray(e.inputs)?r.inputs=e.inputs.slice():r.inputs=[e.inputs],Array.isArray(e.outputs)?r.outputs=e.outputs.slice():r.outputs=[e.outputs],Qf(r.inputs).length!==r.inputs.length)throw new Lf("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(r.inputs.map((function(e){return e.name}))));Qf(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(r.outputs.map((function(e){return e.name})))),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];var i,o=L(r.outputs);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=s.sourceLayer,l=s.nodeIndex,c=s.tensorIndex;r.outputLayers.push(u),r.outputLayersNodeIndices.push(l),r.outputLayersTensorIndices.push(c)}}catch($8){o.e($8)}finally{o.f()}var h,p=L(r.inputs);try{for(p.s();!(h=p.n()).done;){var f=h.value,d=f.sourceLayer,v=f.nodeIndex,m=f.tensorIndex;Vf(0===v,"input layer has >1 nodes"),Vf(0===m,"input layer has >1 tensors"),r.inputLayers.push(d),r.inputLayersNodeIndices.push(v),r.inputLayersTensorIndices.push(m)}}catch($8){p.e($8)}finally{p.f()}r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var g=0;g<r.inputLayers.length;g++){var y=r.inputLayers[g];if(!(y instanceof Wv))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(e.inputs,". ")+"Input ".concat(g," (0-based) originates ")+"from layer type ".concat(y.getClassName(),"."));r.inputNames.push(y.name),r.feedInputShapes.push(y.batchInputShape),r.feedInputNames.push(y.name)}var b,x=L(r.outputLayers);try{for(x.s();!(b=x.n()).done;){var k=b.value;r.outputNames.push(k.name)}}catch($8){x.e($8)}finally{x.f()}r.internalInputShapes=r.inputs.map((function(e){return e.shape})),r.internalOutputShapes=r.outputs.map((function(e){return e.shape}));var w,_={},S={},I={},C={},T={},N=[],E=function e(t,a,i,o,s,u){null!=o&&null!=s&&null!=u||(o=t.sourceLayer,s=t.nodeIndex,u=t.tensorIndex);var l=o.inboundNodes[s];if(-1!==i.indexOf(l))throw new Ff("The tensor ".concat(t.name,' at layer "').concat(o.name,'" ')+"is part of a cycle.");if(-1===a.indexOf(l)){r.containerNodes.add(n.nodeKey(o,s)),o.id in T||(T[o.id]=Object.keys(T).length),-1===i.indexOf(l)&&i.push(l);for(var c=l.inboundLayers.length,h=0;h<c;h++){e(l.inputTensors[h],a,i,l.inboundLayers[h],l.nodeIndices[h],l.tensorIndices[h])}for(a.push(l);i.indexOf(l)>=0;)i.splice(i.indexOf(l),1);N.push(l)}},M=[],D=[],R=L(r.outputs);try{for(R.s();!(w=R.n()).done;){E(w.value,M,D)}}catch($8){R.e($8)}finally{R.f()}var O,F=L(N.slice().reverse());try{for(F.s();!(O=F.n()).done;){var P=O.value;S[P.id]=P,P.id in _||(_[P.id]=0);var z=_[P.id],B=null==I[P.outboundLayer.id]?0:I[P.outboundLayer.id];z=Math.max(z,B),I[P.outboundLayer.id]=z,C[P.outboundLayer.id]=P.outboundLayer,_[P.id]=z;for(var V=0;V<P.inboundLayers.length;V++){var W=P.inboundLayers[V],U=P.nodeIndices[V],H=W.inboundNodes[U],G=null==_[H.id]?0:_[H.id];_[H.id]=Math.max(z+1,G),S[H.id]=H}}}catch($8){F.e($8)}finally{F.f()}var j={};for(var q in _){var X=_[q];X in j||(j[X]=[]),j[X].push(S[q])}var K={};for(var Y in I){var Z=I[Y];Z in K||(K[Z]=[]),K[Z].push(C[Y])}var Q=Object.keys(K).map((function(e){return parseInt(e,10)})).sort(Zf);r.layers=[];var $,J=L(Q);try{for(J.s();!($=J.n()).done;){var ee=K[$.value];ee.sort((function(e,t){var n=T[e.id],r=T[t.id];return n<r?-1:n>r?1:0}));var te,ne=L(ee);try{for(ne.s();!(te=ne.n()).done;){var re=te.value;re instanceof n&&r.internalContainerRefs.push(re),r.layers.push(re)}}catch($8){ne.e($8)}finally{ne.f()}}}catch($8){J.e($8)}finally{J.f()}r.layersByDepth=K,Q=Object.keys(j).map((function(e){return parseInt(e,10)})).sort(Zf);var ae,ie=r.inputs.slice(),oe=[],se=L(Q);try{for(se.s();!(ae=se.n()).done;){var ue,le=L(j[ae.value]);try{for(le.s();!(ue=le.n()).done;){var ce=ue.value,he=ce.outboundLayer;if(null!=he){var pe,fe=L(ce.inputTensors);try{for(fe.s();!(pe=fe.n()).done;){var de=pe.value;if(-1===ie.indexOf(de))throw new Ff("Graph disconnected: cannot obtain value for tensor ".concat(de)+' at layer "'.concat(he.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(oe))}}catch($8){fe.e($8)}finally{fe.f()}var ve,me=L(ce.outputTensors);try{for(me.s();!(ve=me.n()).done;){var ge=ve.value;ie.push(ge)}}catch($8){me.e($8)}finally{me.f()}oe.push(he.name)}}}catch($8){le.e($8)}finally{le.f()}}}catch($8){se.e($8)}finally{se.f()}r.nodesByDepth=j;var ye,be=r.layers.map((function(e){return e.name})),xe=L(be);try{var ke=function(){var e=ye.value,t=be.filter((function(t){return t===e})).length;if(1!==t)throw new Ff('The name "'.concat(e,'" is used ').concat(t," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(be))};for(xe.s();!(ye=xe.n()).done;)ke()}catch($8){xe.e($8)}finally{xe.f()}return r.outboundNodes=[],r.inboundNodes=[],new Lv({outboundLayer:qr(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map((function(e){return null})),outputMasks:r.outputs.map((function(e){return null})),inputShapes:r.inputs.map((function(e){return e.shape})),outputShapes:r.outputs.map((function(e){return e.shape}))}),r.built=!0,r._refCount=1,r}return R(n,[{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){this.assertNotDisposed();var e={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){var t,n=L(this.layers);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.numDisposedVariables+=r.dispose().numDisposedVariables}}catch($8){n.e($8)}finally{n.f()}var a,i=L(this.internalContainerRefs);try{for(i.s();!(a=i.n()).done;){var o=a.value;e.numDisposedVariables+=o.dispose().numDisposedVariables}}catch($8){i.e($8)}finally{i.f()}}return e.refCountAfterDispose=this._refCount,e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.layers.forEach((function(t){t._trainableWeights.forEach((function(t){return t.trainable=e}))})),this.trainable_=e}},{key:"trainableWeights",get:function(){if(this._trainableWeights.length>0)throw new Lf("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];var e,t=[],n=L(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=t.concat(r.trainableWeights)}}catch($8){n.e($8)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=L(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,I(r.nonTrainableWeights))}}catch($8){n.e($8)}finally{n.f()}if(!this.trainable){var a,i=[],o=L(this.layers);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push.apply(i,I(s.trainableWeights))}}catch($8){o.e($8)}finally{o.f()}return i.concat(t)}return t}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"loadWeights",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r={},a=0,i=L(this.layers);try{for(i.s();!(t=i.n()).done;){var o,s=t.value,u=L(s.weights);try{for(u.s();!(o=u.n()).done;){var l=o.value;if(null!=r[l.originalName])throw new Lf("Duplicate weight name: ".concat(l.originalName));r[l.originalName]=l,a++}}catch($8){u.e($8)}finally{u.f()}}}catch($8){i.e($8)}finally{i.f()}var c=[];for(var h in e){var p=h;if(null==r[h]){var f=h.split("/"),d=f.slice(0,-2).concat([f[f.length-1]]);p=d.join("/")}if(null!=r[p])c.push([r[p],e[h]]);else if(n)throw new Lf("Provided weight data has no target variable: ".concat(h));delete r[p]}if(n){var v=[];for(var m in r)v.push(m);if(v.length>0)throw new Lf("".concat(v.length," of ").concat(a," weights are not set: ")+"".concat(v))}Dv(c)}},{key:"updatedConfig",value:function(){var e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(Lm),t.backend="TensorFlow.js",t}},{key:"toJSON",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Fm(this.updatedConfig());return t?JSON.stringify(n):n}},{key:"call",value:function(e,t){var n=this;return Mo((function(){e=Hf(e);for(var r=new Pm,a=0;a<n.inputs.length;++a)r.add(n.inputs[a],e[a]);return Vm(n.outputs,r,t)}))}},{key:"computeMask",value:function(e,t){var n=this;return Mo((function(){var r;return e=Hf(e),r=null==t?Bf(null,e.length):Hf(t),n.runInternalGraph(e,r)[1]}))}},{key:"computeOutputShape",value:function(e){var t=Iv(e);if(t.length!==this.inputLayers.length)throw new Lf("Invalid inputShape argument ".concat(e,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));for(var n={},r=0;r<t.length;r++){var a=this.inputLayers[r],i=t[r];n[a.name+"_0_0"]=i}var o=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(Zf);if(o.length>1){var s,u=L(o);try{for(u.s();!(s=u.n()).done;){var l,c=s.value,h=L(this.nodesByDepth[c]);try{for(h.s();!(l=h.n()).done;){var p=l.value,f=p.outboundLayer;if(-1===this.inputLayers.map((function(e){return e.id})).indexOf(f.id)){for(var d=[],v=0;v<p.inboundLayers.length;v++){var m=p.inboundLayers[v],g=p.nodeIndices[v],y=p.tensorIndices[v],b=n["".concat(m.name,"_").concat(g,"_").concat(y)];d.push(b)}for(var x=Iv(f.computeOutputShape(Uf(d))),k=f.inboundNodes.indexOf(p),w=0;w<x.length;w++){n["".concat(f.name,"_").concat(k,"_").concat(w)]=x[w]}}}}catch($8){h.e($8)}finally{h.f()}}}catch($8){u.e($8)}finally{u.f()}}for(var _=[],S=[],I=0;I<this.outputLayers.length;I++){var C=this.outputLayers[I],T=this.outputLayersNodeIndices[I],N=this.outputLayersTensorIndices[I],E="".concat(C.name,"_").concat(T,"_").concat(N);S.push(E)}for(var M=0;M<S.length;M++){var A=S[M];Vf(A in n),_.push(n[A])}return Uf(_)}},{key:"runInternalGraph",value:function(e,t){null==t&&(t=Bf(null,e.length));for(var n={},r=0;r<this.inputs.length;++r){var a=this.inputs[r],i=e[r],o=t[r];n[a.id]=[i,o]}var s,u=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(Zf),l=L(u);try{for(l.s();!(s=l.n()).done;){var c,h=s.value,p=L(this.nodesByDepth[h]);try{for(p.s();!(c=p.n()).done;){var f,d=c.value,v=d.outboundLayer,m=d.inputTensors,g=d.outputTensors,y=new Array,b=L(m);try{for(b.s();!(f=b.n()).done;){var x=f.value;x.id in n&&y.push(n[x.id])}}catch($8){b.e($8)}finally{b.f()}if(y.length===m.length){var k={},w=void 0,_=void 0,S=void 0,I=void 0;if(null!=d.callArgs&&(k=d.callArgs),1===y.length){var C=N(y[0],2),T=C[0],E=C[1];null==k.mask&&(k.mask=E),S=Hf(v.call(T,k)),I=Hf(v.computeMask(T,E)),w=[T],_=[E]}else w=y.map((function(e){return e[0]})),_=y.map((function(e){return e[1]})),null==k.mask&&(k.mask=_),S=Hf(v.call(w,k)),I=Hf(v.computeMask(w,_));if(v.activityRegularizer)throw new Pf("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(var M=0;M<g.length;++M){var A=g[M],D=S[M],R=I[M];n[A.id]=[D,R]}}}}catch($8){p.e($8)}finally{p.f()}}}catch($8){l.e($8)}finally{l.f()}var O,F=[],P=[],z=[],B=L(this.outputs);try{for(B.s();!(O=B.n()).done;){var V=O.value;Vf(V.id in n,"Could not compute output ".concat(V.name," : ").concat(V.id));var W=N(n[V.id],2),U=W[0],H=W[1];z.push(U.shape),F.push(U),P.push(H)}}catch($8){B.e($8)}finally{B.f()}return[F,P,z]}},{key:"buildNodeConversionMap",value:function(e){var t,r,a={},i=L(this.layers);try{for(i.s();!(r=i.n()).done;){var o=r.value;t=o instanceof n?1:0;for(var s=0;s<o.inboundNodes.length;s++){var u=n.nodeKey(o,s);this.containerNodes.has(u)&&(a[u]=t,t+=1)}}}catch($8){i.e($8)}finally{i.f()}return a}},{key:"getLayer",value:function(e,t){if(null!=t){if(this.layers.length<=t)throw new Lf("Was asked to retrieve layer at index ".concat(t,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[t]}if(null==e)throw new Lf("Provide either a layer name or layer index");var n,r=L(this.layers);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.name===e)return a}}catch($8){r.e($8)}finally{r.f()}throw new Lf("No such layer: ".concat(e))}},{key:"calculateLosses",value:function(){var e=this;return Mo((function(){var t,r=[],a=L(e.layers);try{for(a.s();!(t=a.n()).done;)for(var i=t.value,o=0;o<i.inboundNodes.length;++o){var s=n.nodeKey(i,o);e.containerNodes.has(s)&&r.push.apply(r,I(i.calculateLosses()))}}catch($8){a.e($8)}finally{a.f()}return r}))}},{key:"getConfig",value:function(){var e,t={name:this.name},r=this.buildNodeConversionMap(this.layers),a=[],i=L(this.layers);try{for(i.s();!(e=i.n()).done;){for(var o=e.value,s=o.getClassName(),u=o.getConfig(),l=[],c=0;c<o.inboundNodes.length;c++){var h=o.inboundNodes[c],p=n.nodeKey(o,c),f={};if(this.containerNodes.has(p)){if(h.callArgs)try{JSON.stringify(h.callArgs),f=h.callArgs}catch($8){console.warn("Layer ".concat(o.name," was passed ")+"non-serializable keyword arguments: "+"".concat(h.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),f={}}if(h.inboundLayers.length>0){for(var d=[],v=0;v<h.inboundLayers.length;v++){var m=h.inboundLayers[v],g=h.nodeIndices[v],y=h.tensorIndices[v],b=r[n.nodeKey(m,g)];null==b&&(b=0),d.push([m.name,b,y,f])}l.push(d)}}}var x={};x.name=o.name,x.className=s,x.config=u,x.inboundNodes=l,a.push(x)}}catch($8){i.e($8)}finally{i.f()}t.layers=a;for(var k=[],w=0;w<this.inputLayers.length;w++){var _=this.inputLayers[w],S=this.inputLayersNodeIndices[w],I=n.nodeKey(_,S);if(this.containerNodes.has(I)){var C=r[I];null!==C&&void 0!==C||(C=0);var T=this.inputLayersTensorIndices[w];k.push([_.name,C,T])}}t.inputLayers=k;for(var N=[],E=0;E<this.outputLayers.length;E++){var M=this.outputLayers[E],A=this.outputLayersNodeIndices[E],D=n.nodeKey(M,A);if(this.containerNodes.has(D)){var R=r[D];null!==R&&void 0!==R||(R=0);var O=this.outputLayersTensorIndices[E];N.push([M.name,R,O])}}return t.outputLayers=N,t}},{key:"stateful",get:function(){if(this._stateful)throw new Lf("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");var e,t=L(this.layers);try{for(t.s();!(e=t.n()).done;){if(e.value.stateful)return!0}}catch($8){t.e($8)}finally{t.f()}return!1}},{key:"resetStates",value:function(){var e=this;Mo((function(){e.layers.forEach((function(e){e.stateful&&e.resetStates()}))}))}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={},a={};function i(e,t){e.name in a?a[e.name].push(t):a[e.name]=[t]}function o(e,t){var n,a,o=[],s=L(t);try{for(s.s();!(a=s.n()).done;){var u=a.value,l=u[0],c=u[1],h=u[2];if(n=null==u[3]?{}:u[3],!(l in r))return void i(e,t);var p=r[l];if(p.inboundNodes.length<=c)return void i(e,t);var f=p.inboundNodes[c];o.push(f.outputTensors[h])}}catch($8){s.e($8)}finally{s.f()}o.length>0&&e.apply(Uf(o),n)}function s(e){var a=e.name,o=tm(e,null!=t.customObjects?t.customObjects:{});o.setFastWeightInitDuringBuild(n),r[a]=o,e.inboundNodes.forEach((function(e){if(!(e instanceof Array))throw new Lf("Corrupted configuration, expected array for nodeData: ".concat(e));i(o,e)}))}var u,l=t.name,c=t.layers,h=L(c);try{for(h.s();!(u=h.n()).done;){var p=u.value;s(p)}}catch($8){h.e($8)}finally{h.f()}for(;!$f(a);){var f,d=L(c);try{for(d.s();!(f=d.n()).done;){var v=f.value,m=r[v.name];if(m.name in a){var g=a[m.name];delete a[m.name];var y,b=L(g);try{for(b.s();!(y=b.n()).done;){var x=y.value;o(m,x)}}catch($8){b.e($8)}finally{b.f()}}}}catch($8){d.e($8)}finally{d.f()}}var k,w=[],_=[],S=t.inputLayers,I=L(S);try{for(I.s();!(k=I.n()).done;){var C=k.value,T=C[0],N=C[1],E=C[2];Vf(T in r);var M=r[T],A=M.inboundNodes[N].outputTensors;w.push(A[E])}}catch($8){I.e($8)}finally{I.f()}var D,R=t.outputLayers,O=L(R);try{for(O.s();!(D=O.n()).done;){var F=D.value,P=F[0],z=F[1],B=F[2];Vf(P in r);var V=r[P],W=V.inboundNodes[z].outputTensors;_.push(W[B])}}catch($8){O.e($8)}finally{O.f()}return new e({inputs:w,outputs:_,name:l})}}]),n}(zv);function jm(e,t,n){var r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return null}));if(1===r)return Array.isArray(e)&&1===e.length?e:"object"===typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided ".concat(n," is an array of ").concat(e.length," ")+"element(s), but the model has ".concat(r," outputs. ")+"Make sure a set of weights is provided for each model output.");return e}if("object"===typeof e&&Object.keys(e).length>0&&"object"===typeof e[Object.keys(e)[0]]){var a=[];return t.forEach((function(t){t in e?a.push(e[t]):a.push(null)})),a}throw new Error("The model has multiple (".concat(r,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(r," elements or an object with ").concat(t," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(e)))}function qm(e,t){return jm(e,t,"classWeight")}function Xm(e,t,n,r){return Km.apply(this,arguments)}function Km(){return(Km=F(M().mark((function e(t,n,r,a){var i,o,s;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&null==a){e.next=2;break}throw new Error("Support sampleWeight is not implemented yet");case 2:if(null==r){e.next=15;break}return i=Mo((function(){if(1===t.shape.length)return t.clone();if(2===t.shape.length){if(t.shape[1]>1){return t.argMax(1)}if(1===t.shape[1])return t.reshape([t.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(t.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(t.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")})),e.t0=Array,e.next=7,i.data();case 7:return e.t1=e.sent,o=e.t0.from.call(e.t0,e.t1),Ao(i),s=[],o.forEach((function(e){if(null==r[e])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(e," exists in the data but not in ")+"classWeight");s.push(r[e])})),e.abrupt("return",zu(s,"float32"));case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ym(e,t){return Us(e,t)}function Zm(e,t){var n,r,a=t;n=a.xs,r=a.ys,G(null!=n&&null!=r,(function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(t)}));var i=Qm("input",e.inputNames,n),o=Qm("output",e.outputNames,r),s=i[0].shape[0];G(i.length===e.inputs.length,(function(){return"LayersModel has ".concat(e.inputs.length," inputs, but the dataset ")+"provides ".concat(i.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(e.inputNames),")")})),G(o.length===e.outputs.length,(function(){return"LayersModel has ".concat(e.outputs.length," outputs, but the dataset ")+"provides ".concat(o.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(e.outputNames),")")}));for(var u=function(t){G(i[t].shape[0]===s,(function(){return"Batch size mismatch: input "+"".concat(e.inputNames[t]," has ").concat(i[t].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],".")}))},l=0;l<i.length;l++)u(l);for(var c=function(t){G(o[t].shape[0]===s,(function(){return"Batch size mismatch: output "+"".concat(e.outputNames[t]," has ").concat(o[t].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],".")}))},h=0;h<o.length;h++)c(h);return{xs:i,ys:o}}function Qm(e,t,n){if(n instanceof ra)return[n];if(Array.isArray(n))return G(n.length===t.length,(function(){return"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,".")})),n;var r,a=[],i=L(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(null==n[o])throw new Lf("The feature data generated by the dataset lacks the required "+"".concat(e," key '").concat(o,"'."));a.push(n[o])}}catch($8){i.e($8)}finally{i.f()}return a}function $m(e){if(3===e.length)throw new Pf("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}function Jm(e,t,n){return eg.apply(this,arguments)}function eg(){return eg=F(M().mark((function e(t,n,r){var a,i,o,s,u,l,c,h,p,f,d,v,m,g,y,b,x,k,w,_,S,I,C,T,N,E,A,D,R,O,F,L,P;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=r.batchesPerEpoch,G(null!=t.optimizer,(function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."})),G(null!=r,(function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."})),G(null!=r.epochs&&r.epochs>0&&Number.isInteger(r.epochs),(function(){return"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(r.epochs)})),G(!a||r.batchesPerEpoch>0&&Number.isInteger(r.batchesPerEpoch),(function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(r.batchesPerEpoch)})),G(null==r.validationSplit,(function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."})),!t.isTraining){e.next=8;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 8:return t.isTraining=!0,e.prev=9,(i=null!=r.validationData)&&(ng(r.validationData)?G(null==r.validationBatches||r.validationBatches>0&&Number.isInteger(r.validationBatches),(function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(r.validationBatches)})):(u=$m(r.validationData),o=u.xs,s=u.ys)),l=t.makeTrainFunction(),c=t.getDedupedMetricsNames(),h=i?c.slice().concat(c.map((function(e){return"val_"+e}))):c.slice(),p=Zv(r.callbacks,r.yieldEvery),f=null==r.verbose?1:r.verbose,d=$v(p,f,r.epochs,null,null,tg(n,r),null,i,h),v=d.callbackList,m=d.history,v.setModel(t),t.history=m,e.next=22,v.onTrainBegin();case 22:return t.stopTraining_=!1,g=null==r.initialEpoch?0:r.initialEpoch,e.next=26,n.iterator();case 26:y=e.sent;case 27:if(!(g<r.epochs)){e.next=98;break}return b={},e.next=31,v.onEpochBegin(g);case 31:if(x=0,k=0,a){e.next=37;break}return e.next=36,n.iterator();case 36:y=e.sent;case 37:if(a&&!(x<r.batchesPerEpoch)){e.next=91;break}return e.next=40,y.next();case 40:if(w=e.sent,!a||!w.done){e.next=44;break}return console.warn("You provided `batchesPerEpoch` as "+"".concat(r.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(x," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(r.batchesPerEpoch*r.epochs," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("break",91);case 44:if(null==w.value){e.next=73;break}return _=Zm(t,w.value),S=_.xs,I=_.ys,(C={}).batch=k,C.size=S[0].shape[0],e.next=51,v.onBatchBegin(k,C);case 51:if(T=[],null==r.classWeight){e.next=64;break}N=qm(r.classWeight,t.outputNames),E=0;case 55:if(!(E<N.length)){e.next=64;break}return e.t0=T,e.next=59,Xm(I[E],null,N[E]);case 59:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 61:++E,e.next=55;break;case 64:for(A=S.concat(I).concat(T),D=l(A),Ao(A),R=0;R<c.length;++R)O=c[R],F=D[R],C[O]=F,Do(F);return e.next=70,v.onBatchEnd(k,C);case 70:Gv(C),k++,x++;case 73:if(!(a?x>=r.batchesPerEpoch:w.done)){e.next=87;break}if(!i){e.next=86;break}if(L=void 0,!ng(r.validationData)){e.next=84;break}return e.t2=Hf,e.next=80,t.evaluateDataset(r.validationData,{batches:r.validationBatches});case 80:e.t3=e.sent,L=(0,e.t2)(e.t3),e.next=85;break;case 84:L=Hf(t.evaluate(o,s,{batchSize:null==r.validationBatchSize?32:r.validationBatchSize,verbose:0}));case 85:for(P=0;P<t.metricsNames.length;++P)b["val_".concat(t.metricsNames[P])]=L[P];case 86:return e.abrupt("break",91);case 87:if(!t.stopTraining_){e.next=89;break}return e.abrupt("break",91);case 89:e.next=37;break;case 91:return e.next=93,v.onEpochEnd(g,b);case 93:if(g++,!t.stopTraining_){e.next=96;break}return e.abrupt("break",98);case 96:e.next=27;break;case 98:return e.next=100,v.onTrainEnd();case 100:return e.next=102,t.history.syncData();case 102:return e.abrupt("return",t.history);case 103:return e.prev=103,t.isTraining=!1,e.finish(103);case 106:case"end":return e.stop()}}),e,null,[[9,,103,106]])}))),eg.apply(this,arguments)}function tg(e,t){var n=null;return null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function ng(e){return"function"===typeof e.iterator}function rg(e){return"function"===typeof e.next}function ag(e,t,n){return ig.apply(this,arguments)}function ig(){return ig=F(M().mark((function e(t,n,r){var a,i,o,s,u,l,c,h,p;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=(r=r||{}).batches,i=t.testFunction,o=[],!(r.verbose>0)){e.next=6;break}throw new Pf("Verbose mode is not implemented yet.");case 6:if(G(!a||r.batches>0&&Number.isInteger(r.batches),(function(){return"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(r.batches))})),!rg(n)){e.next=11;break}e.t0=n,e.next=14;break;case 11:return e.next=13,n.iterator();case 13:e.t0=e.sent;case 14:s=e.t0,u=0,l=0,c=M().mark((function e(){var n;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.next();case 2:if(n=e.sent,o=Mo((function(){return n.value&&function(){var e=Zm(t,n.value),r=e.xs,a=e.ys,s=r.concat(a),c=Mo((function(){return i(s)}));if(Ao(s),0===l)for(var h=0;h<c.length;++h)o.push(Lo(0));for(var p=s[0].shape[0],f=function(e){var t=c[e],n=o[e];o[e]=Mo((function(){return Bo(o[e],Us(p,t))})),l>0&&Ao(n)},d=0;d<c.length;++d)f(d);Ao(c),u+=p,++l}(),o})),!n.done){e.next=7;break}return a&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(r.batches," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("return","break");case 7:case"end":return e.stop()}}),e)}));case 18:if(a&&!(l<r.batches)){e.next=25;break}return e.delegateYield(c(),"t1",20);case 20:if("break"!==e.t1){e.next=23;break}return e.abrupt("break",25);case 23:e.next=18;break;case 25:for(h=0;h<o.length;++h)p=o[h],o[h]=Ss(o[h],u),Ao(p);return e.abrupt("return",Uf(o));case 27:case"end":return e.stop()}}),e)}))),ig.apply(this,arguments)}function og(e){G(e>0&&Number.isInteger(e),(function(){return"batchSize is required to be a positive integer, but got ".concat(e)}))}function sg(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((function(e){return Pd(e,t,n-t)})):Pd(e,t,n-t)}function ug(e,t){return Mo((function(){return null==e?null:Array.isArray(e)?e.map((function(e){return ug(e,t)})):jd(e,"int32"===t.dtype?t:t.toInt())}))}function lg(e,t){for(var n=[],r=0,a=null;r<e;)(a=r+t)>=e&&(a=e),n.push([r,a]),r=a;return n}function cg(e,t,n,r,a,i,o,s,u,l,c,h,p,f,d){return hg.apply(this,arguments)}function hg(){return hg=F(M().mark((function e(t,n,r,a,i,o,s,u,l,c,h,p,f,d,v){var m,g,y,b,x,k,w,_;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==i&&(i=32),null==o&&(o=1),null==h&&(h=!0),null==f&&(f=0),m=!1,null!=l&&null!=c&&(m=!0),null==v){e.next=10;break}if(m=!0,null!=d){e.next=10;break}throw new Lf("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");case 10:return null!=(g=t.checkNumSamples(r,i,d,"steps_per_epoch"))&&(y=Rd(0,g)),null==s&&(s=1),b=$v(u,s,o,f,g,d,i,m,p),x=b.callbackList,k=b.history,x.setModel(t),t.history=k,e.next=18,x.onTrainBegin();case 18:t.stopTraining_=!1,w=M().mark((function e(o){var s;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.onEpochBegin(o);case 2:if(s={},null==d){e.next=7;break}throw new Pf("stepsPerEpoch mode is not implemented yet.");case 7:return e.delegateYield(M().mark((function e(){var o,u,p,f;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("batch"!==h){e.next=4;break}throw new Pf("batch shuffling is not implemneted yet");case 4:h&&V(y);case 5:o=zu(y),u=lg(g,i),p=M().mark((function e(h){var p;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p={},e.next=3,x.onBatchBegin(h,p);case 3:return Mo((function(){var e=u[h][0],f=u[h][1],d=Pd(o,e,f-e);p.batch=h,p.size=f-e;for(var v=ug(r,d),g=n(v),y=0;y<a.length;++y){var b=a[y],x=g[y];p[b]=x,Do(x)}if(h===u.length-1&&m)for(var k=t.testLoop(l,c,i),w=0;w<a.length;++w){var _=a[w],S=k[w];Do(S),s["val_"+_]=S}})),e.next=6,x.onBatchEnd(h,p);case 6:if(Gv(p),!t.stopTraining_){e.next=9;break}return e.abrupt("return","break");case 9:case"end":return e.stop()}}),e)})),f=0;case 9:if(!(f<u.length)){e.next=17;break}return e.delegateYield(p(f),"t0",11);case 11:if("break"!==e.t0){e.next=14;break}return e.abrupt("break",17);case 14:++f,e.next=9;break;case 17:o.dispose();case 18:case"end":return e.stop()}}),e)}))(),"t0",8);case 8:return e.next=10,x.onEpochEnd(o,s);case 10:if(!t.stopTraining_){e.next=12;break}return e.abrupt("return","break");case 12:case"end":return e.stop()}}),e)})),_=f;case 21:if(!(_<o)){e.next=29;break}return e.delegateYield(w(_),"t0",23);case 23:if("break"!==e.t0){e.next=26;break}return e.abrupt("break",29);case 26:++_,e.next=21;break;case 29:return e.next=31,x.onTrainEnd();case 31:return e.next=33,t.history.syncData();case 33:return e.abrupt("return",t.history);case 34:case"end":return e.stop()}}),e)}))),hg.apply(this,arguments)}function pg(e,t,n){return fg.apply(this,arguments)}function fg(){return fg=F(M().mark((function e(t,n,r){var a,i,o,s,u,l,c,h,p,f,d,v,m,g,y,b,x,k,w,_,S,I,C,T,N=arguments;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=N.length>3&&void 0!==N[3]?N[3]:{},!t.isTraining){e.next=3;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 3:return t.isTraining=!0,e.prev=4,og(p=null==a.batchSize?32:a.batchSize),f=!1,e.next=10,t.standardizeUserData(n,r,a.sampleWeight,a.classWeight,f,p);case 10:if(d=e.sent,i=d[0],o=d[1],h=d[2],v=!1,!(null!=a.validationData&&a.validationData.length>0)){e.next=36;break}if(v=!0,2!==a.validationData.length){e.next=22;break}s=a.validationData[0],u=a.validationData[1],e.next=27;break;case 22:if(3!==a.validationData.length){e.next=26;break}throw new Pf("validationData including sample weights is not supported yet.");case 26:throw new Lf("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(a.validationData," is invalid."));case 27:return g=!0,e.next=30,t.standardizeUserData(s,u,null,null,g,p);case 30:y=e.sent,l=y[0],c=y[1],m=l.concat(c),e.next=37;break;case 36:null!=a.validationSplit&&a.validationSplit>0&&a.validationSplit<1?(v=!0,b=Math.floor(i[0].shape[0]*(1-a.validationSplit)),x=i[0].shape[0],l=sg(i,b,x),i=sg(i,0,b),c=sg(o,b,x),o=sg(o,0,b),m=l.concat(c)):null!=a.validationSteps&&(v=!0);case 37:return k=i.concat(o).concat(h),t.checkTrainableWeightsConsistency(),w=t.makeTrainFunction(),_=t.getDedupedMetricsNames(),v?(t.makeTestFunction(),S=t.testFunction,I=_.slice().concat(_.map((function(e){return"val_"+e})))):(S=null,m=[],I=_.slice()),C=Zv(a.callbacks,a.yieldEvery),e.next=45,cg(t,w,k,_,p,a.epochs,a.verbose,C,S,m,a.shuffle,I,a.initialEpoch,null,null);case 45:return T=e.sent,e.abrupt("return",T);case 47:return e.prev=47,t.isTraining=!1,vg(i,n),vg(o,r),vg(l,s),vg(c,u),null!=h&&Ao(h),e.finish(47);case 55:case"end":return e.stop()}}),e,null,[[4,,47,55]])}))),fg.apply(this,arguments)}function dg(e){var t=[];e instanceof ra&&(e=[e]);for(var n=0;n<e.length;++n){var r=e[n];if(1===r.rank)t.push(Fd(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function vg(e,t){if(null!=e){var n=[];if(t instanceof ra)n.push(t.id);else if(Array.isArray(t))t.forEach((function(e){return n.push(e.id)}));else if(null!=t)for(var r in t){var a=t[r];n.push(a.id)}var i=[];if(e instanceof ra)-1===n.indexOf(e.id)&&i.push(e);else if(Array.isArray(e))e.forEach((function(e){-1===n.indexOf(e.id)&&i.push(e)}));else if(null!=e)for(var o in e){var s=e[o];-1===n.indexOf(s.id)&&i.push(s)}i.forEach((function(e){e.isDisposed||e.dispose()}))}}function mg(e){return Array.isArray(e)}function gg(e){return!function(e){return e instanceof ra}(e)&&!mg(e)}function yg(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){var o=!1;if(mg(e)&&e.length>0)o=!0;else if(gg(e)){for(var s in e)if(e.hasOwnProperty(s)){o=!0;break}}else o=!0;if(o)throw new Lf("Error when checking model ".concat(i," expected no data, ")+"but got ".concat(e))}return[]}if(null==e)return t.map((function(e){return null}));if(gg(e)){r=[];var u,l=L(t);try{for(l.s();!(u=l.n()).done;){var c=u.value;if(null==e[c])throw new Lf('No data provided for "'.concat(c,'". Need data for each key in: ')+"".concat(t));r.push(e[c])}}catch($8){l.e($8)}finally{l.f()}}else if(mg(e)){if(e.length!==t.length)throw new Lf("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(t.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(e));r=e}else{if(t.length>1)throw new Lf("The model ".concat(i," expects ").concat(t.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(e.shape));r=[e]}if(r=dg(r),null!=n)for(var h=0;h<t.length;++h)if(null!=n[h]){var p=r[h];if(p.shape.length!==n[h].length)throw new Lf("Error when checking ".concat(i,": expected ").concat(t[h]," ")+"to have ".concat(n[h].length," dimension(s). but got array with ")+"shape ".concat(p.shape));for(var f=0;f<n[h].length;++f)if(0!==f||a){var d=p.shape[f],v=n[h][f];if(null!=v&&v>=0&&d!==v)throw new Lf("Error when checking ".concat(i,": expected ").concat(t[h]," ")+"to have shape [".concat(n[h],"], but got array with shape ")+"[".concat(p.shape,"]."))}}return r}function bg(e,t,n){var r=Qf(e.map((function(e){return e.shape[0]})));r.sort();var a=Qf(t.map((function(e){return e.shape[0]})));if(a.sort(),r.length>1)throw new Lf("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map((function(e){return e.shape})))));if(a.length>1)throw new Lf("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map((function(e){return e.shape})))));if(r.length>0&&a.length>0&&!Y(r,a))throw new Lf("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(r[0]," input sample(s) and ").concat(a[0]," target ")+"sample(s).")}function xg(e,t,n){for(var r=[rm,lm,sm],a=0;a<e.length;++a){var i=e[a],o=t[a],s=n[a];if(null!=o){if(o===sm&&1===i.shape[i.shape.length-1])throw new Lf("You are passing a target array of shape ".concat(i.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o))for(var u=i.shape.slice(1),l=s.slice(1),c=0;c<u.length;++c){var h=u[c],p=l[c];if(null!=p&&h!==p)throw new Lf("A target Tensor with shape ".concat(i.shape," was passed for an ")+"output of shape ".concat(s,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}function kg(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new Lf("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(t.length," Tensor(s),")+" but instead got ".concat(e.length," Tensors(s)."));r=e}else{if(t.length>1)throw new Lf("The model expects ".concat(t.length," ").concat(i," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(e.shape),"."));r=[e]}if(null!=n)for(var o=0;o<t.length;++o)if(null!=n[o]){var s=r[o];if(s.shape.length!==n[o].length)throw new Lf("Error when checking ".concat(i,": expected ").concat(t[o]," ")+"to have ".concat(n[o].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(s.shape)));for(var u=0;u<n[o].length;++u)if(0!==u||a){var l=s.shape[u],c=n[o][u];if(null!=c&&c!==l)throw new Lf("Error when checking ".concat(i,": expected ")+"".concat(t[o]," to have shape ").concat(JSON.stringify(n[o])," but ")+"got array with shape ".concat(JSON.stringify(s.shape),"."))}}}var wg=function(t){Hr(r,t);var n=Kr(r);function r(e){var t;return A(this,r),(t=n.call(this,e)).isTraining=!1,t}return R(r,[{key:"summary",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new Lf("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Tm(this,e,t,n)}},{key:"compile",value:function(e){var t=this;if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"===typeof e.optimizer)this.optimizer_=function(e){var t={Adagrad:function(){return vc.adagrad(.01)},Adadelta:function(){return vc.adadelta(1,.95,Af())},Adam:function(){return vc.adam(.001,.9,.999,Af())},Adamax:function(){return vc.adamax(.002,.9,.999,Af(),0)},RMSProp:function(){return vc.rmsprop(.001,.9,0,Af())},SGD:function(){return vc.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new Lf("Unknown Optimizer ".concat(e))}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Po))throw new Lf("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}var n=[];if(Array.isArray(e.loss)||"string"===typeof e.loss||"function"===typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new Lf("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(e.loss,"."));var r=e.loss;n=r.map((function(e){return fm(e)}))}else{var a=fm(e.loss);this.outputs.forEach((function(e){n.push(a)}))}else{for(var i in e.loss=e.loss,e.loss)if(-1===this.outputNames.indexOf(i))throw new Lf('Unknown entry in loss dictionary: "'.concat(i,'". ')+"Only expected the following keys: ".concat(this.outputNames));var o,s=L(this.outputNames);try{for(s.s();!(o=s.n()).done;){var u=o.value;null==e.loss[u]&&console.warn('Output "'.concat(u,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(u," during training")),n.push(fm(e.loss[u]))}}catch($8){s.e($8)}finally{s.f()}}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var l=0;l<this.outputs.length;++l){var c=this.internalOutputShapes[l],h=this.outputNames[l];this.feedOutputNames.push(h),this.feedOutputShapes.push(c),this.feedLossFns.push(this.lossFunctions[l])}var p=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Sd("loss",(function(){for(var e=0;e<t.outputs.length;++e)if(-1===p.indexOf(e)){var n=t.lossFunctions[e];t.outputs.length>1&&(t.metricsTensors.push([n,e]),t.metricsNames.push(t.outputNames[e]+"_loss"))}}));var f=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return[]}));var n;if("string"===typeof e||"function"===typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!==typeof e)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(e));n=e}if(Array.isArray(n))return t.map((function(e){return n}));var r,a=[],i=L(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=n.hasOwnProperty(o)?n[o]:[];Array.isArray(s)||(s=[s]),a.push(s)}}catch($8){i.e($8)}finally{i.f()}return a}(e.metrics,this.outputNames),d=function(e,n,r){t.outputNames.length>1&&(n=t.outputNames[e]+"_"+n),t.metricsNames.push(n),t.metricsTensors.push([r,e])};Sd("metric",(function(){for(var e=function(e){if(-1!==p.indexOf(e))return"continue";!function(n){var r,a,i,o,s=L(n);try{for(s.s();!(o=s.n()).done;){var u=o.value;if("string"===typeof u&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(u)){var l=t.internalOutputShapes[e];1===l[l.length-1]||t.lossFunctions[e]===lm?-1!==["accuracy","acc"].indexOf(u)?a=dm:-1!==["crossentropy","ce"].indexOf(u)&&(a=gm):t.lossFunctions[e]===um?-1!==["accuracy","acc"].indexOf(u)?a=ym:-1!==["crossentropy","ce"].indexOf(u)&&(a=xm):-1!==["accuracy","acc"].indexOf(u)?a=vm:-1!==["crossentropy","ce"].indexOf(u)&&(a=bm);var c=void 0;-1!==["accuracy","acc"].indexOf(u)?c="acc":-1!==["crossentropy","ce"].indexOf(u)&&(c="ce"),i=a,r=""+c}else{var h=wm(u);i=h,r=""+_m(u)}var p=void 0;Sd(r,(function(){p=i})),d(e,r,p)}}catch($8){s.e($8)}finally{s.f()}}(f[e])},n=0;n<t.outputs.length;++n)e(n)})),this.collectedTrainableWeights=this.trainableWeights}},{key:"checkTrainableWeightsConsistency",value:function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=null==n.batchSize?32:n.batchSize;og(r);var a=!0,i=this.standardizeUserDataXY(e,t,a,r);try{var o=i[0].concat(i[1]);this.makeTestFunction();var s=this.testFunction,u=this.testLoop(s,o,r,n.verbose,n.steps);return Uf(u)}finally{vg(i[0],e),vg(i[1],t)}}},{key:"evaluateDataset",value:function(){var e=F(M().mark((function e(t,n){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.makeTestFunction(),e.abrupt("return",ag(this,t,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"checkNumSamples",value:function(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=t)throw new Lf("If ".concat(a," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(t))}else{if(null==e)throw new Lf("Either the input data should have a defined shape, or "+"".concat(a," shoud be specified."));r=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return r}},{key:"execute",value:function(e,t){if(Array.isArray(t)&&0===t.length)throw new Lf("`outputs` is an empty Array, which is not allowed.");var n=Array.isArray(t),r=n?t:[t],a=this.retrieveSymbolicTensors(r),i=new Pm;if(e instanceof ra&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new Lf("The number of inputs provided (".concat(e.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(var o=0;o<this.inputs.length;++o)i.add(this.inputs[o],e[o])}else{var s,u=L(this.inputs);try{for(u.s();!(s=u.n()).done;){var l=s.value,c=e[l.name];if(null==c)throw new Lf("No value is provided for the model's input ".concat(l.name));i.add(l,c)}}catch($8){u.e($8)}finally{u.f()}}var h=Vm(a,i);return n?h:h[0]}},{key:"retrieveSymbolicTensors",value:function(e){var t,n=Bf(null,e.length),r=e.length,a=L(this.layers);try{for(a.s();!(t=a.n()).done;){for(var i=t.value,o=Array.isArray(i.output)?i.output:[i.output],s=o.map((function(e){return e.name})),u=0;u<e.length;++u){var l=s.indexOf(e[u]);if(-1!==l&&(n[u]=o[l],r--),0===r)break}if(0===r)break}}catch($8){a.e($8)}finally{a.f()}if(r>0){var c=[];throw n.forEach((function(t,n){null==t&&c.push(e[n])})),new Lf("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(c)))}return n}},{key:"predictLoop",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Mo((function(){var a=t.checkNumSamples(e);if(r)throw new Pf("Verbose predictLoop() is not implemented yet.");for(var i=lg(a,n),o=t.outputs.map((function(e){return[]})),s=function(n){Mo((function(){var r=i[n][0],a=i[n][1],o=sg(e,r,a),s=[];if(Array.isArray(o))for(var u=0;u<o.length;++u)s.push({key:t.inputs[u],value:o[u]});else s.push({key:t.inputs[0],value:o});var l=new Pm(s);return Vm(t.outputs,l)})).forEach((function(e,t){return o[t].push(e)}))},u=0;u<i.length;++u)s(u);return Uf(o.map((function(e){return ps(e,0)})))}))}},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=dg(e);kg(n,this.inputNames,this.feedInputShapes,!1);try{var r=null==t.batchSize?32:t.batchSize;return og(r),this.predictLoop(n,r)}finally{vg(n,e)}}},{key:"predictOnBatch",value:function(e){kg(e,this.inputNames,this.feedInputShapes,!0);var t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}},{key:"standardizeUserDataXY",value:function(e,t){var n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new Ff("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var r=[],a=0;a<this.feedOutputShapes.length;++a){var i=this.feedOutputShapes[a],o=this.feedLossFns[a];o===um?r.push(i.slice(0,i.length-1).concat([1])):r.push(i)}if(bg(e=yg(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=yg(t,this.feedOutputNames,r,!1,"target")),xg(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!==0)throw new Lf("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}},{key:"standardizeUserData",value:function(){var e=F(M().mark((function e(t,n,r,a){var i,o,s,u,l,c,h,p,f,d=arguments;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=!(d.length>4&&void 0!==d[4])||d[4],o=d.length>5?d[5]:void 0,s=this.standardizeUserDataXY(t,n,i,o),u=N(s,2),l=u[0],c=u[1],null==r){e.next=5;break}throw new Error("sample weight is not supported yet.");case 5:if(h=null,null==a){e.next=19;break}p=qm(a,this.outputNames),h=[],f=0;case 10:if(!(f<p.length)){e.next=19;break}return e.t0=h,e.next=14,Xm(c[f],null,p[f]);case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 16:++f,e.next=10;break;case 19:return e.abrupt("return",[l,c,h]);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"testLoop",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0;return Mo((function(){var o=r.checkNumSamples(t,n,i,"steps"),s=[];if(a>0)throw new Pf("Verbose mode is not implemented yet.");if(null!=i)throw new Pf("steps mode in testLoop() is not implemented yet");for(var u=lg(o,n),l=zu(Rd(0,o)),c=0;c<u.length;++c){var h=u[c][0],p=u[c][1],f=Pd(l,h,p-h),d=ug(t,f),v=e(d);if(0===c)for(var m=0;m<v.length;++m)s.push(Lo(0));for(var g=0;g<v.length;++g){var y=v[g];s[g]=Bo(s[g],Us(p-h,y))}}for(var b=0;b<s.length;++b)s[b]=Ss(s[b],o);return s}))}},{key:"getDedupedMetricsNames",value:function(){for(var e=this.metricsNames,t=[],n=0;n<e.length;++n){var r=e[n],a=r;if(Wf(e,r)>1){var i=Wf(e.slice(0,n),r);a+="_".concat(i)}t.push(a)}return t}},{key:"makeTrainFunction",value:function(){var e=this;return function(t){var n=[],r=t.slice(0,e.inputs.length),a=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),i=t.slice(e.inputs.length+e.outputs.length,e.inputs.length+2*e.outputs.length),o=[],s=e.collectedTrainableWeights.map((function(e){return e.read()}));return[e.optimizer_.minimize((function(){for(var t=[],s=0;s<e.inputs.length;++s)t.push({key:e.inputs[s],value:r[s]});for(var u,l=new Pm(t),c=Vm(e.outputs,l,{training:!0}),h=0;h<e.lossFunctions.length;++h){var p=(0,e.lossFunctions[h])(a[h],c[h]);null!=i[h]&&(p=Ym(p,i[h]));var f=Zs(p);n.push(f),u=0===h?p:Bo(u,p)}for(var d=0;d<e.metricsTensors.length;++d){var v=void 0;if(e.outputs.length>1&&d<e.outputs.length)v=n[d];else{var m=e.metricsTensors[d][0],g=e.metricsTensors[d][1];v=Zs(m(a[g],c[g]))}Do(v),o.push(v)}return u=Zs(u),e.calculateLosses().forEach((function(e){u=Bo(u,e)})),u}),!0,s)].concat(o)}}},{key:"makeTestFunction",value:function(){var e=this;this.testFunction=function(t){return Mo((function(){for(var n,r=[],a=t.slice(0,e.inputs.length),i=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),o=[],s=0;s<e.inputs.length;++s)o.push({key:e.inputs[s],value:a[s]});for(var u=new Pm(o),l=Vm(e.outputs,u),c=0;c<e.lossFunctions.length;++c){var h=e.lossFunctions[c],p=Zs(h(i[c],l[c]));n=0===c?p:Bo(n,p),r.push(n)}for(var f=0;f<e.metricsTensors.length;++f){var d=e.metricsTensors[f][0],v=e.metricsTensors[f][1],m=Zs(d(i[v],l[v]));r.push(m)}return r}))}}},{key:"fit",value:function(){var e=F(M().mark((function e(t,n){var r,a=arguments;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]?a[2]:{},e.abrupt("return",pg(this,t,n,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fitDataset",value:function(){var e=F(M().mark((function e(t,n){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Jm(this,t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"trainOnBatch",value:function(){var e=F(M().mark((function e(t,n){var r,a,i,o,s,u,l,c,h,p;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.standardizeUserData(t,n);case 2:r=e.sent,a=r[0],i=r[1],o=this.makeTrainFunction(),s=o(a.concat(i)),u=[],l=L(s),e.prev=9,l.s();case 11:if((c=l.n()).done){e.next=19;break}return h=c.value,e.next=15,h.data();case 15:p=e.sent,u.push(p[0]);case 17:e.next=11;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(9),l.e(e.t0);case 24:return e.prev=24,l.f(),e.finish(24);case 27:return Ao(s),e.abrupt("return",Uf(u));case 29:case"end":return e.stop()}}),e,this,[[9,21,24,27]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getNamedWeights",value:function(e){for(var t=[],n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n),i=0;i<r.length;++i)n&&!r[i].trainable||t.push({name:r[i].originalName,tensor:a[i]});return t}},{key:"stopTraining",get:function(){return this.stopTraining_},set:function(e){this.stopTraining_=e}},{key:"optimizer",get:function(){return this.optimizer_},set:function(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}},{key:"dispose",value:function(){var e=em(Gr(r.prototype),"dispose",this).call(this);if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){var t=Eo().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-Eo().numTensors}return e}},{key:"getLossIdentifiers",value:function(){var e;if("string"===typeof this.loss)e=Gf(this.loss);else if(Array.isArray(this.loss)){var t,n=L(this.loss);try{for(n.s();!(t=n.n()).done;){if("string"!==typeof t.value)throw new Error("Serialization of non-string loss is not supported.")}}catch($8){n.e($8)}finally{n.f()}e=this.loss.map((function(e){return Gf(e)}))}else{var r=Object.keys(this.loss);e={};for(var a=this.loss,i=0,o=r;i<o.length;i++){var s=o[i];if("string"!==typeof a[s])throw new Error("Serialization of non-string loss is not supported.");e[s]=Gf(a[s])}}return e}},{key:"getMetricIdentifiers",value:function(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[Gf(_m(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((function(e){return Gf(_m(e))}));var e={};for(var t in this.metrics)e[t]=Gf(_m(this.metrics[t]));return e}},{key:"getTrainingConfig",value:function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}},{key:"loadTrainingConfig",value:function(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");var t,n,r=tm(Om(e.optimizer_config));if("string"===typeof e.loss)t=jf(e.loss);else if(Array.isArray(e.loss))t=e.loss.map((function(e){return jf(e)}));else if(null!=e.loss)for(var a in t={},e.loss)t[a]=jf(e.loss[a]);if(Array.isArray(e.metrics))n=e.metrics.map((function(e){return jf(e)}));else if(null!=e.metrics)for(var i in n={},e.metrics)n[i]=jf(e.metrics[i]);this.compile({loss:t,metrics:n,optimizer:r})}},{key:"save",value:function(){var t=F(M().mark((function t(n,r){var a,i,o,s,u,l,c,h,p;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!==typeof n){t.next=9;break}if(0!==(a=Ja(n)).length){t.next=6;break}throw new Lf("Cannot find any save handlers for URL '".concat(n,"'"));case 6:if(!(a.length>1)){t.next=8;break}throw new Lf("Found more than one (".concat(a.length,") save handlers for ")+"URL '".concat(n,"'"));case 8:n=a[0];case 9:if(null!=n.save){t.next=11;break}throw new Lf("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 11:return t.next=13,za(this.getNamedWeights(r));case 13:if(i=t.sent,!1,null,o=this.toJSON(null,false),s={modelTopology:o,format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(Lm),convertedBy:null},!(null!=r&&r.includeOptimizer)||null==this.optimizer){t.next=34;break}return s.trainingConfig=this.getTrainingConfig(),l="optimizer",t.t0=e,t.next=25,this.optimizer.getWeights();case 25:return t.t1=t.sent,t.t2=l,t.next=29,t.t0.encodeWeights.call(t.t0,t.t1,t.t2);case 29:c=t.sent,h=c.data,p=c.specs,(u=i.specs).push.apply(u,I(p)),i.data=qa([i.data,h]);case 34:return null!=this.userDefinedMetadata&&(!0,Im(this.userDefinedMetadata,this.name,true),s.userDefinedMetadata=this.userDefinedMetadata),s.weightData=i.data,s.weightSpecs=i.specs,t.abrupt("return",n.save(s));case 38:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"setUserDefinedMetadata",value:function(e){Im(e,this.name),this.userDefinedMetadata=e}},{key:"getUserDefinedMetadata",value:function(){return this.userDefinedMetadata}}]),r}(Gm);wg.className="Model",To(wg);var _g=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n)}(wg);_g.className="Functional",To(_g);var Sg=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;if(A(this,n),e=e||{},(r=t.call(this,{inputs:[],outputs:[]})).trainable=!0,r.built=!1,r.name=null!=e.name?e.name:_v("sequential_"),null!=e.layers){var a,i=L(e.layers);try{for(i.s();!(a=i.n()).done;){var o=a.value;r.add(o)}}catch($8){i.e($8)}finally{i.f()}}return r}return R(n,[{key:"checkShape",value:function(e){if(e.inboundNodes[0].outputTensors[0].shape.some((function(e){return e<0})))throw new Lf("Negative dimension size caused by adding layer "+"".concat(e.name," with input shape [")+"".concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}},{key:"add",value:function(e){var t,r=e instanceof n||e instanceof wg;if(r){if(1!==(t=e).outputs.length)throw new Lf("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==t.inputs.length)throw new Lf("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new Lf("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var a=function(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new Lf("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));var n=e.dtype;return null==n&&(n="float32"),new Wv({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(a)}if(r)this.outputs=t.outputs,this.inputs=t.inputs;else{if(1!==e.inboundNodes.length)throw new Lf("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(e.name," ")+"which has ".concat(e.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new Lf("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=Bv(this.outputs[0])}this.inboundNodes=[],new Lv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Bf(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(e){return e.shape})),outputShapes:this.outputs[0].shape})}else{var i=e.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}},{key:"pop",value:function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}},{key:"call",value:function(e,t){return null==this.model&&this.build(),this.model.call(e,t)}},{key:"build",value:function(e){if(Tv(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new wg({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}},{key:"countParams",value:function(){return this.built||this.build(),em(Gr(n.prototype),"countParams",this).call(this)}},{key:"summary",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),em(Gr(n.prototype),"summary",this).call(this,e,t,r)}},{key:"setWeights",value:function(e){null==this.model&&this.build(),this.model.setWeights(e)}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new Ff("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}},{key:"evaluateDataset",value:function(){var e=F(M().mark((function e(t,n){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new Ff("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.evaluateDataset(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}},{key:"predictOnBatch",value:function(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}},{key:"compile",value:function(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}},{key:"optimizer",get:function(){return null==this.model?void 0:this.model.optimizer},set:function(e){this.model.optimizer=e}},{key:"fit",value:function(){var e=F(M().mark((function e(t,n){var r,a=arguments;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>2&&void 0!==a[2]?a[2]:{},this.built){e.next=3;break}throw new Ff("The model needs to be compiled before being used.");case 3:return e.abrupt("return",this.model.fit(t,n,r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fitDataset",value:function(){var e=F(M().mark((function e(t,n){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new Ff("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.fitDataset(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"trainOnBatch",value:function(){var e=F(M().mark((function e(t,n){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.model.trainOnBatch(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"stopTraining",get:function(){if(null==this.model)throw new Lf("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(e){if(null==this.model)throw new Lf("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}},{key:"getConfig",value:function(){var e,t=[],n=L(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value,a={};a.className=r.getClassName(),a.config=r.getConfig(),t.push(a)}}catch($8){n.e($8)}finally{n.f()}return{name:this.name,layers:t}}}],[{key:"fromConfig",value:function(e,t){var r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new Lf("Legacy serialization format not supported yet.");r=t}else G(null!=t.layers,(function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."})),r=t.layers,delete t.layers,i=t;var o=new e(i);if(!(o instanceof n))throw new Pf("Sequential.fromConfig called on non-Sequential input: ".concat(o));var s,u=L(r);try{for(u.s();!(s=u.n()).done;){var l=s.value,c=void 0,h=tm(l,c,a);a&&h.setFastWeightInitDuringBuild(!0),o.add(h)}}catch($8){u.e($8)}finally{u.f()}return o}}]),n}(wg);Sg.className="Sequential",To(Sg);var Ig=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"getConfig",value:function(){return{}}}]),n}(Io),Cg=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Yd(e,t)}}]),n}(Ig);Cg.className="elu",To(Cg);var Tg=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"apply",value:function(e){return _u(e)}}]),n}(Ig);Tg.className="selu",To(Tg);var Ng=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"apply",value:function(e){return ku(e)}}]),n}(Ig);Ng.className="relu",To(Ng);var Eg=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"apply",value:function(e){return Mo((function(){return $s(6,ku(e))}))}}]),n}(Ig);Eg.className="relu6",To(Eg);var Mg=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"apply",value:function(e){return e}}]),n}(Ig);Mg.className="linear",To(Mg);var Ag=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"apply",value:function(e){return Iu(e)}}]),n}(Ig);Ag.className="sigmoid",To(Ag);var Dg=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"apply",value:function(e){return function(e){return Mo((function(){var t=Bo(.5,Us(.2,e));return hs(t,0,1)}))}(e)}}]),n}(Ig);Dg.className="hardSigmoid",To(Dg);var Rg=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"apply",value:function(e){return Du(e)}}]),n}(Ig);Rg.className="softplus",To(Rg);var Og=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"apply",value:function(e){return function(e){return Mo((function(){return Ss(e,zo(e).add(1))}))}(e)}}]),n}(Ig);Og.className="softsign",To(Og);var Fg=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"apply",value:function(e){return Pu(e)}}]),n}(Ig);Fg.className="tanh",To(Fg);var Lg=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return Au(e,t)}}]),n}(Ig);Lg.className="softmax",To(Lg);var Pg=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return js(e,t)}}]),n}(Ig);Pg.className="logSoftmax",To(Pg);var zg=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Mo((function(){return Iu(e.mul(t)).mul(e)}))}}]),n}(Ig);function Bg(e){return e.getClassName()}function Vg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Yf(e,Co.getMap().classNameMap,t,"activation")}function Wg(e){if(null==e){var t={className:"linear",config:{}};return Vg(t)}if("string"===typeof e){var n={};return n.className=e,n.config={},Vg(n)}return e instanceof Ig?e:Vg(e)}function Ug(e){if(null!=e&&"object"!==typeof e)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(e))}zg.className="swish",To(zg);var Hg=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n)}(Io),Gg=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),r=t.call(this),Ug(e),r.l1=null==e||null==e.l1?.01:e.l1,r.l2=null==e||null==e.l2?.01:e.l2,r.hasL1=0!==r.l1,r.hasL2=0!==r.l2,r}return R(n,[{key:"apply",value:function(e){var t=this;return Mo((function(){var n=hu([1]);return t.hasL1&&(n=Bo(n,Gs(Us(t.l1,zo(e))))),t.hasL2&&(n=Bo(n,Gs(Us(t.l2,qd(e))))),n.asScalar()}))}},{key:"getConfig",value:function(){return{l1:this.l1,l2:this.l2}}}],[{key:"fromConfig",value:function(e,t){return new e({l1:t.l1,l2:t.l2})}}]),n}(Hg);Gg.className="L1L2",To(Gg);var jg={l1l2:"L1L2"};function qg(e){return Xf(e)}function Xg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Yf(e,Co.getMap().classNameMap,t,"regularizer")}function Kg(e){return null==e?null:"string"===typeof e?Xg({className:e in jg?jg[e]:e,config:{}}):e instanceof Hg?e:Xg(e)}var Yg=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,null!=e&&(r.maxValue=e.maxValue),r}return R(n,[{key:"call",value:function(e,t){e=Cv(e);var n=ku(e);return null!=this.maxValue&&(n=hs(n,0,this.maxValue)),n}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={maxValue:this.maxValue},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv);Yg.className="ReLU",To(Yg);var Zg=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=.3,null==e&&(e={}),r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return R(n,[{key:"call",value:function(e,t){var n=Cv(e);return zs(n,this.alpha)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv);Zg.className="LeakyReLU",To(Zg);var Qg=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;if(A(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),r.supportsMasking=!0,r.alphaInitializer=bv(e.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=Kg(e.alphaRegularizer),r.alphaConstraint=fd(e.alphaConstraint),null==e.sharedAxes)r.sharedAxes=null;else if(Array.isArray(e.sharedAxes))r.sharedAxes=e.sharedAxes;else{if("number"!==typeof e.sharedAxes)throw new Lf("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(e.sharedAxes));r.sharedAxes=[e.sharedAxes]}return r}return R(n,[{key:"build",value:function(e){var t=(e=Tv(e)).slice(1);if(null!=this.sharedAxes){var n,r=L(this.sharedAxes);try{for(r.s();!(n=r.n()).done;){t[n.value-1]=1}}catch($8){r.e($8)}finally{r.f()}}this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var a={};if(null!=this.sharedAxes)for(var i=1;i<e.length;++i)a[i]=e[i];this.inputSpec=[new Rv({ndim:e.length,axes:a})],this.built=!0}},{key:"call",value:function(e,t){return e=Cv(e),vu(e,this.alpha.read())}},{key:"getConfig",value:function(){var e={alphaInitializer:yv(this.alphaInitializer),alphaRegularizer:qg(this.alphaRegularizer),alphaConstraint:hd(this.alphaConstraint),sharedAxes:this.sharedAxes},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv);Qg.className="PReLU",To(Qg);var $g=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;if(A(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==r.DEFAULT_ALPHA)throw new Pf("Non-default alpha value (".concat(e.alpha,") is not supported by the ")+"ELU layer yet.");return r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return R(n,[{key:"call",value:function(e,t){var n=Cv(e);return Is(n)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv);$g.className="ELU",To($g);var Jg=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_THETA=1,null==e&&(e={}),r.theta=null==e.theta?r.DEFAULT_THETA:e.theta,r}return R(n,[{key:"call",value:function(e,t){var n=Cv(e);return n.mul(Od(n.greater(this.theta),"float32"))}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={theta:this.theta},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv);Jg.className="ThresholdedReLU",To(Jg);var ey=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_AXIS=1,null==e&&(e={}),r.softmax=(new Lg).apply,r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r}return R(n,[{key:"call",value:function(e,t){var n=Cv(e);return this.softmax(n,this.axis)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={axis:this.axis},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv);function ty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ny(e,t,n){if("number"===typeof e)return Bf(e,t);if(e.length!==t)throw new Lf("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers.")+" Received: ".concat(e.length," elements."));for(var r=0;r<t;++r){var a=e[r];if((i=a)!==parseInt(i.toString(),10))throw new Lf("The ".concat(n," argument must be an integer or tuple of ").concat(t)+" integers. Received: ".concat(JSON.stringify(e)," including a")+" non-integer number ".concat(a))}return e;var i}function ry(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(null==e)return e;var i,o=t+(t-1)*(a-1);return i="same"===n?e:e-o+1,Math.floor((i+r-1)/r)}function ay(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+Dd([n-t,0]);else{if("same"!==r)throw new Lf("Unsupport padding mode: ".concat(r,"."));e*=t}return e}function iy(e,t){return Mo((function(){return xd(t),"channelsFirst"===t?qu(e,[0,2,3,1]):e}))}function oy(e,t){return Mo((function(){return xd(t),"channelsFirst"===t?qu(e,[0,2,3,4,1]):e}))}function sy(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return Mo((function(){if(null==i&&(i="channelsLast"),xd(i),3!==e.shape.length)throw new Lf("The input of a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead."));if(3!==t.shape.length)throw new Lf("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new Lf("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(t.shape.length," instead"));if("channelsFirst"===i&&(e=qu(e,[0,2,1])),"causal"===a)throw new Pf("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var s=ys(e,t,r,"same"===a?"same":"valid","NWC",o);return null!=n&&(s=Kd(s,n)),s}))}function uy(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return Mo((function(){if(null==i&&(i="channelsLast"),xd(i),3!==e.rank&&4!==e.rank)throw new Lf("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));if(3!==t.rank&&4!==t.rank)throw new Lf("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));var u=iy(e,i);if("causal"===a)throw new Pf("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=sl({x:u,filter:t,strides:r,pad:"same"===a?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),"channelsFirst"===i&&(u=qu(u,[0,3,1,2])),u}))}function ly(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;return Mo((function(){if(null==i&&(i="channelsLast"),xd(i),4!==e.rank&&5!==e.rank)throw new Lf("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(e.rank,"."));if(4!==t.rank&&5!==t.rank)throw new Lf("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(e.rank,"."));var s=oy(e,i);if("causal"===a)throw new Pf("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=ks(s,t,r,"same"===a?"same":"valid","NDHWC",o),null!=n&&(s=Kd(s,n)),"channelsFirst"===i&&(s=qu(s,[0,4,1,2,3])),s}))}ey.className="Softmax",To(ey);var cy=function(e){Hr(n,e);var t=Kr(n);function n(e,r){var a;if(A(this,n),(a=t.call(this,r)).bias=null,a.DEFAULT_KERNEL_INITIALIZER="glorotNormal",a.DEFAULT_BIAS_INITIALIZER="zeros",n.verifyArgs(r),a.rank=e,td(a.rank,"rank"),1!==a.rank&&2!==a.rank&&3!==a.rank)throw new Pf("Convolution layer for rank other than 1, 2, or 3 (".concat(a.rank,") is ")+"not implemented yet.");if(a.kernelSize=ny(r.kernelSize,e,"kernelSize"),a.strides=ny(null==r.strides?1:r.strides,e,"strides"),a.padding=null==r.padding?"valid":r.padding,kd(a.padding),a.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,xd(a.dataFormat),a.activation=Wg(r.activation),a.useBias=null==r.useBias||r.useBias,a.biasInitializer=bv(r.biasInitializer||a.DEFAULT_BIAS_INITIALIZER),a.biasConstraint=fd(r.biasConstraint),a.biasRegularizer=Kg(r.biasRegularizer),a.activityRegularizer=Kg(r.activityRegularizer),a.dilationRate=ny(null==r.dilationRate?1:r.dilationRate,e,"dilationRate"),1===a.rank&&Array.isArray(a.dilationRate)&&1!==a.dilationRate.length)throw new Lf("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(a.dilationRate)));if(2===a.rank){if("number"===typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate];else if(2!==a.dilationRate.length)throw new Lf("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)))}else if(3===a.rank)if("number"===typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate,a.dilationRate];else if(3!==a.dilationRate.length)throw new Lf("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)));return a}return R(n,[{key:"getConfig",value:function(){var e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Bg(this.activation),useBias:this.useBias,biasInitializer:yv(this.biasInitializer),biasRegularizer:qg(this.biasRegularizer),activityRegularizer:qg(this.activityRegularizer),biasConstraint:hd(this.biasConstraint)},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(Vf("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!==typeof e.kernelSize&&!ed(e.kernelSize,"number",1,3))throw new Lf("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(zv),hy=function(e){Hr(n,e);var t=Kr(n);function n(e,r){var a;return A(this,n),(a=t.call(this,e,r)).kernel=null,n.verifyArgs(r),a.filters=r.filters,td(a.filters,"filters"),a.kernelInitializer=bv(r.kernelInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.kernelConstraint=fd(r.kernelConstraint),a.kernelRegularizer=Kg(r.kernelRegularizer),a}return R(n,[{key:"build",value:function(e){e=Tv(e);var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new Lf("The channel dimension of the input should be defined. "+"Found ".concat(e[t]));var n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:ty({},t,n)}],this.built=!0}},{key:"call",value:function(e,t){var n=this;return Mo((function(){var t;e=Cv(e);var r=null==n.bias?null:n.bias.read(),a=rd(n.activation.getClassName());if(null!=a&&2===n.rank)t=uy(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate,a);else{if(1===n.rank)t=sy(e,n.kernel.read(),r,n.strides[0],n.padding,n.dataFormat,n.dilationRate[0]);else if(2===n.rank)t=uy(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate);else{if(3!==n.rank)throw new Pf("convolutions greater than 3D are not implemented yet.");t=ly(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate)}null!=n.activation&&(t=n.activation.apply(t))}return t}))}},{key:"computeOutputShape",value:function(e){e=Tv(e);for(var t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2),r=0;r<n.length;++r){var a=ry(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);t.push(a)}var i=[e[0]];return"channelsLast"===this.dataFormat?(i=i.concat(t)).push(this.filters):(i.push(this.filters),i=i.concat(t)),i}},{key:"getConfig",value:function(){var e={filters:this.filters,kernelInitializer:yv(this.kernelInitializer),kernelRegularizer:qg(this.kernelRegularizer),kernelConstraint:hd(this.kernelConstraint)},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(!("filters"in e)||"number"!==typeof e.filters||e.filters<1)throw new Lf("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(e.filters)))}}]),n}(cy),py=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),r=t.call(this,2,e),n.verifyArgs(e),r}return R(n,[{key:"getConfig",value:function(){var e=em(Gr(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&!ed(e.kernelSize,"number",1,2))throw new Lf("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(hy);py.className="Conv2D",To(py);var fy=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),r=t.call(this,3,e),n.verifyArgs(e),r}return R(n,[{key:"getConfig",value:function(){var e=em(Gr(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new Lf("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(hy);fy.className="Conv3D",To(fy);var dy=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;if(A(this,n),(r=t.call(this,e)).inputSpec=[new Rv({ndim:4})],"same"!==r.padding&&"valid"!==r.padding)throw new Lf("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(r.padding));return r}return R(n,[{key:"build",value:function(e){if(4!==(e=Tv(e)).length)throw new Lf("Input should have rank 4; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new Lf("The channel dimension of the inputs should be defined. Found `None`.");var n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Rv({ndim:4,axes:ty({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return Mo((function(){var t=Cv(e);if(4!==t.shape.length)throw new Lf("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));var r,a,i=t.shape,o=i[0];"channelsFirst"===n.dataFormat?(r=2,a=3):(r=1,a=2);var s=i[r],u=i[a],l=n.kernelSize[0],c=n.kernelSize[1],h=n.strides[0],p=n.strides[1],f=[o,ay(s,h,l,n.padding),ay(u,p,c,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=qu(t,[0,2,3,1]));var d=xs(t,n.kernel.read(),f,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(d=qu(d,[0,3,1,2])),null!=n.bias&&(d=Kd(d,n.bias.read(),n.dataFormat)),null!=n.activation&&(d=n.activation.apply(d)),d}))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=(e=Tv(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3):(t=3,n=1,r=2);var i=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],u=this.strides[1];return a[t]=this.filters,a[n]=ay(a[n],s,i,this.padding),a[r]=ay(a[r],u,o,this.padding),a}},{key:"getConfig",value:function(){var e=em(Gr(n.prototype),"getConfig",this).call(this);return delete e.dilationRate,e}}]),n}(py);dy.className="Conv2DTranspose",To(dy);var vy=function(e){Hr(n,e);var t=Kr(n);function n(e,r){var a;if(A(this,n),(a=t.call(this,e,r)).DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",a.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",a.depthwiseKernel=null,a.pointwiseKernel=null,null==r.filters)throw new Lf("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=r.kernelInitializer||null!=r.kernelRegularizer||null!=r.kernelConstraint)throw new Lf("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=r.padding&&"same"!==r.padding&&"valid"!==r.padding)throw new Lf("SeparableConv".concat(a.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(r.padding)));return a.depthMultiplier=null==r.depthMultiplier?1:r.depthMultiplier,a.depthwiseInitializer=bv(r.depthwiseInitializer||a.DEFAULT_DEPTHWISE_INITIALIZER),a.depthwiseRegularizer=Kg(r.depthwiseRegularizer),a.depthwiseConstraint=fd(r.depthwiseConstraint),a.pointwiseInitializer=bv(r.depthwiseInitializer||a.DEFAULT_POINTWISE_INITIALIZER),a.pointwiseRegularizer=Kg(r.pointwiseRegularizer),a.pointwiseConstraint=fd(r.pointwiseConstraint),a}return R(n,[{key:"build",value:function(e){if((e=Tv(e)).length<this.rank+2)throw new Lf("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(e)));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new Lf("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(e[t])));for(var n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[],i=0;i<this.rank;++i)a.push(1);a.push(n*this.depthMultiplier,this.filters);var o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new Rv({ndim:this.rank+2,axes:ty({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return Mo((function(){var t;if(e=Cv(e),1===n.rank)throw new Pf("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(e=qu(e,[0,2,3,1])),t=Su(e,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(t=Kd(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),"channelsFirst"===n.dataFormat&&(t=qu(t,[0,3,1,2])),t}))}},{key:"getConfig",value:function(){var e=em(Gr(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=yv(this.depthwiseInitializer),e.pointwiseInitializer=yv(this.pointwiseInitializer),e.depthwiseRegularizer=qg(this.depthwiseRegularizer),e.pointwiseRegularizer=qg(this.pointwiseRegularizer),e.depthwiseConstraint=hd(this.depthwiseConstraint),e.pointwiseConstraint=hd(this.pointwiseConstraint),e}}]),n}(hy);vy.className="SeparableConv";var my=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,2,e)}return R(n)}(vy);my.className="SeparableConv2D",To(my);var gy=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),r=t.call(this,1,e),n.verifyArgs(e),r.inputSpec=[{ndim:3}],r}return R(n,[{key:"getConfig",value:function(){var e=em(Gr(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.dataFormat,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&!ed(e.kernelSize,"number",1,1))throw new Lf("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(hy);gy.className="Conv1D",To(gy);var yy=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),r=t.call(this,e),"number"===typeof e.cropping?r.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"===typeof e.cropping[0]?r.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:r.cropping=e.cropping,r.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,r.inputSpec=[{ndim:4}],r}return R(n,[{key:"computeOutputShape",value:function(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}},{key:"call",value:function(e,t){var n=this;return Mo((function(){if(e=Cv(e),"channelsLast"===n.dataFormat){var t=Bd(e,n.cropping[0][0],e.shape[1]-n.cropping[0][0]-n.cropping[0][1],2);return Bd(t,n.cropping[1][0],e.shape[2]-n.cropping[1][1]-n.cropping[1][0],3)}var r=Bd(e,n.cropping[0][0],e.shape[2]-n.cropping[0][0]-n.cropping[0][1],3);return Bd(r,n.cropping[1][0],e.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)}))}},{key:"getConfig",value:function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv);yy.className="Cropping2D",To(yy);var by=function(e){Hr(n,e);var t=Kr(n);function n(e){var r,a;return A(this,n),(r=t.call(this,e)).DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=null==e.size?r.DEFAULT_SIZE:e.size,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,xd(r.dataFormat),r.interpolation=null==e.interpolation?"nearest":e.interpolation,a=r.interpolation,Jf(vd,"InterpolationFormat",a),r}return R(n,[{key:"computeOutputShape",value:function(e){if("channelsFirst"===this.dataFormat){var t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}var r=null==e[1]?null:this.size[0]*e[1],a=null==e[2]?null:this.size[1]*e[2];return[e[0],r,a,e[3]]}},{key:"call",value:function(e,t){var n=this;return Mo((function(){var t=Cv(e),r=t.shape;if("channelsFirst"===n.dataFormat){t=qu(t,[0,2,3,1]);var a=n.size[0]*r[2],i=n.size[1]*r[3],o="nearest"===n.interpolation?t.resizeNearestNeighbor([a,i]):t.resizeBilinear([a,i]);return qu(o,[0,3,1,2])}var s=n.size[0]*r[1],u=n.size[1]*r[2];return"nearest"===n.interpolation?t.resizeNearestNeighbor([s,u]):t.resizeBilinear([s,u])}))}},{key:"getConfig",value:function(){var e={size:this.size,dataFormat:this.dataFormat},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv);by.className="UpSampling2D",To(by);var xy=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,2,e)).depthwiseKernel=null,r.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,r.depthwiseInitializer=bv(e.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=fd(e.depthwiseConstraint),r.depthwiseRegularizer=Kg(e.depthwiseRegularizer),r}return R(n,[{key:"build",value:function(e){if((e=Tv(e)).length<4)throw new Lf("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(e),"."));var t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new Lf("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(e[t],")."));var n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return Mo((function(){var t=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;return Mo((function(){null==a&&(a="channelsLast"),xd(a);var o=iy(e,a);if(4!==e.rank)throw new Lf("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));if(4!==t.rank)throw new Lf("depthwiseKernel is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));return o=ws(o,t,n,"same"===r?"same":"valid","NHWC",i),"channelsFirst"===a&&(o=qu(o,[0,3,1,2])),o}))}(e=Cv(e),n.depthwiseKernel.read(),n.strides,n.padding,n.dataFormat,null);return n.useBias&&(t=Kd(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),t}))}},{key:"computeOutputShape",value:function(e){e=Tv(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=ry(t,this.kernelSize[0],this.padding,this.strides[0]),i=ry(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,a,i]:[e[0],a,i,r]}},{key:"getConfig",value:function(){var e=em(Gr(n.prototype),"getConfig",this).call(this);return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=yv(this.depthwiseInitializer),e.depthwiseRegularizer=qg(this.depthwiseRegularizer),e.depthwiseConstraint=hd(this.depthwiseRegularizer),e}}]),n}(cy);function ky(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new Lf("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function a(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=a(t),constants:n=a(n)}}function wy(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return Mo((function(){var u=t.shape.length;if(u<3)throw new Lf("Input should be at least 3D, but is ".concat(u,"D."));var l=[1,0].concat(Rd(2,u));if(t=qu(t,l),null!=i)throw new Pf("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=a&&((a=a.asType("bool").asType("float32")).rank===u-1&&(a=Ms(a,-1)),a=qu(a,l)),r&&(t=wu(t,0),null!=a&&(a=wu(a,0)));var c,h,p=[],f=n,d=t.shape[0],v=Wu(t);null!=a&&(h=Wu(a));for(var m,g=function(t){var n=v[t],r=Mo((function(){return e(n,f)}));if(null==a)c=r[0],f=r[1];else{var i=Mo((function(){var e=h[t],n=fu(e).sub(e);return{output:r[0].mul(e).add(f[0].mul(n)),newStates:f.map((function(t,a){return r[1][a].mul(e).add(t.mul(n))}))}}));c=i.output,f=i.newStates}s&&p.push(c)},y=0;y<d;++y)g(y);if(s){m=Lu(p,1)}return[c,m,f]}))}xy.className="DepthwiseConv2D",To(xy);var _y=function(e){Hr(n,e);var t=Kr(n);function n(e){var r,a;if(A(this,n),r=t.call(this,e),null==e.cell)throw new Lf("cell property is missing for the constructor of RNN.");if(null==(a=Array.isArray(e.cell)?new Ay({cells:e.cell}):e.cell).stateSize)throw new Lf("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=a,r.returnSequences=null!=e.returnSequences&&e.returnSequences,r.returnState=null!=e.returnState&&e.returnState,r.goBackwards=null!=e.goBackwards&&e.goBackwards,r._stateful=null!=e.stateful&&e.stateful,r.unroll=null!=e.unroll&&e.unroll,r.supportsMasking=!0,r.inputSpec=[new Rv({ndim:3})],r.stateSpec=null,r.states_=null,r.numConstants=null,r.keptStates=[],r}return R(n,[{key:"getStates",value:function(){return null==this.states_?Rd(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((function(e){return null})):this.states_}},{key:"setStates",value:function(e){this.states_=e}},{key:"computeOutputShape",value:function(e){Sv(e)&&(e=e[0]);var t=this.cell.stateSize;Array.isArray(t)||(t=[t]);var n,r=t[0];if(n=this.returnSequences?[e[0],e[1],r]:[e[0],r],this.returnState){var a,i=[],o=L(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push([e[0],s])}}catch($8){o.e($8)}finally{o.f()}return[n].concat(i)}return n}},{key:"computeMask",value:function(e,t){var n=this;return Mo((function(){Array.isArray(t)&&(t=t[0]);var e=n.returnSequences?t:null;if(n.returnState){var r=n.states.map((function(e){return null}));return[e].concat(r)}return e}))}},{key:"states",get:function(){if(null==this.states_){for(var e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[],n=0;n<e;++n)t.push(null);return t}return this.states_},set:function(e){this.states_=e}},{key:"build",value:function(e){if(null!=this.numConstants)throw new Pf("Constants support is not implemented in RNN yet.");Sv(e)&&(e=e[0]);var t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new Rv({shape:[t,null].concat(I(n))});var r,a=[e[0]].concat(e.slice(2));if(this.cell.build(a),r=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!Y(this.stateSpec.map((function(e){return e.shape[e.shape.length-1]})),r))throw new Lf("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=r.map((function(e){return new Rv({shape:[null,e]})}));this.stateful&&this.resetStates()}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Mo((function(){if(!t.stateful)throw new Of("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape[0];if(null==r)throw new Lf("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.states_)Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return hu([r,e])})):t.states_=[hu([r,t.cell.stateSize])];else if(null==e)Ao(t.states_),null!=t.keptStates&&(Ao(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return hu([r,e])})):t.states_[0]=hu([r,t.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new Lf("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));!0===n?t.keptStates.push(t.states_.slice()):Ao(t.states_);for(var a=0;a<t.states_.length;++a){var i=e[a],o=Array.isArray(t.cell.stateSize)?t.cell.stateSize[a]:t.cell.stateSize,s=[r,o];if(!Y(i.shape,s))throw new Lf("State ".concat(a," is incompatible with layer ").concat(t.name,": ")+"expected shape=".concat(s,", received shape=").concat(i.shape));t.states_[a]=i}}t.states_=t.states_.map((function(e){return Do(e.clone())}))}))}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=ky(e,r,a,this.numConstants);e=i.inputs,r=i.initialState,a=i.constants;var o=[],s=[];if(null!=r){t.initialState=r,o=o.concat(r),this.stateSpec=[];var u,l=L(r);try{for(l.s();!(u=l.n()).done;){var c=u.value;this.stateSpec.push(new Rv({shape:c.shape}))}}catch($8){l.e($8)}finally{l.f()}s=s.concat(this.stateSpec)}if(null!=a&&(t.constants=a,o=o.concat(a),this.numConstants=a.length),o[0]instanceof Ov){var h=[e].concat(o),p=this.inputSpec.concat(s),f=this.inputSpec;this.inputSpec=p;var d=em(Gr(n.prototype),"apply",this).call(this,h,t);return this.inputSpec=f,d}return em(Gr(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return Mo((function(){var r=null==t?null:t.mask,a=null==t?null:t.training,i=null==t?null:t.initialState;e=Cv(e),null==i&&(i=n.stateful?n.states_:n.getInitialState(e));var o=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(i.length!==o)throw new Lf("RNN Layer has ".concat(o," state(s) but was passed ")+"".concat(i.length," initial state(s)."));n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var s={training:a},u=wy((function(e,t){var r=n.cell.call([e].concat(t),s);return[r[0],r.slice(1)]}),e,i,n.goBackwards,r,null,n.unroll,n.returnSequences),l=u[0],c=u[1],h=u[2];n.stateful&&n.resetStates(h,a);var p=n.returnSequences?c:l;return n.returnState?[p].concat(h):p}))}},{key:"getInitialState",value:function(e){var t=this;return Mo((function(){var n=hu(e.shape);return n=Fd(n=Gs(n,[1,2])),Array.isArray(t.cell.stateSize)?t.cell.stateSize.map((function(e){return e>1?Ud(n,[1,e]):n})):t.cell.stateSize>1?[Ud(n,[1,t.cell.stateSize])]:[n]}))}},{key:"trainableWeights",get:function(){return this.trainable?this.cell.trainableWeights:[]}},{key:"nonTrainableWeights",get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}},{key:"setFastWeightInitDuringBuild",value:function(e){em(Gr(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e=em(Gr(n.prototype),"getConfig",this).call(this),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);var r=this.cell.getConfig();return this.getClassName()===n.className&&(t.cell={className:this.cell.getClassName(),config:r}),Object.assign({},r,e,t)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.cell,a=tm(r,n);return new e(Object.assign(t,{cell:a}))}}]),n}(zv);_y.className="RNN",To(_y);var Sy=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n)}(zv),Iy=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,td(r.units,"units"),r.activation=Wg(null==e.activation?r.DEFAULT_ACTIVATION:e.activation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=bv(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=bv(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=bv(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=Kg(e.kernelRegularizer),r.recurrentRegularizer=Kg(e.recurrentRegularizer),r.biasRegularizer=Kg(e.biasRegularizer),r.kernelConstraint=fd(e.kernelConstraint),r.recurrentConstraint=fd(e.recurrentConstraint),r.biasConstraint=fd(e.biasConstraint),r.dropout=Ad([1,Dd([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=Ad([1,Dd([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return R(n,[{key:"build",value:function(e){e=Tv(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return Mo((function(){if(2!==e.length)throw new Lf("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));var r=e[1];e=e[0];var a,i=null!=t.training&&t.training;0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Dy({ones:function(){return fu(e)},rate:n.dropout,training:i})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Dy({ones:function(){return fu(r)},rate:n.recurrentDropout,training:i}));var o=n.dropoutMask,s=n.recurrentDropoutMask;a=Gd(null!=o?Us(e,o):e,n.kernel.read()),null!=n.bias&&(a=Kd(a,n.bias.read())),null!=s&&(r=Us(r,s));var u=Bo(a,Gd(r,n.recurrentKernel.read()));return null!=n.activation&&(u=n.activation.apply(u)),[u,u]}))}},{key:"getConfig",value:function(){var e=em(Gr(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:Bg(this.activation),useBias:this.useBias,kernelInitializer:yv(this.kernelInitializer),recurrentInitializer:yv(this.recurrentInitializer),biasInitializer:yv(this.biasInitializer),kernelRegularizer:qg(this.kernelRegularizer),recurrentRegularizer:qg(this.recurrentRegularizer),biasRegularizer:qg(this.biasRegularizer),activityRegularizer:qg(this.activityRegularizer),kernelConstraint:hd(this.kernelConstraint),recurrentConstraint:hd(this.recurrentConstraint),biasConstraint:hd(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign({},e,t)}}]),n}(Sy);Iy.className="SimpleRNNCell",To(Iy);var Cy=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),e.cell=new Iy(e),t.call(this,e)}return R(n,[{key:"call",value:function(e,t){var r=this;return Mo((function(){null!=r.cell.dropoutMask&&(Ao(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Ao(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return em(Gr(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(_y);Cy.className="SimpleRNN",To(Cy);var Ty=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;if(A(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new Lf("GRUCell does not support reset_after parameter set to true.");return r.units=e.units,td(r.units,"units"),r.activation=Wg(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=Wg(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=bv(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=bv(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=bv(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=Kg(e.kernelRegularizer),r.recurrentRegularizer=Kg(e.recurrentRegularizer),r.biasRegularizer=Kg(e.biasRegularizer),r.kernelConstraint=fd(e.kernelConstraint),r.recurrentConstraint=fd(e.recurrentConstraint),r.biasConstraint=fd(e.biasConstraint),r.dropout=Ad([1,Dd([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=Ad([1,Dd([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.implementation=e.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return R(n,[{key:"build",value:function(e){var t=(e=Tv(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return Mo((function(){if(2!==e.length)throw new Lf("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=null!=t.training&&t.training,a=e[1];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Dy({ones:function(){return fu(e)},rate:n.dropout,training:r,count:3})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Dy({ones:function(){return fu(a)},rate:n.recurrentDropout,training:r,count:3}));var i,o,s,u=n.dropoutMask,l=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=Us(e,u[0]));var c=Gd(e,n.kernel.read());n.useBias&&(c=Kd(c,n.bias.read())),0<n.recurrentDropout&&n.recurrentDropout<1&&(a=Us(a,l[0]));var h=n.recurrentKernel.read(),p=N(Ru(h,[2*n.units,n.units],h.rank-1),2),f=p[0],d=p[1],v=Gd(a,f),m=N(Ru(c,3,c.rank-1),3),g=m[0],y=m[1],b=m[2],x=N(Ru(v,2,v.rank-1),2),k=x[0],w=x[1];i=n.recurrentActivation.apply(Bo(g,k)),o=n.recurrentActivation.apply(Bo(y,w));var _=Gd(Us(o,a),d);s=n.activation.apply(Bo(b,_));var S=Bo(Us(i,a),Us(Bo(1,uu(i)),s));return[S,S]}))}},{key:"getConfig",value:function(){var e=em(Gr(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:Bg(this.activation),recurrentActivation:Bg(this.recurrentActivation),useBias:this.useBias,kernelInitializer:yv(this.kernelInitializer),recurrentInitializer:yv(this.recurrentInitializer),biasInitializer:yv(this.biasInitializer),kernelRegularizer:qg(this.kernelRegularizer),recurrentRegularizer:qg(this.recurrentRegularizer),biasRegularizer:qg(this.biasRegularizer),activityRegularizer:qg(this.activityRegularizer),kernelConstraint:hd(this.kernelConstraint),recurrentConstraint:hd(this.recurrentConstraint),biasConstraint:hd(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign({},e,t)}}]),n}(Sy);Ty.className="GRUCell",To(Ty);var Ny=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Ty(e),t.call(this,e)}return R(n,[{key:"call",value:function(e,t){var r=this;return Mo((function(){null!=r.cell.dropoutMask&&(Ao(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Ao(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return em(Gr(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(_y);Ny.className="GRU",To(Ny);var Ey=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,td(r.units,"units"),r.activation=Wg(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=Wg(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=bv(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=bv(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=bv(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=e.unitForgetBias,r.kernelRegularizer=Kg(e.kernelRegularizer),r.recurrentRegularizer=Kg(e.recurrentRegularizer),r.biasRegularizer=Kg(e.biasRegularizer),r.kernelConstraint=fd(e.kernelConstraint),r.recurrentConstraint=fd(e.recurrentConstraint),r.biasConstraint=fd(e.biasConstraint),r.dropout=Ad([1,Dd([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=Ad([1,Dd([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.implementation=e.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return R(n,[{key:"build",value:function(e){var t,n,r=(e=Tv(e))[e.length-1];if(this.kernel=this.addWeight("kernel",[r,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var a=this.biasInitializer,i=this.units;n=new(t=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"apply",value:function(e,t){var n=a.apply([i]),r=(new nv).apply([i]),o=a.apply([2*i]);return Wd(Wd(n,r),o)}}]),n}(ev),t.className="CustomInit",t)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}},{key:"call",value:function(e,t){var n=this;return Mo((function(){var r=null!=t.training&&t.training;if(3!==e.length)throw new Lf("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var a=e[1],i=e[2];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Dy({ones:function(){return fu(e)},rate:n.dropout,training:r,count:4})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Dy({ones:function(){return fu(a)},rate:n.recurrentDropout,training:r,count:4}));var o,s,u,l,c=n.dropoutMask,h=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=Us(e,c[0]));var p=Gd(e,n.kernel.read());0<n.recurrentDropout&&n.recurrentDropout<1&&(a=Us(a,h[0])),p=Bo(p,Gd(a,n.recurrentKernel.read())),n.useBias&&(p=Kd(p,n.bias.read()));var f=N(Ru(p,4,p.rank-1),4),d=f[0],v=f[1],m=f[2],g=f[3];o=n.recurrentActivation.apply(d),s=n.recurrentActivation.apply(v),u=Bo(Us(s,i),Us(o,n.activation.apply(m))),l=n.recurrentActivation.apply(g);var y=Us(l,n.activation.apply(u));return[y,y,u]}))}},{key:"getConfig",value:function(){var e=em(Gr(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:Bg(this.activation),recurrentActivation:Bg(this.recurrentActivation),useBias:this.useBias,kernelInitializer:yv(this.kernelInitializer),recurrentInitializer:yv(this.recurrentInitializer),biasInitializer:yv(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:qg(this.kernelRegularizer),recurrentRegularizer:qg(this.recurrentRegularizer),biasRegularizer:qg(this.biasRegularizer),activityRegularizer:qg(this.activityRegularizer),kernelConstraint:hd(this.kernelConstraint),recurrentConstraint:hd(this.recurrentConstraint),biasConstraint:hd(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign({},e,t)}}]),n}(Sy);Ey.className="LSTMCell",To(Ey);var My=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Ey(e),t.call(this,e)}return R(n,[{key:"call",value:function(e,t){var r=this;return Mo((function(){null!=r.cell.dropoutMask&&(Ao(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Ao(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return em(Gr(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(_y);My.className="LSTM",To(My);var Ay=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).cells=e.cells,r}return R(n,[{key:"stateSize",get:function(){var e,t=[],n=L(this.cells.slice().reverse());try{for(n.s();!(e=n.n()).done;){var r=e.value;Array.isArray(r.stateSize)?t.push.apply(t,I(r.stateSize)):t.push(r.stateSize)}}catch($8){n.e($8)}finally{n.f()}return t}},{key:"call",value:function(e,t){var n=this;return Mo((function(){var r,a=e.slice(1),i=[],o=L(n.cells.slice().reverse());try{for(o.s();!(r=o.n()).done;){var s=r.value;Array.isArray(s.stateSize)?i.push(a.splice(0,s.stateSize.length)):i.push(a.splice(0,1))}}catch($8){o.e($8)}finally{o.f()}i.reverse();for(var u,l=[],c=0;c<n.cells.length;++c){var h=n.cells[c];a=i[c],u=0===c?[e[0]].concat(a):[u[0]].concat(a),u=h.call(u,t),l.push(u.slice(1))}a=[];var p,f=L(l.slice().reverse());try{for(f.s();!(p=f.n()).done;){var d,v=p.value;(d=a).push.apply(d,I(v))}}catch($8){f.e($8)}finally{f.f()}return[u[0]].concat(a)}))}},{key:"build",value:function(e){var t;Sv(e)&&(e=e[0]),this.cells.forEach((function(n,r){Sd("RNNCell_".concat(r),(function(){n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]}))})),this.built=!0}},{key:"getConfig",value:function(){var e=em(Gr(n.prototype),"getConfig",this).call(this),t={cells:this.cells.map((function(e){return{className:e.getClassName(),config:e.getConfig()}}))};return Object.assign({},e,t)}},{key:"trainableWeights",get:function(){if(!this.trainable)return[];var e,t=[],n=L(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,I(r.trainableWeights))}}catch($8){n.e($8)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=L(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,I(r.nonTrainableWeights))}}catch($8){n.e($8)}finally{n.f()}if(!this.trainable){var a,i=[],o=L(this.cells);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push.apply(i,I(s.trainableWeights))}}catch($8){o.e($8)}finally{o.f()}return i.concat(t)}return t}},{key:"getWeights",value:function(){var e,t=[],n=L(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,I(r.weights))}}catch($8){n.e($8)}finally{n.f()}return Av(t)}},{key:"setWeights",value:function(e){var t,n=[],r=L(this.cells);try{for(r.s();!(t=r.n()).done;)for(var a=t.value,i=a.weights.length,o=e.splice(i),s=0;s<a.weights.length;++s)n.push([a.weights[s],o[s]])}catch($8){r.e($8)}finally{r.f()}Dv(n)}}],[{key:"fromConfig",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],i=L(t.cells);try{for(i.s();!(n=i.n()).done;){var o=n.value;a.push(tm(o,r))}}catch($8){i.e($8)}finally{i.f()}return new e({cells:a})}}]),n}(Sy);function Dy(e){var t=e.ones,n=e.rate,r=e.training,a=void 0!==r&&r,i=e.count,o=void 0===i?1:i,s=function(){return Zd(t(),n)},u=function(){return Qd(s,t,a)};return!o||o<=1?Do(u().clone()):Array(o).fill(void 0).map(u).map((function(e){return Do(e.clone())}))}Ay.className="StackedRNNCells",To(Ay);var Ry=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},Oy=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;if(A(this,n),e.unroll)throw new Pf("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Pf("It is not possible at the moment to stack convolutional cells.");return(r=t.call(this,e)).inputSpec=[new Rv({ndim:5})],r}return R(n,[{key:"call",value:function(e,t){var r=this;return Mo((function(){if(null!=r.cell.dropoutMask&&(Ao(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Ao(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t&&t.constants)throw new Lf("ConvRNN2D cell does not support constants");var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return em(Gr(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}},{key:"computeOutputShape",value:function(e){var t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0]].concat(I(t.slice(2)))),this.returnState&&(t=[t].concat(I(Array(2).fill([e[0]].concat(I(t.slice(-3))))))),t}},{key:"getInitialState",value:function(e){var t=this;return Mo((function(){var n=t.cell.stateSize,r=e.shape,a=t.computeSingleOutputShape(r),i=hu([a[0]].concat(I(a.slice(2))));return Array.isArray(n)?Array(n.length).fill(i):[i]}))}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Mo((function(){if(!t.stateful)throw new Of("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape,a=t.computeSingleOutputShape(r),i=[a[0]].concat(I(a.slice(2)));if(null==r[0])throw new Lf("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.getStates())Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(){return hu(i)})):t.states_=[hu(i)];else if(null==e)Ao(t.states_),null!=t.keptStates&&(Ao(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(){return hu(i)})):t.states_[0]=hu(i);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new Lf("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));n?t.keptStates.push(t.states_.slice()):Ao(t.states_);for(var o=0;o<t.states_.length;++o){var s=e[o],u=i;if(!Y(s.shape,u))throw new Lf("State ".concat(o," is incompatible with layer ").concat(t.name,": ")+"expected shape=".concat(u,", received shape=").concat(s.shape));t.states_[o]=s}}t.states_=t.states_.map((function(e){return Do(e.clone())}))}))}},{key:"computeSingleOutputShape",value:function(e){var t=this.cell,n=t.dataFormat,r=t.filters,a=t.kernelSize,i=t.padding,o=t.strides,s=t.dilationRate,u="channelsFirst"===n,l=e[u?3:2],c=e[u?4:3],h=ry(l,a[0],i,o[0],s[0]),p=ry(c,a[1],i,o[1],s[1]);return[].concat(I(e.slice(0,2)),I(u?[r,h,p]:[h,p,r]))}}]),n}(_y);Oy.className="ConvRNN2D";var Fy=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;A(this,n);var a=e.filters,i=e.kernelSize,o=e.strides,s=e.padding,u=e.dataFormat,l=e.dilationRate;return(r=t.call(this,Object.assign({},e,{units:a}))).filters=a,td(r.filters,"filters"),r.kernelSize=ny(i,2,"kernelSize"),r.kernelSize.forEach((function(e){return td(e,"kernelSize")})),r.strides=ny(o||1,2,"strides"),r.strides.forEach((function(e){return td(e,"strides")})),r.padding=s||"valid",kd(r.padding),r.dataFormat=u||"channelsLast",xd(r.dataFormat),r.dilationRate=ny(l||1,2,"dilationRate"),r.dilationRate.forEach((function(e){return td(e,"dilationRate")})),r}return R(n,[{key:"build",value:function(e){var t;e=Tv(e);var n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new Lf("The channel dimension of the input should be defined. "+"Found ".concat(e[n]));var r=e[n],a=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);var i=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",i,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){var o;if(this.unitForgetBias){var s=this.biasInitializer,u=this.filters;o=new(t=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"apply",value:function(e,t){return Vd([s.apply([u]),pu([u]),s.apply([2*u])])}}]),n}(ev),t.className="CustomInit",t)}else o=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,o,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}},{key:"call",value:function(e,t){var n=this;return Mo((function(){if(3!==e.length)throw new Lf("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=t.training||!1,a=e[0],i=e[1],o=e[2];0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Dy({ones:function(){return fu(a)},rate:n.dropout,training:r,count:4}));var s=n.dropoutMask,u=function(e,t,n){return t&&t[n]?Us(t[n],e):e},l=u(a,s,0),c=u(a,s,1),h=u(a,s,2),p=u(a,s,3);0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Dy({ones:function(){return fu(i)},rate:n.recurrentDropout,training:r,count:4}));var f=n.recurrentDropoutMask,d=u(i,f,0),v=u(i,f,1),m=u(i,f,2),g=u(i,f,3),y=N(Ru(n.kernel.read(),4,3),4),b=y[0],x=y[1],k=y[2],w=y[3],_=N(n.useBias?Ru(n.bias.read(),4):[null,null,null,null],4),S=_[0],I=_[1],C=_[2],T=_[3];l=n.inputConv(l,b,S,n.padding),c=n.inputConv(c,x,I,n.padding),h=n.inputConv(h,k,C,n.padding),p=n.inputConv(p,w,T,n.padding);var E=N(Ru(n.recurrentKernel.read(),4,3),4),M=E[0],A=E[1],D=E[2],R=E[3];d=n.recurrentConv(d,M),v=n.recurrentConv(v,A),m=n.recurrentConv(m,D),g=n.recurrentConv(g,R);var O=n.recurrentActivation.apply(Bo(l,d)),F=n.recurrentActivation.apply(Bo(c,v)),L=Bo(Us(F,o),Us(O,n.activation.apply(Bo(h,m)))),P=Us(n.recurrentActivation.apply(Bo(p,g)),n.activation.apply(L));return[P,P,L]}))}},{key:"getConfig",value:function(){var e=em(Gr(n.prototype),"getConfig",this).call(this),t=(e.units,Ry(e,["units"])),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign({},t,r)}},{key:"inputConv",value:function(e,t,n,r){var a=gs(e,t,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?Kd(a,n,this.dataFormat):a}},{key:"recurrentConv",value:function(e,t){return gs(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}]),n}(Ey);Fy.className="ConvLSTM2DCell",To(Fy);var Ly=function(e){Hr(n,e);var t=Kr(n);function n(e){A(this,n);var r=new Fy(e);return t.call(this,Object.assign({},e,{cell:r}))}return R(n,null,[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(Oy);Ly.className="ConvLSTM2D",To(Ly);var Py=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).rate=Math.max(Math.min(e.rate,1),0),r.noiseShape=e.noiseShape,r.seed=e.seed,r.supportsMasking=!0,r}return R(n,[{key:"getNoiseShape",value:function(e){if(null==this.noiseShape)return this.noiseShape;for(var t=e.shape,n=[],r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n}},{key:"call",value:function(e,t){var n=this;return Mo((function(){n.invokeCallHook(e,t);var r=Cv(e);if(0<n.rate&&n.rate<1){var a=null!=t.training&&t.training,i=n.getNoiseShape(r);return Qd((function(){return Zd(r,n.rate,i,n.seed)}),(function(){return r}),a)}return e}))}},{key:"getConfig",value:function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"dispose",value:function(){return em(Gr(n.prototype),"dispose",this).call(this)}}]),n}(zv);Py.className="Dropout",To(Py);var zy=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).inputSpec=[{ndim:3}],r}return R(n,[{key:"getNoiseShape",value:function(e){var t=e.shape;return[t[0],1,t[2]]}}]),n}(Py);zy.className="SpatialDropout1D",To(zy);var By=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;if(A(this,n),(r=t.call(this,e)).activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){var a=null;null!=e.batchSize&&(a=e.batchSize),r.batchInputShape=[a,e.inputDim]}return r.units=e.units,td(r.units,"units"),r.activation=Wg(e.activation),null!=e.useBias&&(r.useBias=e.useBias),r.kernelInitializer=bv(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=bv(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=fd(e.kernelConstraint),r.biasConstraint=fd(e.biasConstraint),r.kernelRegularizer=Kg(e.kernelRegularizer),r.biasRegularizer=Kg(e.biasRegularizer),r.activityRegularizer=Kg(e.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],r}return R(n,[{key:"build",value:function(e){var t=(e=Tv(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:ty({},-1,t)}],this.built=!0}},{key:"computeOutputShape",value:function(e){var t=(e=Tv(e)).slice();return t[t.length-1]=this.units,t}},{key:"call",value:function(e,t){var n=this;return Mo((function(){n.invokeCallHook(e,t);var r,a=Cv(e),i=rd(n.activation.getClassName());return null!=i?r=Gd(a,n.kernel.read(),i,n.bias?n.bias.read():null):(r=Gd(a,n.kernel.read()),null!=n.bias&&(r=Kd(r,n.bias.read())),null!=n.activation&&(r=n.activation.apply(r))),r}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:Bg(this.activation),useBias:this.useBias,kernelInitializer:yv(this.kernelInitializer),biasInitializer:yv(this.biasInitializer),kernelRegularizer:qg(this.kernelRegularizer),biasRegularizer:qg(this.biasRegularizer),activityRegularizer:qg(this.activityRegularizer),kernelConstraint:hd(this.kernelConstraint),biasConstraint:hd(this.biasConstraint)},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv);By.className="Dense",To(By);var Vy=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),e=e||{},(r=t.call(this,e)).inputSpec=[{minNDim:3}],r.dataFormat=e.dataFormat,r}return R(n,[{key:"computeOutputShape",value:function(e){var t,n=L((e=Tv(e)).slice(1));try{for(n.s();!(t=n.n()).done;){if(null==t.value)throw new Lf('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(e.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.')}}catch($8){n.e($8)}finally{n.f()}return[e[0],Ed(e,1)]}},{key:"call",value:function(e,t){var n=this;return Mo((function(){n.invokeCallHook(e,t);var r=Cv(e);if("channelsFirst"===n.dataFormat&&r.rank>1){for(var a=[0],i=2;i<r.rank;++i)a.push(i);a.push(1),r=r.transpose(a)}return function(e){if(e.rank<=1)throw new Lf("batchFlatten requires a minimum rank of 2. Got rank: ".concat(e.rank,"."));var t=[e.shape[0],Ed(e.shape,1)];return e.reshape(t)}(r)}))}},{key:"getConfig",value:function(){var e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);var t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv);Vy.className="Flatten",To(Vy);var Wy=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).supportsMasking=!0,r.activation=Wg(e.activation),r}return R(n,[{key:"call",value:function(e,t){var n=this;return Mo((function(){n.invokeCallHook(e,t);var r=Cv(e);return n.activation.apply(r)}))}},{key:"getConfig",value:function(){var e={activation:Bg(this.activation)},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv);Wy.className="Activation",To(Wy);var Uy=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).n=e.n,r.inputSpec=[{ndim:2}],r}return R(n,[{key:"computeOutputShape",value:function(e){return[e[0],this.n,e[1]]}},{key:"call",value:function(e,t){var n=this;return Mo((function(){return e=Cv(e),t=e,r=n.n,Mo((function(){if(2!==t.shape.length)throw new Lf("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(t.shape.length," tensor."));return Ud(Fd(t,1),[1,r,1])}));var t,r}))}},{key:"getConfig",value:function(){var e={n:this.n},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv);Uy.className="RepeatVector",To(Uy);var Hy=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;A(this,n),(r=t.call(this,e)).targetShape=e.targetShape;for(var a=0;a<r.targetShape.length;++a)r.isUnknown(r.targetShape[a])&&(r.targetShape[a]=null);return r}return R(n,[{key:"isUnknown",value:function(e){return e<0||null==e}},{key:"fixUnknownDimension",value:function(e,t){for(var n="Total size of new array must be unchanged.",r=t.slice(),a=1,i=null,o=0;o<r.length;++o){var s=r[o];if(this.isUnknown(s)){if(null!==i)throw new Lf("Can only specifiy one unknown dimension.");i=o}else a*=s}var u=Ed(e);if(null!==i){if(0===a||u%a!==0)throw new Lf(n);r[i]=u/a}else if(u!==a)throw new Lf(n);return r}},{key:"computeOutputShape",value:function(e){for(var t=!1,n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}},{key:"call",value:function(e,t){var n=this;return Mo((function(){n.invokeCallHook(e,t);var r=Cv(e),a=r.shape,i=a.slice(0,1).concat(n.fixUnknownDimension(a.slice(1),n.targetShape));return r.reshape(i)}))}},{key:"getConfig",value:function(){var e={targetShape:this.targetShape},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv);Hy.className="Reshape",To(Hy);var Gy=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;if(A(this,n),r=t.call(this,e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(e.dims," instead."));var a=Rd(1,e.dims.length+1);if(!Y(e.dims.slice().sort(),a))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");return r.dims=e.dims,r.dimsIncludingBatch=[0].concat(r.dims),r.inputSpec=[new Rv({ndim:r.dims.length+1})],r}return R(n,[{key:"computeOutputShape",value:function(e){var t=(e=Tv(e)).slice();return this.dims.forEach((function(n,r){t[r+1]=e[n]})),t}},{key:"call",value:function(e,t){return qu(Cv(e),this.dimsIncludingBatch)}},{key:"getConfig",value:function(){var e={dims:this.dims},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv);Gy.className="Permute",To(Gy);var jy=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,r.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0,r}return R(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=em(Gr(n.prototype),"getConfig",this).call(this),t={maskValue:this.maskValue};return Object.assign(t,e),t}},{key:"computeMask",value:function(e,t){var n=Cv(e);return Wo(lu(n,this.maskValue),-1)}},{key:"call",value:function(e,t){var n=this;return Mo((function(){n.invokeCallHook(e,t);var r=Cv(e),a=Wo(lu(r,n.maskValue),-1,!0);return r.mul(a.asType(r.dtype))}))}}]),n}(zv);jy.className="Masking",To(jy);var qy=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;if(A(this,n),(r=t.call(this,e)).embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){var a=null;null!=e.batchSize&&(a=e.batchSize),null==e.inputLength?r.batchInputShape=[a,null]:r.batchInputShape=[a].concat(Hf(e.inputLength))}return r.inputDim=e.inputDim,td(r.inputDim,"inputDim"),r.outputDim=e.outputDim,td(r.outputDim,"outputDim"),r.embeddingsInitializer=bv(e.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=Kg(e.embeddingsRegularizer),r.activityRegularizer=Kg(e.activityRegularizer),r.embeddingsConstraint=fd(e.embeddingsConstraint),r.maskZero=e.maskZero,r.supportsMasking=e.maskZero,r.inputLength=e.inputLength,r}return R(n,[{key:"build",value:function(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}},{key:"warnOnIncompatibleInputShape",value:function(e){}},{key:"computeMask",value:function(e,t){var n=this;return Mo((function(){return n.maskZero?(e=Cv(e),lu(e,ju(e))):null}))}},{key:"computeOutputShape",value:function(e){if(e=Tv(e),null==this.inputLength)return[].concat(I(e),[this.outputDim]);var t=Hf(this.inputLength);if(t.length!==e.length-1)throw new Lf('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));for(var n=0,r=0;r<t.length;++r){var a=t[r],i=e[r+1];if(null!=a&&null!=i&&a!==i)throw new Lf('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));null==a&&(t[n]=i),n++}return[e[0]].concat(I(t),[this.outputDim])}},{key:"call",value:function(e,t){var n=this;return Mo((function(){n.invokeCallHook(e,t);var r=Cv(e);return"int32"!==r.dtype&&(r=Od(r,"int32")),jd(n.embeddings.read(),r.as1D()).reshape(Tv(n.computeOutputShape(r.shape)))}))}},{key:"getConfig",value:function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:yv(this.embeddingsInitializer),embeddingsRegularizer:qg(this.embeddingsRegularizer),activityRegularizer:qg(this.activityRegularizer),embeddingsConstraint:hd(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv);qy.className="Embedding",To(qy);var Xy=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,e||{})).supportsMasking=!0,r}return R(n,[{key:"mergeFunction",value:function(e){throw new Pf}},{key:"computeElementwiseOpOutputShape",value:function(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;for(var n=e.slice(0,e.length-t.length),r=0;r<t.length;++r){var a=e[e.length-t.length+r],i=t[r];if(null==a||null==i||a<0||i<0)n.push(null);else if(1===a)n.push(i);else if(1===i)n.push(a);else{if(a!==i)throw new Lf("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(a)}}return n}},{key:"build",value:function(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Tv(e)]),e.length<2)throw new Lf("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(e.length," input(s)."));var t,n=[],r=L(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;null!=a&&null!==a[0]&&n.push(a[0])}}catch($8){r.e($8)}finally{r.f()}if((n=Qf(n)).length>1)throw new Lf("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(e),"."));for(var i=null==e[0]?null:e[0].slice(1),o=1;o<e.length;++o){var s=null==e[o]?null:e[o].slice(1);i=this.computeElementwiseOpOutputShape(i,s)}var u=e.map((function(e){return e.length}));-1===e.indexOf(null)&&1===Qf(u).length?this.reshapeRequired=!1:this.reshapeRequired=!0}},{key:"call",value:function(e,t){var n=this;return Mo((function(){if(n.reshapeRequired){var t=[],r=e.map((function(e){return e.rank}));if(-1===r.indexOf(null)){var a,i=Dd(r),o=L(e);try{for(o.s();!(a=o.n()).done;){for(var s=a.value,u=s.rank,l=0;l<i-u;++l)s=Fd(s,1);t.push(s)}}catch($8){o.e($8)}finally{o.f()}return n.mergeFunction(t)}var c,h=!1,p=L(e);try{for(p.s();!(c=p.n()).done;){var f=c.value,d=f.rank;if(null==d){var v=f.shape,m=v[0],g=v.slice(1).concat([m]),y=f.reshape([m].concat(Ed(v.slice(1))));y=(y=qu(y,[1,0])).reshape(g),t.push(y),h=!0}else if(d>1){var b=Rd(1,d).concat([0]);t.push(qu(f,b)),h=!0}else t.push(f)}}catch($8){p.e($8)}finally{p.f()}var x=n.mergeFunction(t),k=x.rank;if(h)if(null==k){var w=x.shape,_=w[w.length-1],S=[_].concat(w.slice(0,w.length-1));x=qu(x.reshape([-1,_]),[1,0]).reshape(S)}else if(k>1){var I=[k-1].concat(Rd(0,k-1));x=qu(x,I)}return x}return n.mergeFunction(e)}))}},{key:"computeOutputShape",value:function(e){var t;t=null==e[0]?null:e[0].slice(1);for(var n=1;n<e.length;++n){var r=null==e[n]?null:e[n].slice(1);t=this.computeElementwiseOpOutputShape(t,r)}var a,i=[],o=L(e);try{for(o.s();!(a=o.n()).done;){var s=a.value;null!=s&&null!==s[0]&&i.push(s[0])}}catch($8){o.e($8)}finally{o.f()}return t=1===(i=Qf(i)).length?i.concat(t):[null].concat(t)}},{key:"computeMask",value:function(e,t){return Mo((function(){if(null==t)return null;if(!Array.isArray(t))throw new Lf("`mask` should be an Array");if(!Array.isArray(e))throw new Lf("`inputs` should be an Array");if(t.length!==e.length)throw new Lf("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(e.length," vs ").concat(t.length,")"));if(t.every((function(e){return null==e})))return null;t=t.map((function(e){return null==e?e:Ms(e,0)}));for(var n=t[0],r=1;r<t.length-1;++r)n=qs(n,t[r]);return n}))}}]),n}(zv),Ky=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,e)}return R(n,[{key:"mergeFunction",value:function(e){return Mo((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Bo(t,e[n]);return t}))}}]),n}(Xy);Ky.className="Add",To(Ky);var Yy=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,e)}return R(n,[{key:"mergeFunction",value:function(e){return Mo((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Us(t,e[n]);return t}))}}]),n}(Xy);Yy.className="Multiply",To(Yy);var Zy=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,e)}return R(n,[{key:"mergeFunction",value:function(e){return Mo((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Bo(t,e[n]);return Us(1/e.length,t)}))}}]),n}(Xy);Zy.className="Average",To(Zy);var Qy=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,e)}return R(n,[{key:"mergeFunction",value:function(e){return Mo((function(){for(var t=e[0],n=1;n<e.length;++n)t=Ys(t,e[n]);return t}))}}]),n}(Xy);Qy.className="Maximum",To(Qy);var $y=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,e)}return R(n,[{key:"mergeFunction",value:function(e){return Mo((function(){for(var t=e[0],n=1;n<e.length;++n)t=$s(t,e[n]);return t}))}}]),n}(Xy);$y.className="Minimum",To($y);var Jy=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).DEFAULT_AXIS=-1,null==e&&(e={}),r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return R(n,[{key:"build",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new Lf("A `Concatenate` layer should be called on a list of at least 2 inputs");var t,n=!0,r=L(e);try{for(r.s();!(t=r.n()).done;){if(null!=t.value){n=!1;break}}}catch($8){r.e($8)}finally{r.f()}if(!n){for(var a=[],i=0;i<e.length;++i){var o=e[i].slice();o.splice(this.axis,1);var s,u=!1,l=L(a);try{for(l.s();!(s=l.n()).done;){if(Y(s.value,o)){u=!0;break}}}catch($8){l.e($8)}finally{l.f()}u||a.push(o)}if(a.length>1)throw new Lf("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}}},{key:"mergeFunction",value:function(e){var t=this;return Mo((function(){return Vd(e,t.axis)}))}},{key:"computeOutputShape",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new Lf("A `Concatenate` layer should be called on a list of inputs.");var t,n=e,r=n[0].slice(),a=this.axis<0?r.length+this.axis:this.axis,i=L(n.slice(1));try{for(i.s();!(t=i.n()).done;){var o=t.value;if(null==r[a]||null==o[a]){r[a]=null;break}r[a]+=o[a]}}catch($8){i.e($8)}finally{i.f()}return r}},{key:"computeMask",value:function(e,t){var n=this;if(null==t)return null;if(!Array.isArray(t))throw new Lf("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new Lf("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new Lf("Mismatch in the length of mask (".concat(t.length,") ")+"and the legnth of inputs (".concat(e.length,")"));return Mo((function(){var r=!0;if(t.forEach((function(e){null==e||(r=!1)})),r)return null;for(var a=[],i=0;i<e.length;++i)null==t[i]?a.push(fu(e[i]).asType("bool")):t[i].rank<e[i].rank?a.push(Ms(t[i],-1)):a.push(t[i]);var o=ps(a,n.axis);return Vo(o,-1,!1)}))}},{key:"getConfig",value:function(){var e={axis:this.axis},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Xy);function eb(e,t){for(;e<0;)e+=t;return e}Jy.className="Concatenate",To(Jy);var tb=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).axes=e.axes,r.normalize=null!=e.normalize&&e.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return R(n,[{key:"build",value:function(e){G(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0],n=e[1];if(t.length>3||n.length>3)throw new Pf("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new Lf("Dimension incompatibility: "+"".concat(t[r[0]]," !== ").concat(n[r[1]]))}},{key:"mergeFunction",value:function(e){if(2!==e.length)throw new Lf("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(e.length," input(s)."));var t,n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map((function(t,n){return eb(t,e[n].shape.length)})):[eb(this.axes,n.shape.length),eb(this.axes,r.shape.length)],this.normalize&&(n=nm(n,t[0]),r=nm(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new Pf("batchDot is not implemented for tensors of 4D or higher rank yet");if(G(e.shape.length>=2,(function(){return"batchDot requires the rank of x to be >= 2, "+"but got ".concat(e.shape.length)})),G(e.shape.length>=2,(function(){return"batchDot requires the rank of y to be >= 2, "+"but got ".concat(t.shape.length)})),"number"===typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new Pf("batchDot is not implemented for complex64-type Tensors yet.");var r=e.shape.length,a=t.shape.length;null==n&&(n=[r-1,a-2]);var i=n;return Mo((function(){var n,o;if(r>a){n=r-a;for(var s=[],u=0;u<n;++u)s.push(1);t=t.reshape(t.shape.concat(s))}else if(a>r){n=a-r;for(var l=[],c=0;c<n;++c)l.push(1);e=e.reshape(e.shape.concat(l))}else n=0;if(2===e.shape.length&&2===t.shape.length)o=i[0]===i[1]?e.mul(t).sum(i[0]):e.transpose([1,0]).mul(t).sum(i[1]);else{var h=i[0]!==e.shape.length-1,p=i[1]===t.shape.length-1;o=e.matMul(t,h,p)}if(n>0){for(var f,d=[],v=f=r>a?r+a-3:r-1;v<f+n;++v)d.push(v);o=o.squeeze(d)}return 1===o.shape.length&&(o=o.expandDims(1)),o}))}(n,r,t)}},{key:"interpretAxes",value:function(e,t){return Array.isArray(this.axes)?this.axes:[eb(this.axes,e.length),eb(this.axes,t.length)]}},{key:"computeOutputShape",value:function(e){G(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new Pf("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);var a=t.concat(n);return 1===a.length&&a.push(1),a}},{key:"computeMask",value:function(e,t){return null}},{key:"getConfig",value:function(){var e={axes:this.axes,normalize:this.normalize},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Xy);tb.className="Dot",To(tb);var nb=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).supportsMasking=!0,r.stddev=e.stddev,r}return R(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=em(Gr(n.prototype),"getConfig",this).call(this),t={stddev:this.stddev};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return Mo((function(){n.invokeCallHook(e,t);var r=Cv(e);return Qd((function(){return Hd(r.shape,0,n.stddev).add(r)}),(function(){return r}),t.training||!1)}))}}]),n}(zv);nb.className="GaussianNoise",To(nb);var rb=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r}return R(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=em(Gr(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return Mo((function(){n.invokeCallHook(e,t);var r=Cv(e);if(n.rate>0&&n.rate<1){return Qd((function(){var e=Math.sqrt(n.rate/(1-n.rate));return r.mul(Hd(r.shape,1,e))}),(function(){return r}),t.training||!1)}return r}))}}]),n}(zv);rb.className="GaussianDropout",To(rb);var ab=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r.noiseShape=e.noiseShape,r}return R(n,[{key:"_getNoiseShape",value:function(e){return this.noiseShape||Cv(e).shape}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=em(Gr(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return Mo((function(){if(n.rate<1&&n.rate>0){var r=n._getNoiseShape(e);return Qd((function(){var t=Cv(e),a=-1.7580993408473766,i=Ps(xu(r),n.rate);i=Od(i,"float32");var o=Math.pow((1-n.rate)*(1+n.rate*Math.pow(a,2)),-.5),s=-o*a*n.rate;return t.mul(i).add(i.add(-1).mul(a)).mul(o).add(s)}),(function(){return Cv(e)}),t.training||!1)}return e}))}}]),n}(zv);function ib(e,t,n,r,a){var i,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)i=us(e,t,n,r,a,o);else if(3===e.rank)i=ls(e,t,n,r,a,o);else{if(4!==e.rank)throw new Pf("batchNormalization is not implemented for array of rank ".concat(e.rank," ")+"yet");i=cs(e,t,n,r,a,o)}return i}function ob(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Mo((function(){var i=su(e,r),o=i.mean,s=i.variance;return[ib(e,o,s,n,t,a),o,s]}))}function sb(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Mo((function(){var i,o=su(e,r),s=o.mean,u=o.variance,l=[],c=L(Rd(0,e.rank));try{for(c.s();!(i=c.n()).done;){var h=i.value;-1!==r.indexOf(h)?l.push(1):l.push(e.shape[h])}}catch($8){c.e($8)}finally{c.f()}var p=s.reshape(l),f=u.reshape(l),d=null==t?null:t.reshape(l),v=null==n?null:n.reshape(l);return[ib(e,p,f,v,d,a),s,u]}))}ab.className="AlphaDropout",To(ab);var ub=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),null==e&&(e={}),(r=t.call(this,e)).supportsMasking=!0,r.axis=null==e.axis?-1:e.axis,r.momentum=null==e.momentum?.99:e.momentum,r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=bv(e.betaInitializer||"zeros"),r.gammaInitializer=bv(e.gammaInitializer||"ones"),r.movingMeanInitializer=bv(e.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=bv(e.movingVarianceInitializer||"ones"),r.betaConstraint=fd(e.betaConstraint),r.gammaConstraint=fd(e.gammaConstraint),r.betaRegularizer=Kg(e.betaRegularizer),r.gammaRegularizer=Kg(e.gammaRegularizer),r}return R(n,[{key:"build",value:function(e){e=Tv(e);var t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new Lf("Axis ".concat(t," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(e),"."));this.inputSpec=[new Rv({ndim:e.length,axes:ty({},t,n)})];var r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}},{key:"call",value:function(e,t){var n=this;return Mo((function(){var r=null!=t.training&&t.training,a=Cv(e),i=a.shape,o=i.length,s=Rd(0,o),u=n.axis>=0?n.axis:n.axis+o;s.splice(u,1);var l=Bf(1,o);l[u]=i[u];var c=s.slice();c.sort();var h=!Y(c,Rd(0,o).slice(0,o-1));if(!r)return function(){if(h){var e=n.movingMean.read().reshape(l),t=n.movingVariance.read().reshape(l),r=n.center?n.beta.read().reshape(l):null,i=n.scale?n.gamma.read().reshape(l):null;return ib(a,e,t,r,i,n.epsilon)}return ib(a,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var p=function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Y(r.slice().sort(),Rd(0,e.rank-1))?ob(e,t,n,r,a):sb(e,t,n,r,a)}(a,n.gamma.read(),n.beta.read(),s,n.epsilon),f=N(p,3),d=f[0],v=f[1],m=f[2],g=function(e,t,n){Mo((function(){var r=1-n,a=e.read(),i=a.sub(t).mul(r);e.write(a.sub(i))}))};return g(n.movingMean,v,n.momentum),g(n.movingVariance,m,n.momentum),d}))}},{key:"getConfig",value:function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:yv(this.betaInitializer),gammaInitializer:yv(this.gammaInitializer),movingMeanInitializer:yv(this.movingMeanInitializer),movingVarianceInitializer:yv(this.movingVarianceInitializer),betaRegularizer:qg(this.betaRegularizer),gammaRegularizer:qg(this.gammaRegularizer),betaConstraint:hd(this.betaConstraint),gammaConstraint:hd(this.gammaConstraint)},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv);ub.className="BatchNormalization",To(ub);var lb=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;if(A(this,n),null==e&&(e={}),(r=t.call(this,e)).axis=null==e.axis?-1:e.axis,"number"===typeof r.axis){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received ".concat(r.axis))}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(r.axis)));var a,i=L(r.axis);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(!Number.isInteger(o))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(r.axis)))}}catch($8){i.e($8)}finally{i.f()}}return r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=bv(e.betaInitializer||"zeros"),r.gammaInitializer=bv(e.gammaInitializer||"ones"),r.betaRegularizer=Kg(e.betaRegularizer),r.gammaRegularizer=Kg(e.gammaRegularizer),r.supportsMasking=!0,r}return R(n,[{key:"build",value:function(e){var t=(e=Tv(e)).length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(var n=0;n<this.axis.length;++n)this.axis[n]<0&&(this.axis[n]+=t);var r,a=L(this.axis);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(i<0||i>=t)throw new Error("Invalid axis: ".concat(i))}}catch($8){a.e($8)}finally{a.f()}if(this.axis.length!==Qf(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));var o=this.axis.map((function(t){return e[t]}));this.scale?this.gamma=this.addWeight("gamma",o,"float32",this.gammaInitializer,this.gammaRegularizer,true):this.gamma=null,this.center?this.beta=this.addWeight("beta",o,"float32",this.betaInitializer,this.betaRegularizer,true):this.beta=null,this.built=!0}},{key:"call",value:function(e,t){var n=this,r=Cv(e),a=r.shape,i=a.length;return Mo((function(){var e,t=su(r,n.axis,!0),o=t.mean,s=t.variance,u=Bf(1,i),l=L(n.axis);try{for(l.s();!(e=l.n()).done;){var c=e.value;u[c]=a[c]}}catch($8){l.e($8)}finally{l.f()}for(var h=function(e){return null!=e&&e.shape.length!==i&&n.axis!==[i-1]?e.reshape(u):e},p=h(n.gamma.read()),f=h(n.beta.read()),d=[],v=[],m=0;m<i;++m)-1!==n.axis.indexOf(m)?(d.push(a[m]),v.push(1)):(d.push(1),v.push(a[m]));return o=o.tile(d),s=s.tile(d),p=p.tile(v),f=f.tile(v),ib(r,o,s,f,p,n.epsilon)}))}},{key:"getConfig",value:function(){var e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:yv(this.betaInitializer),gammaInitializer:yv(this.gammaInitializer),betaRegularizer:qg(this.betaRegularizer),gammaRegularizer:qg(this.gammaRegularizer)},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv);lb.className="LayerNormalization",To(lb);var cb=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;if(A(this,n),null==e&&(e={}),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)r.padding=[[1,1],[1,1]];else if("number"===typeof e.padding)r.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new Lf("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(e.padding.length," array."));var a,i;if("number"===typeof e.padding[0])a=[e.padding[0],e.padding[0]],i=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new Lf("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(e.padding[0].length," array."));if(a=e.padding[0],2!==e.padding[1].length)throw new Lf("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(e.padding[1].length," array."));i=e.padding[1]}r.padding=[a,i]}return r.inputSpec=[new Rv({ndim:4})],r}return R(n,[{key:"computeOutputShape",value:function(e){var t,n;return e=Tv(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}},{key:"call",value:function(e,t){var n=this;return Mo((function(){return t=Cv(e),r=n.padding,a=n.dataFormat,Mo((function(){if(4!==t.rank)throw new Lf("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(t.rank,"-D tensor."));if(null==r&&(r=[[1,1],[1,1]]),2!==r.length||2!==r[0].length||2!==r[1].length)throw new Lf("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==a&&(a="channelsLast"),"channelsLast"!==a&&"channelsFirst"!==a)throw new Lf("Unknown data format: ".concat(a,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");var e;return e="channelsFirst"===a?[[0,0],[0,0],r[0],r[1]]:[[0,0],r[0],r[1],[0,0]],du(t,e)}));var t,r,a}))}},{key:"getConfig",value:function(){var e={padding:this.padding,dataFormat:this.dataFormat},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv);function hb(e,t,n,r,a,i){return Mo((function(){var o;xd(a),wd(i),kd(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=iy(e,a);var s="same"===r?"same":"valid";return o="max"===i?Xs(e,t,n,s):is(e,t,n,s),"channelsFirst"===a&&(o=qu(o,[0,3,1,2])),o}))}function pb(e,t,n,r,a,i){return Mo((function(){var o;xd(a),wd(i),kd(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=oy(e,a);var s="same"===r?"same":"valid";return o="max"===i?Ks(e,t,n,s):os(e,t,n,s),"channelsFirst"===a&&(o=qu(o,[0,4,1,2,3])),o}))}cb.className="ZeroPadding2D",To(cb);var fb=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;if(A(this,n),null==e.poolSize&&(e.poolSize=2),r=t.call(this,e),"number"===typeof e.poolSize)r.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!==typeof e.poolSize[0])throw new Lf("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.poolSize)));r.poolSize=e.poolSize}if(td(r.poolSize,"poolSize"),null==e.strides)r.strides=r.poolSize;else if("number"===typeof e.strides)r.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!==typeof e.strides[0])throw new Lf("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.strides)));r.strides=e.strides}return td(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,kd(r.padding),r.inputSpec=[new Rv({ndim:3})],r}return R(n,[{key:"computeOutputShape",value:function(e){var t=ry((e=Tv(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}},{key:"call",value:function(e,t){var n=this;return Mo((function(){n.invokeCallHook(e,t),e=Fd(Cv(e),2);var r=n.poolingFunction(Cv(e),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return Fu(r,[2])}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv),db=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,e)}return R(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return xd(a),kd(r),hb(e,t,n,r,a,"max")}}]),n}(fb);db.className="MaxPooling1D",To(db);var vb=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,e)}return R(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return xd(a),kd(r),hb(e,t,n,r,a,"avg")}}]),n}(fb);vb.className="AveragePooling1D",To(vb);var mb=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;if(A(this,n),null==e.poolSize&&(e.poolSize=[2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new Lf("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides];return td(r.poolSize,"poolSize"),td(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,xd(r.dataFormat),kd(r.padding),r.inputSpec=[new Rv({ndim:4})],r}return R(n,[{key:"computeOutputShape",value:function(e){e=Tv(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=ry(t,this.poolSize[0],this.padding,this.strides[0]),n=ry(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}},{key:"call",value:function(e,t){var n=this;return Mo((function(){return n.invokeCallHook(e,t),n.poolingFunction(Cv(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv),gb=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,e)}return R(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return xd(a),kd(r),hb(e,t,n,r,a,"max")}}]),n}(mb);gb.className="MaxPooling2D",To(gb);var yb=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,e)}return R(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return xd(a),kd(r),hb(e,t,n,r,a,"avg")}}]),n}(mb);yb.className="AveragePooling2D",To(yb);var bb=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;if(A(this,n),null==e.poolSize&&(e.poolSize=[2,2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new Lf("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides,e.strides];return td(r.poolSize,"poolSize"),td(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,xd(r.dataFormat),kd(r.padding),r.inputSpec=[new Rv({ndim:5})],r}return R(n,[{key:"computeOutputShape",value:function(e){e=Tv(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return t=ry(t,this.poolSize[0],this.padding,this.strides[0]),n=ry(n,this.poolSize[1],this.padding,this.strides[1]),r=ry(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}},{key:"call",value:function(e,t){var n=this;return Mo((function(){return n.invokeCallHook(e,t),n.poolingFunction(Cv(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv),xb=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,e)}return R(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return xd(a),kd(r),pb(e,t,n,r,a,"max")}}]),n}(bb);xb.className="MaxPooling3D",To(xb);var kb=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,e)}return R(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return xd(a),kd(r),pb(e,t,n,r,a,"avg")}}]),n}(bb);kb.className="AveragePooling3D",To(kb);var wb=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).inputSpec=[new Rv({ndim:3})],r}return R(n,[{key:"computeOutputShape",value:function(e){return[e[0],e[2]]}},{key:"call",value:function(e,t){throw new Pf}}]),n}(zv),_b=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,e||{})}return R(n,[{key:"call",value:function(e,t){return Mo((function(){var t=Cv(e);return Zs(t,1)}))}}]),n}(wb);_b.className="GlobalAveragePooling1D",To(_b);var Sb=function(e){Hr(n,e);var t=Kr(n);function n(e){return A(this,n),t.call(this,e||{})}return R(n,[{key:"call",value:function(e,t){return Mo((function(){var t=Cv(e);return Ws(t,1)}))}}]),n}(wb);Sb.className="GlobalMaxPooling1D",To(Sb);var Ib=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,xd(r.dataFormat),r.inputSpec=[new Rv({ndim:4})],r}return R(n,[{key:"computeOutputShape",value:function(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}},{key:"call",value:function(e,t){throw new Pf}},{key:"getConfig",value:function(){var e={dataFormat:this.dataFormat},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(zv),Cb=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"call",value:function(e,t){var n=this;return Mo((function(){var t=Cv(e);return"channelsLast"===n.dataFormat?Zs(t,[1,2]):Zs(t,[2,3])}))}}]),n}(Ib);Cb.className="GlobalAveragePooling2D",To(Cb);var Tb=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.apply(this,arguments)}return R(n,[{key:"call",value:function(e,t){var n=this;return Mo((function(){var t=Cv(e);return"channelsLast"===n.dataFormat?Ws(t,[1,2]):Ws(t,[2,3])}))}}]),n}(Ib);Tb.className="GlobalMaxPooling2D",To(Tb);var Nb=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).layer=e.layer,r}return R(n,[{key:"build",value:function(e){this.built=!0}},{key:"trainable",get:function(){return null!=this.layer&&this.layer.trainable},set:function(e){null!=this.layer&&(this.layer.trainable=e)}},{key:"trainableWeights",get:function(){return this.layer.trainableWeights}},{key:"nonTrainableWeights",get:function(){return this.layer.nonTrainableWeights}},{key:"updates",get:function(){return this.layer._updates}},{key:"losses",get:function(){return this.layer.losses}},{key:"getWeights",value:function(){return this.layer.getWeights()}},{key:"setWeights",value:function(e){this.layer.setWeights(e)}},{key:"getConfig",value:function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"setFastWeightInitDuringBuild",value:function(e){em(Gr(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.layer,a=tm(r,n);delete t.layer;var i={layer:a};return Object.assign(i,t),new e(i)}}]),n}(zv),Eb=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).supportsMasking=!0,r}return R(n,[{key:"build",value:function(e){if((e=Tv(e)).length<3)throw new Lf("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];var t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),em(Gr(n.prototype),"build",this).call(this,e)}},{key:"computeOutputShape",value:function(e){var t=[(e=Tv(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}},{key:"call",value:function(e,t){var n=this;return Mo((function(){return wy((function(e,r){return[Cv(n.layer.call(e,t)),[]]}),e=Cv(e),[],!1,null,null,!1,!0)[1]}))}}]),n}(Nb);Eb.className="TimeDistributed",To(Eb);var Mb=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;A(this,n),r=t.call(this,e);var a=e.layer.getConfig(),i={};i.className=e.layer.getClassName(),i.config=a,r.forwardLayer=tm(i),a.goBackwards=!0!==a.goBackwards;var o,s={};if(s.className=e.layer.getClassName(),s.config=a,r.backwardLayer=tm(s),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,o=r.mergeMode,Jf(yd,"BidirectionalMergeMode",o),e.weights)throw new Pf("weights support is not implemented for Bidirectional layer yet.");return r._stateful=e.layer.stateful,r.returnSequences=e.layer.returnSequences,r.returnState=e.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=e.layer.inputSpec,r.numConstants=null,r}return R(n,[{key:"trainable",get:function(){return this._trainable},set:function(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}},{key:"getWeights",value:function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}},{key:"setWeights",value:function(e){var t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=this.forwardLayer.computeOutputShape(e);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),this.returnState?(r=a.slice(1),t=a[0]):t=a[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):Uf(n)}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=ky(e,r,a,this.numConstants);if(e=i.inputs,r=i.initialState,a=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(null==r||0===r.length)&&null==a)return em(Gr(n.prototype),"apply",this).call(this,e,t);var o=[],s=[];if(null!=r){var u=r.length;if(u%2>0)throw new Lf("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=r,o.push.apply(o,I(r));var l=r.map((function(e){return new Rv({shape:e.shape})}));this.forwardLayer.stateSpec=l.slice(0,u/2),this.backwardLayer.stateSpec=l.slice(u/2),s.push.apply(s,I(l))}if(null!=a)throw new Pf("Support for constants in Bidirectional layers is not implemented yet.");for(var c=o[0]instanceof Ov,h=0,p=o;h<p.length;h++){if(p[h]instanceof Ov!==c)throw new Lf("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors")}if(c){var f=[e].concat(o),d=this.inputSpec.concat(s),v=this.inputSpec;this.inputSpec=d;var m=em(Gr(n.prototype),"apply",this).call(this,f,t);return this.inputSpec=v,m}return em(Gr(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return Mo((function(){var r,a,i,o,s=t.initialState;if(null==s)r=n.forwardLayer.call(e,t),a=n.backwardLayer.call(e,t);else{var u=s.slice(0,s.length/2),l=s.slice(s.length/2);r=n.forwardLayer.call(e,Object.assign(t,{initialState:u})),a=n.backwardLayer.call(e,Object.assign(t,{initialState:l}))}return n.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),n.returnSequences&&(a=wu(a,1)),"concat"===n.mergeMode?o=Vd([r,a]):"sum"===n.mergeMode?o=Bo(r,a):"ave"===n.mergeMode?o=Us(.5,Bo(r,a)):"mul"===n.mergeMode?o=Us(r,a):null==n.mergeMode&&(o=[r,a]),n.returnState?null==n.mergeMode?o.concat(i):[o].concat(i):o}))}},{key:"resetStates",value:function(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}},{key:"build",value:function(e){var t=this;Sd(this.forwardLayer.name,(function(){t.forwardLayer.build(e)})),Sd(this.backwardLayer.name,(function(){t.backwardLayer.build(e)})),this.built=!0}},{key:"computeMask",value:function(e,t){var n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){var r=this.forwardLayer.states.map((function(e){return null}));return Array.isArray(n)?n.concat(r).concat(r):[n].concat(r).concat(r)}return n}},{key:"trainableWeights",get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}},{key:"nonTrainableWeights",get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}},{key:"setFastWeightInitDuringBuild",value:function(e){em(Gr(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e={mergeMode:this.mergeMode},t=em(Gr(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"fromConfig",value:function(e,t){var n=tm(t.layer);if(delete t.layer,null!=t.numConstants)throw new Pf("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=t;return r.layer=n,new e(r)}}]),n}(Nb);Mb.className="Bidirectional",To(Mb);var Ab,Db;!function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(Ab||(Ab={})),function(e){!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(Db||(Db={}));var Rb={};function Ob(e){return Rb[e]}function Fb(e,t,n,r,a){var i=t.inputParams[e];if(i&&void 0!==i.inputIndexStart){var o=i.inputIndexStart,s=0===i.inputIndexEnd?void 0:void 0===i.inputIndexEnd?o+1:i.inputIndexEnd;if("tensor"===i.type)return Lb(t.inputNames[i.inputIndexStart],n,r,a);if("tensors"===i.type)return t.inputNames.slice(o,s).map((function(e){return Lb(e,n,r,a)}));var u=Lb(t.inputNames.slice(o)[0],n,r,a),l=u.dataSync();return"number"===i.type?l[0]:ve(u.shape,l)}var c=t.attrParams[e];return c&&c.value}function Lb(e,t,n,r){var a=N(Bb(e),2),i=a[0],o=a[1];if(null!=r){var s=r.getHashTableHandleByName(i);if(null!=s)return s}var u=n.currentContextIds.find((function(e){return!!t[zb(i,e)]}));return void 0!==u?t[zb(i,u)][o]:void 0}function Pb(e,t){var n=N(Bb(e),2),r=n[0],a=n[1];return[zb(r,t&&t.currentContextId),a]}function zb(e,t){return t?"".concat(e,"-").concat(t):e}function Bb(e){var t=e.split(":");return 1===t.length?[e,0]:[t[0],Number(t[t.length-1])]}function Vb(e,t,n){var r=Fb("pad",e,t,n);if("explicit"===r){r=Fb("explicitPaddings",e,t,n);for(var a=[[0,0],[0,0],[0,0],[0,0]],i=0;i<4;i++)a[i][0]=r[2*i],a[i][1]=r[2*i+1];return a}return r}function Wb(e){return e.kept?e:Vi(e)}var Ub=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Hb=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Gb=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]}],jb=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number"}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],qb=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],Xb=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Kb=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],Yb=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],Zb=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}],Qb=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],$b=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Jb=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],ex=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],tx=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],nx=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],rx=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],ax=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]}],ix=function(){function e(){var n;A(this,e);var b=[t,r,a,i,o,s,u,p,h,l,f,d,v,m,g,y,c],x=(n=[]).concat.apply(n,I(b.map((function(e){return e.json}))));this.opMappers=x.reduce((function(e,t){return e[t.tfOpName]=t,e}),{})}return R(e,[{key:"transformGraph",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.node,a=[],i=[],o=[],s=r.reduce((function(e,n){return e[n.name]=t.mapNode(n),n.op.startsWith("Placeholder")?a.push(e[n.name]):"Const"===n.op?i.push(e[n.name]):null!=n.input&&0!==n.input.length||o.push(e[n.name]),e}),{}),u=[],l=[],c={},h={};null!=n&&(c=this.mapSignatureEntries(n.inputs),h=this.mapSignatureEntries(n.outputs));var p=Object.keys(s);p.forEach((function(e){var t=s[e];t.inputNames.forEach((function(e){var n=N(Pb(e),1)[0];t.inputs.push(s[n]),s[n].children.push(t)}))})),0===Object.keys(h).length?p.forEach((function(e){var t=s[e];0===t.children.length&&l.push(t)})):Object.keys(h).forEach((function(e){var t=N(Pb(e),1)[0],n=s[t];null!=n&&(n.signatureKey=h[e],l.push(n))})),Object.keys(c).length>0?Object.keys(c).forEach((function(e){var t=N(Pb(e),1)[0],n=s[t];n&&(n.signatureKey=c[e],u.push(n))})):u=a;var f={};null!=e.library&&null!=e.library.function&&(f=e.library.function.reduce((function(e,n){return e[n.signature.name]=t.mapFunction(n),e}),{}));var d={nodes:s,inputs:u,outputs:l,weights:i,placeholders:a,signature:n,functions:f};return o.length>0&&(d.initNodes=o),d}},{key:"mapSignatureEntries",value:function(e){return Object.keys(e||{}).reduce((function(t,n){return t[e[n].name]=n,t}),{})}},{key:"mapNode",value:function(e){var t=Ob(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});var n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map((function(e){return e.startsWith("^")?e.substr(1):e})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr};return null!=t.inputs&&(n.inputParams=t.inputs.reduce((function(e,t){return e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e}),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce((function(t,n){var r=n.type,a=void 0;switch(n.type){case"string":void 0===(a=sx(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=sx(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(a=gx(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=gx(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(a=lx(e.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(a=lx(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(a=mx(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=mx(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(a=ux(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=ux(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(a=bx(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=bx(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(a=vx(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=vx(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(a=yx(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=yx(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(a=px(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=px(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(a=fx(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=fx(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":void 0===(a=hx(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=hx(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(e.op))}return t[n.name]={value:a,type:r},t}),{})),n}},{key:"mapFunction",value:function(e){var t=this,n=e.nodeDef,r=[],a={};null!=n&&(a=n.reduce((function(e,n){return e[n.name]=t.mapNode(n),"Const"===n.op&&r.push(e[n.name]),e}),{}));var i=[],o=[];e.signature.inputArg.forEach((function(e){var t=N(Pb(e.name),1)[0],n={name:t,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:cx(e.type),type:"dtype"}},children:[]};n.signatureKey=e.name,i.push(n),a[t]=n})),Object.keys(a).forEach((function(e){var t=a[e];t.inputNames.forEach((function(e){var n=N(Pb(e),1)[0];t.inputs.push(a[n]),a[n].children.push(t)}))}));var s=e.ret;e.signature.outputArg.forEach((function(e){var t=N(Pb(s[e.name]),2),n=t[0],r=t[1],i=a[n];null!=i&&(i.defaultOutput=r,o.push(i))}));var u=this.mapArgsToSignature(e);return{nodes:a,inputs:i,outputs:o,weights:r,placeholders:[],signature:u}}},{key:"mapArgsToSignature",value:function(e){var t=this;return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((function(e,n){return e[n.name]=t.mapArgToTensorInfo(n),e}),{}),outputs:e.signature.outputArg.reduce((function(n,r){return n[r.name]=t.mapArgToTensorInfo(r,e.ret),n}),{})}}},{key:"mapArgToTensorInfo",value:function(e,t){var n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}}],[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),e}();function ox(e,t){var n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){var t=Ce().global;if("undefined"!==typeof t.atob)return t.atob(e);if("undefined"!==typeof Buffer)return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return t?n:n.toLowerCase()}function sx(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return null!=a?ox(a.s,r):n}function ux(e,t,n){var r=e[t];return r?r.b:n}function lx(e,t,n){var r=e[t]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"===typeof a?a:parseInt(a,10)}function cx(e){switch("string"===typeof e&&(e=Ab[e]),e){case Ab.DT_FLOAT:return"float32";case Ab.DT_INT32:case Ab.DT_INT64:case Ab.DT_INT8:case Ab.DT_UINT8:return"int32";case Ab.DT_BOOL:return"bool";case Ab.DT_DOUBLE:return"float32";case Ab.DT_STRING:return"string";default:return null}}function hx(e,t,n){var r=e[t];return r&&r.func?r.func.name:n}function px(e,t,n){var r=e[t];return r&&r.type?cx(r.type):n}function fx(e,t,n){var r=e[t];return r&&r.list&&r.list.type?r.list.type.map((function(e){return cx(e)})):n}function dx(e){if(!e.unknownRank)return null!=e.dim?e.dim.map((function(e){return"number"===typeof e.size?e.size:parseInt(e.size,10)})):[]}function vx(e,t,n){var r=e[t];return r&&r.shape?dx(r.shape):n}function mx(e,t,n){var r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(e){return"number"===typeof e?e:parseInt(e,10)})):n}function gx(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return a&&a.list&&a.list.s?a.list.s.map((function(e){return ox(e,r)})):n}function yx(e,t,n){var r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map((function(e){return dx(e)})):n}function bx(e,t,n){var r=e[t];return r&&r.list&&r.list.b?r.list.b:n}var xx=function(){function e(t,n,r){var a=this;A(this,e),this.node=t,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map((function(e){return a.getInput(e)})),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((function(e,t){return e[t]=a.getAttr(t),e}),{}))}return R(e,[{key:"getInput",value:function(e){return Lb(e,this.tensorMap,this.context)}},{key:"getAttr",value:function(e,t){var n=this.node.rawAttrs[e];if(null!=n.tensor)return Lb(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return lx(this.node.rawAttrs,e,t);if(null!=n.s)return sx(this.node.rawAttrs,e,t);if(null!=n.b)return ux(this.node.rawAttrs,e,t);if(null!=n.shape)return vx(this.node.rawAttrs,e,t);if(null!=n.type)return px(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return mx(this.node.rawAttrs,e,t);if(null!=n.list.s)return gx(this.node.rawAttrs,e,t);if(null!=n.list.shape)return yx(this.node.rawAttrs,e,t);if(null!=n.list.b)return bx(this.node.rawAttrs,e,t);if(null!=n.list.type)return fx(this.node.rawAttrs,e,t)}return t}}]),e}();var kx=Ra({addN_:function(e){G(Array.isArray(e),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),G(e.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+"".concat(e.length)}));var t=e.map((function(e,t){return Aa(e,"tensors".concat(t),"addN")})),n=t[0];t.forEach((function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(e){if(!Y(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=t;return _a.runKernel(Fe,r)}});function _x(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if("number"!==typeof e&&"number"!==typeof t){G(e.length===t.length,(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}));for(var r=0;r<e.length;r++){var a=e[r],i=t[r];G(a<0||i<0||a===i,(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}}}function Sx(e){return"number"!==typeof e&&!e.some((function(e){return e<0}))}function Ix(e,t,n){var r=Cx(e,n),a=!Sx(r);if(a&&0===t.length)throw new Error("Tried to calculate elements of an empty list"+" with non-fully-defined elementShape: ".concat(r));if(a&&t.forEach((function(e){r=Cx(e.shape,r)})),!Sx(r))throw new Error("Non-fully-defined elementShape: ".concat(r));return r}function Cx(e,t){if("number"===typeof e)return t;if("number"===typeof t)return e;if(e.length!==t.length)throw new Error("Incompatible ranks during merge: ".concat(e," vs. ").concat(t));for(var n=[],r=0;r<e.length;++r){var a=e[r],i=t[r];if(a>=0&&i>=0&&a!==i)throw new Error("Incompatible shape during merge: ".concat(e," vs. ").concat(t));n[r]=a>=0?a:i}return n}var Tx=function(){function e(t,n,r,a,i,o,s){A(this,e),this.name=t,this.dtype=n,this.maxSize=r,this.elementShape=a,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.idTensor=Lo(0),Do(this.idTensor)}return R(e,[{key:"id",get:function(){return this.idTensor.id}},{key:"closed",get:function(){return this.closed_}},{key:"clearAndClose",value:function(e){this.tensors.forEach((function(t){null!=e&&e.has(t.tensor.id)||t.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"read",value:function(e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||e>=this.size())throw new Error("Tried to read from index ".concat(e,", but array size is: ").concat(this.size()));var t=this.tensors[e];if(t.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(e," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}},{key:"readMany",value:function(e){var t=this;return e.map((function(e){return t.read(e)}))}},{key:"write",value:function(e,t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index ".concat(e,", but array is not resizeable and size is: ").concat(this.maxSize));var n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,",\n          because the value dtype is ").concat(t.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),_x(this.elementShape,t.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been written."));n.tensor=t,Do(t),n.written=!0,this.tensors[e]=n}},{key:"writeMany",value:function(e,t){var n=this;if(e.length!==t.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(e.length," is not the same as tensors size: ").concat(t.length,"."));e.forEach((function(e,r){return n.write(e,t[r])}))}},{key:"gather",value:function(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(t));if(e)e=e.slice(0,this.size());else{e=[];for(var n=0;n<this.size();n++)e.push(n)}if(0===e.length)return La([],[0].concat(this.elementShape));var r=this.readMany(e);return _x(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Lu(r,0)}},{key:"concat",value:function(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(e));if(0===this.size())return La([],[0].concat(this.elementShape));for(var t=[],n=0;n<this.size();n++)t.push(n);var r=this.readMany(t);return _x(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(r[0].shape,")")),ps(r,0)}},{key:"scatter",value:function(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));var n=Math.max.apply(Math,I(e));if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(e,Wu(t,0))}},{key:"split",value:function(e,t){var n=this;if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));var r=0,a=e.map((function(e){return r+=e}));if(r!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(t.shape));if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(e.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");var i=0===r?0:t.size/r,o=[];Mo((function(){t=as(t,[1,r,i]);for(var s=0;s<e.length;++s){var u=[0,0===s?0:a[s-1],0],l=[1,e[s],i];o[s]=as(Cu(t,u,l),n.elementShape)}return o}));for(var s=[],u=0;u<e.length;u++)s[u]=u;this.writeMany(s,o)}}]),e}(),Nx=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;A(this,e),this.tensors=t,this.elementShape=n,this.elementDtype=r,null!=t&&t.forEach((function(e){if(r!==e.dtype)throw new Error("Invalid data types; op elements ".concat(r,", but list elements ").concat(e.dtype));_x(n,e.shape,"TensorList shape mismatch: "),Do(e)})),this.idTensor=Lo(0),this.maxNumElements=a,Do(this.idTensor)}return R(e,[{key:"id",get:function(){return this.idTensor.id}},{key:"copy",value:function(){return new e(I(this.tensors),this.elementShape,this.elementDtype)}},{key:"clearAndClose",value:function(e){this.tensors.forEach((function(t){null!=e&&e.has(t.id)||t.dispose()})),this.tensors.length=0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"stack",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(-1!==r&&this.tensors.length!==r)throw new Error("Operation expected a list with ".concat(r," elements but got a list with ").concat(this.tensors.length," elements."));_x(e,this.elementShape,"TensorList shape mismatch: ");var a=Ix(this.elementShape,this.tensors,e);return Mo((function(){var e=n.tensors.map((function(e){return as(e,a)}));return Lu(e,0)}))}},{key:"popBack",value:function(e,t){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");var n=Ix(this.elementShape,this.tensors,e),r=this.tensors.pop();return _x(r.shape,e,"TensorList shape mismatch: "),as(r,n)}},{key:"pushBack",value:function(e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(_x(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Do(e),this.tensors.push(e)}},{key:"resize",value:function(e){if(e<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(e));if(-1!==this.maxNumElements&&e>this.maxNumElements)throw new Error("TensorListResize input size ".concat(e," is greater maxNumElement ").concat(this.maxNumElements,"."));this.tensors.length=e}},{key:"getItem",value:function(e,t,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(e<0||e>this.tensors.length)throw new Error("Trying to access element ".concat(e," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[e])throw new Error("element at index ".concat(e," is null."));_x(this.tensors[e].shape,t,"TensorList shape mismatch: ");var r=Ix(this.elementShape,this.tensors,t);return as(this.tensors[e],r)}},{key:"setItem",value:function(e,t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error("Trying to set element ".concat(e," in a list with max ").concat(this.maxNumElements," elements."));_x(this.elementShape,t.shape,"TensorList shape mismatch: "),Do(t),this.tensors[e]=t}},{key:"gather",value:function(e,t,n){var r=this;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));_x(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());var a=Ix(this.elementShape,this.tensors,n);return 0===e.length?La([],[0].concat(a)):Mo((function(){var t=e.map((function(e){return as(r.tensors[e],a)}));return Lu(t,0)}))}},{key:"concat",value:function(e,t){var n=this;if(e&&e!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(e));_x(this.elementShape,t,"TensorList shape mismatch: ");var r=Ix(this.elementShape,this.tensors,t);return 0===this.size()?La([],[0].concat(r)):Mo((function(){var e=n.tensors.map((function(e){return as(e,r)}));return ps(e,0)}))}}]),e}();function Ex(e,t,n){var r=e.dtype;if(e.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(e.shape));if(e.dtype!==n)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(n));_x(e.shape.slice(1),t,"TensorList shape mismatch: ");var a=Wu(e);return new Nx(a,t,r)}function Mx(e,t,n){return new Nx([],e,t,n)}function Ax(e,t,n,r){if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));var a=Math.max.apply(Math,I(t));if(null!=r&&-1!==r&&a>=r)throw new Error("Max index must be < array size (".concat(a,"  vs. ").concat(r,")"));var i=new Nx([],n,e.dtype,r),o=Wu(e,0);return t.forEach((function(e,t){i.setItem(e,o[t])})),i}function Dx(e,t,n){var r=0,a=t.map((function(e){return r+=e}));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(e.shape));for(var i=Cx(e.shape.slice(1),n),o=0===r?0:e.size/r,s=Mo((function(){var n=[];e=as(e,[1,r,o]);for(var s=0;s<t.length;++s){var u=[0,0===s?0:a[s-1],0],l=[1,t[s],o];n[s]=as(Cu(e,u,l),i)}return e.dispose(),n})),u=new Nx([],n,e.dtype,t.length),l=0;l<s.length;l++)u.setItem(l,s[l]);return u}var Rx=function(){var e=F(M().mark((function e(t,n,r){var a,i,o,s,u,l,c,h,p,f,d,v,m,g,y,b,x,k,w,_,S,I,C,T,N,E,A,D,R,O,F,L,P,z,B,V,W,U,H,G,j,q,X,K,Y,Z,Q,$,J,ee,te,ne,re,ae,ie,oe,se,ue,le,ce,he,pe,fe,de,ve,me,ge,ye,be,xe,ke,we,_e,Se,Ie,Ce,Te,Ne,Ee,Me,Ae,De,Re,Oe,Fe,Le,Pe,ze,Be,Ve,We,Ue,He,Ge,je,qe;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="If"===e.t0||"StatelessIf"===e.t0?3:"While"===e.t0||"StatelessWhile"===e.t0?15:"LoopCond"===e.t0?19:"Switch"===e.t0?21:"Merge"===e.t0?32:"Enter"===e.t0?37:"Exit"===e.t0?41:"NextIteration"===e.t0?44:"TensorArrayV3"===e.t0?47:"TensorArrayWriteV3"===e.t0?57:"TensorArrayReadV3"===e.t0?63:"TensorArrayGatherV3"===e.t0?67:"TensorArrayScatterV3"===e.t0?72:"TensorArrayConcatV3"===e.t0?78:"TensorArraySplitV3"===e.t0?82:"TensorArraySizeV3"===e.t0?88:"TensorArrayCloseV3"===e.t0?91:"TensorListSetItem"===e.t0?95:"TensorListGetItem"===e.t0?101:"TensorListScatterV2"===e.t0||"TensorListScatter"===e.t0?107:"TensorListReserve"===e.t0||"EmptyTensorList"===e.t0?114:"TensorListGather"===e.t0?121:"TensorListStack"===e.t0?127:"TensorListFromTensor"===e.t0?133:"TensorListConcat"===e.t0?139:"TensorListPushBack"===e.t0?144:"TensorListPopBack"===e.t0?149:"TensorListSplit"===e.t0?154:160;break;case 3:return a=Fb("thenBranch",t,n,r),i=Fb("elseBranch",t,n,r),o=Fb("cond",t,n,r),s=Fb("args",t,n,r),e.next=9,o.data();case 9:if(!e.sent[0]){e.next=14;break}return e.abrupt("return",r.functionMap[a].executeFunctionAsync(s,r.tensorArrayMap,r.tensorListMap));case 14:return e.abrupt("return",r.functionMap[i].executeFunctionAsync(s,r.tensorArrayMap,r.tensorListMap));case 15:return e.delegateYield(M().mark((function e(){var a,i,o,s,u,l,c,h;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Fb("body",t,n,r),i=Fb("cond",t,n,r),o=Fb("args",t,n,r),e.next=5,r.functionMap[i].executeFunctionAsync(o,r.tensorArrayMap,r.tensorListMap);case 5:return s=e.sent,u=o.map((function(e){return e.id})),e.next=9,s[0].data();case 9:l=e.sent,s.forEach((function(e){e.kept||-1!==u.indexOf(e.id)||e.dispose()})),c=o,h=M().mark((function e(){var t,n,o;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c,e.next=3,r.functionMap[a].executeFunctionAsync(c,r.tensorArrayMap,r.tensorListMap);case 3:return c=e.sent,n=c.map((function(e){return e.id})),t.forEach((function(e){e.kept||-1!==u.indexOf(e.id)||-1!==n.indexOf(e.id)||e.dispose()})),e.next=8,r.functionMap[i].executeFunctionAsync(c,r.tensorArrayMap,r.tensorListMap);case 8:return o=e.sent,e.next=11,o[0].data();case 11:l=e.sent,o.forEach((function(e){e.kept||-1!==u.indexOf(e.id)||-1!==n.indexOf(e.id)||e.dispose()}));case 13:case"end":return e.stop()}}),e)}));case 13:if(!l[0]){e.next=17;break}return e.delegateYield(h(),"t0",15);case 15:e.next=13;break;case 17:return e.abrupt("return",{v:c});case 18:case"end":return e.stop()}}),e)}))(),"t1",16);case 16:if("object"!==typeof(u=e.t1)){e.next=19;break}return e.abrupt("return",u.v);case 19:return l=Fb("pred",t,n,r),e.abrupt("return",[Wb(l)]);case 21:return c=Fb("pred",t,n,r),(h=Fb("data",t,n,r)).kept||(h=Wb(h)),e.next=26,c.data();case 26:if(!e.sent[0]){e.next=30;break}e.t2=[void 0,h],e.next=31;break;case 30:e.t2=[h,void 0];case 31:return e.abrupt("return",e.t2);case 32:if(p=t.inputNames.find((function(e){return void 0!==Lb(e,n,r)})),!p){e.next=36;break}return f=Lb(p,n,r),e.abrupt("return",[Wb(f)]);case 36:return e.abrupt("return",void 0);case 37:return d=Fb("frameName",t,n,r),v=Fb("tensor",t,n,r),r.enterFrame(d),e.abrupt("return",[Wb(v)]);case 41:return m=Fb("tensor",t,n,r),r.exitFrame(),e.abrupt("return",[Wb(m)]);case 44:return g=Fb("tensor",t,n,r),r.nextIteration(),e.abrupt("return",[Wb(g)]);case 47:return y=Fb("size",t,n,r),b=Fb("dtype",t,n,r),x=Fb("elementShape",t,n,r),k=Fb("dynamicSize",t,n,r),w=Fb("clearAfterRead",t,n,r),_=Fb("identicalElementShapes",t,n,r),S=Fb("name",t,n,r),I=new Tx(S,b,y,x,_,k,w),r.addTensorArray(I),e.abrupt("return",[I.idTensor,Lo(1)]);case 57:return C=Fb("tensorArrayId",t,n,r),T=Fb("index",t,n,r),N=Fb("tensor",t,n,r),(E=r.getTensorArray(C.id)).write(T,N),e.abrupt("return",[E.idTensor]);case 63:return A=Fb("tensorArrayId",t,n,r),D=Fb("index",t,n,r),R=r.getTensorArray(A.id),e.abrupt("return",[R.read(D)]);case 67:return O=Fb("tensorArrayId",t,n,r),F=Fb("indices",t,n,r),L=Fb("dtype",t,n,r),P=r.getTensorArray(O.id),e.abrupt("return",[P.gather(F,L)]);case 72:return z=Fb("tensorArrayId",t,n,r),B=Fb("indices",t,n,r),V=Fb("tensor",t,n,r),(W=r.getTensorArray(z.id)).scatter(B,V),e.abrupt("return",[W.idTensor]);case 78:return U=Fb("tensorArrayId",t,n,r),H=r.getTensorArray(U.id),G=Fb("dtype",t,n,r),e.abrupt("return",[H.concat(G)]);case 82:return j=Fb("tensorArrayId",t,n,r),q=Fb("tensor",t,n,r),X=Fb("lengths",t,n,r),(K=r.getTensorArray(j.id)).split(X,q),e.abrupt("return",[K.idTensor]);case 88:return Y=Fb("tensorArrayId",t,n,r),Z=r.getTensorArray(Y.id),e.abrupt("return",[Lo(Z.size(),"int32")]);case 91:return Q=Fb("tensorArrayId",t,n,r),($=r.getTensorArray(Q.id)).clearAndClose(),e.abrupt("return",[$.idTensor]);case 95:return J=Fb("tensorListId",t,n,r),ee=Fb("index",t,n,r),te=Fb("tensor",t,n,r),(ne=r.getTensorList(J.id)).setItem(ee,te),e.abrupt("return",[ne.idTensor]);case 101:return re=Fb("tensorListId",t,n,r),ae=Fb("index",t,n,r),ie=Fb("elementShape",t,n,r),oe=Fb("elementDType",t,n,r),se=r.getTensorList(re.id),e.abrupt("return",[se.getItem(ae,ie,oe)]);case 107:return ue=Fb("indices",t,n,r),le=Fb("tensor",t,n,r),ce=Fb("elementShape",t,n,r),he=Fb("numElements",t,n,r),pe=Ax(le,ue,ce,he),r.addTensorList(pe),e.abrupt("return",[pe.idTensor]);case 114:return fe=Fb("elementShape",t,n,r),de=Fb("elementDType",t,n,r),ve="TensorListReserve"===t.op?"numElements":"maxNumElements",me=Fb(ve,t,n,r),ge=Mx(fe,de,me),r.addTensorList(ge),e.abrupt("return",[ge.idTensor]);case 121:return ye=Fb("tensorListId",t,n,r),be=Fb("indices",t,n,r),xe=Fb("elementShape",t,n,r),ke=Fb("elementDType",t,n,r),we=r.getTensorList(ye.id),e.abrupt("return",[we.gather(be,ke,xe)]);case 127:return _e=Fb("tensorListId",t,n,r),Se=Fb("elementShape",t,n,r),Ie=Fb("elementDType",t,n,r),Ce=Fb("numElements",t,n,r),Te=r.getTensorList(_e.id),e.abrupt("return",[Te.stack(Se,Ie,Ce)]);case 133:return Ne=Fb("tensor",t,n,r),Ee=Fb("elementShape",t,n,r),Me=Fb("elementDType",t,n,r),Ae=Ex(Ne,Ee,Me),r.addTensorList(Ae),e.abrupt("return",[Ae.idTensor]);case 139:return De=Fb("tensorListId",t,n,r),Re=r.getTensorList(De.id),Oe=Fb("dtype",t,n,r),Fe=Fb("elementShape",t,n,r),e.abrupt("return",[Re.concat(Oe,Fe)]);case 144:return Le=Fb("tensorListId",t,n,r),Pe=Fb("tensor",t,n,r),(ze=r.getTensorList(Le.id)).pushBack(Pe),e.abrupt("return",[ze.idTensor]);case 149:return Be=Fb("tensorListId",t,n,r),Ve=Fb("elementShape",t,n,r),We=Fb("elementDType",t,n,r),Ue=r.getTensorList(Be.id),e.abrupt("return",[Ue.popBack(Ve,We)]);case 154:return He=Fb("tensor",t,n,r),Ge=Fb("elementShape",t,n,r),je=Fb("lengths",t,n,r),qe=Dx(He,je,Ge),r.addTensorList(qe),e.abrupt("return",[qe.idTensor]);case 160:throw TypeError("Node type ".concat(t.op," is not implemented"));case 161:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();var Ox=Ra({maxPoolWithArgmax_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=Aa(e,"x","maxPoolWithArgmax"),o={x:i},s={filterSize:t,strides:n,pad:r,includeBatchInIndex:a},u=_a.runKernel(hn,o,s);return{result:u[0],indexes:u[1]}}});function Fx(e,t,n){var r=N(Fb("fusedOps",e,t,n),2),a=r[0],i=r[1],o="biasadd"===a,s="prelu"===i,u="fusedbatchnorm"===a,l=Fb("numArgs",e,t,n);if(o){if(s&&2!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&1!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(u)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");var c=Fb("strides",e,t,n),h=Vb(e,t,n),p=Fb("dataFormat",e,t,n).toUpperCase(),f=Fb("dilations",e,t,n),d=N(Fb("args",e,t,n),2);return{stride:c,pad:h,dataFormat:p,dilations:f,biasArg:d[0],preluArg:d[1],activationFunc:i,leakyreluAlpha:Fb("leakyreluAlpha",e,t,n)}}function Lx(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");var r={start:e,stop:t,num:n};return _a.runKernel(Zt,{},r)}var Px=Ra({multinomial_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Aa(e,"logits","multinomial"),i=a.size,o=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(i,"."));if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(o));n=n||Math.random();var s=1===o?as(a,[1,-1]):a,u={logits:s},l={numSamples:t,seed:n,normalized:r},c=_a.runKernel(gn,u,l);return 1===o?as(c,[c.size]):c}});function zx(){return(zx=F(M().mark((function e(t){var n,r,a;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Aa(t,"condition","whereAsync","bool"),e.next=3,n.data();case 3:return r=e.sent,a=qc(n.shape,r),t!==n&&n.dispose(),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Bx=function(e){return zx.apply(this,arguments)};function Vx(){return Vx=F(M().mark((function e(t,n){var r,a,i,o,s,u,l,c,h,p,f;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Aa(t,"x","setdiff1d"),a=Aa(n,"y","setdiff1d"),G(r.dtype===a.dtype,(function(){return"x and y should have the same dtype, but got x (".concat(r.dtype,") and y (").concat(a.dtype,").")})),G(1===r.rank,(function(){return"x should be 1D tensor, but got x (".concat(r.shape,").")})),G(1===a.rank,(function(){return"y should be 1D tensor, but got y (".concat(a.shape,").")})),e.next=7,r.data();case 7:return i=e.sent,e.next=10,a.data();case 10:for(o=e.sent,s=new Set(o),u=0,l=0;l<i.length;l++)s.has(i[l])||u++;for(c=new ea([u],r.dtype),h=new ea([u],"int32"),p=0,f=0;p<i.length;p++)s.has(i[p])||(c.values[f]=i[p],h.values[f]=p,f++);return e.abrupt("return",[c.toTensor(),h.toTensor()]);case 18:case"end":return e.stop()}}),e)}))),Vx.apply(this,arguments)}var Wx=function(e,t){return Vx.apply(this,arguments)};function Ux(e,t,n){return{boxes:Fb("boxes",e,t,n),scores:Fb("scores",e,t,n),maxOutputSize:Fb("maxOutputSize",e,t,n),iouThreshold:Fb("iouThreshold",e,t,n),scoreThreshold:Fb("scoreThreshold",e,t,n),softNmsSigma:Fb("softNmsSigma",e,t,n)}}var Hx=function(){var e=F(M().mark((function e(t,n,r){var a,i,o,s,u,l,c,h,p,f,d,v,m,g,y,b,x,k,w,_,S,I,C,T;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="NonMaxSuppressionV5"===e.t0?3:"NonMaxSuppressionV4"===e.t0?8:"NonMaxSuppressionV3"===e.t0||"NonMaxSuppressionV2"===e.t0?14:"Where"===e.t0?19:"ListDiff"===e.t0?26:27;break;case 3:return a=Ux(t,n,r),i=a.boxes,o=a.scores,s=a.maxOutputSize,u=a.iouThreshold,l=a.scoreThreshold,c=a.softNmsSigma,e.next=6,ic.nonMaxSuppressionWithScoreAsync(i,o,s,u,l,c);case 6:return h=e.sent,e.abrupt("return",[h.selectedIndices,h.selectedScores]);case 8:return p=Ux(t,n,r),f=p.boxes,d=p.scores,v=p.maxOutputSize,m=p.iouThreshold,g=p.scoreThreshold,y=Fb("padToMaxOutputSize",t,n,r),e.next=12,ic.nonMaxSuppressionPaddedAsync(f,d,v,m,g,y);case 12:return b=e.sent,e.abrupt("return",[b.selectedIndices,b.validOutputs]);case 14:return x=Ux(t,n,r),k=x.boxes,w=x.scores,_=x.maxOutputSize,S=x.iouThreshold,I=x.scoreThreshold,e.next=17,ic.nonMaxSuppressionAsync(k,w,_,S,I);case 17:return e.t1=e.sent,e.abrupt("return",[e.t1]);case 19:return C=Bi(Fb("condition",t,n,r),"bool"),e.next=22,Bx(C);case 22:return e.t2=e.sent,T=[e.t2],C.dispose(),e.abrupt("return",T);case 26:return e.abrupt("return",Wx(Fb("x",t,n,r),Fb("y",t,n,r)));case 27:throw TypeError("Node type ".concat(t.op," is not implemented"));case 28:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Gx=function(){function e(t,n){A(this,e),this.keyDType=t,this.valueDType=n,this.handle=Lo(0),this.tensorMap=new Map,Do(this.handle)}return R(e,[{key:"id",get:function(){return this.handle.id}},{key:"clearAndClose",value:function(){this.tensorMap.forEach((function(e){return e.dispose()})),this.tensorMap.clear(),this.handle.dispose()}},{key:"size",value:function(){return this.tensorMap.size}},{key:"tensorSize",value:function(){return Lo(this.size(),"int32")}},{key:"import",value:function(){var e=F(M().mark((function e(t,n){var r,a=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkKeyAndValueTensor(t,n),e.next=3,t.data();case 3:return r=e.sent,this.tensorMap.forEach((function(e){return e.dispose()})),this.tensorMap.clear(),e.abrupt("return",Mo((function(){var e=Wu(n),t=r.length,i=e.length;G(t===i,(function(){return"The number of elements doesn't match, keys has "+"".concat(t," elements, the values has ").concat(i," ")+"elements."}));for(var o=0;o<t;o++){var s=r[o],u=e[o];Do(u),a.tensorMap.set(s,u)}return a.handle})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"find",value:function(){var e=F(M().mark((function e(t,n){var r,a=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkKeyAndValueTensor(t,n),e.next=3,t.data();case 3:return r=e.sent,e.abrupt("return",Mo((function(){for(var e=[],t=0;t<r.length;t++){var i=r[t],o=a.findWithDefault(i,n);e.push(o)}return Lu(e)})));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"findWithDefault",value:function(e,t){var n=this.tensorMap.get(e);return null!=n?n:t}},{key:"checkKeyAndValueTensor",value:function(e,t){if(e.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ")+"".concat(e.dtype));if(t.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ")+"".concat(t.dtype))}}]),e}(),jx=function(){var e=F(M().mark((function e(t,n,r,a){var i,o,s,u,l,c,h,p,f,d,v,m,g;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="HashTable"===e.t0||"HashTableV2"===e.t0?3:"LookupTableImport"===e.t0||"LookupTableImportV2"===e.t0?8:"LookupTableFind"===e.t0||"LookupTableFindV2"===e.t0?16:"LookupTableSize"===e.t0||"LookupTableSizeV2"===e.t0?24:27;break;case 3:return i=Fb("keyDType",t,n,r),o=Fb("valueDType",t,n,r),s=new Gx(i,o),a.addHashTable(t.name,s),e.abrupt("return",[s.handle]);case 8:return u=Fb("tableHandle",t,n,r,a),l=Fb("keys",t,n,r),c=Fb("values",t,n,r),h=a.getHashTableById(u.id),e.next=14,h.import(l,c);case 14:return e.t1=e.sent,e.abrupt("return",[e.t1]);case 16:return p=Fb("tableHandle",t,n,r,a),f=Fb("keys",t,n,r),d=Fb("defaultValue",t,n,r),v=a.getHashTableById(p.id),e.next=22,v.find(f,d);case 22:return e.t2=e.sent,e.abrupt("return",[e.t2]);case 24:return m=Fb("tableHandle",t,n,r,a),g=a.getHashTableById(m.id),e.abrupt("return",[g.tensorSize()]);case 27:throw TypeError("Node type ".concat(t.op," is not implemented"));case 28:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}();function qx(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(e.shape,"."));var a=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(i,"."));var o=t.size;if(0!==t.rank&&(1!==t.rank||o!==a))throw new Error("sparseValues has incorrect shape "+"".concat(t.shape,", should be [] or [").concat(a,"]"));if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}var Xx=Ra({sparseToDense_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=Aa(e,"sparseIndices","sparseToDense","int32"),i=Aa(t,"sparseValues","sparseToDense"),o=Aa(r,"defaultValue","sparseToDense",i.dtype);qx(a,i,n,o);var s={sparseIndices:a,sparseValues:i,defaultValue:o},u={outputShape:n};return _a.runKernel(sr,s,u)}});var Kx=Ra({bincount_:function(e,t,n){var r=Aa(e,"x","bincount"),a=Aa(t,"weights","bincount");G("int32"===r.dtype,(function(){return"Error in bincount: input "+"dtype must be int32, but got ".concat(r.dtype)})),G(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),G(a.size===r.size||0===a.size,(function(){return"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(r.shape,", weights shape: ")+"".concat(a.shape,".")}));var i={x:r,weights:a},o={size:n};return _a.runKernel(Qe,i,o)}});var Yx=Ra({denseBincount_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Aa(e,"x","denseBincount"),i=Aa(t,"weights","denseBincount");G("int32"===a.dtype,(function(){return"Error in denseBincount: input "+"dtype must be int32, but got ".concat(a.dtype)})),G(a.rank<=2,(function(){return"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(a.rank,".")})),G(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),G(i.size===a.size||0===i.size,(function(){return"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(a.shape,", weights shape: ")+"".concat(i.shape,".")}));var o={x:a,weights:i},s={size:n,binaryOutput:r};return _a.runKernel(dt,o,s)}});var Zx=Ra({scatterND_:function(e,t,n){var r=Aa(e,"indices","scatterND","int32"),a=Aa(t,"updates","scatterND");Nc(a,r,n);var i={indices:r,updates:a},o={shape:n};return _a.runKernel(Gn,i,o)}});var Qx=Ra({gatherND_:function(e,t){var n=Aa(t,"indices","gatherND","int32"),r={params:Aa(e,"x","gatherND"),indices:n};return _a.runKernel(zt,r)}});function $x(e,t,n,r){var a=function(e,t,n){switch(e.category){case"arithmetic":return Mo((function(){return function(e,t,n){switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[Bo(Fb("a",e,t,n),Fb("b",e,t,n))];case"AddN":return[kx(Fb("tensors",e,t,n))];case"FloorMod":case"Mod":return[xf(Fb("a",e,t,n),Fb("b",e,t,n))];case"Mul":return[Us(Fb("a",e,t,n),Fb("b",e,t,n))];case"RealDiv":case"Div":return[Ss(Fb("a",e,t,n),Fb("b",e,t,n))];case"DivNoNan":return[uf(Fb("a",e,t,n),Fb("b",e,t,n))];case"FloorDiv":return[_s(Fb("a",e,t,n),Fb("b",e,t,n))];case"Sub":return[Hs(Fb("a",e,t,n),Fb("b",e,t,n))];case"Minimum":return[$s(Fb("a",e,t,n),Fb("b",e,t,n))];case"Maximum":return[Ys(Fb("a",e,t,n),Fb("b",e,t,n))];case"Pow":return[ql(Fb("a",e,t,n),Fb("b",e,t,n))];case"SquaredDifference":return[ec(Fb("a",e,t,n),Fb("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"basic_math":return Mo((function(){return function(e,t,n){switch(e.op){case"Abs":case"ComplexAbs":return[zo(Fb("x",e,t,n))];case"Acos":return[Zp(Fb("x",e,t,n))];case"Acosh":return[Qp(Fb("x",e,t,n))];case"Asin":return[Jp(Fb("x",e,t,n))];case"Asinh":return[ef(Fb("x",e,t,n))];case"Atan":return[tf(Fb("x",e,t,n))];case"Atan2":return[nf(Fb("x",e,t,n),Fb("y",e,t,n))];case"Atanh":return[rf(Fb("x",e,t,n))];case"Ceil":return[af(Fb("x",e,t,n))];case"Complex":return[Oa(Fb("real",e,t,n),Fb("imag",e,t,n))];case"Cos":return[Pp(Fb("x",e,t,n))];case"Cosh":return[Bp(Fb("x",e,t,n))];case"Elu":return[Is(Fb("x",e,t,n))];case"Erf":return[cf(Fb("x",e,t,n))];case"Exp":return[Vs(Fb("x",e,t,n))];case"Expm1":return[hf(Fb("x",e,t,n))];case"Floor":return[Os(Fb("x",e,t,n))];case"Log":return[Bs(Fb("x",e,t,n))];case"Log1p":return[tc(Fb("x",e,t,n))];case"Imag":return[Ku(Fb("x",e,t,n))];case"Neg":return[uu(Fb("x",e,t,n))];case"Reciprocal":return[_f(Fb("x",e,t,n))];case"Real":return[Yu(Fb("x",e,t,n))];case"Relu":return[ku(Fb("x",e,t,n))];case"Round":return[Sf(Fb("x",e,t,n))];case"Selu":return[_u(Fb("x",e,t,n))];case"Sigmoid":return[Iu(Fb("x",e,t,n))];case"Sin":return[_h(Fb("x",e,t,n))];case"Sign":return[If(Fb("x",e,t,n))];case"Sinh":return[Ih(Fb("x",e,t,n))];case"Softplus":return[Du(Fb("x",e,t,n))];case"Sqrt":return[Ou(Fb("x",e,t,n))];case"Square":return[ou(Fb("x",e,t,n))];case"Tanh":return[Pu(Fb("x",e,t,n))];case"Tan":return[Tf(Fb("x",e,t,n))];case"ClipByValue":return[hs(Fb("x",e,t,n),Fb("clipValueMin",e,t,n),Fb("clipValueMax",e,t,n))];case"Relu6":return[tl(Fb("x",e,t,n))];case"Rsqrt":return[zh(Lb(e.inputNames[0],t,n))];case"Prod":return[wf(Fb("x",e,t,n),Fb("axes",e,t,n))];case"LeakyRelu":return[zs(Fb("x",e,t,n),Fb("alpha",e,t,n))];case"Prelu":return[vu(Fb("x",e,t,n),Fb("alpha",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"control":return Rx(e,t,n);case"convolution":return Mo((function(){return function(e,t,n){switch(e.op){case"Conv1D":var r=Fb("stride",e,t,n),a=Fb("pad",e,t,n),i=Fb("dataFormat",e,t,n).toUpperCase(),o=Fb("dilation",e,t,n);return[ys(Fb("x",e,t,n),Fb("filter",e,t,n),r,a,i,o)];case"Conv2D":var s=Fb("strides",e,t,n),u=Vb(e,t,n),l=Fb("dataFormat",e,t,n).toUpperCase(),c=Fb("dilations",e,t,n);return[gs(Fb("x",e,t,n),Fb("filter",e,t,n),[s[1],s[2]],u,l,[c[1],c[2]])];case"_FusedConv2D":var h=Fx(e,t,n),p=h.stride,f=h.pad,d=h.dataFormat,v=h.dilations,m=h.biasArg,g=h.preluArg,y=h.activationFunc,b=h.leakyreluAlpha;return[sl({x:Fb("x",e,t,n),filter:Fb("filter",e,t,n),strides:[p[1],p[2]],pad:f,dataFormat:d,dilations:[v[1],v[2]],bias:m,activation:y,preluActivationWeights:g,leakyreluAlpha:b})];case"FusedDepthwiseConv2dNative":var x=Fx(e,t,n),k=x.stride,w=x.pad,_=x.dataFormat,S=x.dilations,I=x.biasArg,C=x.preluArg,T=x.activationFunc,N=x.leakyreluAlpha;return[cl({x:Fb("x",e,t,n),filter:Fb("filter",e,t,n),strides:[k[1],k[2]],pad:w,dataFormat:_,dilations:[S[1],S[2]],bias:I,activation:T,preluActivationWeights:C,leakyreluAlpha:N})];case"Conv2DBackpropInput":case"Conv2dTranspose":var E=Fb("outputShape",e,t,n),M=Fb("strides",e,t,n),A=Vb(e,t,n);return[xs(Fb("x",e,t,n),Fb("filter",e,t,n),E,[M[1],M[2]],A)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":var D=Fb("strides",e,t,n),R=Vb(e,t,n),O=Fb("dilations",e,t,n),F=Fb("dataFormat",e,t,n).toUpperCase();return[ws(Fb("input",e,t,n),Fb("filter",e,t,n),[D[1],D[2]],R,F,[O[1],O[2]])];case"Conv3D":var L=Fb("strides",e,t,n),P=Fb("pad",e,t,n),z=Fb("dataFormat",e,t,n).toUpperCase(),B=Fb("dilations",e,t,n);return[ks(Fb("x",e,t,n),Fb("filter",e,t,n),[L[1],L[2],L[3]],P,z,[B[1],B[2],B[3]])];case"AvgPool":var V=Fb("strides",e,t,n),W=Fb("pad",e,t,n),U=Fb("kernelSize",e,t,n);return[is(Fb("x",e,t,n),[U[1],U[2]],[V[1],V[2]],W)];case"MaxPool":var H=Fb("strides",e,t,n),G=Fb("pad",e,t,n),j=Fb("kernelSize",e,t,n);return[Xs(Fb("x",e,t,n),[j[1],j[2]],[H[1],H[2]],G)];case"MaxPoolWithArgmax":var q=Fb("strides",e,t,n),X=Fb("pad",e,t,n),K=Fb("kernelSize",e,t,n),Y=Fb("includeBatchInIndex",e,t,n),Z=Ox(Fb("x",e,t,n),[K[1],K[2]],[q[1],q[2]],X,Y);return[Z.result,Z.indexes];case"AvgPool3D":var Q=Fb("strides",e,t,n),$=Fb("pad",e,t,n),J=Fb("kernelSize",e,t,n);return[os(Fb("x",e,t,n),[J[1],J[2],J[3]],[Q[1],Q[2],Q[3]],$)];case"MaxPool3D":var ee=Fb("strides",e,t,n),te=Fb("pad",e,t,n),ne=Fb("kernelSize",e,t,n);return[Ks(Fb("x",e,t,n),[ne[1],ne[2],ne[3]],[ee[1],ee[2],ee[3]],te)];case"Dilation2D":var re=Fb("strides",e,t,n),ae=Fb("pad",e,t,n),ie=Fb("dilations",e,t,n),oe=re[1],se=re[2],ue=ie[1],le=ie[2];return[sf(Fb("x",e,t,n),Fb("filter",e,t,n),[oe,se],ae,[ue,le],"NHWC")];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"creation":return Mo((function(){return function(e,t,n){switch(e.op){case"Fill":var r=Fb("shape",e,t,n),a=Fb("dtype",e,t,n);return[Rs(r,Fb("value",e,t,n),a)];case"LinSpace":return[Lx(Fb("start",e,t,n),Fb("stop",e,t,n),Fb("num",e,t,n))];case"Multinomial":var i=Fb("logits",e,t,n),o=Fb("numSamples",e,t,n),s=Fb("seed",e,t,n);return[Px(i,o,s)];case"OneHot":var u=Fb("indices",e,t,n),l=Fb("depth",e,t,n),c=Fb("onValue",e,t,n),h=Fb("offValue",e,t,n);return[cu(u,l,c,h)];case"Ones":return[pu(Fb("shape",e,t,n),Fb("dtype",e,t,n))];case"OnesLike":return[fu(Fb("x",e,t,n))];case"RandomUniform":return[xu(Fb("shape",e,t,n),Fb("minval",e,t,n),Fb("maxval",e,t,n),Fb("dtype",e,t,n))];case"Range":return[Gl(Fb("start",e,t,n),Fb("stop",e,t,n),Fb("step",e,t,n),Fb("dtype",e,t,n))];case"TruncatedNormal":var p=Fb("shape",e,t,n),f=Fb("mean",e,t,n),d=Fb("stdDev",e,t,n),v=Fb("seed",e,t,n);return[Vu(p,f,d,Fb("dtype",e,t,n),v)];case"Zeros":return[hu(Fb("shape",e,t,n),Fb("dtype",e,t,n))];case"ZerosLike":return[ju(Fb("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"dynamic":return Hx(e,t,n);case"evaluation":return Mo((function(){return function(e,t,n){switch(e.op){case"TopKV2":var r=Fb("x",e,t,n),a=Fb("k",e,t,n),i=Fb("sorted",e,t,n),o=Nf(r,a,i);return[o.values,o.indices];case"Unique":var s=Fb("x",e,t,n),u=Mf(s);return[u.values,u.indices];case"UniqueV2":var l=Fb("x",e,t,n),c=Fb("axis",e,t,n),h=Mf(l,c);return[h.values,h.indices];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"image":return Mo((function(){return function(e,t,n){switch(e.op){case"ResizeBilinear":var r=Fb("images",e,t,n),a=Fb("size",e,t,n),i=Fb("alignCorners",e,t,n),o=Fb("halfPixelCenters",e,t,n);return[ic.resizeBilinear(r,[a[0],a[1]],i,o)];case"ResizeNearestNeighbor":var s=Fb("images",e,t,n),u=Fb("size",e,t,n),l=Fb("alignCorners",e,t,n),c=Fb("halfPixelCenters",e,t,n);return[ic.resizeNearestNeighbor(s,[u[0],u[1]],l,c)];case"CropAndResize":var h=Fb("image",e,t,n),p=Fb("boxes",e,t,n),f=Fb("boxInd",e,t,n),d=Fb("cropSize",e,t,n),v=Fb("method",e,t,n),m=Fb("extrapolationValue",e,t,n);return[ic.cropAndResize(h,p,f,d,v,m)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"graph":return Mo((function(){return function(e,t,n){switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":var r=Fb("default",e,t,n);return[Lb(e.name,t,n)||r];case"Placeholder":return[Lb(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[Wb(Fb("x",e,t,n))];case"IdentityN":return Fb("x",e,t,n).map((function(e){return Wb(e)}));case"Shape":return[zu(Fb("x",e,t,n).shape,"int32")];case"ShapeN":return Fb("x",e,t,n).map((function(e){return zu(e.shape)}));case"Size":return[Lo(Fb("x",e,t,n).size,"int32")];case"Rank":return[Lo(Fb("x",e,t,n).rank,"int32")];case"NoOp":return[Lo(1)];case"Print":var a=Fb("x",e,t,n),i=Fb("data",e,t,n),o=Fb("message",e,t,n),s=Fb("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(o);for(var u=0;u<i.length;u++)console.log(Array.prototype.slice.call(i[u].dataSync()).slice(0,s));return[a];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"logical":return Mo((function(){return function(e,t,n){switch(e.op){case"Equal":return[Es(Fb("a",e,t,n),Fb("b",e,t,n))];case"NotEqual":return[lu(Fb("a",e,t,n),Fb("b",e,t,n))];case"Greater":return[Ls(Fb("a",e,t,n),Fb("b",e,t,n))];case"GreaterEqual":return[Ps(Fb("a",e,t,n),Fb("b",e,t,n))];case"Less":return[rp(Fb("a",e,t,n),Fb("b",e,t,n))];case"LessEqual":return[Hl(Fb("a",e,t,n),Fb("b",e,t,n))];case"LogicalAnd":return[qs(Fb("a",e,t,n),Fb("b",e,t,n))];case"LogicalNot":return[Dp(Fb("a",e,t,n))];case"LogicalOr":return[gf(Fb("a",e,t,n),Fb("b",e,t,n))];case"Select":case"SelectV2":return[Gu(Fb("condition",e,t,n),Fb("a",e,t,n),Fb("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"matrices":return Mo((function(){return function(e,t,n){switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[hl(Fb("a",e,t,n),Fb("b",e,t,n),Fb("transposeA",e,t,n),Fb("transposeB",e,t,n))];case"Transpose":return[qu(Fb("x",e,t,n),Fb("perm",e,t,n))];case"_FusedMatMul":var r=N(Fb("fusedOps",e,t,n),2),a=r[0],i=r[1],o="biasadd"===a,s="prelu"===i,u=Fb("numArgs",e,t,n),l=Fb("leakyreluAlpha",e,t,n);if(o){if(s&&2!==u)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&1!==u)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var c=N(Fb("args",e,t,n),2),h=c[0],p=c[1];return[pl({a:Fb("a",e,t,n),b:Fb("b",e,t,n),transposeA:Fb("transposeA",e,t,n),transposeB:Fb("transposeB",e,t,n),bias:h,activation:i,preluActivationWeights:p,leakyreluAlpha:l})];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"normalization":return Mo((function(){return function(e,t,n){switch(e.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[ss(Fb("x",e,t,n),Fb("mean",e,t,n),Fb("variance",e,t,n),Fb("offset",e,t,n),Fb("scale",e,t,n),Fb("epsilon",e,t,n))];case"LRN":return[vf(Fb("x",e,t,n),Fb("radius",e,t,n),Fb("bias",e,t,n),Fb("alpha",e,t,n),Fb("beta",e,t,n))];case"Softmax":return[Au(Fb("x",e,t,n))];case"LogSoftmax":return[js(Fb("x",e,t,n))];case"SparseToDense":return[Xx(Fb("sparseIndices",e,t,n),Fb("outputShape",e,t,n),Fb("sparseValues",e,t,n),Fb("defaultValue",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"reduction":return Mo((function(){return function(e,t,n){switch(e.op){case"Max":var r=Fb("axis",e,t,n),a=Fb("keepDims",e,t,n);return[Ws(Fb("x",e,t,n),r,a)];case"Mean":var i=Fb("axis",e,t,n),o=Fb("keepDims",e,t,n);return[Zs(Fb("x",e,t,n),i,o)];case"Min":var s=Fb("axis",e,t,n),u=Fb("keepDims",e,t,n);return[Qs(Fb("x",e,t,n),s,u)];case"Sum":var l=Fb("axis",e,t,n),c=Fb("keepDims",e,t,n);return[Gs(Fb("x",e,t,n),l,c)];case"All":var h=Fb("axis",e,t,n),p=Fb("keepDims",e,t,n);return[Vo(Fb("x",e,t,n),h,p)];case"Any":var f=Fb("axis",e,t,n),d=Fb("keepDims",e,t,n);return[Wo(Fb("x",e,t,n),f,d)];case"ArgMax":var v=Fb("axis",e,t,n);return[Uo(Fb("x",e,t,n),v)];case"ArgMin":var m=Fb("axis",e,t,n);return[$p(Fb("x",e,t,n),m)];case"Prod":var g=Fb("axis",e,t,n),y=Fb("keepDims",e,t,n);return[wf(Fb("x",e,t,n),g,y)];case"Cumsum":var b=Fb("axis",e,t,n),x=Fb("exclusive",e,t,n),k=Fb("reverse",e,t,n);return[Th(Fb("x",e,t,n),b,x,k)];case"Bincount":var w=Fb("x",e,t,n),_=Fb("weights",e,t,n),S=Fb("size",e,t,n);return[Kx(w,_,S)];case"DenseBincount":var I=Fb("x",e,t,n),C=Fb("weights",e,t,n),T=Fb("size",e,t,n),N=Fb("binaryOutput",e,t,n);return[Yx(I,C,T,N)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"slice_join":return Mo((function(){return function(e,t,n){switch(e.op){case"ConcatV2":case"Concat":var r=Fb("n",e,t,n),a=Fb("axis",e,t,n),i=Fb("tensors",e,t,n);return i=i.slice(0,r),[ps(i,a)];case"Gather":var o=Fb("x",e,t,n),s=Fb("indices",e,t,n);return[Fs(o,Bi(s,"int32"),0)];case"GatherV2":var u=Fb("axis",e,t,n),l=Fb("batchDims",e,t,n),c=Fb("x",e,t,n),h=Fb("indices",e,t,n);return[Fs(c,Bi(h,"int32"),u,l)];case"Reverse":for(var p=Fb("dims",e,t,n),f=[],d=0;d<p.length;d++)p[d]&&f.push(d);var v=Fb("x",e,t,n);return[wu(v,f)];case"ReverseV2":var m=Fb("axis",e,t,n),g=Fb("x",e,t,n);return[wu(g,m)];case"Slice":var y=Fb("begin",e,t,n),b=Fb("size",e,t,n);return[Cu(Fb("x",e,t,n),y,b)];case"StridedSlice":var x=Fb("begin",e,t,n),k=Fb("end",e,t,n),w=Fb("strides",e,t,n),_=Fb("beginMask",e,t,n),S=Fb("endMask",e,t,n),I=Fb("ellipsisMask",e,t,n),C=Fb("newAxisMask",e,t,n),T=Fb("shrinkAxisMask",e,t,n),N=Fb("x",e,t,n);return[Cf(N,x,k,w,_,S,I,C,T)];case"Pack":return Mo((function(){var r=Fb("axis",e,t,n),a=Fb("tensors",e,t,n),i=a[0].shape,o=Fu(a[0]).shape,s=a.map((function(e){var t=Y(e.shape,i);if(!t&&!Y(Fu(e).shape,o))throw new Error("the input tensors shape does not match");return t?e:as(e,i)}));return[Lu(s,r)]}));case"Unpack":var E=Fb("axis",e,t,n),M=Fb("tensor",e,t,n);return Wu(M,E);case"Tile":var A=Fb("reps",e,t,n);return[As(Fb("x",e,t,n),A)];case"Split":case"SplitV":var D=Fb("axis",e,t,n),R=Fb("numOrSizeSplits",e,t,n),O=Fb("x",e,t,n);return Ru(O,R,D);case"ScatterNd":var F=Fb("indices",e,t,n),L=Fb("values",e,t,n),P=Fb("shape",e,t,n);return[Zx(F,L,P)];case"GatherNd":var z=Fb("x",e,t,n),B=Fb("indices",e,t,n);return[Qx(z,B)];case"SparseToDense":var V=Fb("sparseIndices",e,t,n),W=Fb("outputShape",e,t,n),U=Fb("sparseValues",e,t,n),H=Fb("defaultValue",e,t,n);return[Xx(V,U,W,U.dtype===H.dtype?H:Bi(H,U.dtype))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"spectral":return Mo((function(){return function(e,t,n){switch(e.op){case"FFT":return[Zu(Fb("x",e,t,n))];case"IFFT":return[$u(Fb("x",e,t,n))];case"RFFT":return[Qu(Fb("x",e,t,n))];case"IRFFT":return[Ju(Fb("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"transformation":return Mo((function(){return function(e,t,n){switch(e.op){case"Cast":return[Bi(Fb("x",e,t,n),Fb("dtype",e,t,n))];case"ExpandDims":var r=Fb("axis",e,t,n);return[Ms(Fb("x",e,t,n),r)];case"Squeeze":var a=Fb("axis",e,t,n);return[Fu(Fb("x",e,t,n),a)];case"Reshape":return[as(Fb("x",e,t,n),Fb("shape",e,t,n))];case"MirrorPad":return[bf(Fb("x",e,t,n),Fb("padding",e,t,n),Fb("mode",e,t,n))];case"PadV2":case"Pad":return[du(Fb("x",e,t,n),Fb("padding",e,t,n),Fb("constantValue",e,t,n))];case"SpaceToBatchND":var i=Fb("blockShape",e,t,n),o=Fb("paddings",e,t,n);return[ch(Fb("x",e,t,n),i,o)];case"BatchToSpaceND":var s=Fb("blockShape",e,t,n),u=Fb("crops",e,t,n);return[Gp(Fb("x",e,t,n),s,u)];case"DepthToSpace":var l=Fb("blockSize",e,t,n),c=Fb("dataFormat",e,t,n).toUpperCase();return[of(Fb("x",e,t,n),l,c)];case"BroadcastTo":return[Hu(Fb("x",e,t,n),Fb("shape",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"hash_table":return jx(e,t,n,r);case"custom":var a=Ob(e.op);if(a&&a.customExecutor)return a.customExecutor(new xx(e,t,n));throw TypeError("Custom op ".concat(e.op," is not registered."));default:throw TypeError("Unknown op '".concat(e.op,"'. File an issue at ")+"https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(e,t,n);return we(a)?a.then((function(e){return[].concat(e)})):[].concat(a)}var Jx=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};A(this,e),this.weightMap=t,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return R(e,[{key:"newFrame",value:function(e,t){return{id:e,frameName:t,iterationId:0}}},{key:"currentContext",get:function(){return this.contexts},set:function(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}},{key:"currentContextId",get:function(){return this._currentContextIds[0]}},{key:"currentContextIds",get:function(){return this._currentContextIds}},{key:"generateCurrentContextIds",value:function(){for(var e=[],t=0;t<this.contexts.length-1;t++){var n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}},{key:"contextIdforContexts",value:function(e){return e?e.map((function(e){return 0===e.id&&0===e.iterationId?"":"".concat(e.frameName,"-").concat(e.iterationId)})).join("/"):""}},{key:"enterFrame",value:function(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}},{key:"exitFrame",value:function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}},{key:"nextIteration",value:function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}},{key:"getWeight",value:function(e){return this.weightMap[e]}},{key:"addTensorArray",value:function(e){this.tensorArrayMap[e.id]=e}},{key:"getTensorArray",value:function(e){return this.tensorArrayMap[e]}},{key:"addTensorList",value:function(e){this.tensorListMap[e.id]=e}},{key:"getTensorList",value:function(e){return this.tensorListMap[e]}},{key:"dispose",value:function(e){for(var t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(var n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}]),e}();function ek(e,t,n,r){var a=new Set,i=[],o=null,s=null,u=new Set,l=Object.keys(e).map((function(e){return Bb(e)[0]})),c=[];null!=r&&(c=r.map((function(e){return Bb(e.name)[0]})));for(var h=I(t);h.length>0;){var p=h.pop();(ak(p)||ik(p)||ok(p))&&null==o&&(s=(o=p).children.map((function(e){return e.name})).filter((function(e){return a.has(e)}))),a.add(p.name),null==n[p.name]&&(-1===l.indexOf(p.name)&&-1===c.indexOf(p.name)&&(0!==p.inputs.length?p.inputs.forEach((function(e){u.has(e.name)||(u.add(e.name),h.push(e))})):i.push(p.name)))}return{inputs:e,outputs:t,usedNodes:a,missingInputs:i,dynamicNode:o,syncInputs:s}}var tk=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],nk=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],rk=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function ak(e){return tk.indexOf(e.op)>=0}function ik(e){return nk.indexOf(e.op)>=0}function ok(e){return rk.indexOf(e.op)>=0}var sk=function(){function e(t,n){var r=this;A(this,e),this.graph=t,this.parent=n,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach((function(n){r._functionExecutorMap[n]=new e(t.functions[n],r)}))}return R(e,[{key:"weightIds",get:function(){return this.parent?this.parent.weightIds:this._weightIds}},{key:"functionExecutorMap",get:function(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}},{key:"weightMap",get:function(){return this.parent?this.parent.weightMap:this._weightMap},set:function(e){var t,n=Object.keys(e).map((function(t){return e[t].map((function(e){return e.id}))}));this._weightIds=(t=[]).concat.apply(t,I(n)),this._weightMap=e}},{key:"resourceManager",set:function(e){this._resourceManager=e}},{key:"inputs",get:function(){return this._inputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))}},{key:"outputs",get:function(){return this._outputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))}},{key:"inputNodes",get:function(){return this._inputs.map((function(e){return e.signatureKey||e.name}))}},{key:"outputNodes",get:function(){return this._outputs.map((function(e){var t=e.signatureKey||e.name;return e.defaultOutput?"".concat(t,":").concat(e.defaultOutput):t}))}},{key:"functions",get:function(){var e=this;return Object.keys(this._functions).reduce((function(t,n){return t[n]=e._functions[n].signature,t}),{})}},{key:"getCompilationKey",value:function(e,t){var n=e.map((function(e){return e.name})).sort(),r=t.map((function(e){return e.name})).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}},{key:"compile",value:function(e,t){var n=ek(e,t,this.weightMap,this._initNodes),r=n.missingInputs,a=n.dynamicNode,i=n.syncInputs;if(null!=a)throw new Error("This execution contains the node '".concat(a.name,"', which has ")+"the dynamic op '".concat(a.op,"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+"dynamic ops, specify the inputs [".concat(i,"]"));if(r.length>0){var o=t.map((function(e){return e.name})),s=Object.keys(e);throw new Error("Cannot compute the outputs [".concat(o,"] from the provided inputs ")+"[".concat(s,"]. Missing the following inputs: [").concat(r,"]"))}return function(e,t,n){var r=n.usedNodes,a=n.inputs,i=[],o=Object.keys(a).map((function(e){return Bb(e)[0]})).map((function(t){return e.nodes[t]})),s=e.initNodes;o.forEach((function(e){r.has(e.name)&&i.push(e)})),e.weights.forEach((function(e){r.has(e.name)&&i.push(e)})),null!=s&&s.forEach((function(e){r.has(e.name)&&i.push(e)}));for(var u=new Set,l=[];i.length>0;){var c=i.pop();u.add(c.name),t[c.name]||l.push(c),c.children.forEach((function(e){!u.has(e.name)&&r.has(e.name)&&e.inputs.every((function(e){return u.has(e.name)}))&&i.push(e)}))}return l}(this.graph,this.weightMap,n)}},{key:"execute",value:function(e,t){var n=this;e=this.mapInputs(e);var r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);var a=r.map((function(e){return n.graph.nodes[Bb(e)[0]]})),i=t.map((function(e){return Bb(e)[0]})),o=i.map((function(e){return n.graph.nodes[e]}));0===o.length&&(o=this._outputs);var s=this.getCompilationKey(a,o),u=this.compiledMap.get(s);null==u&&(u=this.compile(e,o),this.compiledMap.set(s,u));var l={},c={};return Mo((function(){var r=new Jx(n.weightMap,l,c,n.functionExecutorMap),a=Object.assign({},n.weightMap);Object.keys(e).forEach((function(t){var n=N(Bb(t),2),r=n[0],i=[];i[n[1]]=e[t],a[r]=i}));for(var o=n.getFrozenTensorIds(a),s={},h=0;h<u.length;h++){var p=u[h];if(!a[p.name]){var f=$x(p,a,r,n._resourceManager);if(we(f))throw new Error("The execution of the op '".concat(p.op,"' returned a promise. ")+"Please use model.executeAsync() instead.");a[p.name]=f,n.checkTensorForDisposal(p.name,p,a,r,o,i,s)}}return null==n.parent&&r.dispose(o),t.map((function(e){return Lb(e,a,r)}))}))}},{key:"getFrozenTensorIds",value:function(e){var t=[].concat.apply([],Object.keys(e).map((function(t){return e[t]})).map((function(e){return e.map((function(e){return e.id}))})));return new Set(t)}},{key:"checkTensorForDisposal",value:function(e,t,n,r,a,i,o){"control"!==t.category&&-1===i.indexOf(e)&&(n[e].forEach((function(e){null!=e&&(o[e.id]=(o[e.id]||0)+t.children.length)})),t.inputs.forEach((function(e){if("control"!==e.category){var t=function(e,t,n){return t[zb(e,n.currentContextId)]}(e.name,n,r);null!=t&&t.forEach((function(e){if(e&&!a.has(e.id)){var t=o[e.id];1===t?(e.dispose(),delete o[e.id]):null!=t&&o[e.id]--}}))}})))}},{key:"executeAsync",value:function(){var e=F(M().mark((function e(t,n){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._executeAsync(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_executeAsync",value:function(){var e=F(M().mark((function e(t,n){var r,a,i,o,s,u,l,c,h,p=arguments;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=p.length>2&&void 0!==p[2]&&p[2],a=p.length>3&&void 0!==p[3]?p[3]:{},i=p.length>4&&void 0!==p[4]?p[4]:{},r||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n)),o=new Jx(this.weightMap,a,i,this.functionExecutorMap),e.next=7,this.executeWithControlFlow(t,o,n,r);case 7:return s=e.sent,u=n.map((function(e){return Lb(e,s,o)})),l=u.map((function(e){return e.id})),c=Object.keys(t).map((function(e){return t[e].id})),h=new Set([].concat(I(l),I(c),I(this.weightIds))),Object.keys(s).forEach((function(e){s[e].forEach((function(e){!e||e.isDisposed||h.has(e.id)||e.dispose()}))})),null==this.parent&&o.dispose(h),e.abrupt("return",u);case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"executeFunctionAsync",value:function(){var e=F(M().mark((function e(t,n,r){var a,i=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.reduce((function(e,t,n){return e[i.inputs[n].name]=t,e}),{}),e.abrupt("return",this._executeAsync(a,this.outputNodes,!0,n,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"executeWithControlFlow",value:function(){var e=F(M().mark((function e(t,n,r,a){var i,o,s,u,l,c,h,p,f,d,v,m,g,y,b,x,k,w=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=Object.keys(t),o=i.map((function(e){return w.graph.nodes[Bb(e)[0]]})),s=r.map((function(e){return Bb(e)[0]})),0===(u=s.map((function(e){return w.graph.nodes[e]}))).length&&(u=this._outputs),l=ek(t,u,this.weightMap,this._initNodes),c=l.usedNodes,h=l.missingInputs,p=l.dynamicNode,f=l.syncInputs,d=[].concat(I(o),I(this.graph.weights),I(this._initNodes||[])).map((function(e){return{node:e,contexts:n.currentContext}})),v=Object.assign({},this.weightMap),Object.keys(t).forEach((function(e){var n=N(Bb(e),2),r=n[0],a=[];a[n[1]]=t[e],v[r]=a})),m={},g=this.getFrozenTensorIds(v),y={};case 12:if(!(d.length>0)){e.next=18;break}return b=this.processStack(o,d,n,v,y,g,s,m,c),e.next=16,Promise.all(b);case 16:e.next=12;break;case 18:if(null!=p||a||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),!((x=u.filter((function(e){return!ak(e)&&!Lb(e.name,v,n)})).map((function(e){return e.name}))).length>0)){e.next=24;break}throw k="",null!=p&&(k="Alternatively, to avoid the dynamic ops, use model.execute() "+"and specify the inputs [".concat(f,"]")),new Error("Cannot compute the outputs [".concat(x,"] from the provided ")+"inputs [".concat(i,"]. Consider providing the following inputs: ")+"[".concat(h,"]. ").concat(k));case 24:return e.abrupt("return",v);case 25:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"processStack",value:function(e,t,n,r,a,i,o,s,u){for(var l=this,c=[],h=function(){var e=t.pop();n.currentContext=e.contexts;var h="";if("Enter"===e.node.op&&Fb("isConstant",e.node,r,n)){var p=N(Pb(e.node.name,n),1);h=p[0]}if(null==r[e.node.name]){var f=$x(e.node,r,n,l._resourceManager);if(!h){var d=N(Pb(e.node.name,n),1);h=d[0]}var v=n.currentContext;we(f)?c.push(f.then((function(c){return r[h]=c,n.currentContext=v,l.checkTensorForDisposal(h,e.node,r,n,i,o,s),l.processChildNodes(e.node,t,n,r,a,u),c}))):(r[h]=f,l.checkTensorForDisposal(h,e.node,r,n,i,o,s),l.processChildNodes(e.node,t,n,r,a,u))}else l.processChildNodes(e.node,t,n,r,a,u)};t.length>0;)h();return c}},{key:"processChildNodes",value:function(e,t,n,r,a,i){e.children.forEach((function(e){var o=N(Pb(e.name,n),1)[0];!a[o]&&i.has(e.name)&&("Merge"===e.op?e.inputNames.some((function(e){return!!Lb(e,r,n)}))&&(a[o]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every((function(e){return!!Lb(e,r,n)}))&&(a[o]=!0,t.push({contexts:n.currentContext,node:e})))}))}},{key:"dispose",value:function(){var e=this;Object.keys(this.weightMap).forEach((function(t){return e.weightMap[t].forEach((function(e){return e.dispose()}))}))}},{key:"checkInputShapeAndType",value:function(e){var t=this;Object.keys(e).forEach((function(n){var r=e[n],a=N(Bb(n),1)[0],i=t.graph.nodes[a];if(i.attrParams.shape&&i.attrParams.shape.value){var o=i.attrParams.shape.value;G(o.length===r.shape.length&&r.shape.every((function(e,t){return-1===o[t]||o[t]===e})),(function(){return"The shape of dict['".concat(i.name,"'] provided in ")+"model.execute(dict) must be [".concat(o,"], but was ")+"[".concat(r.shape,"]")}))}i.attrParams.dtype&&i.attrParams.dtype.value&&G(r.dtype===i.attrParams.dtype.value,(function(){return"The dtype of dict['".concat(i.name,"'] provided in ")+"model.execute(dict) must be "+"".concat(i.attrParams.dtype.value,", but was ").concat(r.dtype)}))}))}},{key:"mapInputs",value:function(e){var t={};for(var n in e){if(null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n])t[this._signature.inputs[n].name]=e[n];else t[n]=e[n]}return t}},{key:"checkInputs",value:function(e){var t=this,n=Object.keys(e).filter((function(e){var n=N(Bb(e),1)[0];return null==t.graph.nodes[n]}));if(n.length>0)throw new Error("The dict provided in model.execute(dict) has "+"keys: [".concat(n,"] that are not part of graph"))}},{key:"mapOutputs",value:function(e){var t=this;return e.map((function(e){return null!=t._signature&&null!=t._signature.outputs&&null!=t._signature.outputs[e]?t._signature.outputs[e].name:e}),{})}},{key:"checkOutputs",value:function(e){var t=this;e.forEach((function(e){var n=N(Bb(e),1)[0];if(!t.graph.nodes[n])throw new Error("The output '".concat(e,"' is not found in the graph"))}))}}]),e}(),uk=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};A(this,e),this.hashTableNameToHandle=t,this.hashTableMap=n}return R(e,[{key:"addHashTable",value:function(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}},{key:"getHashTableHandleByName",value:function(e){return this.hashTableNameToHandle[e]}},{key:"getHashTableById",value:function(e){return this.hashTableMap[e]}},{key:"dispose",value:function(){for(var e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(var t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}]),e}(),lk="?tfjs-format=file",ck="model.json",hk=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};A(this,e),this.modelUrl=t,this.loadOptions=n,this.version="n/a",null==n&&(this.loadOptions={}),this.resourceManager=new uk}return R(e,[{key:"modelVersion",get:function(){return this.version}},{key:"inputNodes",get:function(){return this.executor.inputNodes}},{key:"outputNodes",get:function(){return this.executor.outputNodes}},{key:"inputs",get:function(){return this.executor.inputs}},{key:"outputs",get:function(){return this.executor.outputs}},{key:"weights",get:function(){return this.executor.weightMap}},{key:"metadata",get:function(){return this.artifacts.userDefinedMetadata}},{key:"modelSignature",get:function(){return this.signature}},{key:"findIOHandler",value:function(){var e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=ro(e,this.loadOptions);else{var t=ei(e,this.loadOptions);if(0===t.length)t.push(ro(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one (".concat(t.length,") load handlers for ")+"URL '".concat([e],"'"));this.handler=t[0]}}},{key:"load",value:function(){var e=F(M().mark((function e(){var t;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.findIOHandler(),null!=this.handler.load){e.next=3;break}throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");case 3:return e.next=5,this.handler.load();case 5:return t=e.sent,e.abrupt("return",this.loadSync(t));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadSync",value:function(e){this.artifacts=e;var t,n=this.artifacts.modelTopology;t=null!=this.artifacts.userDefinedMetadata&&null!=this.artifacts.userDefinedMetadata.signature?this.artifacts.userDefinedMetadata.signature:this.artifacts.signature,this.signature=t,this.version="".concat(n.versions.producer,".").concat(n.versions.minConsumer);var r=Va(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new sk(ix.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),this.executor.resourceManager=this.resourceManager,null!=e.modelInitializer&&null!=e.modelInitializer.node){var a=ix.Instance.transformGraph(e.modelInitializer);this.initializer=new sk(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}},{key:"save",value:function(){var e=F(M().mark((function e(t,n){var r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof t){e.next=9;break}if(0!==(r=Ja(t)).length){e.next=6;break}throw new Error("Cannot find any save handlers for URL '".concat(t,"'"));case 6:if(!(r.length>1)){e.next=8;break}throw new Error("Found more than one (".concat(r.length,") save handlers for ")+"URL '".concat(t,"'"));case 8:t=r[0];case 9:if(null!=t.save){e.next=11;break}throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 11:return e.abrupt("return",t.save(this.artifacts));case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"predict",value:function(e,t){return this.execute(e,this.outputNodes)}},{key:"normalizeInputs",value:function(e){if(!(e instanceof ra)&&!Array.isArray(e))return e;if((e=Array.isArray(e)?e:[e]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,"+"the graph model has ".concat(this.inputNodes.length," placeholders, ")+"while there are ".concat(e.length," input tensors."));return this.inputNodes.reduce((function(t,n,r){return t[n]=e[r],t}),{})}},{key:"normalizeOutputs",value:function(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}},{key:"execute",value:function(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);var n=this.executor.execute(e,t);return n.length>1?n:n[0]}},{key:"executeAsync",value:function(){var e=F(M().mark((function e(t,n){var r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.normalizeInputs(t),n=this.normalizeOutputs(n),e.next=4,this.executor.executeAsync(t,n);case 4:return r=e.sent,e.abrupt("return",r.length>1?r:r[0]);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"convertTensorMapToTensorsMap",value:function(e){return Object.keys(e).reduce((function(t,n){return t[n]=[e[n]],t}),{})}},{key:"dispose",value:function(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}]),e}();function pk(e){return fk.apply(this,arguments)}function fk(){return fk=F(M().mark((function e(t){var n,r,a=arguments;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:{},null!=t){e.next=3;break}throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");case 3:return null==n&&(n={}),n.fromTFHub&&null==t.load&&(t.endsWith("/")||(t+="/"),t="".concat(t).concat(ck).concat(lk)),r=new hk(t,n),e.next=8,r.load();case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)}))),fk.apply(this,arguments)}var dk=n(6699);function vk(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if(bk(e)){var i=Array.isArray(e)?[]:{};for(var o in r.add(e),e){var s=e[o],u=vk(s,t,n,r);i[o]=u}return r.delete(e),i}throw new Error("Can't recurse into non-iterable type: ".concat(e))}return n.set(e,a.value),a.value}function mk(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yk;return gk(e,t)}function gk(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(bk(r)){var i=Array.isArray(r)?[]:{};n.add(r);var o=function(r){var a=gk(e.map((function(e){return e[r]})),t,n);i[r]=a};for(var s in r)o(s);return n.delete(r),i}throw new Error("Can't recurse into non-iterable type: ".concat(r))}return a.value}function yk(e){return null===e?null:bk(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function bk(e){return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"===typeof e&&!(e instanceof ra))}function xk(e){return function(e,t){return vk(e,t)}(e,kk)}function kk(e){return e instanceof ra?{value:e.clone(),recurse:!1}:bk(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var wk=function(){function e(t){if(A(this,e),this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return R(e,[{key:"wrap",value:function(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}},{key:"get",value:function(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}},{key:"set",value:function(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}},{key:"length",value:function(){var e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}},{key:"isFull",value:function(){return this.length()===this.capacity}},{key:"isEmpty",value:function(){return 0===this.length()}},{key:"push",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}},{key:"pushAll",value:function(e){var t,n=L(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.push(r)}}catch($8){n.e($8)}finally{n.f()}}},{key:"pop",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var e=this.get(this.end);return this.set(this.end,void 0),e}},{key:"unshift",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}},{key:"shift",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}},{key:"shuffleExcise",value:function(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}]),e}(),_k=function(e){Hr(n,e);var t=Kr(n);function n(){return A(this,n),t.call(this,n.INITIAL_CAPACITY)}return R(n,[{key:"isFull",value:function(){return!1}},{key:"push",value:function(e){em(Gr(n.prototype),"isFull",this).call(this)&&this.expand(),em(Gr(n.prototype),"push",this).call(this,e)}},{key:"unshift",value:function(e){em(Gr(n.prototype),"isFull",this).call(this)&&this.expand(),em(Gr(n.prototype),"unshift",this).call(this,e)}},{key:"expand",value:function(){for(var e=2*this.capacity,t=new Array(e),n=this.length(),r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}]),n}(wk);function Sk(e){return new Ek(e)}function Ik(e,t){return new Vk(e,t)}_k.INITIAL_CAPACITY=32;var Ck,Tk=function(){function e(){A(this,e)}return R(e,[{key:"toArray",value:function(){var e=F(M().mark((function e(){var t,n;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,this.next();case 3:n=e.sent;case 4:if(n.done){e.next=11;break}return t.push(n.value),e.next=8,this.next();case 8:n=e.sent,e.next=4;break;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toArrayForTest",value:function(){var e=F(M().mark((function e(){var t,n,r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.prefetch(100),n=[],e.next=4,t.next();case 4:r=e.sent;case 5:if(r.done){e.next=12;break}return n.push(r.value),e.next=9,t.next();case 9:r=e.sent,e.next=5;break;case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resolveFully",value:function(){var e=F(M().mark((function e(){var t;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:t=e.sent;case 3:if(t.done){e.next=9;break}return e.next=6,this.next();case 6:t=e.sent,e.next=3;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resolveWhile",value:function(){var e=F(M().mark((function e(t){var n,r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:n=e.sent,r=t(n.value);case 4:if(n.done||!r){e.next=11;break}return e.next=7,this.next();case 7:n=e.sent,r=t(n.value),e.next=4;break;case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleErrors",value:function(e){return new Lk(this,e)}},{key:"filter",value:function(e){return new Ok(this,e)}},{key:"map",value:function(e){return new Fk(this,e)}},{key:"mapAsync",value:function(e){return new Pk(this,e)}},{key:"serialMapAsync",value:function(e){return new Pk(this,e).serial()}},{key:"flatmap",value:function(e){return new Bk(this,e)}},{key:"forEachAsync",value:function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.map(t).resolveFully());case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"serialForEach",value:function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.serialMapAsync(t).resolveWhile((function(e){return!0===e})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rowMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Rk(this,e,t)}},{key:"columnMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:yk,r=this.rowMajorBatch(e,t);return r.map((function(e){return mk(e,n)}))}},{key:"concatenate",value:function(e,t){return new Vk(new Nk([this,e]),t)}},{key:"take",value:function(e){return e<0||null==e?this:new Dk(this,e)}},{key:"skip",value:function(e){return e<0||null==e?this:new Ak(this,e)}},{key:"prefetch",value:function(e){return new Wk(this,e)}},{key:"shuffle",value:function(e,t){return new Uk(this,e,t)}},{key:"serial",value:function(){return new Mk(this)}}]),e}(),Nk=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this)).items=e,r.trav=0,r}return R(n,[{key:"summary",value:function(){return"Array of ".concat(this.items.length," items")}},{key:"next",value:function(){var e=F(M().mark((function e(){var t;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.trav>=this.items.length)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return t=this.items[this.trav],this.trav++,e.abrupt("return",{value:xk(t),done:!1});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Tk),Ek=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this)).nextFn=e,r}return R(n,[{key:"summary",value:function(){return"Function call"}},{key:"next",value:function(){var e=F(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",this.nextFn());case 4:throw e.prev=4,e.t0=e.catch(0),e.t0.message="Error thrown while iterating through a dataset: ".concat(e.t0.message),e.t0;case 8:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(){return e.apply(this,arguments)}}()}]),n}(Tk),Mk=function(e){Hr(n,e);var t=Kr(n);function n(e){var r;return A(this,n),(r=t.call(this)).upstream=e,r.lastRead=Promise.resolve({value:null,done:!1}),r}return R(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Serial")}},{key:"next",value:function(){var e=F(M().mark((function e(){var t=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=F(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.upstream.next());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Tk),Ak=function(e){Hr(n,e);var t=Kr(n);function n(e,r){var a;return A(this,n),(a=t.call(this)).upstream=e,a.maxCount=r,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return R(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Skip")}},{key:"next",value:function(){var e=F(M().mark((function e(){var t=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=F(M().mark((function e(){var t;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++<this.maxCount)){e.next=9;break}return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done){e.next=6;break}return e.abrupt("return",t);case 6:Ao(t.value),e.next=0;break;case 9:return e.abrupt("return",this.upstream.next());case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Tk),Dk=function(e){Hr(n,e);var t=Kr(n);function n(e,r){var a;return A(this,n),(a=t.call(this)).upstream=e,a.maxCount=r,a.count=0,a}return R(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Take")}},{key:"next",value:function(){var e=F(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++>=this.maxCount)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return e.abrupt("return",this.upstream.next());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Tk),Rk=function(e){Hr(n,e);var t=Kr(n);function n(e,r){var a,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return A(this,n),(a=t.call(this)).upstream=e,a.batchSize=r,a.enableSmallLastBatch=i,a.lastRead=Promise.resolve({value:null,done:!1}),a}return R(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}},{key:"next",value:function(){var e=F(M().mark((function e(){var t=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=F(M().mark((function e(){var t,n;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[];case 1:if(!(t.length<this.batchSize)){e.next=12;break}return e.next=4,this.upstream.next();case 4:if(!(n=e.sent).done){e.next=9;break}if(!(this.enableSmallLastBatch&&t.length>0)){e.next=8;break}return e.abrupt("return",{value:t,done:!1});case 8:return e.abrupt("return",{value:null,done:!0});case 9:t.push(n.value),e.next=1;break;case 12:return e.abrupt("return",{value:t,done:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Tk),Ok=function(e){Hr(n,e);var t=Kr(n);function n(e,r){var a;return A(this,n),(a=t.call(this)).upstream=e,a.predicate=r,a.lastRead=Promise.resolve({value:null,done:!1}),a}return R(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Filter")}},{key:"next",value:function(){var e=F(M().mark((function e(){var t=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=F(M().mark((function e(){var t;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done&&!this.predicate(t.value)){e.next=6;break}return e.abrupt("return",t);case 6:Ao(t.value),e.next=0;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Tk),Fk=function(e){Hr(n,e);var t=Kr(n);function n(e,r){var a;return A(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return R(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Map")}},{key:"next",value:function(){var e=F(M().mark((function e(){var t,n,r,a,i,o,s;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:n=ma(t.value),r=this.transform(t.value),a=ma(r),i=L(n);try{for(i.s();!(o=i.n()).done;)va(s=o.value,a)||s.dispose()}catch($8){i.e($8)}finally{i.f()}return e.abrupt("return",{value:r,done:!1});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Tk),Lk=function(e){Hr(n,e);var t=Kr(n);function n(e,r){var a;return A(this,n),(a=t.call(this)).upstream=e,a.handler=r,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return R(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> handleErrors")}},{key:"next",value:function(){var e=F(M().mark((function e(){var t=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=F(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,this.upstream.next();case 4:return e.abrupt("return",e.sent);case 7:if(e.prev=7,e.t0=e.catch(1),this.handler(e.t0)){e.next=11;break}return e.abrupt("return",{value:null,done:!0});case 11:e.next=0;break;case 13:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(){return e.apply(this,arguments)}}()}]),n}(Tk),Pk=function(e){Hr(n,e);var t=Kr(n);function n(e,r){var a;return A(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return R(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> AsyncMap")}},{key:"next",value:function(){var e=F(M().mark((function e(){var t,n,r,a,i,o,s;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:return n=ma(t.value),e.next=8,this.transform(t.value);case 8:r=e.sent,a=ma(r),i=L(n);try{for(i.s();!(o=i.n()).done;)va(s=o.value,a)||s.dispose()}catch($8){i.e($8)}finally{i.f()}return e.abrupt("return",{value:r,done:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Tk),zk=function(e){Hr(n,e);var t=Kr(n);function n(){var e;return A(this,n),(e=t.call(this)).outputQueue=new _k,e.lastRead=Promise.resolve({value:null,done:!1}),e}return R(n,[{key:"next",value:function(){var e=F(M().mark((function e(){var t=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=F(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.outputQueue.length()){e.next=7;break}return e.next=3,this.pump();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:e.next=0;break;case 7:return e.abrupt("return",{value:this.outputQueue.shift(),done:!1});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Tk),Bk=function(e){Hr(n,e);var t=Kr(n);function n(e,r){var a;return A(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return R(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Flatmap")}},{key:"pump",value:function(){var e=F(M().mark((function e(){var t,n,r,a,i,o,s;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",!1);case 5:n=ma(t.value),r=this.transform(t.value),a=ma(r),this.outputQueue.pushAll(r),i=L(n);try{for(i.s();!(o=i.n()).done;)va(s=o.value,a)||s.dispose()}catch($8){i.e($8)}finally{i.f()}return e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(zk),Vk=function(e){Hr(n,e);var t=Kr(n);function n(e,r){var a;return A(this,n),(a=t.call(this)).baseErrorHandler=r,a.lastRead=null,a.iterator=null,a.moreIterators=e,a}return R(n,[{key:"summary",value:function(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")}},{key:"next",value:function(){var e=F(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.readFromChain(this.lastRead),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"readFromChain",value:function(){var e=F(M().mark((function e(t){var n,r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(null!=this.iterator){e.next=10;break}return e.next=5,this.moreIterators.next();case 5:if(!(n=e.sent).done){e.next=8;break}return e.abrupt("return",{value:null,done:!0});case 8:this.iterator=n.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler));case 10:return e.next=12,this.iterator.next();case 12:if(!(r=e.sent).done){e.next=16;break}return this.iterator=null,e.abrupt("return",this.readFromChain(t));case 16:return e.abrupt("return",r);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Tk);!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(Ck||(Ck={}));var Wk=function(e){Hr(n,e);var t=Kr(n);function n(e,r){var a;return A(this,n),(a=t.call(this)).upstream=e,a.bufferSize=r,a.buffer=new wk(r),a}return R(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Prefetch")}},{key:"refill",value:function(){for(;!this.buffer.isFull();){var e=this.upstream.next();this.buffer.push(e)}}},{key:"next",value:function(){return this.refill(),this.buffer.shift()}}]),n}(Tk),Uk=function(e){Hr(n,e);var t=Kr(n);function n(e,r,a){var i;return A(this,n),(i=t.call(this,e,r)).upstream=e,i.windowSize=r,i.upstreamExhausted=!1,i.random=dk.alea(a||Fr().toString()),i.lastRead=Promise.resolve({value:null,done:!1}),i}return R(n,[{key:"next",value:function(){var e=F(M().mark((function e(){var t=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"randomInt",value:function(e){return Math.floor(this.random()*e)}},{key:"chooseIndex",value:function(){return this.randomInt(this.buffer.length())}},{key:"serialNext",value:function(){var e=F(M().mark((function e(){var t,n;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.upstreamExhausted||this.refill();case 1:if(this.buffer.isEmpty()){e.next=14;break}return t=this.chooseIndex(),e.next=5,this.buffer.shuffleExcise(t);case 5:if(!(n=e.sent).done){e.next=10;break}this.upstreamExhausted=!0,e.next=12;break;case 10:return this.refill(),e.abrupt("return",n);case 12:e.next=1;break;case 14:return e.abrupt("return",{value:null,done:!0});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Wk),Hk=function(){function e(){A(this,e),this.size=null}return R(e,[{key:"batch",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this;return G(e>0,(function(){return"batchSize needs to be positive, but it is\n      ".concat(e)})),t=this.size===1/0||null==this.size?this.size:n?Math.ceil(this.size/e):Math.floor(this.size/e),Gk(F(M().mark((function t(){return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.iterator();case 2:return t.abrupt("return",t.sent.columnMajorBatch(e,n,jk));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"concatenate",value:function(e){var t,n=this;return t=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,Gk(F(M().mark((function t(){return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.t0=t.sent,t.next=5,e.iterator();case 5:return t.t1=t.sent,t.abrupt("return",t.t0.concatenate.call(t.t0,t.t1));case 7:case"end":return t.stop()}}),t)}))),t)}},{key:"filter",value:function(e){var t,n=this;return t=this.size===1/0?1/0:null,Gk(F(M().mark((function t(){return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.filter((function(t){return Mo((function(){return e(t)}))})));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"forEachAsync",value:function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator();case 2:return e.abrupt("return",e.sent.forEachAsync(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"map",value:function(e){var t=this;return Gk(F(M().mark((function n(){return M().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.map((function(t){return Mo((function(){return e(t)}))})));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"mapAsync",value:function(e){var t=this;return Gk(F(M().mark((function n(){return M().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.mapAsync(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"prefetch",value:function(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var t=this;return Gk(F(M().mark((function n(){return M().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.prefetch(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"repeat",value:function(e){var t,n=this;return t=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,Gk(F(M().mark((function t(){var r;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Sk(F(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.iterator();case 2:return e.t0=e.sent,e.abrupt("return",{value:e.t0,done:!1});case 4:case"end":return e.stop()}}),e)})))),t.abrupt("return",Ik(r.take(e)));case 2:case"end":return t.stop()}}),t)}))),t)}},{key:"skip",value:function(e){var t,n=this;return t=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,Gk(F(M().mark((function t(){return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.skip(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"shuffle",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));var r=this,a=dk.alea(t||Fr().toString());return Gk(F(M().mark((function t(){var i;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=a.int32(),n&&(i+=a.int32()),t.next=4,r.iterator();case 4:return t.abrupt("return",t.sent.shuffle(e,i.toString()));case 5:case"end":return t.stop()}}),t)}))),this.size)}},{key:"take",value:function(e){var t,n=this;return t=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,Gk(F(M().mark((function t(){return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.take(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"toArray",value:function(){var e=F(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArray());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toArrayForTest",value:function(){var e=F(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArrayForTest());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function Gk(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new(function(n){Hr(a,n);var r=Kr(a);function a(){var e;return A(this,a),(e=r.apply(this,arguments)).size=t,e}return R(a,[{key:"iterator",value:function(){var t=F(M().mark((function t(){return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e());case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),a}(Hk))}function jk(e){return null===e?null:function(e){return null==e||null===(t=e)||"object"!==typeof t&&"function"!==typeof t||Array.isArray(e)||"object"===typeof e&&e instanceof ra||oe(e);var t}(e[0])?{value:function(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof ra?Lu(e):La(e)}(e),recurse:!1}:{value:null,recurse:!0}}Hk.MAX_BUFFER_SIZE=1e4;Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");function qk(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&G("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors in the CPU backend.")}))}))}var Xk=qc,Kk=function(e){Hr(n,e);var t=Kr(n);function n(){var e;return A(this,n),(e=t.call(this)).blockSize=48,e.firstUse=!0,e.data=new P(qr(e),No()),e}return R(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"write",value:function(e,t,n){this.firstUse&&(this.firstUse=!1,Ce().get("IS_NODE")&&zc("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&ue(n[0])){var a=n.map((function(e){return Lr(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}},{key:"refCount",value:function(e){return this.data.has(e)?this.data.get(e).refCount:0}},{key:"incRef",value:function(e){this.data.get(e).refCount++}},{key:"decRef",value:function(e){this.data.has(e)&&this.data.get(e).refCount--}},{key:"move",value:function(e,t,n,r,a){this.data.set(e,{values:t,dtype:r,refCount:a})}},{key:"numDataIds",value:function(){return this.data.numDataIds()}},{key:"read",value:function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readSync(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readSync",value:function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensorInfos;return"complex64"===n?Bc(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)):this.data.get(e).values}},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map((function(e){return Pr(e)}))}catch(KG){throw new Error("Failed to decode encoded string bytes into utf-8")}return zi(e.shape,e.dtype,n)}},{key:"makeOutput",value:function(e,t,n){var r=this.write(e,t,n);return No().makeTensorFromDataId(r,t,n,this)}},{key:"disposeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;var n=this.data.get(e),r=n.complexTensorInfos;null!=r&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}},{key:"disposeIntermediateTensorInfo",value:function(e){this.disposeData(e.dataId)}},{key:"time",value:function(){var e=F(M().mark((function e(t){var n,r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Fr(),t(),r=Fr()-n,e.abrupt("return",{kernelMs:r});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"memory",value:function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}},{key:"where",value:function(e){qk([e],"where");var t=this.readSync(e.dataId);return Xk(e.shape,t)}},{key:"dispose",value:function(){}},{key:"floatPrecision",value:function(){return 32}},{key:"epsilon",value:function(){return em(Gr(n.prototype),"epsilon",this).call(this)}}]),n}(z);Kk.nextDataId=0;function Yk(e,t,n){return function(r){var a=r.inputs,i=r.attrs,o=r.backend,s=a.x;if(qk(s,e),"string"===s.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");for(var u=o,l=u.data.get(s.dataId).values,c=K(s.shape),h=n||s.dtype,p=ae(h,c),f=0;f<c;++f)p[f]=t(l[f],i);return u.makeTensorInfo(s.shape,h,p)}}function Zk(e,t,n){return function(r){var a=r.inputs,i=r.attrs,o=r.backend,s=a.x;if(qk(s,e),"string"===s.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");var u=o,l=u.data.get(s.dataId).values,c=n||s.dtype,h=t(l,c,i);return u.makeTensorInfo(s.shape,c,h)}}Oo("cpu",(function(){return new Kk}),1);var Qk=Yk(St,(function(e){return e>=0?e:Math.exp(e)-1})),$k={kernelName:St,backendName:"cpu",kernelFunc:Qk};function Jk(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var ew={kernelName:Wt,backendName:"cpu",kernelFunc:Jk};function tw(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.alpha;qk([a],"leakyRelu");for(var o=K(a.shape),s=n.data.get(a.dataId).values,u=re("float32",o),l=0;l<s.length;l++)u[l]=s[l]<0?i*s[l]:s[l];return n.makeTensorInfo(a.shape,"float32",u)}var nw={kernelName:Xt,backendName:"cpu",kernelFunc:tw};function rw(e){return function(t,n,r,a,i){var o=Ns(t,n),s=o.length,u=fe(o),l=re(i,K(o)),c=t.length,h=n.length,p=fe(t),f=fe(n),d=Cs(t,o),v=Cs(n,o);if(d.length+v.length===0)for(var m=0;m<l.length;++m)l[m]=e(r[m%r.length],a[m%a.length]);else for(var g=function(t){var n=ke(t,s,u),i=n.slice(-c);d.forEach((function(e){return i[e]=0}));var o=xe(i,c,p),m=n.slice(-h);v.forEach((function(e){return m[e]=0}));var g=xe(m,h,f);l[t]=e(r[o],a[g])},y=0;y<l.length;++y)g(y);return[l,o]}}var aw=rw((function(e,t){return e<0?t*e:e}));function iw(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha;qk([r,a],"prelu");var i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=N(aw(r.shape,a.shape,i,o,r.dtype),2),u=s[0],l=s[1];return n.makeTensorInfo(l,r.dtype,u)}var ow={kernelName:En,backendName:"cpu",kernelFunc:iw},sw=Yk(On,(function(e){return Math.max(0,e)})),uw={kernelName:On,backendName:"cpu",kernelFunc:sw},lw=Yk(Vn,(function(e){return Math.min(Math.max(0,e),6)})),cw={kernelName:Vn,backendName:"cpu",kernelFunc:lw};function hw(e,t,n,r,a){if("linear"===n)return Jk({inputs:{x:t},backend:e});if("relu"===n)return sw({inputs:{x:t},backend:e});if("elu"===n)return Qk({inputs:{x:t},backend:e});if("relu6"===n)return lw({inputs:{x:t},backend:e});if("prelu"===n)return iw({inputs:{x:t,alpha:r},backend:e});if("leakyrelu"===n)return tw({inputs:{x:t},backend:e,attrs:{alpha:a}});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function pw(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",o)},s}var fw={kernelName:tt,backendName:"cpu",kernelFunc:pw};function dw(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){var r=dw(e,t,"float32"),a=dw(e,t,"float32");return pw({inputs:{real:r,imag:a},backend:e})}var i=ge(K(t),n);return e.makeTensorInfo(t,n,i)}function vw(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var mw={kernelName:Dn,backendName:"cpu",kernelFunc:vw};function gw(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dtype;if("complex64"===i){if("complex64"===a.dtype)return Jk({inputs:{x:a},backend:n});var o=dw(n,a.shape,a.dtype),s=gw({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),u=pw({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}if("complex64"===a.dtype){var l=vw({inputs:{input:a},backend:n}),c=gw({inputs:{x:l},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(l),c}if(!ie(a.dtype,i)){var h=Jk({inputs:{x:a},backend:n});return{dataId:h.dataId,shape:h.shape,dtype:i}}if("int32"===i){var p=n.data.get(a.dataId).values,f=Int32Array.from(p);return n.makeTensorInfo(a.shape,"int32",f)}if("bool"===i){var d=n.data.get(a.dataId).values,v=Or([0],a.dtype),m=N(rw((function(e,t){return e!==t?1:0}))(a.shape,[],d,v,"bool"),2),g=m[0],y=m[1];return n.makeTensorInfo(y,"bool",g)}throw new Error("Error in Cast: failed to cast ".concat(a.dtype," to ").concat(i))}var yw={kernelName:$e,backendName:"cpu",kernelFunc:gw};function bw(e,t,n,r){return null==n?function(n){var a=n.inputs,i=n.backend,o=a.a,s=a.b,u=i;qk([o,s],e);var l=u.data.get(o.dataId).values,c=u.data.get(s.dataId).values,h=r||o.dtype,p=N(t(o.shape,s.shape,l,c,h),2),f=p[0],d=p[1];return u.makeTensorInfo(d,h,f)}:function(e){var a=e.inputs,i=e.backend,o=a.a,s=a.b,u=i;if("complex64"===o.dtype||"complex64"===s.dtype){var l=gw({inputs:{x:o},backend:u,attrs:{dtype:"complex64"}}),c=u.data.get(l.dataId),h=c.complexTensorInfos.real,p=c.complexTensorInfos.imag,f=u.data.get(h.dataId).values,d=u.data.get(p.dataId).values,v=gw({inputs:{x:s},backend:u,attrs:{dtype:"complex64"}}),m=u.data.get(v.dataId),g=m.complexTensorInfos.real,y=m.complexTensorInfos.imag,b=u.data.get(g.dataId).values,x=u.data.get(y.dataId).values,k=N(n(o.shape,s.shape,f,d,b,x),3),w=k[0],_=k[1],S=k[2],I=u.makeTensorInfo(S,"float32",w),C=u.makeTensorInfo(S,"float32",_),T=pw({inputs:{real:I,imag:C},backend:u});return u.disposeIntermediateTensorInfo(l),u.disposeIntermediateTensorInfo(v),u.disposeIntermediateTensorInfo(I),u.disposeIntermediateTensorInfo(C),T}var E=u.data.get(o.dataId).values,M=u.data.get(s.dataId).values,A=r||o.dtype,D=N(t(o.shape,s.shape,E,M,A),2),R=D[0],O=D[1];return u.makeTensorInfo(O,A,R)}}function xw(e){return function(t,n,r,a,i,o){var s=Ns(t,n),u=K(s),l=s.length,c=fe(s),h=re("float32",u),p=re("float32",u),f=Cs(t,s),d=Cs(n,s),v=Bc(r,a),m=Bc(i,o),g=t.length,y=fe(t),b=n.length,x=fe(n);if(f.length+d.length===0)for(var k=0;k<h.length;k++){var w=k%v.length,_=k%m.length,S=e(v[2*w],v[2*w+1],m[2*_],m[2*_+1]);h[k]=S.real,p[k]=S.imag}else for(var I=function(t){var n=ke(t,l,c),r=n.slice(-g);f.forEach((function(e){return r[e]=0}));var a=xe(r,g,y),i=n.slice(-b);d.forEach((function(e){return i[e]=0}));var o=xe(i,b,x),s=e(v[2*a],v[2*a+1],m[2*o],m[2*o+1]);h[t]=s.real,p[t]=s.imag},C=0;C<h.length;C++)I(C);return[h,p,s]}}var kw=rw((function(e,t){return e+t})),ww=xw((function(e,t,n,r){return{real:e+n,imag:t+r}})),_w=bw(Oe,kw,ww),Sw={kernelName:Oe,backendName:"cpu",kernelFunc:_w};function Iw(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.shape,o=K(a.shape),s=ee(i,o),u=K(s);G(o===u,(function(){return"The new shape (".concat(s,") has ").concat(u," elements and the old ")+"shape (".concat(a.shape,") has ").concat(o," elements. The new shape and old ")+"shape must have the same number of elements."})),n.incRef(a.dataId);var l=n.data.get(a.dataId);if(null!=l.complexTensorInfos){var c=l.complexTensorInfos.real,h=l.complexTensorInfos.imag;c.shape=s,h.shape=s}return{dataId:a.dataId,shape:s,dtype:a.dtype}}var Cw={kernelName:Fn,backendName:"cpu",kernelFunc:Iw};function Tw(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=r.transposeA,s=r.transposeB;qk([a,i],"matMul");var u=a.shape.length,l=i.shape.length,c=o?a.shape[u-2]:a.shape[u-1],h=s?i.shape[l-1]:i.shape[l-2],p=o?a.shape[u-1]:a.shape[u-2],f=s?i.shape[l-2]:i.shape[l-1],d=a.shape.slice(0,-2),v=i.shape.slice(0,-2),m=K(d),g=K(v);G(u>=2&&l>=2&&(m===g||1===m||1===g),(function(){return"Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input "+"batch dimensions of (".concat(d,") and (").concat(v,").")}));var y=(m>g?a.shape.slice(0,-2):i.shape.slice(0,-2)).concat([p,f]);G(c===h,(function(){return"Error in matMul: inner shapes (".concat(c,") and (")+"".concat(h,") of Tensors with shapes ").concat(a.shape," and ")+"".concat(i.shape," and transposeA=").concat(o)+" and transposeB=".concat(s," must match.")}));for(var b=s?[g,f,h]:[g,h,f],x=Iw({inputs:{x:a},backend:n,attrs:{shape:o?[m,c,p]:[m,p,c]}}),k=Iw({inputs:{x:i},backend:n,attrs:{shape:b}}),w=o?x.shape[1]:x.shape[2],_=o?x.shape[2]:x.shape[1],S=s?k.shape[1]:k.shape[2],I=Math.max(m,g),C=n.data.get(x.dataId).values,T=n.data.get(k.dataId).values,E=fe(x.shape),M=fe(k.shape),A=N(o?[E[0],1,E[1]]:[E[0],E[1],1],3),D=A[0],R=A[1],O=A[2],F=N(s?[1,M[1],M[0]]:[M[1],1,M[0]],3),L=F[0],P=F[1],z=F[2],B=_*S,V=zi([I,_,S],x.dtype),W=V.values,U=n.blockSize,H=0;H<I;H++)for(var j=0;j<_;j+=U)for(var q=0;q<S;q+=U)for(var X=0;X<w;X+=U)for(var Y=Math.min(j+U,_),Z=Math.min(q+U,S),Q=Math.min(X+U,w),$=j;$<Y;$++)for(var J=q;J<Z;J++){for(var ee=0,te=X;te<Q;te++){var ne=Math.min(H,m-1)*D,re=Math.min(H,g-1)*z;ee+=C[ne+$*R+te*O]*T[te*L+J*P+re]}W[H*B+($*S+J)]+=ee}return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(k),n.makeTensorInfo(y,V.dtype,V.values)}var Nw={kernelName:Ye,backendName:"cpu",kernelFunc:Tw};var Ew={kernelName:wr,backendName:"cpu",kernelFunc:function(e){var t,n,r,a=e.inputs,i=e.backend,o=e.attrs,s=a.a,u=a.b,l=a.bias,c=a.preluActivationWeights,h=o.transposeA,p=o.transposeB,f=o.activation,d=o.leakyreluAlpha,v=[];t=Tw({inputs:{a:s,b:u},attrs:{transposeA:h,transposeB:p},backend:i}),l&&(n=_w({inputs:{a:t,b:l},backend:i}),v.push(t),t=n),f&&(r=hw(i,t,f,c,d),v.push(t),t=r);for(var m=0,g=v;m<g.length;m++){var y=g[m];i.disposeIntermediateTensorInfo(y)}return t}};function Mw(e){for(var t=new Float32Array(e.length),n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}var Aw={kernelName:Ae,backendName:"cpu",kernelFunc:function(e){var t=e.inputs.x,n=e.backend;qk(t,"abs");var r=new Float32Array(K(t.shape));return r=Mw(n.data.get(t.dataId).values),n.makeOutput(r,t.shape,"float32")}},Dw=Yk(De,(function(e){return Math.acos(e)})),Rw={kernelName:De,backendName:"cpu",kernelFunc:Dw},Ow=Yk(Re,(function(e){return Math.acosh(e)})),Fw={kernelName:Re,backendName:"cpu",kernelFunc:Ow};var Lw={kernelName:Fe,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t;qk(t,"addN");for(var a=r.map((function(e){return n.data.get(e.dataId).values})),i=zi(r[0].shape,r[0].dtype),o=i.values,s=0;s<r.length;s++)for(var u=a[s],l=0;l<o.length;l++)o[l]+=u[l];return n.makeTensorInfo(i.shape,i.dtype,i.values)}};function Pw(e,t,n,r,a){for(var i=t.length,o=K(t),s=fe(t),u=fe(a),l=re(n,K(a)),c=0;c<o;++c){for(var h=ke(c,i,s),p=new Array(h.length),f=0;f<p.length;f++)p[f]=h[r[f]];l[xe(p,i,u)]=e[c]}return l}function zw(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.perm;qk(a,"transpose");for(var o=a.shape.length,s=new Array(o),u=0;u<s.length;u++)s[u]=a.shape[i[u]];var l=Pw(r.data.get(a.dataId).values,a.shape,a.dtype,i,s);return{dataId:r.write(l,s,a.dtype),shape:s,dtype:a.dtype}}var Bw={kernelName:dr,backendName:"cpu",kernelFunc:zw};var Vw={kernelName:Le,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;qk(a,"all");var s=te(i,a.shape),u=s,l=ru(u,a.shape.length),c=a;null!=l&&(c=zw({inputs:{x:a},backend:n,attrs:{perm:l}}),u=iu(u.length,a.shape.length)),nu("all",u,c.shape.length);for(var h=N(eu(c.shape,u),2),p=h[0],f=K(h[1]),d=ge(K(p),c.dtype),v=n.data.get(c.dataId).values,m=0;m<d.length;++m){for(var g=m*f,y=v[g],b=0;b<f;++b){var x=v[g+b];y=y&&x}d[m]=y}null!=l&&n.disposeIntermediateTensorInfo(c);var k=n.makeTensorInfo(p,c.dtype,d);if(o){var w=Iw({inputs:{x:k},backend:n,attrs:{shape:tu(p,s)}});return n.disposeIntermediateTensorInfo(k),w}return k}};var Ww={kernelName:Pe,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;qk(a,"any");var s=te(i,a.shape),u=s,l=ru(u,a.shape.length),c=a;null!=l&&(c=zw({inputs:{x:a},backend:n,attrs:{perm:l}}),u=iu(u.length,a.shape.length)),nu("any",u,c.shape.length);for(var h=N(eu(c.shape,u),2),p=h[0],f=K(h[1]),d=ge(K(p),c.dtype),v=n.data.get(c.dataId).values,m=0;m<d.length;++m){for(var g=m*f,y=v[g],b=0;b<f;++b){var x=v[g+b];y=y||x}d[m]=y}null!=l&&n.disposeIntermediateTensorInfo(c);var k=n.makeTensorInfo(p,c.dtype,d);if(o){var w=Iw({inputs:{x:k},backend:n,attrs:{shape:tu(p,s)}});return n.disposeIntermediateTensorInfo(k),w}return k}};var Uw={kernelName:ze,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis;qk(a,"argMax");var o=te(i,a.shape),s=ru(o,a.shape.length),u=a,l=[];null!=s&&(u=zw({inputs:{x:a},backend:n,attrs:{perm:s}}),l.push(u),o=iu(o.length,u.shape.length)),nu("argMax",o=[o[0]],u.shape.length);for(var c=N(eu(u.shape,o),2),h=c[0],p=c[1],f=ge(K(h),"int32"),d=K(p),v=n.data.get(u.dataId).values,m=0;m<f.length;++m){for(var g=m*d,y=v[g],b=0,x=0;x<d;++x){var k=v[g+x];k>y&&(y=k,b=x)}f[m]=b}return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(h,"int32",f)}};var Hw={kernelName:Be,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis;qk(a,"argMin");var o=te(i,a.shape),s=ru(o,a.shape.length),u=a,l=[];null!=s&&(u=zw({inputs:{x:a},backend:n,attrs:{perm:s}}),l.push(u),o=iu(o.length,u.shape.length)),nu("argMin",o=[o[0]],u.shape.length);for(var c=N(eu(u.shape,o),2),h=c[0],p=c[1],f=ge(K(h),"int32"),d=K(p),v=n.data.get(u.dataId).values,m=0;m<f.length;++m){for(var g=m*d,y=v[g],b=0,x=0;x<d;++x){var k=v[g+x];k<y&&(y=k,b=x)}f[m]=b}return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(h,"int32",f)}},Gw=Yk(Ve,(function(e){return Math.asin(e)})),jw={kernelName:Ve,backendName:"cpu",kernelFunc:Gw},qw=Yk(We,(function(e){return Math.asinh(e)})),Xw={kernelName:We,backendName:"cpu",kernelFunc:qw},Kw=Yk(Ue,(function(e){return Math.atan(e)})),Yw={kernelName:Ue,backendName:"cpu",kernelFunc:Kw},Zw=rw((function(e,t){return Math.atan2(e,t)})),Qw=bw(Ge,Zw),$w={kernelName:Ge,backendName:"cpu",kernelFunc:Qw},Jw=Yk(He,(function(e){return Math.atanh(e)})),e_={kernelName:He,backendName:"cpu",kernelFunc:Jw};function t_(e,t,n,r,a,i){for(var o=a.strideHeight,s=a.strideWidth,u=a.dilationHeight,l=a.dilationWidth,c=a.effectiveFilterHeight,h=a.effectiveFilterWidth,p=a.padInfo.top,f=a.padInfo.left,d="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=zi(a.outShape,n),m=v.values,g=a.outShape[1]*a.outShape[2]*a.outShape[3],y=a.outShape[2]*a.outShape[3],b=a.outShape[3],x=0;x<a.batchSize;++x)for(var k=x*g,w=x*r[0],_=0;_<a.inChannels;++_)for(var S=0;S<a.outHeight;++S)for(var I=S*o-p,C=Math.max(0,I),T=Math.min(a.inHeight,c+I),N=k+S*y,E=0;E<a.outWidth;++E){for(var M=E*s-f,A=Math.max(0,M),D=Math.min(a.inWidth,h+M),R=d,O=0,F=0,L=C;L<T;L+=u){for(var P=w+L*r[1],z=A;z<D;z+=l){var B=e[P+z*r[2]+_];"max"===i&&B>R?R=B:"avg"===i&&(O+=B,F++)}if(isNaN(R))break}m[N+E*b+_]="avg"===i?O/F:R}return v}function n_(e,t,n,r){for(var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=zi(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,h=r.effectiveFilterHeight,p=r.effectiveFilterWidth,f=r.padInfo.top,d=r.padInfo.left,v=zi(t,n,e),m=0;m<r.batchSize;++m)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.outHeight;++y){for(var b=y*s-f,x=b;x<0;)x+=l;for(var k=Math.min(r.inHeight,h+b),w=0;w<r.outWidth;++w){for(var _=w*u-d,S=_;S<0;)S+=c;for(var I=Math.min(r.inWidth,p+_),C=Number.NEGATIVE_INFINITY,T=-1,N=x;N<k;N+=l)for(var E=N-b,M=S;M<I;M+=c){var A=M-_,D=v.get(m,N,M,g);D>C&&(C=D,T=a?i?((m*r.inHeight+N)*r.inWidth+M)*r.inChannels+g:(N*r.inWidth+M)*r.inChannels+g:E*p+A)}o.set(T,m,y,w,g)}}return o}function r_(e,t,n,r,a,i){for(var o=a.strideDepth,s=a.strideHeight,u=a.strideWidth,l=a.dilationDepth,c=a.dilationHeight,h=a.dilationWidth,p=a.effectiveFilterDepth,f=a.effectiveFilterHeight,d=a.effectiveFilterWidth,v=a.padInfo.front,m=a.padInfo.top,g=a.padInfo.left,y="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=zi(a.outShape,n),x=b.values,k=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],w=a.outShape[2]*a.outShape[3]*a.outShape[4],_=a.outShape[3]*a.outShape[4],S=a.outShape[4],I=0;I<a.batchSize;++I)for(var C=I*k,T=I*r[0],N=0;N<a.inChannels;++N)for(var E=0;E<a.outDepth;++E){for(var M=E*o-v,A=M;A<0;)A+=l;for(var D=Math.min(a.inDepth,p+M),R=C+E*w,O=0;O<a.outHeight;++O){for(var F=O*s-m,L=F;L<0;)L+=c;for(var P=Math.min(a.inHeight,f+F),z=R+O*_,B=0;B<a.outWidth;++B){for(var V=B*u-g,W=V;W<0;)W+=h;for(var U=Math.min(a.inWidth,d+V),H=z+B*S,G=y,j=0,q=0,X=A;X<D;X+=l){for(var K=T+X*r[1],Y=L;Y<P;Y+=c){for(var Z=K+Y*r[2],Q=W;Q<U;Q+=h){var $=e[Z+Q*r[3]+N];if("max"===i&&$>G?G=$:"avg"===i&&(j+=$,q++),isNaN(G))break}if(isNaN(G))break}if(isNaN(G))break}x[H+N]="avg"===i?j/q:G}}}return b}var a_={kernelName:je,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;qk(a,"avgPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;G(ns(o,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var l,c=Go(a.shape,i,o,1,s,u);if(1===c.filterWidth&&1===c.filterHeight&&Y(c.inShape,c.outShape))l=Jk({inputs:{x:a},backend:n});else{var h=n.data.get(a.dataId).values,p=fe(a.shape),f=t_(h,a.shape,a.dtype,p,c,"avg");l=n.makeTensorInfo(c.outShape,a.dtype,f.values)}return l}};var i_={kernelName:Xe,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode,l=r.dataFormat;qk(a,"avgPool3d");var c=jo(a.shape,i,o,1,s,u,l),h=r_(n.data.get(a.dataId).values,a.shape,a.dtype,fe(a.shape),c,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}};var o_={kernelName:Ke,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,l=r.dimRoundingMode;qk([a,i],"avgPool3DGrad");for(var c=jo(i.shape,o,s,1,u,l),h=c.strideDepth,p=c.strideHeight,f=c.strideWidth,d=c.filterDepth,v=c.filterHeight,m=c.filterWidth,g=c.dilationDepth,y=c.dilationHeight,b=c.dilationWidth,x=c.effectiveFilterDepth,k=c.effectiveFilterHeight,w=c.effectiveFilterWidth,_=x-1-c.padInfo.front,S=w-1-c.padInfo.left,I=k-1-c.padInfo.top,C=zi(i.shape,"float32"),T=1/(d*v*m),N=n.bufferSync(a),E=0;E<c.batchSize;++E)for(var M=0;M<c.inChannels;++M)for(var A=0;A<c.inDepth;++A)for(var D=0;D<c.inHeight;++D)for(var R=0;R<c.inWidth;++R){for(var O=A-_,F=D-I,L=R-S,P=0,z=0;z<x;z+=g){var B=(O+z)/h;if(!(B<0||B>=c.outDepth||Math.floor(B)!==B))for(var V=0;V<k;V+=y){var W=(F+V)/p;if(!(W<0||W>=c.outHeight||Math.floor(W)!==W))for(var U=0;U<w;U+=b){var H=(L+U)/f;if(!(H<0||H>=c.outWidth||Math.floor(H)!==H))P+=N.get(E,B,W,H,M)}}}C.set(P*T,E,A,D,R,M)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}};var s_={kernelName:qe,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;qk([a,i],"avgPoolGrad");for(var s=r.filterSize,u=r.strides,l=r.pad,c=Go(o.shape,s,u,1,l),h=c.strideHeight,p=c.strideWidth,f=c.filterHeight,d=c.filterWidth,v=c.dilationHeight,m=c.dilationWidth,g=c.effectiveFilterHeight,y=c.effectiveFilterWidth,b=y-1-c.padInfo.left,x=g-1-c.padInfo.top,k=zi(o.shape,"float32"),w=1/(f*d),_=n.data.get(a.dataId).values,S=zi(a.shape,"float32",_),I=0;I<c.batchSize;++I)for(var C=0;C<c.inChannels;++C)for(var T=0;T<c.inHeight;++T)for(var N=0;N<c.inWidth;++N){for(var E=T-x,M=N-b,A=0,D=0;D<g;D+=v){var R=(E+D)/h;if(!(R<0||R>=c.outHeight||Math.floor(R)!==R))for(var O=0;O<y;O+=m){var F=(M+O)/p;if(!(F<0||F>=c.outWidth||Math.floor(F)!==F))A+=S.get(I,R,F,C)}}k.set(A*w,I,T,N,C)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}};var u_={kernelName:Lt,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.scale,o=t.offset,s=t.mean,u=t.variance;G(s.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),G(null==o||s.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),G(null==i||s.shape.length===i.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),qk([a,s,u,i,o],"batchNorm");var l=r.varianceEpsilon;null==l&&(l=.001);for(var c=n.data.get(a.dataId).values,h=n.data.get(s.dataId).values,p=n.data.get(u.dataId).values,f=i?n.data.get(i.dataId).values:new Float32Array([1]),d=o?n.data.get(o.dataId).values:new Float32Array([0]),v=new Float32Array(c.length),m=d.length,g=f.length,y=p.length,b=h.length,x=0,k=0,w=0,_=0,S=0;S<c.length;++S)v[S]=d[x++]+(c[S]-h[k++])*f[w++]/Math.sqrt(p[_++]+l),x>=m&&(x=0),k>=b&&(k=0),w>=g&&(w=0),_>=y&&(_=0);return n.makeTensorInfo(a.shape,a.dtype,v)}};function l_(e,t,n,r,a){var i=ko(r,t,n),o=K(n),s=fe(r);if(i){var u=wo(t,s);return"string"===a?e.slice(u,u+o):e.subarray(u,u+o)}for(var l=zi(r,a,"string"===a?jc(e):e),c=zi(n,a),h=0;h<c.size;++h){var p=c.indexToLoc(h),f=p.map((function(e,n){return e+t[n]}));c.set.apply(c,[l.get.apply(l,I(f))].concat(I(p)))}return"string"===a?c.values.map((function(e){return Lr(e)})):c.values}function c_(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.begin,o=r.size;qk(a,"slice");var s=N(_o(a,i,o),2),u=s[0],l=s[1];po(a,u,l);var c=l_(n.data.get(a.dataId).values,u,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,c)}var h_={kernelName:Xn,backendName:"cpu",kernelFunc:c_};var p_={kernelName:Ze,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.crops;qk([a],"batchToSpaceND");var s=i.reduce((function(e,t){return e*t})),u=wc(a.shape,i,s),l=_c(u.length,i.length),c=Sc(a.shape,i,s),h=Ic(o,i.length),p=Cc(c,o,i.length),f=Iw({inputs:{x:a},backend:n,attrs:{shape:u}}),d=zw({inputs:{x:f},backend:n,attrs:{perm:l}}),v=Iw({inputs:{x:d},backend:n,attrs:{shape:c}}),m=c_({inputs:{x:v},backend:n,attrs:{begin:h,size:p}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(v),m}};function f_(e,t,n,r,a){for(var i=K(r),o=ge(a,n),s=0;s<e.length;s++){var u=e[s];if(u<0)throw new Error("Input x must be non-negative!");u>=a||(o[u]+=i>0?t[s]:1)}return o}function d_(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e.shape[0],i=e.shape[1],o=zi([a,n],t.dtype),s=0;s<a;s++)for(var u=0;u<i;u++){var l=e.get(s,u);if(l<0)throw new Error("Input x must be non-negative!");l>=n||(r?o.set(1,s,l):t.size>0?o.set(o.get(s,l)+t.get(s,u),s,l):o.set(o.get(s,l)+1,s,l))}return o}var v_={kernelName:Qe,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=f_(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,s)}};function m_(e){return function(t,n,r){for(var a=re(n,t.length),i=0;i<t.length;++i)a[i]=e(t[i],r);return a}}var g_=m_((function(e){return Math.ceil(e)})),y_=Zk(Je,g_),b_={kernelName:Je,backendName:"cpu",kernelFunc:y_},x_=Yk(et,(function(e,t){var n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e})),k_={kernelName:et,backendName:"cpu",kernelFunc:x_},w_={kernelName:nt,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs.x,n=e.backend,r=new Float32Array(K(t.shape)),a=n.data.get(t.dataId),i=a.complexTensorInfos.real,o=a.complexTensorInfos.imag,s=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,l=0;l<s.length;l++){var c=s[l],h=u[l];r[l]=Math.hypot(c,h)}return n.makeOutput(r,t.shape,"float32")}};function __(e,t,n,r){var a=ae(n,K(t));if(r&&"string"!==n){var i=0;e.forEach((function(e){var t=K(e.shape);a.set(e.vals,i),i+=t}))}else{var o=0;e.forEach((function(e){for(var r="string"===n?jc(e.vals):e.vals,i=0,s=0;s<e.shape[0];++s)for(var u=s*t[1]+o,l=0;l<e.shape[1];++l)a[u+l]=r[i++];o+=e.shape[1]}))}return a}function S_(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var I_={kernelName:Ht,backendName:"cpu",kernelFunc:S_};function C_(e){var t=e.inputs,n=e.backend,r=te(e.attrs.axis,t[0].shape)[0],a=bc(t.map((function(e){return e.shape})),r);if(0===K(a))return n.makeTensorInfo(a,t[0].dtype,[]);var i=t.filter((function(e){return K(e.shape)>0}));if(1===i.length)return Jk({inputs:{x:i[0]},backend:n});if(yc(i.map((function(e){return e.shape})),r),"complex64"===i[0].dtype){var o=i.map((function(e){return vw({inputs:{input:e},backend:n})})),s=i.map((function(e){return S_({inputs:{input:e},backend:n})})),u=C_({inputs:o,backend:n,attrs:{axis:r}}),l=C_({inputs:s,backend:n,attrs:{axis:r}}),c=pw({inputs:{real:u,imag:l},backend:n});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),s.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(l),c}var h=i.map((function(e){var t=K(e.shape.slice(r));return Iw({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})})),p=h.map((function(e){return{vals:n.data.get(e.dataId).values,shape:e.shape}}));a=bc(h.map((function(e){return e.shape})),1);var f=1===h[0].shape[0],d=__(p,a,t[0].dtype,f),v=bc(i.map((function(e){return e.shape})),r),m=n.makeTensorInfo(v,t[0].dtype,d);return h.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),m}var T_={kernelName:rt,backendName:"cpu",kernelFunc:C_};function N_(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dataFormat,l=r.dilations,c=r.dimRoundingMode;qk([a,i],"conv2d");for(var h=rs(u),p=qo(a.shape,i.shape,o,l,s,c,!1,h),f=p.filterHeight,d=p.filterWidth,v=p.dilationHeight,m=p.dilationWidth,g=p.padInfo.left,y=p.padInfo.top,b="channelsLast"===p.dataFormat,x=new ea(p.outShape,a.dtype),k=fe(a.shape),w=fe(i.shape),_=k[0],S=b?k[1]:k[2],I=b?k[2]:1,C=b?1:k[1],T=x.strides[0],N=b?x.strides[1]:x.strides[2],E=b?x.strides[2]:1,M=b?1:x.strides[1],A=n.data.get(a.dataId).values,D=n.data.get(i.dataId).values,R=x.values,O=0;O<p.batchSize;++O)for(var F=O*_,L=O*T,P=0;P<p.outHeight;++P)for(var z=L+P*N,B=P*p.strideHeight-y,V=0;V<f;++V){var W=B+V*v;if(!(W<0||W>=p.inHeight))for(var U=V*w[0],H=F+W*S,G=0;G<p.outWidth;++G)for(var j=z+G*E,q=G*p.strideWidth-g,X=0;X<d;++X){var K=q+X*m;if(!(K<0||K>=p.inWidth))for(var Y=H+K*I,Z=U+X*w[1],Q=0;Q<p.inChannels;++Q){for(var $=A[Y+Q*C],J=0;J<p.outChannels;++J)R[j+J*M]+=$*D[Z+J];Z+=p.outChannels}}}return n.makeTensorInfo(x.shape,x.dtype,R)}var E_={kernelName:at,backendName:"cpu",kernelFunc:N_};var M_={kernelName:it,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.dataFormat,l=r.dimRoundingMode,c=r.filterShape;qk([a,i],"conv2dBackpropFilter");for(var h=rs(u),p=qo(a.shape,c,o,1,s,l,!1,h),f=p.strideHeight,d=p.strideWidth,v=p.filterHeight,m=p.filterWidth,g="channelsLast"===p.dataFormat,y=new ea(p.filterShape,"float32"),b=p.padInfo.left,x=p.padInfo.top,k=n.data.get(a.dataId).values,w=n.data.get(i.dataId).values,_=new ea(a.shape,a.dtype,k),S=new ea(i.shape,i.dtype,w),I=0;I<v;++I)for(var C=Math.max(0,Math.ceil((x-I)/f)),T=Math.min(p.outHeight,(p.inHeight+x-I)/f),N=0;N<m;++N)for(var E=Math.max(0,Math.ceil((b-N)/d)),M=Math.min(p.outWidth,(p.inWidth+b-N)/d),A=0;A<p.inChannels;++A)for(var D=0;D<p.outChannels;++D){for(var R=0,O=0;O<p.batchSize;++O)for(var F=C;F<T;++F)for(var L=I+F*f-x,P=E;P<M;++P){var z=N+P*d-b;R+=g?_.get(O,L,z,A)*S.get(O,F,P,D):_.get(O,A,L,z)*S.get(O,D,F,P)}y.set(R,I,N,A,D)}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};var A_={kernelName:ot,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.inputShape,s=r.strides,u=r.pad,l=r.dataFormat,c=r.dimRoundingMode;qk([a,i],"conv2dBackpropInput");var h=fe(i.shape),p=fe(a.shape),f=rs(l),d=qo(o,i.shape,s,1,u,c,!1,f),v=new ea(d.inShape,"float32"),m=v.values,g=n.data.get(a.dataId).values,y=n.data.get(i.dataId).values,b=N(h,3),x=b[0],k=b[1],w=b[2],_=d.batchSize,S=d.filterHeight,I=d.filterWidth,C=d.inChannels,T=d.inHeight,E=d.inWidth,M=d.outChannels,A=d.outHeight,D=d.outWidth,R=d.strideHeight,O=d.strideWidth;f=d.dataFormat;for(var F=S-1-d.padInfo.top,L=I-1-d.padInfo.left,P="channelsLast"===f,z=v.strides[0],B=P?v.strides[1]:v.strides[2],V=P?v.strides[2]:1,W=P?1:v.strides[1],U=p[0],H=P?p[1]:p[2],G=P?p[2]:1,j=P?1:p[1],q=0;q<_;++q)for(var X=0;X<C;++X)for(var K=0;K<T;++K)for(var Y=K-F,Z=Math.max(0,Math.ceil(Y/R)),Q=Math.min(A,(S+Y)/R),$=0;$<E;++$){for(var J=$-L,ee=Math.max(0,Math.ceil(J/O)),te=Math.min(D,(I+J)/O),ne=0,re=Z;re<Q;++re)for(var ae=re*R-Y,ie=ee;ie<te;++ie)for(var oe=U*q+H*re+G*ie,se=x*(S-1-ae)+k*(I-1-(ie*O-J))+w*X,ue=0;ue<M;++ue){ne+=g[oe+j*ue]*y[se+ue]}m[z*q+B*K+V*$+W*X]=ne}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};var D_={kernelName:st,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations;qk([a,i],"conv3d");for(var l=Xo(a.shape,i.shape,o,u,s),c=l.filterDepth,h=l.filterHeight,p=l.filterWidth,f=l.dilationDepth,d=l.dilationHeight,v=l.dilationWidth,m=l.padInfo,g=m.front,y=m.left,b=m.top,x=new ea(l.outShape,a.dtype),k=n.data.get(a.dataId).values,w=n.data.get(i.dataId).values,_=x.values,S=fe(a.shape),I=fe(i.shape),C=0;C<l.batchSize;++C)for(var T=C*S[0],N=C*x.strides[0],E=0;E<l.outDepth;++E)for(var M=N+E*x.strides[1],A=E*l.strideDepth-g,D=0;D<c;++D){var R=A+D*f;if(!(R<0||R>=l.inDepth))for(var O=D*I[0],F=T+R*S[1],L=0;L<l.outHeight;++L)for(var P=M+L*x.strides[2],z=L*l.strideHeight-b,B=0;B<h;++B){var V=z+B*d;if(!(V<0||V>=l.inHeight))for(var W=O+B*I[1],U=F+V*S[2],H=0;H<l.outWidth;++H)for(var G=P+H*l.outChannels,j=H*l.strideWidth-y,q=0;q<p;++q){var X=j+q*v;if(!(X<0||X>=l.inWidth))for(var K=W+q*I[2],Y=U+X*l.inChannels,Z=K,Q=0;Q<l.inChannels;++Q){for(var $=k[Y+Q],J=0;J<l.outChannels;++J)_[G+J]+=$*w[Z+J];Z+=l.outChannels}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}};var R_={kernelName:ut,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.filterShape;qk([a,i],"conv3dBackpropFilterV2");for(var l=fe(a.shape),c=fe(i.shape),h=Xo(a.shape,u,o,1,s),p=h.strideDepth,f=h.strideHeight,d=h.strideWidth,v=h.filterDepth,m=h.filterHeight,g=h.filterWidth,y=new ea(h.filterShape,"float32"),b=y.values,x=N(y.strides,4),k=x[0],w=x[1],_=x[2],S=x[3],I=n.data.get(i.dataId).values,C=N(c,4),T=C[0],E=C[1],M=C[2],A=C[3],D=n.data.get(a.dataId).values,R=N(l,4),O=R[0],F=R[1],L=R[2],P=R[3],z=h.padInfo.front,B=h.padInfo.left,V=h.padInfo.top,W=0;W<v;++W)for(var U=Math.max(0,Math.ceil((z-W)/p)),H=Math.min(h.outDepth,(h.inDepth+z-W)/p),G=W*k,j=0;j<m;++j)for(var q=Math.max(0,Math.ceil((V-j)/f)),X=Math.min(h.outHeight,(h.inHeight+V-j)/f),K=j*w+G,Y=0;Y<g;++Y)for(var Z=Math.max(0,Math.ceil((B-Y)/d)),Q=Math.min(h.outWidth,(h.inWidth+B-Y)/d),$=Y*_+K,J=0;J<h.inChannels;++J)for(var ee=J*S+$,te=0;te<h.outChannels;++te){for(var ne=0,re=0;re<h.batchSize;++re)for(var ae=re*O,ie=re*T,oe=U;oe<H;++oe)for(var se=(W+oe*p-z)*F+ae,ue=oe*E+ie,le=q;le<X;++le)for(var ce=(j+le*f-V)*L+se,he=le*M+ue,pe=Z;pe<Q;++pe){var de=pe*A+he;ne+=D[(Y+pe*d-B)*P+ce+J]*I[de+te]}b[ee+te]=ne}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};var O_={kernelName:lt,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.pad,s=r.strides,u=r.inputShape;qk([a],"conv3dBackpropInputV2");for(var l=fe(a.shape),c=fe(i.shape),h=Xo(u,i.shape,s,1,o),p=new ea(h.inShape,"float32"),f=p.values,d=N(p.strides,4),v=d[0],m=d[1],g=d[2],y=d[3],b=n.data.get(a.dataId).values,x=N(l,4),k=x[0],w=x[1],_=x[2],S=x[3],I=n.data.get(i.dataId).values,C=N(c,4),T=C[0],E=C[1],M=C[2],A=C[3],D=h.batchSize,R=h.filterDepth,O=h.filterHeight,F=h.filterWidth,L=h.inChannels,P=h.inDepth,z=h.inHeight,B=h.inWidth,V=h.outChannels,W=h.outDepth,U=h.outHeight,H=h.outWidth,G=h.strideDepth,j=h.strideHeight,q=h.strideWidth,X=R-1-h.padInfo.front,K=O-1-h.padInfo.top,Y=F-1-h.padInfo.left,Z=0;Z<D;++Z)for(var Q=0;Q<L;++Q)for(var $=0;$<P;++$)for(var J=$-X,ee=Math.max(0,Math.ceil(J/G)),te=Math.min(W,(R+J)/G),ne=0;ne<z;++ne)for(var re=ne-K,ae=Math.max(0,Math.ceil(re/j)),ie=Math.min(U,(O+re)/j),oe=0;oe<B;++oe){for(var se=oe-Y,ue=Math.max(0,Math.ceil(se/q)),le=Math.min(H,(F+se)/q),ce=0,he=ee;he<te;++he)for(var pe=he*G-J,de=ae;de<ie;++de)for(var ve=de*j-re,me=ue;me<le;++me)for(var ge=k*Z+w*he+_*de+S*me,ye=T*(R-1-pe)+E*(O-1-ve)+M*(F-1-(me*q-se))+A*Q,be=0;be<V;++be){ce+=b[ge+be]*I[ye+be]}f[v*Z+m*$+g*ne+y*oe+Q]=ce}return n.makeTensorInfo(p.shape,p.dtype,p.values)}},F_=Yk(ct,(function(e){return Math.cos(e)})),L_={kernelName:ct,backendName:"cpu",kernelFunc:F_},P_=Yk(ht,(function(e){return Math.cosh(e)})),z_={kernelName:ht,backendName:"cpu",kernelFunc:P_};var B_={kernelName:ft,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,s=r.cropSize,u=r.method,l=r.extrapolationValue,c=N(a.shape,4),h=c[0],p=c[1],f=c[2],d=c[3],v=i.shape[0],m=N(s,2),g=m[0],y=m[1],b=zi([v,g,y,d],"float32"),x=n.data.get(i.dataId).values,k=n.data.get(o.dataId).values,w=n.data.get(a.dataId).values,_=fe(a.shape),S=fe(b.shape),I=0;I<v;I++){var C=4*I,T=x[C],E=x[C+1],M=x[C+2],A=x[C+3],D=k[I];if(!(D>=h))for(var R=g>1?(M-T)*(p-1)/(g-1):0,O=y>1?(A-E)*(f-1)/(y-1):0,F=0;F<g;F++){var L=g>1?T*(p-1)+F*R:.5*(T+M)*(p-1);if(L<0||L>p-1)for(var P=0;P<y;P++)for(var z=0;z<d;z++){var B=z+P*S[2]+F*S[1]+I*S[0];b.values[B]=l}else if("bilinear"===u)for(var V=Math.floor(L),W=Math.ceil(L),U=L-V,H=0;H<y;H++){var G=y>1?E*(f-1)+H*O:.5*(E+A)*(f-1);if(G<0||G>f-1)for(var j=0;j<d;j++){var q=j+H*S[2]+F*S[1]+I*S[0];b.values[q]=l}else for(var X=Math.floor(G),K=Math.ceil(G),Y=G-X,Z=0;Z<d;Z++){var Q=Z+X*_[2]+V*_[1]+D*_[0],$=w[Q],J=w[Q=Z+K*_[2]+V*_[1]+D*_[0]],ee=w[Q=Z+X*_[2]+W*_[1]+D*_[0]],te=$+(J-$)*Y,ne=ee+(w[Q=Z+K*_[2]+W*_[1]+D*_[0]]-ee)*Y;Q=Z+H*S[2]+F*S[1]+I*S[0],b.values[Q]=te+(ne-te)*U}}else for(var re=0;re<y;++re){var ae=y>1?E*(f-1)+re*O:.5*(E+A)*(f-1);if(ae<0||ae>f-1)for(var ie=0;ie<d;ie++){var oe=ie+re*S[2]+F*S[1]+I*S[0];b.values[oe]=l}else for(var se=Math.round(ae),ue=Math.round(L),le=0;le<d;le++){var ce=le+se*_[2]+ue*_[1]+D*_[0],he=le+re*S[2]+F*S[1]+I*S[0];b.values[he]=w[ce]}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};var V_={kernelName:pt,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse;qk(a,"cumsum");var u=ru([i],a.shape.length),l=a;null!=u&&(l=zw({inputs:{x:a},backend:n,attrs:{perm:u}}));var c=iu(1,a.shape.length)[0];if(c!==l.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(l.shape.length-1," but got axis=").concat(c));for(var h=pa(l.dtype,"int32"),p=ge(K(l.shape),h),f=n.data.get(l.dataId).values,d=l.shape[l.shape.length-1],v=s?function(e,t){return e+d-t-1}:function(e,t){return e+t},m=0;m<f.length;m+=d)for(var g=0;g<d;g++){var y=v(m,g);if(0===g)p[y]=o?0:f[y];else{var b=v(m,g-1);p[y]=o?f[b]+p[b]:f[y]+p[b]}}var x=n.makeTensorInfo(l.shape,h,p);if(null!=u){var k=zw({inputs:{x:x},backend:n,attrs:{perm:au(u)}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(l),k}return x}};var W_={kernelName:dt,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=r.binaryOutput;if(1===a.shape.length){var u=f_(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}if(2===a.shape.length){var l=d_(n.bufferSync(a),n.bufferSync(i),o,s);return n.makeTensorInfo(l.shape,i.dtype,l.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}};var U_={kernelName:vt,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockSize,o=r.dataFormat;G("NHWC"===o,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(o)})),G(i>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(i)}));for(var s=a.shape[0],u=a.shape[1],l=a.shape[2],c=a.shape[3],h=u*i,p=l*i,f=c/(i*i),d=n.data.get(a.dataId).values,v=new Float32Array(s*h*p*f),m=0,g=0;g<s;++g)for(var y=0;y<h;++y)for(var b=Math.floor(y/i),x=y%i,k=0;k<p;++k)for(var w=Math.floor(k/i),_=(x*i+k%i)*f,S=0;S<f;++S){var I=S+_+c*(w+l*(b+u*g));v[m++]=d[I]}return n.makeTensorInfo([s,h,p,f],a.dtype,v)}};function H_(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,l=r.dimRoundingMode;qk([a,i],"depthwiseConv2DNative");var c=fe(a.shape),h=fe(i.shape),p=u;null==p&&(p=[1,1]),G(ns(o,p),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(p,"'")}));for(var f=qo(a.shape,i.shape,o,p,s,l,!0),d=f.filterHeight,v=f.filterWidth,m=f.dilationHeight,g=f.dilationWidth,y=f.padInfo,b=y.left,x=y.top,k=f.outChannels/f.inChannels,w=new ea(f.outShape,a.dtype),_=n.data.get(a.dataId).values,S=n.data.get(i.dataId).values,I=w.values,C=0;C<f.batchSize;++C)for(var T=C*c[0],N=C*w.strides[0],E=0;E<f.outHeight;++E)for(var M=N+E*w.strides[1],A=E*f.strideHeight-b,D=0;D<d;++D){var R=A+D*m;if(!(R<0||R>=f.inHeight))for(var O=D*h[0],F=T+R*c[1],L=0;L<f.outWidth;++L)for(var P=M+L*w.strides[2],z=L*f.strideWidth-x,B=0;B<v;++B){var V=z+B*g;if(!(V<0||V>=f.inWidth))for(var W=O+B*h[1],U=F+V*f.inChannels,H=P,j=W,q=0;q<f.inChannels;++q){for(var X=_[U+q],K=0;K<k;++K)I[H+K]+=X*S[j+K];H+=k,j+=k}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}var G_={kernelName:mt,backendName:"cpu",kernelFunc:H_};var j_={kernelName:gt,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.dilations,u=r.pad,l=r.dimRoundingMode,c=r.filterShape;qk([a,i],"depthwiseConv2dNativeBackpropFilter");for(var h=qo(a.shape,c,o,s,u,l,!0),p=h.strideHeight,f=h.strideWidth,d=h.filterHeight,v=h.filterWidth,m=new ea(h.filterShape,"float32"),g=h.padInfo.left,y=h.padInfo.top,b=h.outChannels/h.inChannels,x=n.data.get(a.dataId).values,k=new ea(a.shape,a.dtype,x),w=n.data.get(i.dataId).values,_=new ea(i.shape,i.dtype,w),S=0;S<d;++S)for(var I=Math.max(0,Math.ceil((y-S)/p)),C=Math.min(h.outHeight,(h.inHeight+y-S)/p),T=0;T<v;++T)for(var N=Math.max(0,Math.ceil((g-T)/f)),E=Math.min(h.outWidth,(h.inWidth+g-T)/f),M=0;M<h.outChannels;++M){for(var A=Math.trunc(M/b),D=M%b,R=0,O=0;O<h.batchSize;++O)for(var F=I;F<C;++F)for(var L=S+F*p-y,P=N;P<E;++P){var z=T+P*f-g;R+=k.get(O,L,z,A)*_.get(O,F,P,M)}m.set(R,S,T,A,D)}return n.makeTensorInfo(m.shape,m.dtype,m.values)}};var q_={kernelName:yt,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.strides,s=r.dilations,u=r.pad,l=r.dimRoundingMode,c=r.inputShape;qk([a,i],"depthwiseConv2DNativeBackpropInput");for(var h=fe(a.shape),p=fe(i.shape),f=qo(c,i.shape,o,s,u,l,!0),d=new ea(f.inShape,"float32"),v=d.values,m=N(d.strides,3),g=m[0],y=m[1],b=m[2],x=n.data.get(a.dataId).values,k=N(h,3),w=k[0],_=k[1],S=k[2],I=n.data.get(i.dataId).values,C=N(p,3),T=C[0],E=C[1],M=C[2],A=f.batchSize,D=f.filterHeight,R=f.filterWidth,O=f.inChannels,F=f.inHeight,L=f.inWidth,P=f.outChannels,z=f.outHeight,B=f.outWidth,V=f.strideHeight,W=f.strideWidth,U=D-1-f.padInfo.top,H=R-1-f.padInfo.left,G=P/O,j=0;j<A;++j)for(var q=0;q<O;++q)for(var X=0;X<F;++X)for(var K=X-U,Y=Math.max(0,Math.ceil(K/V)),Z=Math.min(z,(D+K)/V),Q=0;Q<L;++Q){for(var $=Q-H,J=Math.max(0,Math.ceil($/W)),ee=Math.min(B,(R+$)/W),te=0,ne=Y;ne<Z;++ne)for(var re=ne*V-K,ae=J;ae<ee;++ae)for(var ie=w*j+_*ne+S*ae,oe=T*(D-1-re)+E*(R-1-(ae*W-$))+M*q,se=0;se<G;++se){te+=x[ie+(q*G+se)]*I[oe+se]}v[g*j+y*X+b*Q+q]=te}return n.makeTensorInfo(d.shape,d.dtype,d.values)}};var X_={kernelName:bt,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=t.x,a=K(r.shape),i=n.data.get(r.dataId).values,o=zi([a,a],r.dtype),s=o.values,u=0;u<i.length;u++)s[u*a+u]=i[u];var l=[].concat(I(r.shape),I(r.shape));return n.makeTensorInfo(l,o.dtype,o.values)}},K_={kernelName:xt,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,l=n,c=l.data.get(a.dataId).values,h=a.shape.length,p=l.data.get(i.dataId).values,f=i.shape.length,d=Ho(a.shape,i.shape,o,s,"NHWC",u),v=d.batchSize,m=d.inHeight,g=d.inWidth,y=d.inChannels,b=d.outHeight,x=d.outWidth,k=d.padInfo,w=d.strideHeight,_=d.strideWidth,S=d.filterHeight,I=d.filterWidth,C=d.dilationHeight,T=d.dilationWidth,N=d.outShape,E=K(N),M=N.length,A=ae(a.dtype,E),D=0;D<v;++D)for(var R=0;R<b;++R)for(var O=R*w-k.top,F=0;F<x;++F)for(var L=F*_-k.left,P=0;P<y;++P){for(var z=Number.MIN_SAFE_INTEGER,B=0;B<S;++B){var V=O+B*C;if(V>=0&&V<m)for(var W=0;W<I;++W){var U=L+W*T;if(U>=0&&U<g){var H=xe([D,V,U,P],h,fe(a.shape)),G=xe([B,W,P],f,fe(i.shape)),j=c[H]+p[G];j>z&&(z=j)}}}A[xe([D,R,F,P],M,fe(N))]=z}return{dataId:l.write(Or(A,a.dtype),N,a.dtype),shape:N,dtype:a.dtype}}},Y_={kernelName:wt,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,s=r.strides,u=r.pad,l=r.dilations,c=n,h=ve(a.shape,c.data.get(a.dataId).values),p=ve(i.shape,c.data.get(i.dataId).values),f=Ho(a.shape,i.shape,s,u,"NHWC",l),d=f.batchSize,v=f.inHeight,m=f.inWidth,g=f.inChannels,y=f.outHeight,b=f.outWidth,x=f.padInfo,k=f.strideHeight,w=f.strideWidth,_=f.filterHeight,S=f.filterWidth,I=f.dilationHeight,C=f.dilationWidth,T=f.outShape;G(o.rank===T.length,(function(){return"Error in ".concat(wt,", dy ")+"must have the same rank as output ".concat(T.length,", but got ")+"".concat(o.rank)}));for(var N=ve(T,c.data.get(o.dataId).values),E=ye(i.shape,i.dtype),M=0;M<d;++M)for(var A=0;A<y;++A)for(var D=A*k-x.top,R=0;R<b;++R)for(var O=R*w-x.left,F=0;F<g;++F){for(var L=Number.MIN_SAFE_INTEGER,P=0,z=0,B=0;B<_;++B){var V=D+B*I;if(V>=0&&V<v)for(var W=0;W<S;++W){var U=O+W*C;if(U>=0&&U<m){var H=h[M][V][U][F]+p[B][W][F];H>L&&(L=H,P=B,z=W)}}}E[P][z][F]+=N[M][A][R][F]}return{dataId:c.write(Or(E,a.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},Z_={kernelName:kt,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,s=r.strides,u=r.pad,l=r.dilations,c=n,h=ve(a.shape,c.data.get(a.dataId).values),p=ve(i.shape,c.data.get(i.dataId).values),f=Ho(a.shape,i.shape,s,u,"NHWC",l),d=f.batchSize,v=f.inHeight,m=f.inWidth,g=f.inChannels,y=f.outHeight,b=f.outWidth,x=f.padInfo,k=f.strideHeight,w=f.strideWidth,_=f.filterHeight,S=f.filterWidth,I=f.dilationHeight,C=f.dilationWidth,T=f.outShape;G(o.rank===T.length,(function(){return"Error in ".concat(kt,", dy ")+"must have the same rank as output ".concat(T.length,", but got ")+"".concat(o.rank)}));for(var N=ve(T,c.data.get(o.dataId).values),E=ye(a.shape,a.dtype),M=0;M<d;++M)for(var A=0;A<y;++A)for(var D=A*k-x.top,R=0;R<b;++R)for(var O=R*w-x.left,F=0;F<g;++F){for(var L=Number.MIN_SAFE_INTEGER,P=D<0?0:D,z=O<0?0:O,B=0;B<_;++B){var V=D+B*I;if(V>=0&&V<v)for(var W=0;W<S;++W){var U=O+W*C;if(U>=0&&U<m){var H=h[M][V][U][F]+p[B][W][F];H>L&&(L=H,P=V,z=U)}}}E[M][P][z][F]+=N[M][A][R][F]}return{dataId:c.write(Or(E,a.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}};var Q_={kernelName:It,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y;qk([r,a],"eluGrad");for(var i=new Float32Array(K(a.shape)),o=n.data.get(a.dataId).values,s=n.data.get(r.dataId).values,u=0;u<o.length;++u){var l=o[u];i[u]=l>=1?s[u]:s[u]*(l+1)}return n.makeTensorInfo(a.shape,"float32",i)}},$_=rw((function(e,t){return e===t?1:0})),J_=bw(Tt,$_,null,"bool"),eS={kernelName:Tt,backendName:"cpu",kernelFunc:J_},tS=Yk(Ct,(function(e){var t=Math.sign(e),n=Math.abs(e),r=1/(1+.3275911*n);return t*(1-((((1.061405429*r-1.453152027)*r+1.421413741)*r-.284496736)*r+.254829592)*r*Math.exp(-n*n))})),nS={kernelName:Ct,backendName:"cpu",kernelFunc:tS},rS=m_((function(e){return Math.exp(e)})),aS=Zk(Nt,rS),iS={kernelName:Nt,backendName:"cpu",kernelFunc:aS};function oS(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.input,i=r.dim,o=a.shape.length,s=a.shape.slice(),u=i;return i<0&&(G(-(o+1)<=i,(function(){return"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")})),u=o+i+1),s.splice(u,0,1),Iw({inputs:{x:a},backend:n,attrs:{shape:s}})}var sS={kernelName:Et,backendName:"cpu",kernelFunc:oS},uS=m_((function(e){return Math.expm1(e)})),lS=Zk(Mt,uS),cS={kernelName:Mt,backendName:"cpu",kernelFunc:lS},hS=rw((function(e,t){return e*t})),pS=xw((function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}})),fS=bw(yn,hS,pS),dS={kernelName:yn,backendName:"cpu",kernelFunc:fS},vS=rw((function(e,t){return e/t})),mS=bw(_t,vS),gS={kernelName:_t,backendName:"cpu",kernelFunc:mS},yS=rw((function(e,t){return e-t})),bS=xw((function(e,t,n,r){return{real:e-n,imag:t-r}})),xS=bw(or,yS,bS),kS={kernelName:or,backendName:"cpu",kernelFunc:xS};function wS(e,t,n){for(var r=e.shape,a=r[0],i=r[1],o=n.data.get(e.dataId),s=o.complexTensorInfos.real,u=o.complexTensorInfos.imag,l=[a,i],c=K(l),h=re("float32",c),p=re("float32",c),f=0;f<a;f++){for(var d=c_({inputs:{x:s},backend:n,attrs:{begin:[f,0],size:[1,i]}}),v=c_({inputs:{x:u},backend:n,attrs:{begin:[f,0],size:[1,i]}}),m=pw({inputs:{real:d,imag:v},backend:n}),g=_S(m,t,n),y=Bc(g.real,g.imag),b=0;b<i;b++){var x=Vc(y,b);h[f*i+b]=x.real,p[f*i+b]=x.imag}n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m)}var k=n.makeTensorInfo(l,"float32",h),w=n.makeTensorInfo(l,"float32",p),_=pw({inputs:{real:k,imag:w},backend:n});return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(w),_}function _S(e,t,n){var r=K(e.shape),a=n.data.get(e.dataId),i=n.data.get(a.complexTensorInfos.real.dataId).values,o=n.data.get(a.complexTensorInfos.imag.dataId).values;if(0===((g=r)&g-1)){var s=SS(i,o,r,t,n),u=[e.shape[0],e.shape[1]];if(t){var l=n.makeTensorInfo(u,"float32",s.real),c=n.makeTensorInfo(u,"float32",s.imag),h=n.makeTensorInfo([],"float32",Rr(r,"float32")),p=Jk({inputs:{x:h},backend:n}),f=gS.kernelFunc({inputs:{a:l,b:h},backend:n}),d=gS.kernelFunc({inputs:{a:c,b:p},backend:n}),v=n.data.get(f.dataId).values,m=n.data.get(d.dataId).values;return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),{real:v,imag:m}}return s}var g,y=function(e,t,n){for(var r=new Float32Array(2*t),a=0;a<t;a++){for(var i=0,o=0,s=0;s<t;s++){var u=Uc(a*s,t,n),l=Vc(e,s);i+=l.real*u.real-l.imag*u.imag,o+=l.real*u.imag+l.imag*u.real}n&&(i/=t,o/=t),Wc(r,i,o,a)}return r}(Bc(i,o),r,t);return function(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}(y)}function SS(e,t,n,r,a){if(1===n)return{real:e,imag:t};var i=Bc(e,t),o=n/2,s=function(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}(i),u=s.real,l=s.imag,c=[u.length],h=a.makeTensorInfo(c,"float32",u),p=a.makeTensorInfo(c,"float32",l),f=pw({inputs:{real:h,imag:p},backend:a}),d=function(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}(i),v=d.real,m=d.imag,g=[v.length],y=a.makeTensorInfo(g,"float32",v),b=a.makeTensorInfo(g,"float32",m),x=pw({inputs:{real:y,imag:b},backend:a}),k=SS(u,l,o,r,a),w=k.real,_=k.imag,S=[w.length],I=a.makeTensorInfo(S,"float32",w),C=a.makeTensorInfo(S,"float32",_),T=pw({inputs:{real:I,imag:C},backend:a}),N=SS(v,m,o,r,a),E=N.real,M=N.imag,A=[E.length],D=a.makeTensorInfo(A,"float32",E),R=a.makeTensorInfo(A,"float32",M),O=pw({inputs:{real:D,imag:R},backend:a}),F=function(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),a=0;a<Math.ceil(e/2);a++){var i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}(n,r),L=[F.real.length],P=a.makeTensorInfo(L,"float32",F.real),z=a.makeTensorInfo(L,"float32",F.imag),B=pw({inputs:{real:P,imag:z},backend:a}),V=fS({inputs:{a:B,b:O},backend:a}),W=_w({inputs:{a:T,b:V},backend:a}),U=xS({inputs:{a:T,b:V},backend:a}),H=vw({inputs:{input:W},backend:a}),G=vw({inputs:{input:U},backend:a}),j=S_({inputs:{input:W},backend:a}),q=S_({inputs:{input:U},backend:a}),X=C_({inputs:[H,G],backend:a,attrs:{axis:0}}),K=C_({inputs:[j,q],backend:a,attrs:{axis:0}}),Y=a.data.get(X.dataId).values,Z=a.data.get(K.dataId).values;return a.disposeIntermediateTensorInfo(h),a.disposeIntermediateTensorInfo(p),a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(y),a.disposeIntermediateTensorInfo(b),a.disposeIntermediateTensorInfo(x),a.disposeIntermediateTensorInfo(I),a.disposeIntermediateTensorInfo(C),a.disposeIntermediateTensorInfo(T),a.disposeIntermediateTensorInfo(D),a.disposeIntermediateTensorInfo(R),a.disposeIntermediateTensorInfo(O),a.disposeIntermediateTensorInfo(P),a.disposeIntermediateTensorInfo(z),a.disposeIntermediateTensorInfo(B),a.disposeIntermediateTensorInfo(V),a.disposeIntermediateTensorInfo(W),a.disposeIntermediateTensorInfo(U),a.disposeIntermediateTensorInfo(H),a.disposeIntermediateTensorInfo(j),a.disposeIntermediateTensorInfo(G),a.disposeIntermediateTensorInfo(q),a.disposeIntermediateTensorInfo(X),a.disposeIntermediateTensorInfo(K),{real:Y,imag:Z}}var IS={kernelName:At,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,a=K(r.shape),i=r.shape[r.shape.length-1],o=Iw({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),s=wS(o,!1,n),u=Iw({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}};function CS(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,i=n.dtype||ce(a),o=ae(i,K(r));return function(e,t,n){e.fill(t)}(o,a),t.makeTensorInfo(r,i,o)}var TS={kernelName:Dt,backendName:"cpu",kernelFunc:CS};var NS={kernelName:Rt,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=(e.attrs,e.backend),r=t.image,a=n,i=re(r.dtype,K(r.shape)),o=N(r.shape,4),s=o[0],u=o[1],l=o[2],c=o[3],h=a.data.get(r.dataId).values,p=0;p<s;p++)for(var f=p*l*u*c,d=0;d<u;d++)for(var v=d*(l*c),m=0;m<l;m++)for(var g=m*c,y=0;y<c;y++){var b=[s,d,m,y][2],x=Math.round(l-b),k=f+v+g+y,w=h[k];if(x>=0&&x<l)w=h[f+v+x*c+y];i[k]=w}return{dataId:a.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},ES=m_((function(e){return Math.floor(e)})),MS=Zk(Ot,ES),AS={kernelName:Ot,backendName:"cpu",kernelFunc:MS},DS=rw((function(e,t){return Math.floor(e/t)})),RS=bw(Ft,DS,null,"int32"),OS={kernelName:Ft,backendName:"cpu",kernelFunc:RS};var FS={kernelName:_r,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,l=r.pad,c=r.dataFormat,h=r.dilations,p=r.dimRoundingMode,f=r.activation,d=r.leakyreluAlpha,v=N_({inputs:{x:a,filter:i},backend:n,attrs:{strides:u,pad:l,dataFormat:c,dilations:h,dimRoundingMode:p}});if(o){var m=v;v=_w({inputs:{a:v,b:o},backend:n}),n.disposeIntermediateTensorInfo(m)}if(f){var g=v;v=hw(n,v,f,s,d),n.disposeIntermediateTensorInfo(g)}return v}};var LS={kernelName:Sr,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,l=r.pad,c=r.dataFormat,h=r.dilations,p=r.dimRoundingMode,f=r.activation,d=r.leakyreluAlpha,v=H_({inputs:{x:a,filter:i},backend:n,attrs:{strides:u,pad:l,dataFormat:c,dilations:h,dimRoundingMode:p}});if(o){var m=v;v=_w({inputs:{a:v,b:o},backend:n}),n.disposeIntermediateTensorInfo(m)}if(f){var g=v;v=hw(n,v,f,s,d),n.disposeIntermediateTensorInfo(g)}return v}};var PS={kernelName:zt,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,i=K(r.shape),o=a.shape,s=o[o.length-1],u=N(Tc(r,a),4),l=u[0],c=u[1],h=u[2],p=u[3];if(0===c)return n.makeTensorInfo(l,r.dtype,[]);for(var f=zi([c,h],r.dtype),d=n.data.get(a.dataId).values,v=n.data.get(r.dataId).values,m=0;m<c;m++){for(var g=[],y=0,b=0;b<s;b++){var x=d[m*s+b];y+=x*p[b],g.push(x)}if(y<0||y>=i/h)throw new Error("Invalid indices: ".concat(g," does not index into ").concat(r.shape));for(var k=0;k<h;k++)f.values[m*h+k]=v[y*h+k]}return n.makeTensorInfo(l,f.dtype,f.values)}};function zS(e,t,n){for(var r=zi(n,e.dtype),a=0;a<r.size;++a){var i=r.indexToLoc(a).slice(),o=i[0],s=i[2],u=t.locToIndex([o,s]);i[2]=t.values[u];var l=e.locToIndex(i);r.values[a]=e.values[l]}return r}var BS={kernelName:Pt,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.indices,o=r.axis,s=r.batchDims;qk([a,i],"gatherV2");var u=s;null==s&&(u=0);var l=K(i.shape),c=Gc(a,i,te(o,a.shape)[0],u),h=Iw({inputs:{x:a},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),p=Iw({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,l/c.batchSize]}}),f=[c.batchSize,c.outerSize,l/c.batchSize,c.sliceSize],d=n.bufferSync(p),v=zS(n.bufferSync(h),d,f);return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.makeTensorInfo(c.outputShape,v.dtype,v.values)}},VS=rw((function(e,t){return e>t?1:0})),WS=bw(Bt,VS,null,"bool"),US={kernelName:Bt,backendName:"cpu",kernelFunc:WS},HS=rw((function(e,t){return e>=t?1:0})),GS=bw(Vt,HS,null,"bool"),jS={kernelName:Vt,backendName:"cpu",kernelFunc:GS};var qS={kernelName:Ut,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,a=K(r.shape),i=r.shape[r.shape.length-1],o=Iw({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),s=wS(o,!0,n),u=Iw({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}},XS=Yk(Gt,(function(e){return Number.isFinite(e)?1:0}),"bool"),KS={kernelName:Gt,backendName:"cpu",kernelFunc:XS},YS=Yk(jt,(function(e){return Math.abs(e)===1/0?1:0}),"bool"),ZS={kernelName:jt,backendName:"cpu",kernelFunc:YS},QS=Yk(qt,(function(e){return Number.isNaN(e)?1:0}),"bool"),$S={kernelName:qt,backendName:"cpu",kernelFunc:QS},JS=rw((function(e,t){return e<t?1:0})),eI=bw(Kt,JS,null,"bool"),tI={kernelName:Kt,backendName:"cpu",kernelFunc:eI},nI=rw((function(e,t){return e<=t?1:0})),rI=bw(Yt,nI,null,"bool"),aI={kernelName:Yt,backendName:"cpu",kernelFunc:rI};function iI(e,t,n){var r=(t-e)/(n-1),a=ge(n,"float32");a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return a}var oI={kernelName:Zt,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=iI(n.start,n.stop,n.num);return t.makeTensorInfo([r.length],"float32",r)}},sI=m_((function(e){return Math.log(e)})),uI=Zk(Qt,sI),lI={kernelName:Qt,backendName:"cpu",kernelFunc:uI},cI=Yk($t,(function(e){return Math.log1p(e)})),hI={kernelName:$t,backendName:"cpu",kernelFunc:cI},pI=rw((function(e,t){return e&&t})),fI=bw(Jt,pI,null,"bool"),dI={kernelName:Jt,backendName:"cpu",kernelFunc:fI},vI=Yk(en,(function(e){return e?0:1}),"bool"),mI={kernelName:en,backendName:"cpu",kernelFunc:vI},gI=rw((function(e,t){return e||t})),yI=bw(tn,gI,null,"bool"),bI={kernelName:tn,backendName:"cpu",kernelFunc:yI};var xI={kernelName:nn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.depthRadius,o=r.bias,s=r.alpha,u=r.beta;qk(a,"LRN");var l=a.shape[3],c=l-1,h=n.data.get(a.dataId).values,p=K(a.shape),f=new Float32Array(p);function d(e){for(var t=e%l,n=e-t+Math.max(0,t-i),r=e-t+Math.min(t+i,c),a=0;n<=r;n++){var o=h[n];a+=o*o}return a}for(var v=0;v<p;v++){var m=d(v),g=h[v]*Math.pow(o+s*m,-u);f[v]=g}return n.makeTensorInfo(a.shape,a.dtype,f)}};var kI={kernelName:rn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,s=r.depthRadius,u=r.bias,l=r.alpha,c=r.beta;qk(o,"LRNGrad");for(var h=K(o.shape),p=o.shape[3],f=n.data.get(o.dataId).values,d=n.data.get(a.dataId).values,v=n.data.get(i.dataId).values,m=new Float32Array(h),g=h,y=0;y<g;y++){for(var b=y%p,x=y-b+Math.max(0,b-s),k=y-b+Math.min(p,b+s+1),w=0,_=x;_<k;_++)w+=Math.pow(d[_],2);w=l*w+u;for(var S=x;S<k;S++){var I=-2*l*c*d[S]*v[y]/w;y===S&&(I+=Math.pow(w,-c)),I*=f[y],m[S]+=I}}return n.makeTensorInfo(o.shape,a.dtype,m)}};function wI(e,t,n,r){for(var a=re(r,K(n)),i=0;i<a.length;++i){for(var o=i*t,s=e[o],u=0;u<t;++u){var l=e[o+u];l>s&&(s=l)}a[i]=s}return a}function _I(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reductionIndices,o=r.keepDims,s=n,u=a.shape,l=u.length,c=te(i,u),h=c,p=ru(h,l),f=s.data.get(a.dataId).values;if(null!=p){for(var d=new Array(l),v=0;v<d.length;v++)d[v]=u[p[v]];f=Pw(f,u,a.dtype,p,d),h=iu(h.length,l),u=d}qk(a,"max"),nu("max",h,l);var m=N(eu(u,h),2),g=m[0],y=wI(f,K(m[1]),g,a.dtype),b=s.write(y,g,a.dtype),x=g;o&&(x=d=tu(g,c));return{dataId:b,shape:x,dtype:a.dtype}}var SI={kernelName:an,backendName:"cpu",kernelFunc:_I},II=rw((function(e,t){return Math.max(e,t)})),CI=bw(on,II),TI={kernelName:on,backendName:"cpu",kernelFunc:CI};var NI={kernelName:sn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;qk(a,"maxPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;G(ns(o,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var l,c=Go(a.shape,i,o,1,s,u);if(1===c.filterWidth&&1===c.filterHeight&&Y(c.inShape,c.outShape))l=Jk({inputs:{x:a},backend:n});else{var h=n.data.get(a.dataId).values,p=fe(a.shape),f=t_(h,a.shape,a.dtype,p,c,"max");l=n.makeTensorInfo(c.outShape,a.dtype,f.values)}return l}};var EI={kernelName:ln,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode,l=r.dataFormat;qk(a,"maxPool3d");var c=jo(a.shape,i,o,1,s,u,l),h=r_(n.data.get(a.dataId).values,a.shape,a.dtype,fe(a.shape),c,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}};var MI={kernelName:cn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,l=r.dimRoundingMode;qk([a,i],"maxPool3DGrad");for(var c=jo(i.shape,o,s,1,u,l),h=function(e,t){for(var n=zi(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,l=t.effectiveFilterDepth,c=t.effectiveFilterHeight,h=t.effectiveFilterWidth,p=t.padInfo.front,f=t.padInfo.top,d=t.padInfo.left,v=0;v<t.batchSize;++v)for(var m=0;m<t.inChannels;++m)for(var g=0;g<t.outDepth;++g){for(var y=g*r-p,b=y;b<0;)b+=o;for(var x=Math.min(t.inDepth,l+y),k=0;k<t.outHeight;++k){for(var w=k*a-f,_=w;_<0;)_+=s;for(var S=Math.min(t.inHeight,c+w),I=0;I<t.outWidth;++I){for(var C=I*i-d,T=C;T<0;)T+=u;for(var N=Math.min(t.inWidth,h+C),E=Number.NEGATIVE_INFINITY,M=-1,A=b;A<x;A+=o)for(var D=A-y,R=_;R<S;R+=s)for(var O=R-w,F=T;F<N;F+=u){var L=F-C,P=e.get(v,A,R,F,m);P>=E&&(E=P,M=D*c*h+O*c+L)}n.set(M,v,g,k,I,m)}}}return n}(n.bufferSync(i),c),p=c.strideDepth,f=c.strideHeight,d=c.strideWidth,v=c.dilationDepth,m=c.dilationHeight,g=c.dilationWidth,y=c.effectiveFilterDepth,b=c.effectiveFilterHeight,x=c.effectiveFilterWidth,k=y-1-c.padInfo.front,w=x-1-c.padInfo.left,_=b-1-c.padInfo.top,S=zi(i.shape,"float32"),I=n.bufferSync(a),C=0;C<c.batchSize;++C)for(var T=0;T<c.inChannels;++T)for(var N=0;N<c.inDepth;++N)for(var E=0;E<c.inHeight;++E)for(var M=0;M<c.inWidth;++M){for(var A=N-k,D=E-_,R=M-w,O=0,F=0;F<y;F+=v){var L=(A+F)/p;if(!(L<0||L>=c.outDepth||Math.floor(L)!==L))for(var P=0;P<b;P+=m){var z=(D+P)/f;if(!(z<0||z>=c.outHeight||Math.floor(z)!==z))for(var B=0;B<x;B+=g){var V=(R+B)/d;if(!(V<0||V>=c.outWidth||Math.floor(V)!==V)){var W=y*b*x-1-h.get(C,L,z,V,T)===F*b*x+P*x+B?1:0;if(0!==W)O+=I.get(C,L,z,V,T)*W}}}}S.set(O,C,N,E,M,T)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}};var AI={kernelName:un,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;qk([i,t.output],"maxPoolGrad");for(var s=r.filterSize,u=r.strides,l=r.pad,c=r.dimRoundingMode,h=Go(o.shape,s,u,1,l,c),p=n.data.get(o.dataId).values,f=zi(h.outShape,o.dtype,n_(p,o.shape,o.dtype,h).values),d=h.strideHeight,v=h.strideWidth,m=h.dilationHeight,g=h.dilationWidth,y=h.effectiveFilterHeight,b=h.effectiveFilterWidth,x=b-1-h.padInfo.left,k=y-1-h.padInfo.top,w=zi(o.shape,"float32"),_=n.data.get(a.dataId).values,S=zi(a.shape,"float32",_),I=0;I<h.batchSize;++I)for(var C=0;C<h.inChannels;++C)for(var T=0;T<h.inHeight;++T)for(var N=0;N<h.inWidth;++N){for(var E=T-k,M=N-x,A=0,D=0;D<y;D+=m){var R=(E+D)/d;if(!(R<0||R>=h.outHeight||Math.floor(R)!==R))for(var O=0;O<b;O+=g){var F=(M+O)/v;if(!(F<0||F>=h.outWidth||Math.floor(F)!==F)){var L=y*b-1-f.get(I,R,F,C)===D*b+O?1:0;if(0!==L)A+=S.get(I,R,F,C)*L}}}w.set(A,I,T,N,C)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};var DI={kernelName:hn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.filterSize,o=n.strides,s=n.pad,u=n.includeBatchInIndex,l=r;qk(a,"MaxPoolWithArgmax");var c=l.data.get(a.dataId).values,h=Go(a.shape,i,o,[1,1],s),p=function(e,t,n,r,a){var i=t_(e,0,n,fe(t),a,"max"),o=n_(e,t,n,a,!0,r);return[i.values,o.values]}(c,a.shape,a.dtype,u,h),f=N(p,2),d=f[0],v=f[1],m=l.write(d,h.outShape,a.dtype),g=l.write(v,h.outShape,a.dtype);return[{dataId:m,shape:h.outShape,dtype:a.dtype},{dataId:g,shape:h.outShape,dtype:"int32"}]}};function RI(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.axis,s=a.keepDims;qk(i,"sum");var u=(t="bool"===i.dtype?gw({inputs:{x:i},backend:r,attrs:{dtype:"int32"}}):Jk({inputs:{x:i},backend:r})).shape.length,l=te(o,t.shape),c=ru(l,u),h=l,p=t;null!=c&&(p=zw({inputs:{x:t},backend:r,attrs:{perm:c}}),h=iu(h.length,u)),nu("sum",h,p.shape.length);for(var f=N(eu(p.shape,h),2),d=f[0],v=f[1],m=dw(r,d,pa(p.dtype,"int32")),g=K(v),y=r.data.get(m.dataId).values,b=r.data.get(p.dataId).values,x=0;x<y.length;++x){for(var k=x*g,w=0,_=0;_<g;++_)w+=b[k+_];y[x]=w}if(s){var S=m;m=Iw({inputs:{x:m},backend:r,attrs:{shape:tu(m.shape,l)}}),r.disposeIntermediateTensorInfo(S)}return r.disposeIntermediateTensorInfo(t),null!=c&&r.disposeIntermediateTensorInfo(p),m}var OI={kernelName:er,backendName:"cpu",kernelFunc:RI};var FI={kernelName:pn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=te(i,a.shape),u=K(eu(a.shape,s)[1]),l=[],c=n.makeTensorInfo([],"float32",new Float32Array([u]));l.push(c);var h=gw({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});l.push(h);var p=mS({inputs:{a:h,b:c},backend:n});l.push(p);var f=RI({inputs:{x:p},backend:n,attrs:{axis:i,keepDims:o}});return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),f}};var LI={kernelName:fn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;qk(a,"min");var s=te(i,a.shape),u=s,l=ru(u,a.shape.length),c=a;null!=l&&(c=zw({inputs:{x:a},backend:n,attrs:{perm:l}}),u=iu(u.length,a.shape.length)),nu("min",u,c.shape.length);for(var h=N(eu(c.shape,u),2),p=h[0],f=K(h[1]),d=ge(K(p),c.dtype),v=n.data.get(c.dataId).values,m=0;m<d.length;++m){for(var g=m*f,y=v[g],b=0;b<f;++b){var x=v[g+b];x<y&&(y=x)}d[m]=y}null!=l&&n.disposeIntermediateTensorInfo(c);var k=n.makeTensorInfo(p,c.dtype,d);if(o){var w=Iw({inputs:{x:k},backend:n,attrs:{shape:tu(p,s)}});return n.disposeIntermediateTensorInfo(k),w}return k}},PI=rw((function(e,t){return Math.min(e,t)})),zI=bw(dn,PI),BI={kernelName:dn,backendName:"cpu",kernelFunc:zI};var VI={kernelName:vn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.mode;qk(a,"mirrorPad");for(var s=i.map((function(e,t){return e[0]+a.shape[t]+e[1]})),u=i.map((function(e){return e[0]})),l=i.map((function(e,t){return e[0]+a.shape[t]})),c="reflect"===o?0:1,h=n.data.get(a.dataId).values,p=a.shape.length,f=fe(a.shape),d=K(s),v=s.length,m=fe(s),g=re(a.dtype,d),y=0;y<d;y++){for(var b=ke(y,v,m),x=0;x<v;x++)b[x]<u[x]?b[x]=2*u[x]-b[x]-c:b[x]>=l[x]&&(b[x]=2*(l[x]-1)-b[x]+c);b=b.map((function(e,t){return e-u[t]}));var k=xe(b,p,f);g[y]=h[k]}return{dataId:n.write(g,s,a.dtype),shape:s,dtype:a.dtype}}},WI=rw((function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})),UI=bw(mn,WI),HI={kernelName:mn,backendName:"cpu",kernelFunc:UI},GI=n(8598);function jI(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.dim,o=a.shape.length,s=i;if(-1===s&&(s=o-1),s!==o-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(o," and dim was ").concat(s));var u=te([s],a.shape),l=_I({inputs:{x:a},backend:n,attrs:{reductionIndices:u,keepDims:!1}}),c=tu(l.shape,u),h=Iw({inputs:{x:l},backend:n,attrs:{shape:c}}),p=xS({inputs:{a:a,b:h},backend:n}),f=aS({inputs:{x:p},backend:n}),d=RI({inputs:{x:f},backend:n,attrs:{axis:u,keepDims:!1}}),v=Iw({inputs:{x:d},backend:n,attrs:{shape:c}}),m=mS({inputs:{a:f,b:v},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(v),m}var qI={kernelName:rr,backendName:"cpu",kernelFunc:jI};var XI={kernelName:gn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,s=r.normalized;qk(a,"multinomial");for(var u=s?a:jI({inputs:{logits:a},backend:n,attrs:{dim:-1}}),l=u.shape[0],c=u.shape[1],h=n.data.get(u.dataId).values,p=[l,i],f=ge(K(p),"int32"),d=0;d<l;++d){var v=d*c,m=new Float32Array(c-1);m[0]=h[v];for(var g=1;g<m.length;++g)m[g]=m[g-1]+h[v+g];for(var y=GI.alea(o.toString()),b=d*i,x=0;x<i;++x){var k=y();f[b+x]=m.length;for(var w=0;w<m.length;w++)if(k<m[w]){f[b+x]=w;break}}}return s||n.disposeIntermediateTensorInfo(u),n.makeTensorInfo(p,"int32",f)}};function KI(e,t,n){var r=Rr(-1,n);return hS([],t,r,e,n)}var YI={kernelName:bn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x;qk(r,"neg");var a=N(KI(n.data.get(r.dataId).values,r.shape,r.dtype),2),i=a[0],o=a[1];return n.makeTensorInfo(o,r.dtype,i)}},ZI=Sl;var QI={kernelName:kn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold;qk(a,"NonMaxSuppression");var l=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,h=ZI(l,c,o,s,u).selectedIndices;return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},$I=Il;var JI={kernelName:wn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,l=r.padToMaxOutputSize;qk(a,"NonMaxSuppressionPadded");var c=n.data.get(a.dataId).values,h=n.data.get(i.dataId).values,p=$I(c,h,o,s,u,l),f=p.selectedIndices,d=p.validOutputs;return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([],"int32",new Int32Array([d]))]}},eC=Cl;var tC={kernelName:_n,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,l=r.softNmsSigma;qk(a,"NonMaxSuppressionWithScore");var c=n.data.get(a.dataId).values,h=n.data.get(i.dataId).values,p=eC(c,h,o,s,u,l),f=p.selectedIndices,d=p.selectedScores;return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([d.length],"float32",new Float32Array(d))]}},nC=rw((function(e,t){return e!==t?1:0})),rC=bw(xn,nC,null,"bool"),aC={kernelName:xn,backendName:"cpu",kernelFunc:rC};var iC={kernelName:In,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=r.depth,o=r.onValue,s=r.offValue;qk(a,"oneHot");var u=K(a.shape),l=new Float32Array(u*i);l.fill(s);for(var c=n.data.get(a.dataId).values,h=0;h<u;++h)c[h]>=0&&c[h]<i&&(l[h*i+c[h]]=o);return n.makeTensorInfo([].concat(I(a.shape),[i]),"int32",l)}};function oC(e){var t=e.inputs,n=e.backend,r=t.x;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){var a=vw({inputs:{input:r},backend:n}),i=oC({inputs:{x:a},backend:n}),o=S_({inputs:{input:r},backend:n}),s=oC({inputs:{x:o},backend:n}),u=pw({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}return CS({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var sC={kernelName:yr,backendName:"cpu",kernelFunc:oC};var uC={kernelName:Sn,backendName:"cpu",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===a.dtype){var i=vw({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),s=S_({inputs:{input:a},backend:r}),u=oC({inputs:{x:s},backend:r}),l=pw({inputs:{real:o,imag:u},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),l}return CS({backend:r,attrs:{shape:a.shape,value:1,dtype:a.dtype}})}};function lC(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return oS({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,i=t[0].dtype;t.forEach((function(e){j(a,e.shape,"All tensors passed to stack must have matching shapes"),G(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=[],s=C_({inputs:t.map((function(e){var t=oS({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t})),backend:n,attrs:{axis:r}});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),s}var cC={kernelName:Cn,backendName:"cpu",kernelFunc:lC};var hC={kernelName:Tn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.constantValue;qk(a,"pad");var s=i.map((function(e,t){return e[0]+a.shape[t]+e[1]})),u=i.map((function(e){return e[0]})),l=n.data.get(a.dataId).values,c=K(a.shape),h=a.shape.length,p=fe(a.shape),f=K(s),d=s.length,v=fe(s),m=re(a.dtype,f);0!==o&&m.fill(o);for(var g=0;g<c;g++){m[xe(ke(g,h,p).map((function(e,t){return e+u[t]})),d,v)]=l[g]}return{dataId:n.write(m,s,a.dtype),shape:s,dtype:a.dtype}}},pC=rw((function(e,t){return Math.pow(e,t)})),fC=bw(Nn,pC),dC={kernelName:Nn,backendName:"cpu",kernelFunc:fC};function vC(e,t,n,r){for(var a=N(eu(e,r),2),i=a[0],o=a[1],s=pa(t,"int32"),u=ge(K(i),s),l=K(o),c=0;c<u.length;++c){for(var h=c*l,p=1,f=0;f<l;++f)p*=n[h+f];u[c]=p}return{outVals:u,outShape:i,outDtype:s}}var mC={kernelName:Mn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;qk(a,"prod");var s=a.shape.length,u=te(i,a.shape),l=ru(u,s),c=u,h=a,p=[];null!=l&&(h=zw({inputs:{x:a},backend:n,attrs:{perm:l}}),p.push(h),c=iu(c.length,s));var f=n.data.get(h.dataId).values,d=vC(h.shape,h.dtype,f,c),v=d.outVals,m=d.outShape,g=d.outDtype,y=m;return o&&(y=tu(m,u)),p.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(y,g,v)}};function gC(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return ge(0,r);var a=ge(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return a}var yC={kernelName:An,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.dtype,o=gC(r,a,n.step,i);return t.makeTensorInfo([o.length],i,o)}},bC=Yk(Rn,(function(e){return 1/e})),xC={kernelName:Rn,backendName:"cpu",kernelFunc:bC};var kC={kernelName:zn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=r.size;qk(a,"resizeBilinear");for(var u=fe(a.shape),l=N(s,2),c=l[0],h=l[1],p=N(a.shape,4),f=p[0],d=p[1],v=p[2],m=p[3],g=n.data.get(a.dataId).values,y=new Float32Array(K([f,c,h,m])),b=[i&&c>1?d-1:d,i&&h>1?v-1:v],x=[i&&c>1?c-1:c,i&&h>1?h-1:h],k=0,w=b[0]/x[0],_=b[1]/x[1],S=0;S<f;S++)for(var I=0;I<c;I++){var C=void 0;C=o?w*(I+.5)-.5:w*I;for(var T=Math.max(0,Math.floor(C)),E=C-T,M=Math.min(d-1,Math.ceil(C)),A=S*u[0]+T*u[1],D=S*u[0]+M*u[1],R=0;R<h;R++){var O=void 0;O=o?_*(R+.5)-.5:_*R;for(var F=Math.max(0,Math.floor(O)),L=O-F,P=Math.min(v-1,Math.ceil(O)),z=A+F*u[2],B=D+F*u[2],V=A+P*u[2],W=D+P*u[2],U=0;U<m;U++){var H=g[z+U],G=g[B+U],j=H+(g[V+U]-H)*L,q=j+(G+(g[W+U]-G)*L-j)*E;y[k++]=q}}}return n.makeTensorInfo([f,c,h,m],"float32",y)}};var wC={kernelName:Bn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners;qk([i,a],"resizeBilinearGrad");for(var s=fe(a.shape),u=N(a.shape,4),l=u[0],c=u[1],h=u[2],p=u[3],f=N(i.shape,3),d=f[1],v=f[2],m=new Float32Array(l*c*h*p),g=[o&&d>1?c-1:c,o&&v>1?h-1:h],y=[o&&d>1?d-1:d,o&&v>1?v-1:v],b=g[0]/y[0],x=g[1]/y[1],k=n.data.get(i.dataId).values,w=0,_=0;_<l;_++)for(var S=_*s[0],I=0;I<d;I++)for(var C=I*b,T=Math.floor(C),E=Math.min(Math.ceil(C),c-1),M=S+T*s[1],A=S+E*s[1],D=C-T,R=1-D,O=0;O<v;O++)for(var F=O*x,L=Math.floor(F),P=Math.min(Math.ceil(F),h-1),z=F-L,B=1-z,V=M+L*s[2],W=M+P*s[2],U=A+L*s[2],H=A+P*s[2],G=R*B,j=R*z,q=D*B,X=D*z,K=0;K<p;K++){var Y=k[w++];m[V+K]+=Y*G,m[W+K]+=Y*j,m[U+K]+=Y*q,m[H+K]+=Y*X}return n.makeTensorInfo([l,h,c,p],"float32",m)}};var _C={kernelName:Ln,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=r.size;qk(a,"resizeNearestNeighbor");for(var u=fe(a.shape),l=N(s,2),c=l[0],h=l[1],p=N(a.shape,4),f=p[0],d=p[1],v=p[2],m=p[3],g=n.data.get(a.dataId).values,y=new Float32Array(f*c*h*m),b=[i&&c>1?d-1:d,i&&h>1?v-1:v],x=[i&&c>1?c-1:c,i&&h>1?h-1:h],k=b[0]/x[0],w=b[1]/x[1],_=0,S=0;S<f;S++)for(var I=S*u[0],C=0;C<c;C++){var T=o?k*(C+.5):k*C,E=Math.min(d-1,i?Math.round(T):Math.floor(T));o&&(E=Math.max(0,E));for(var M=I+E*u[1],A=0;A<h;A++){var D=o?w*(A+.5):w*A,R=Math.min(v-1,i?Math.round(D):Math.floor(D));o&&(R=Math.max(0,R));for(var O=M+R*u[2],F=0;F<m;F++){var L=g[O+F];y[_++]=L}}}return n.makeTensorInfo([f,c,h,m],a.dtype,y)}};var SC={kernelName:Pn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners;qk([i,a],"resizeNearestNeighborGrad");for(var s=fe(a.shape),u=fe(i.shape),l=N(a.shape,4),c=l[0],h=l[1],p=l[2],f=l[3],d=N(i.shape,3),v=d[1],m=d[2],g=new Float32Array(c*h*p*f),y=n.data.get(i.dataId).values,b=[o&&v>1?h-1:h,o&&m>1?p-1:p],x=[o&&v>1?v-1:v,o&&m>1?m-1:m],k=b[0]/x[0],w=b[1]/x[1],_=1/k,S=1/w,I=2*Math.ceil(_)+2,C=2*Math.ceil(S)+2,T=0;T<c;T++)for(var E=T*s[0],M=0;M<h;M++)for(var A=E+M*s[1],D=Math.floor(M*_),R=Math.floor(D-I/2),O=0;O<p;O++)for(var F=A+O*s[2],L=Math.floor(O*S),P=Math.floor(L-C/2),z=0;z<f;z++){for(var B=0,V=0;V<I;V++){var W=V+R;if(!(W<0||W>=v)){var U=E+W*u[1],H=W*k;if(M===Math.min(h-1,o?Math.round(H):Math.floor(H)))for(var G=0;G<C;G++){var j=G+P;if(!(j<0||j>=m)){var q=U+j*u[2],X=j*w;O===Math.min(p-1,o?Math.round(X):Math.floor(X))&&(B+=y[q+z])}}}}g[F+z]=B}return n.makeTensorInfo(a.shape,a.dtype,g)}};var IC={kernelName:Wn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dims;qk(a,"reverse");var o=a.shape.length,s=te(i,a.shape);if(0===o)return Jk({inputs:{x:a},backend:n});for(var u=new ea(a.shape,a.dtype),l=n.bufferSync(a),c=function(e){var t=u.indexToLoc(e),n=t.slice();s.forEach((function(e){return n[e]=a.shape[e]-1-n[e]})),u.set.apply(u,[l.get.apply(l,I(n))].concat(I(t)))},h=0;h<u.size;h++)c(h);return n.makeTensorInfo(u.shape,u.dtype,u.values)}},CC={kernelName:kr,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=n.radians,o=n.fillValue,s=n.center,u=r,l=re(a.dtype,K(a.shape)),c=N(a.shape,4),h=c[0],p=c[1],f=c[2],d=c[3],v=N(kc(s,p,f),2),m=v[0],g=v[1],y=Math.sin(i),b=Math.cos(i),x=u.data.get(a.dataId).values,k=0;k<h;k++)for(var w=k*f*p*d,_=0;_<p;_++)for(var S=_*(f*d),I=0;I<f;I++)for(var C=I*d,T=0;T<d;T++){var E=[h,_,I,T],M=E[2],A=E[1],D=(M-m)*b-(A-g)*y,R=(M-m)*y+(A-g)*b;D=Math.round(D+m),R=Math.round(R+g);var O=o;if("number"!==typeof o&&(O=3===T?255:o[T]),D>=0&&D<f&&R>=0&&R<p)O=x[w+R*(f*d)+D*d+T];l[w+S+C+T]=O}return{dataId:u.write(l,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},TC=Yk(Un,(function(e){var t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1})),NC={kernelName:Un,backendName:"cpu",kernelFunc:TC},EC=m_((function(e){return 1/Math.sqrt(e)})),MC=Zk(Hn,EC),AC={kernelName:Hn,backendName:"cpu",kernelFunc:MC};function DC(e,t,n,r,a,i,o,s,u,l){var c=[r/a,a],h=e.values,p=t.values;if(0===r)return zi(n,t.dtype);var f=zi(c,t.dtype);f.values.fill(u);for(var d=0;d<i;d++){for(var v=[],m=0,g=0;g<o;g++){var y=h[d*o+g];v.push(y),m+=y*s[g]}if(m<0||m>=r/a)throw new Error("Invalid indices: ".concat(v," does not index into ").concat(n));for(var b=0;b<a;b++)l?f.values[m*a+b]+=p[d*a+b]:f.values[m*a+b]=0===t.rank?p[0]:p[d*a+b]}return f}var RC={kernelName:Gn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=t.updates,o=r.shape,s=Ec(0,a,o),u=s.sliceRank,l=s.numUpdates,c=s.sliceSize,h=s.strides,p=s.outputSize,f=DC(n.bufferSync(a),n.bufferSync(i),o,p,c,l,u,h,0,!0);return n.makeTensorInfo(o,f.dtype,f.values)}};var OC={kernelName:jn,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,i=t.e;qk([r,a,i],"select");for(var o=r.shape.length,s=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,c=pa(a.dtype,i.dtype),h=ge(K(a.shape),c),p=0,f=0===o||o>1||1===a.shape.length?1:K(a.shape.slice(1)),d=0;d<s.length;d++)for(var v=0;v<f;v++)1===s[d]?h[p++]=u[d]:h[p++]=l[d];return n.makeTensorInfo(a.shape,c,h)}},FC=Yk(qn,(function(e){return e>=0?1.0507009873554805*e:1.7580993408473768*(Math.exp(e)-1)})),LC={kernelName:qn,backendName:"cpu",kernelFunc:FC},PC=Yk(Qn,(function(e){return 1/(1+Math.exp(-e))})),zC={kernelName:Qn,backendName:"cpu",kernelFunc:PC},BC=Yk(Zn,(function(e){return e<0?-1:e>0?1:0})),VC={kernelName:Zn,backendName:"cpu",kernelFunc:BC},WC=Yk(Kn,(function(e){return Math.sin(e)})),UC={kernelName:Kn,backendName:"cpu",kernelFunc:WC},HC=Yk(Yn,(function(e){return Math.sinh(e)})),GC={kernelName:Yn,backendName:"cpu",kernelFunc:HC},jC=Math.log(1.1920928955078125e-7)+2,qC=Yk($n,(function(e){var t=e>-jC,n=e<jC,r=Math.exp(e);return n?r:t?e:Math.log(1+r)})),XC={kernelName:$n,backendName:"cpu",kernelFunc:qC};var KC={kernelName:tr,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.paddings;qk([a],"spaceToBatchND");var s=K(i),u=[[0,0]];u.push.apply(u,I(o));for(var l=1+i.length;l<a.shape.length;++l)u.push([0,0]);var c=hC.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:u,constantValue:0}}),h=wc(c.shape,i,s,!1),p=_c(h.length,i.length,!1),f=Sc(c.shape,i,s,!1),d=Iw({inputs:{x:c},backend:n,attrs:{shape:h}}),v=zw({inputs:{x:d},backend:n,attrs:{perm:p}}),m=Iw({inputs:{x:v},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(v),m}};var YC={kernelName:sr,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sparseIndices,i=t.sparseValues,o=t.defaultValue,s=r.outputShape,u=Ec(0,a,s),l=u.sliceRank,c=u.numUpdates,h=u.sliceSize,p=u.strides,f=u.outputSize,d=DC(n.bufferSync(a),n.bufferSync(i),s,f,h,c,l,p,n.data.get(o.dataId).values[0],!1);return n.makeTensorInfo(s,d.dtype,d.values)}};var ZC={kernelName:nr,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.numOrSizeSplits,o=te(r.axis,a.shape)[0],s=Hc(a,i,o),u=new Array(a.shape.length).fill(0),l=a.shape.slice();return s.map((function(e){var t=I(l);t[o]=e;var r=c_({inputs:{x:a},backend:n,attrs:{begin:u,size:t}});return u[o]+=e,r}))}},QC=Yk(Jn,(function(e){return Math.sqrt(e)})),$C={kernelName:Jn,backendName:"cpu",kernelFunc:QC},JC={kernelName:ir,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n;qk(r,"square");for(var i=a.data.get(r.dataId).values,o=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];o[s]=u*u}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},eT=rw((function(e,t){var n=e-t;return n*n})),tT=bw(ar,eT),nT={kernelName:ar,backendName:"cpu",kernelFunc:tT},rT=Yk(br,(function(e,t){var n=t;return isNaN(e)?NaN:e>0?1:n.alpha})),aT={kernelName:br,backendName:"cpu",kernelFunc:rT};function iT(e,t,n,r){for(var a=zi(e,t.dtype),i=0;i<a.size;i++){for(var o=a.indexToLoc(i),s=new Array(o.length),u=0;u<s.length;u++)s[u]=o[u]*n[u]+r[u];a.set.apply(a,[t.get.apply(t,s)].concat(I(o)))}return a}var oT={kernelName:ur,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.begin,o=r.end,s=r.strides,u=r.beginMask,l=r.endMask,c=r.ellipsisMask,h=r.newAxisMask,p=r.shrinkAxisMask;qk(a,"stridedSlice");var f,d=So(a.shape,i,o,s,u,l,c,h,p),v=d.nonStrided,m=d.$begin,g=d.$strides,y=d.size,b=d.newShape,x=d.outShape,k=Iw({inputs:{x:a},backend:n,attrs:{shape:b}});if(v){var w=c_({inputs:{x:k},backend:n,attrs:{begin:m,size:y}});f=Iw({inputs:{x:w},backend:n,attrs:{shape:x}}),n.disposeIntermediateTensorInfo(w)}else if(x.some((function(e){return 0===e})))f=n.makeTensorInfo(x,a.dtype,[]);else{var _=iT(x,n.bufferSync(k),g,m);f=n.makeTensorInfo(_.shape,_.dtype,_.values)}var S=Iw({inputs:{x:f},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(f),S}},sT=Yk(lr,(function(e){return Math.tan(e)})),uT={kernelName:lr,backendName:"cpu",kernelFunc:sT},lT=Yk(cr,(function(e){return Math.tanh(e)}));function cT(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];for(var a=zi(n,e.dtype),i=0;i<a.values.length;++i){for(var o=a.indexToLoc(i),s=new Array(e.rank),u=0;u<s.length;u++)s[u]=o[u]%e.shape[u];var l=e.locToIndex(s);a.values[i]=e.values[l]}return a}var hT={kernelName:hr,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;qk(a,"tile");var o=cT(n.bufferSync(a),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}};function pT(e,t,n,r,a){for(var i=t[t.length-1],o=e.length/i,s=i,u=re(n,o*r),l=re("int32",o*r),c=0;c<o;c++){for(var h=c*s,p=e.subarray(h,h+s),f=[],d=0;d<p.length;d++)f.push({value:p[d],index:d});f.sort((function(e,t){return t.value-e.value}));for(var v=c*r,m=u.subarray(v,v+r),g=l.subarray(v,v+r),y=0;y<r;y++)m[y]=f[y].value,g[y]=f[y].index}var b=t.slice();return b[b.length-1]=r,[zi(b,n,u),zi(b,"int32",l)]}var fT={kernelName:pr,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.k;r.sorted,qk(a,"topk");var o=N(pT(n.data.get(a.dataId).values,a.shape,a.dtype,i),2),s=o[0],u=o[1];return[n.makeTensorInfo(s.shape,s.dtype,s.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}};var dT={kernelName:fr,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=t.transforms,o=n.interpolation,s=n.fillMode,u=n.fillValue,l=n.outputShape,c=N(a.shape,4),h=c[0],p=c[1],f=c[2],d=c[3],v=N(null!=l?l:[p,f],2),m=v[0],g=v[1],y=[h,m,g,d],b=fe(a.shape),x=b[0],k=b[1],w=b[2],_=re(a.dtype,K(y));_.fill(u);for(var S=r.data.get(a.dataId).values,I=r.data.get(i.dataId).values,C=0;C<h;++C){for(var T=1===i.shape[0]?I:I.subarray(8*C,8*C+8),E=0;E<m;++E)for(var M=0;M<g;++M)for(var A=0;A<d;++A){var D=void 0,R=T[6]*M+T[7]*E+1;if(0!==R){var O=(T[0]*M+T[1]*E+T[2])/R,F=(T[3]*M+T[4]*E+T[5])/R,L=vT(O,f,s),P=vT(F,p,s);switch(o){case"nearest":D=gT(S,p,f,x,k,w,C,P,L,A,u);break;case"bilinear":D=yT(S,p,f,x,k,w,C,P,L,A,u);break;default:throw new Error("Error in Transform: Expect 'nearest' or "+"'bilinear', but got ".concat(o))}_[C*x+E*k+M*w+A]=D}}return r.makeTensorInfo(y,a.dtype,_)}return{dataId:r.write(_,y,a.dtype),shape:a.shape,dtype:a.dtype}}};function vT(e,t,n){switch(n){case"reflect":return function(e,t){var n=e;if(n<0)if(t<=1)n=0;else{var r=2*t;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-t?n+r:-n-1}else if(n>t-1)if(t<=1)n=0;else{var a=2*t;(n-=a*Math.trunc(n/a))>=t&&(n=a-n-1)}return W(0,n,t-1)}(e,t);case"wrap":return function(e,t){var n=e;if(n<0)if(t<=1)n=0;else{var r=t-1;n+=t*(Math.trunc(-n/r)+1)}else if(n>t-1)if(t<=1)n=0;else{var a=t-1;n-=t*Math.trunc(n/a)}return W(0,n,t-1)}(e,t);case"nearest":return function(e,t){return W(0,e,t-1)}(e,t);default:return function(e,t){return e}(e)}}function mT(e,t,n,r,a,i,o,s,u,l,c){return 0<=s&&s<t&&0<=u&&u<n?e[o*r+s*a+u*i+l]:c}function gT(e,t,n,r,a,i,o,s,u,l,c){return mT(e,t,n,r,a,i,o,Math.round(s),Math.round(u),l,c)}function yT(e,t,n,r,a,i,o,s,u,l,c){var h=Math.floor(s),p=Math.floor(u),f=h+1,d=p+1;return(f-s)*((d-u)*mT(e,t,n,r,a,i,o,h,p,l,c)+(u-p)*mT(e,t,n,r,a,i,o,h,d,l,c))+(s-h)*((d-u)*mT(e,t,n,r,a,i,o,f,p,l,c)+(u-p)*mT(e,t,n,r,a,i,o,f,d,l,c))}function bT(e,t,n,r){for(var a=te(t,n)[0],i=[1,n[0],1],o=0;o<a;o++)i[0]*=n[o];i[1]=n[a];for(var s=a+1;s<n.length;s++)i[2]*=n[s];for(var u={},l=new Int32Array(n[a]),c=new ea(i,r,e),h=[],p=1===i[0]&&1===i[2],f=0;f<n[a];f++){var d=void 0;if(p)d=e[f].toString();else{for(var v=[],m=0;m<i[0];m++)for(var g=0;g<i[2];g++)v.push(c.get(m,f,g));d=v.join(",")}if(void 0!==u[d])l[f]=u[d];else{var y=Object.keys(u).length;u[d]=y,l[f]=y,h.push(f)}}var b=i.slice();b[1]=Object.keys(u).length;var x=new ea(b,r);h.forEach((function(e,t){for(var n=0;n<i[0];n++)for(var r=0;r<i[2];r++)x.set(c.get(n,e,r),n,t,r)}));var k=n.slice();return k[a]=b[1],{outputValues:x.values,outputShape:k,indices:l}}var xT={kernelName:vr,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;qk(i,"unique");var o=bT(r.data.get(i.dataId).values,a,i.shape,i.dtype),s=o.outputValues,u=o.outputShape,l=o.indices;return[r.makeTensorInfo(u,i.dtype,s),r.makeTensorInfo([l.length],"int32",l)]}};var kT={kernelName:mr,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a.shape.length,s=a.shape[i],u=new Array(o-1),l=0,c=0;c<o;c++)c!==i&&(u[l++]=a.shape[c]);var h=new Array(o).fill(0),p=a.shape.slice();p[i]=1;for(var f=new Array(s),d=0;d<f.length;d++){h[i]=d;var v=c_({inputs:{x:a},backend:n,attrs:{begin:h,size:p}});f[d]=Iw({inputs:{x:v},backend:n,attrs:{shape:u}}),n.disposeIntermediateTensorInfo(v)}return f}};for(var wT={kernelName:gr,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.segmentIds,o=r.numSegments;qk(a,"unsortedSegmentSum");for(var s=[],u=[],l=a.shape.length-i.shape.length,c=i,h=0;h<l;++h){var p=oS({inputs:{input:c},backend:n,attrs:{dim:h+1}});c=p,u.push(p)}for(var f=0;f<o;++f){var d=Rr(f,"int32"),v=n.makeTensorInfo([],"int32",d),m=J_({inputs:{a:v,b:c},backend:n}),g=gw({inputs:{x:m},backend:n,attrs:{dtype:"float32"}}),y=fS({inputs:{a:g,b:a},backend:n}),b=RI({inputs:{x:y},backend:n,attrs:{axis:0,keepDims:!1}});s.push(b),u.push(v),u.push(m),u.push(g),u.push(y),u.push(b)}var x=lC({inputs:s,backend:n,attrs:{axis:0}});return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),x}},_T=0,ST=[Ew,Aw,Rw,Fw,Sw,Lw,Vw,Ww,Uw,Hw,jw,Xw,Yw,$w,e_,a_,i_,o_,s_,Nw,u_,p_,v_,yw,b_,k_,fw,w_,T_,M_,A_,E_,R_,O_,D_,L_,z_,B_,V_,W_,U_,G_,j_,q_,X_,K_,Z_,Y_,gS,$k,Q_,eS,nS,iS,sS,cS,IS,TS,NS,AS,OS,FS,LS,PS,BS,US,jS,ew,qS,I_,KS,ZS,$S,nw,tI,aI,oI,lI,hI,dI,mI,bI,xI,kI,TI,NI,EI,MI,AI,DI,SI,FI,LI,BI,VI,HI,XI,dS,YI,QI,JI,tC,aC,iC,uC,cC,hC,dC,ow,mC,yC,mw,xC,uw,cw,Cw,kC,wC,_C,SC,IC,CC,NC,AC,RC,OC,LC,zC,VC,UC,GC,h_,qI,XC,KC,YC,ZC,$C,JC,nT,aT,oT,kS,OI,uT,{kernelName:cr,backendName:"cpu",kernelFunc:lT},hT,fT,Bw,dT,xT,kT,wT,sC];_T<ST.length;_T++){Mr(ST[_T])}var IT,CT,TT,NT={},ET={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function MT(e){if(!(e in NT)){var t=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=function(e){if("undefined"!==typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);if(t.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete NT[e]}),!1),1===e)return t.getContext("webgl",ET)||t.getContext("experimental-webgl",ET);return t.getContext("webgl2",ET)}(e);if(null===t)return console.log("Could not get context for WebGL version",e),null;NT[e]=t}var n=NT[e];return n.isContextLost()?(delete NT[e],MT(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),NT[e])}function AT(e,t){return[t,e]}function DT(e){var t=K(e);return Q(Math.ceil(t/4))}function RT(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function OT(e,t){var n,r,a,i,o,s,u,l,c,h=e;return 2===Ce().getNumber("WEBGL_VERSION")?(n=h.R32F,r=h.R16F,a=h.RGBA16F,i=h.RGBA32F,o=h.RED,s=4,u=1,l=h.HALF_FLOAT,c=h.FLOAT):(n=e.RGBA,r=e.RGBA,a=e.RGBA,i=h.RGBA,o=e.RGBA,s=4,u=4,l=null!=t?t.HALF_FLOAT_OES:null,c=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function FT(e,t){var n=t();return Ce().getBool("DEBUG")&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(IT||(IT={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(CT||(CT={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(TT||(TT={}));function LT(e){return!!(Ce().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function PT(e,t){return ZT(e,(function(){return e.getExtension(t)}),'Extension "'+t+'" not supported on this browser.')}function zT(e,t){var n=ZT(e,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(FT(e,(function(){return e.shaderSource(n,t)})),FT(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw function(e,t){var n=WT.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);for(var r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,o=a.map((function(e,t){return $((t+1).toString(),i)+e})),s=0,u=0;u<o.length;u++)s=Math.max(o[u].length,s);var l=o.slice(0,r-1),c=o.slice(r-1,r),h=o.slice(r);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat($(c[0],s)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var BT,VT,WT=/ERROR: [0-9]+:([0-9]+):/g;function UT(e,t){if(FT(e,(function(){return e.validateProgram(t)})),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function HT(e,t,n,r,a,i,o){var s=e.getAttribLocation(t,n);return-1!==s&&(FT(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),FT(e,(function(){return e.vertexAttribPointer(s,a,e.FLOAT,!1,i,o)})),FT(e,(function(){return e.enableVertexAttribArray(s)})),!0)}function GT(e,t,n){return ZT(e,(function(){return e.getUniformLocation(t,n)}),'uniform "'+n+'" not present in program.')}function jT(e,t,n){return e.getUniformLocation(t,n)}function qT(e,t,n,r){FT(e,(function(){return function(e,t,n){QT(e,n),FT(e,(function(){return e.activeTexture(e.TEXTURE0+n)})),FT(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)}))}(e,t,r)})),FT(e,(function(){return e.uniform1i(n,r)}))}function XT(e,t,n){FT(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),FT(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}))}function KT(e,t){FT(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,t)})),FT(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function YT(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}(e,t))}function ZT(e,t,n){var r=FT(e,(function(){return t()}));if(null==r)throw new Error(n);return r}function QT(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){var a="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(a,"."))}}function $T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return K(e.slice(0,e.length-t))}function JT(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function eN(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[$T(e)].concat(I(JT(e)))),t}function tN(e){return e%2===0}function nN(e,t){if(Y(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(tN(n)&&tN(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&tN(e[0])&&tN(t[0])}function rN(e,t){return null!=e.getExtension(t)}function aN(e){try{if(null!=MT(e))return!0}catch(tY){return console.log("Error when getting WebGL context: ",tY),!1}return!1}function iN(e){if(0===e)return!1;var t=MT(e);if(1!==e){if(rN(t,"EXT_color_buffer_float"))return oN(t);var n="EXT_color_buffer_half_float";if(rN(t,n)){var r=t.getExtension(n);return function(e,t){var n=OT(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);var a=1,i=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,a,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),s}(t,r)}return!1}return!!rN(t,"OES_texture_float")&&(!!rN(t,"WEBGL_color_buffer_float")&&oN(t))}function oN(e){var t=OT(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function sN(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&G("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors ")+"in the WebGL backend."}))}))}var uN=Ce();function lN(){var e,t,n,r,a,i,o,s,u,l;return 2===Ce().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function cN(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=fe(t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / ").concat(t),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(t):"index -= ".concat(e[a]," * ").concat(t);return"".concat(i,"; ").concat(o,";")})).join("")}function hN(e){var t=fe(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}uN.registerFlag("HAS_WEBGL",(function(){return uN.getNumber("WEBGL_VERSION")>0})),uN.registerFlag("WEBGL_VERSION",(function(){return aN(2)?2:aN(1)?1:0})),uN.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(function(){return!1})),uN.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===uN.get("WEBGL_VERSION")})),uN.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),uN.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),uN.registerFlag("WEBGL_PACK",(function(){return uN.getBool("HAS_WEBGL")})),uN.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return uN.getBool("WEBGL_PACK")})),uN.registerFlag("WEBGL_PACK_CLIP",(function(){return uN.getBool("WEBGL_PACK")})),uN.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),uN.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return uN.getBool("WEBGL_PACK")})),uN.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return uN.getBool("WEBGL_PACK")})),uN.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return uN.getBool("WEBGL_PACK")})),uN.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return uN.getBool("WEBGL_PACK")})),uN.registerFlag("WEBGL_PACK_REDUCE",(function(){return uN.getBool("WEBGL_PACK")})),uN.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return uN.getBool("WEBGL_PACK")})),uN.registerFlag("WEBGL_CONV_IM2COL",(function(){return uN.getBool("WEBGL_PACK")})),uN.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return function(e){if(null==BT){var t=MT(e);BT=t.getParameter(t.MAX_TEXTURE_SIZE)}return BT}(uN.getNumber("WEBGL_VERSION"))})),uN.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return function(e){if(null==VT){var t=MT(e);VT=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,VT)}(uN.getNumber("WEBGL_VERSION"))})),uN.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=uN.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;var t=MT(e);return rN(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:rN(t,"EXT_disjoint_timer_query")?1:0}(e)})),uN.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return uN.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Ia()})),uN.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return function(e){if(0===e)return!1;var t=MT(e);if(1===e){if(!rN(t,"OES_texture_float"))return!1}else if(!rN(t,"EXT_color_buffer_float"))return!1;return oN(t)}(uN.getNumber("WEBGL_VERSION"))})),uN.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!uN.getBool("WEBGL_FORCE_F16_TEXTURES")&&uN.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),uN.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return iN(uN.getNumber("WEBGL_VERSION"))})),uN.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return 2===(e=uN.getNumber("WEBGL_VERSION"))&&null!=MT(e).fenceSync;var e})),uN.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return uN.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),uN.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(function(){return-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(e,"."))})),uN.registerFlag("WEBGL_FLUSH_THRESHOLD",(function(){return Ia()&&uN.getBool("IS_CHROME")?1:-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(e,"."))}));var pN="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",fN=R((function e(t){A(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=IT.DENSE;var n=DT(t),r=lN();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(cN(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")})),dN=R((function e(t){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=IT.DENSE;var n=DT(t),r=lN();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(cN(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")})),vN=R((function e(t){A(this,e),this.variableNames=["A"],this.outTexUsage=CT.DOWNLOAD;var n=lN();this.outputShape=t,this.userCode="\n      ".concat(pN,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(n.output," = encode_float(x);\n      }\n    ")})),mN=R((function e(t){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=CT.DOWNLOAD;var n=lN();this.outputShape=t,this.userCode="\n      ".concat(pN,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(n.output," = encode_float(x);\n      }\n    ")})),gN=R((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];A(this,e),this.variableNames=["A"];var a=lN(),i=N(n,2),o=i[0],s=i[1];this.outputShape=t;var u="result";r&&(u="floor(result * 255. + 0.5)"),this.userCode="\n      ".concat(hN(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n\n        int r = flatIndex / ").concat(s,";\n        int c = imod(flatIndex, ").concat(s,");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n        vec4 values = ").concat(a.texture2D,"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ").concat(a.output," = vec4(").concat(u,", 0., 0., 0.);\n      }\n    ")})),yN=R((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];A(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var a=lN(),i=N(n,2),o=i[0],s=i[1];this.outputShape=t;var u="",l="result";r&&(l="floor(result * 255. + 0.5)");for(var c=0;c<=1;c++)for(var h=0;h<=1;h++){var p=2*c+h;u+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(h," < ").concat(t[2],") {\n            localCoords[2] += ").concat(h,";\n            if(localCoords[1] + ").concat(c," < ").concat(t[1],") {\n              localCoords[1] += ").concat(c,";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / ").concat(s,";\n              c = imod(flatIndex, ").concat(s,");\n              uv = (vec2(c, r) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n              values = ").concat(a.texture2D,"(A, uv);\n\n              if(offset == 0) {\n                result[").concat(p,"] = values[0];\n              } else if(offset == 1) {\n                result[").concat(p,"] = values[1];\n              } else if(offset == 2) {\n                result[").concat(p,"] = values[2];\n              } else {\n                result[").concat(p,"] = values[3];\n              }\n            }\n          }\n        ")}this.userCode="\n      ".concat(hN(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        ").concat(u,"\n\n        ").concat(a.output," = ").concat(l,";\n      }\n    ")}));function bN(e){var t=lN();return function(e,t){var n=ZT(e,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(FT(e,(function(){return e.shaderSource(n,t)})),FT(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function xN(e){return function(e,t){var n=ZT(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return FT(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),FT(e,(function(){return e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function kN(e){return function(e,t){var n=ZT(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return FT(e,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)})),FT(e,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Uint16Array([0,1,2,2,1,3]))}function wN(e,t,n,r,a,i){!function(e,t){var n=Ce().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){var a="[".concat(e,"x").concat(t,"]"),i="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU "+i+".")}}(t,n);var o=function(e){return ZT(e,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}(e),s=e.TEXTURE_2D;return FT(e,(function(){return e.bindTexture(s,o)})),FT(e,(function(){return e.texParameteri(s,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),FT(e,(function(){return e.texParameteri(s,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),FT(e,(function(){return e.texParameteri(s,e.TEXTURE_MIN_FILTER,e.NEAREST)})),FT(e,(function(){return e.texParameteri(s,e.TEXTURE_MAG_FILTER,e.NEAREST)})),FT(e,(function(){return e.texImage2D(s,0,r,t,n,0,a,i,null)})),FT(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),o}function _N(e){return e.internalFormatFloat}function SN(e){return e.internalFormatHalfFloat}function IN(e){return e.downloadTextureFormat}function CN(e){return e.internalFormatPackedFloat}function TN(e){return e.internalFormatPackedHalfFloat}function NN(e,t,n,r,a,i,o,s){var u=e,l=new Float32Array(function(e,t){var n=N(RT(e,t),2);return n[0]*n[1]*4}(i,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}var EN=function(){function e(t){A(this,e),this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=Ce().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,function(e,t){NT[e]=t}(n,t)):this.gl=MT(n);var r="WEBGL_color_buffer_float",a="EXT_color_buffer_half_float";if(1===Ce().getNumber("WEBGL_VERSION")){var i="OES_texture_half_float";if(this.textureFloatExtension=PT(this.gl,"OES_texture_float"),rN(this.gl,i))this.textureHalfFloatExtension=PT(this.gl,i);else if(Ce().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),rN(this.gl,a))this.colorBufferHalfFloatExtension=PT(this.gl,a);else if(Ce().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",rN(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!rN(this.gl,a))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(a)}this.vertexBuffer=xN(this.gl),this.indexBuffer=kN(this.gl),this.framebuffer=function(e){return ZT(e,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=OT(this.gl,this.textureHalfFloatExtension)}return R(e,[{key:"debug",get:function(){return Ce().getBool("DEBUG")}},{key:"dispose",value:function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;FT(t,(function(){return t.finish()})),FT(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),FT(t,(function(){return t.deleteFramebuffer(e.framebuffer)})),FT(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),FT(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),FT(t,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}}},{key:"createFloat32MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=N(AT(t,n),2);return wN(e,a[0],a[1],_N(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"createFloat16MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=N(AT(t,n),2);return wN(e,a[0],a[1],SN(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createUnsignedBytesMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=N(AT(t,n),2);return wN(e,a[0],a[1],IN(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}},{key:"uploadPixelDataToTexture",value:function(e,t){this.throwIfDisposed(),function(e,t,n){FT(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),n.data instanceof Uint8Array?FT(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)})):FT(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)})),FT(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t)}},{key:"uploadDenseMatrixToTexture",value:function(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,a,i){var o,s,u;FT(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),a instanceof Uint8Array?(o=new Uint8Array(n*r*4),s=e.UNSIGNED_BYTE,u=e.RGBA):(o=new Float32Array(n*r*4),s=e.FLOAT,u=i.internalFormatPackedFloat),o.set(a),FT(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,u,n,r,0,e.RGBA,s,o)})),FT(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t,n,r,this.textureConfig)}},{key:"createFloat16PackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=N(RT(t,n),2);return wN(e,a[0],a[1],TN(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createPackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=N(RT(t,n),2);return wN(e,a[0],a[1],CN(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"deleteMatrixTexture",value:function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(KT(this.gl,this.framebuffer),this.outputTexture=null),FT(this.gl,(function(){return t.gl.deleteTexture(e)}))}},{key:"downloadByteEncodedFloatMatrixFromOutputTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n,r){var a=N(AT(t,n),2),i=a[0],o=a[1],s=new Uint8Array(t*n*4);return FT(e,(function(){return e.readPixels(0,0,i,o,r.downloadTextureFormat,e.UNSIGNED_BYTE,s)})),new Float32Array(s.buffer)}(r.gl,t,n,r.textureConfig)}))}},{key:"downloadPackedMatrixFromBuffer",value:function(e,t,n,r,a,i){return NN(this.gl,e,0,0,0,a,i,this.textureConfig)}},{key:"downloadFloat32MatrixFromBuffer",value:function(e,t){return function(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}(this.gl,e,t)}},{key:"createBufferFromTexture",value:function(e,t,n){this.bindTextureToFrameBuffer(e);var r=function(e,t,n,r){var a=e.createBuffer();FT(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)}));var i=16*t*n;return FT(e,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)})),FT(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)})),FT(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),a}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}},{key:"createAndWaitForFence",value:function(){var e=this.createFence(this.gl);return this.pollFence(e)}},{key:"createFence",value:function(e){var t,n,r=this;if(Ce().getBool("WEBGL_FENCE_API_ENABLED")){var a=e,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=a.clientWaitSync(i,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=i}else Ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,Ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}}},{key:"downloadMatrixFromPackedTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n){var r=new Float32Array(t*n*4);return FT(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)})),r}(r.gl,t,n)}))}},{key:"createProgram",value:function(e){this.throwIfDisposed();var t=this.gl,n=zT(t,e),r=bN(t),a=function(e){return ZT(e,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}(t);return FT(t,(function(){return t.attachShader(a,r)})),FT(t,(function(){return t.attachShader(a,n)})),function(e,t){if(FT(e,(function(){return e.linkProgram(t)})),!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(t,a),this.debug&&UT(t,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=function(e,t,n){return FT(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),HT(e,t,"clipSpacePos",n,3,20,0)&&HT(e,t,"uv",n,2,20,12)}(t,this.program,this.vertexBuffer)),a}},{key:"deleteProgram",value:function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&FT(this.gl,(function(){return t.gl.deleteProgram(e)}))}},{key:"setProgram",value:function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&UT(this.gl,this.program),FT(this.gl,(function(){return t.gl.useProgram(e)}))}},{key:"getUniformLocation",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?GT(this.gl,e,t):jT(this.gl,e,t)}},{key:"getAttributeLocation",value:function(e,t){var n=this;return this.throwIfDisposed(),FT(this.gl,(function(){return n.gl.getAttribLocation(e,t)}))}},{key:"getUniformLocationNoThrow",value:function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}},{key:"setInputMatrixTexture",value:function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),qT(this.gl,e,t,n)}},{key:"setOutputMatrixTexture",value:function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}},{key:"setOutputPackedMatrixTexture",value:function(e,t,n){this.throwIfDisposed();var r=N(RT(t,n),2),a=r[0],i=r[1];this.setOutputMatrixTextureDriver(e,a,i)}},{key:"setOutputMatrixWriteRegion",value:function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}},{key:"setOutputPackedMatrixWriteRegion",value:function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}},{key:"debugValidate",value:function(){null!=this.program&&UT(this.gl,this.program),YT(this.gl)}},{key:"executeProgram",value:function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),FT(e,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))}},{key:"blockUntilAllProgramsCompleted",value:function(){var e=this;this.throwIfDisposed(),FT(this.gl,(function(){return e.gl.finish()}))}},{key:"getQueryTimerExtension",value:function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=PT(this.gl,2===Ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}},{key:"getQueryTimerExtensionWebGL2",value:function(){return this.getQueryTimerExtension()}},{key:"getQueryTimerExtensionWebGL1",value:function(){return this.getQueryTimerExtension()}},{key:"beginQuery",value:function(){if(2===Ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a}},{key:"endQuery",value:function(){if(2!==Ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}}},{key:"waitForQueryAndGetTime",value:function(){var e=F(M().mark((function e(t){var n=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J((function(){return n.disposed||n.isQueryAvailable(t,Ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}));case 2:return e.abrupt("return",this.getQueryTime(t,Ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getQueryTime",value:function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}},{key:"isQueryAvailable",value:function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}var i=this.getQueryTimerExtensionWebGL1(),o=i.getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}},{key:"pollFence",value:function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))}},{key:"pollItems",value:function(){for(var e=function(e){for(var t=0;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t){(0,this.itemsToPoll[t].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}},{key:"addItemToPoll",value:function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||J((function(){return n.pollItems(),0===n.itemsToPoll.length}))}},{key:"bindTextureToFrameBuffer",value:function(e){this.throwIfDisposed(),XT(this.gl,e,this.framebuffer),this.debug&&YT(this.gl)}},{key:"unbindTextureToFrameBuffer",value:function(){null!=this.outputTexture?(XT(this.gl,this.outputTexture,this.framebuffer),this.debug&&YT(this.gl)):KT(this.gl,this.framebuffer)}},{key:"downloadMatrixDriver",value:function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n}},{key:"setOutputMatrixTextureDriver",value:function(e,t,n){this.throwIfDisposed();var r=this.gl;XT(r,e,this.framebuffer),this.debug&&YT(r),this.outputTexture=e,FT(r,(function(){return r.viewport(0,0,t,n)})),FT(r,(function(){return r.scissor(0,0,t,n)}))}},{key:"setOutputMatrixWriteRegionDriver",value:function(e,t,n,r){var a=this;this.throwIfDisposed(),FT(this.gl,(function(){return a.gl.scissor(e,t,n,r)}))}},{key:"throwIfDisposed",value:function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}},{key:"throwIfNoProgram",value:function(){if(null==this.program)throw new Error("No GPU program is currently set.")}}]),e}();var MN=Cs;function AN(e,t,n,r){var a=[];e.forEach((function(e){var t=K(e.shapeInfo.logicalShape);e.shapeInfo.isUniform?a.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(a.push("uniform sampler2D ".concat(e.name,";")),a.push("uniform int offset".concat(e.name,";")))}));var i,o,s=a.join("\n"),u=e.map((function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="";r+=n?RN(e):DN(e);var a=e.shapeInfo.logicalShape,i=t.logicalShape;a.length<=i.length&&(r+=n?VN(e,t):WN(e,t));return r}(e,t,r)})).join("\n"),l=t.texShape,c=lN(),h=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(c),p=function(e){return"".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(ON,"\n    ").concat(FN,"\n    ").concat(LN,"\n  ")}(c);return t.isPacked?(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(1===n[0])return"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(n[1],".0);\n      }\n    ");if(1===n[1])return"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(n[0],".0);\n      }\n    ");return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      return 2 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n    }\n  ")}(0,t);case 2:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(Y(e,t))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(n[0],", ").concat(n[1],"));\n      }\n    ");var r=Math.ceil(e[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[2]/2),a=r*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t);default:return function(e,t){for(var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),a=r*Math.ceil(e[e.length-2]/2),i=a,o="",s="b, r, c",u=2;u<e.length-1;u++)i*=e[e.length-u-1],o="\n      int b".concat(u," = index / ").concat(i,";\n      index -= b").concat(u," * ").concat(i,";\n    ")+o,s="b".concat(u,", ")+s;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      ").concat(o,"\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec").concat(e.length,"(").concat(s,");\n    }\n  ")}(e,t)}}(t.logicalShape,l),o=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(c)):(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){if(1===t[0])return"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    ");if(1===t[1])return"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    ");return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}(0,t);case 2:return function(e,t){if(Y(e,t))return"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    ");if(1===e[1])return"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===e[0])return"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=cN(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t);case 4:return function(e,t){var n=cN(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t);case 5:return function(e,t){var n=cN(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){var n=cN(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,l),o=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(c)),r&&(p+=PN),[p,h,o,s,i,u,n].join("\n")}function DN(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(n,"() {return ").concat(t,";}");var r=N(e.shapeInfo.texShape,2),a=r[0],i=r[1];if(1===a&&1===i)return"\n      float ".concat(n,"() {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");var o=N(e.shapeInfo.texShape,2),s=o[0],u=o[1],l=zN(t);return"\n    float ".concat(n,"() {\n      vec2 uv = uvFromFlat(").concat(s,", ").concat(u,", ").concat(l,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(n,"(int index) {\n        ").concat(BN(e),"\n      }\n    ");var r=e.shapeInfo.texShape,a=r[0],i=r[1];if(1===i&&1===a)return"\n      float ".concat(n,"(int index) {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");var o=zN(t);if(1===i)return"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / ").concat(a,".0);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");if(1===a)return"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / ").concat(i,".0, 0.5);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");return"\n    float ".concat(n,"(int index) {\n      vec2 uv = uvFromFlat(").concat(a,", ").concat(i,", index + ").concat(o,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape;if(null!=a&&Y(t,a)){var i=a[0],o=a[1];return"\n    float ".concat(r,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(o,".0, ").concat(i,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}var s=ne(t),u=s.newShape,l=s.keptDims,c=u;if(c.length<t.length){var h=HN(e,c),p=["row","col"];return"\n      ".concat(DN(h),"\n      float ").concat(r,"(int row, int col) {\n        return ").concat(r,"(").concat(GN(p,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(t[1],", 1)));\n        ").concat(BN(e),"\n      }\n    ");var f=a[0],d=a[1],v=zN(n);if(1===d)return"\n    float ".concat(r,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(v,"), vec3(").concat(t[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(f,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");if(1===f)return"\n    float ".concat(r,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(v,"), vec3(").concat(t[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(d,".0, 0.5);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n  float ".concat(r,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(t[1]," + col + ").concat(v,";\n    vec2 uv = uvFromFlat(").concat(f,", ").concat(d,", index);\n    return sampleTexture(").concat(n,", uv);\n  }\n")}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[1]*t[2],i=t[2],o=ne(t),s=o.newShape,u=o.keptDims,l=s;if(l.length<t.length){var c=HN(e,l),h=["row","col","depth"];return"\n        ".concat(DN(c),"\n        float ").concat(r,"(int row, int col, int depth) {\n          return ").concat(r,"(").concat(GN(h,u),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(a,", ").concat(i,", 1)));\n        ").concat(BN(e),"\n      }\n    ");var p=e.shapeInfo.texShape,f=p[0],d=p[1],v=e.shapeInfo.flatOffset;if(d===a&&null==v)return"\n        float ".concat(r,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(i,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(d,".0, ").concat(f,".0);\n          return sampleTexture(").concat(n,", uv);\n        }\n      ");if(d===i&&null==v)return"\n    float ".concat(r,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(t[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(d,".0, ").concat(f,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");var m=zN(n);return"\n      float ".concat(r,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(a," + col * ").concat(i," + depth + ").concat(m,";\n        vec2 uv = uvFromFlat(").concat(f,", ").concat(d,", index);\n        return sampleTexture(").concat(n,", uv);\n      }\n  ")}(e);case 4:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[3],i=t[2]*a,o=t[1]*i,s=ne(t),u=s.newShape,l=s.keptDims;if(u.length<t.length){var c=HN(e,u),h=["row","col","depth","depth2"];return"\n      ".concat(DN(c),"\n      float ").concat(r,"(int row, int col, int depth, int depth2) {\n        return ").concat(r,"(").concat(GN(h,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(o,", ").concat(i,", ").concat(a,", 1)));\n        ").concat(BN(e),"\n      }\n    ");var p=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,d=f[0],v=f[1];if(v===o&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(i,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(v,".0, ").concat(d,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(v===a&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(t[1]*t[2],", ").concat(t[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(v,".0, ").concat(d,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var m=zN(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(o," + col * ").concat(i," +\n          depth * ").concat(a," + depth2;\n      vec2 uv = uvFromFlat(").concat(d,", ").concat(v,", index + ").concat(m,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],i=t[3]*a,o=t[2]*i,s=t[1]*o,u=ne(t),l=u.newShape,c=u.keptDims;if(l.length<t.length){var h=HN(e,l),p=["row","col","depth","depth2","depth3"];return"\n      ".concat(DN(h),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(GN(p,c),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(s,", ").concat(o,", ").concat(i,", ").concat(a,")) +\n          depth3;\n        ").concat(BN(e),"\n      }\n    ");var f=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,v=d[0],m=d[1];if(m===s&&null==f)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(o,", ").concat(i,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(m,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(m===a&&null==f)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(m,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var g=zN(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(o," + depth * ").concat(i," +\n          depth2 * ").concat(a," + depth3 + ").concat(g,";\n      vec2 uv = uvFromFlat(").concat(v,", ").concat(m,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=ne(t),i=a.newShape,o=a.keptDims;if(i.length<t.length){var s=HN(e,i),u=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(DN(s),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(GN(u,o),");\n      }\n    ")}var l=t[5],c=t[4]*l,h=t[3]*c,p=t[2]*h,f=t[1]*p;if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(f,", ").concat(p,", ").concat(h,", ").concat(c,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(l,", 1)));\n        ").concat(BN(e),"\n      }\n    ");var d=e.shapeInfo.flatOffset,v=e.shapeInfo.texShape,m=v[0],g=v[1];if(g===f&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(p,", ").concat(h,", ").concat(c,", ").concat(l,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(g,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(g===l&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(g,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var y=zN(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(f," + col * ").concat(p," + depth * ").concat(h," +\n          depth2 * ").concat(c," + depth3 * ").concat(l," + depth4 + ").concat(y,";\n      vec2 uv = uvFromFlat(").concat(m,", ").concat(g,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);default:throw new Error("".concat(t.length,"-D input sampling")+" is not yet supported")}}function RN(e){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=lN();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e.shapeInfo.texShape,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=lN();return"\n    vec4 ".concat(n,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(a[0],", ").concat(a[1],", index);\n      return ").concat(i.texture2D,"(").concat(t,", uv);\n    }\n  ")}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=a[0],o=a[1],s=lN();if(null!=a&&Y(t,a))return"\n      vec4 ".concat(r,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(o,".0, ").concat(i,".0);\n\n        return ").concat(s.texture2D,"(").concat(n,", uv);\n      }\n    ");var u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],l=Math.ceil(t[1]/2);return"\n    vec4 ".concat(r,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(l,", ").concat(u[0],", ").concat(u[1],", row, col);\n      return ").concat(s.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===t[0]){var o=[1,2],s=HN(e,t.slice(1)),u=["b","row","col"];return"\n        ".concat(RN(s),"\n        vec4 ").concat(r,"(int b, int row, int col) {\n          return ").concat(r,"(").concat(GN(u,o),");\n        }\n      ")}var l=i[0],c=i[1],h=Math.ceil(t[2]/2),p=h*Math.ceil(t[1]/2),f=lN();return"\n    vec4 ".concat(r,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(l,", ").concat(c,", ").concat(p,", ").concat(h,", b, row, col);\n      return ").concat(f.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e);default:return function(e){for(var t=e.shapeInfo.logicalShape,n=t.length,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],s=o[0],u=o[1],l=Math.ceil(t[n-1]/2),c=l*Math.ceil(t[n-2]/2),h="int b, int row, int col",p="b * ".concat(c," + (row / 2) * ").concat(l," + (col / 2)"),f=2;f<n-1;f++)h="int b".concat(f,", ")+h,c*=t[n-f-1],p="b".concat(f," * ").concat(c," + ")+p;var d=lN();return"\n    vec4 ".concat(a,"(").concat(h,") {\n      int index = ").concat(p,";\n      int texR = index / ").concat(u,";\n      int texC = index - texR * ").concat(u,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(u,", ").concat(s,");\n      return ").concat(d.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e)}}var ON="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",FN="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",LN="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",PN="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function zN(e){return"offset".concat(e)}function BN(e){var t=e.name,n=K(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function VN(e,t){var n,r=e.name,a=r.charAt(0).toUpperCase()+r.slice(1),i="get"+a+"AtOutCoords",o=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,u=MN(e.shapeInfo.logicalShape,t.logicalShape),l=UN(s),c=s-o,h=["x","y","z","w","u","v"];n=0===o?"":s<2&&u.length>=1?"coords = 0;":u.map((function(e){return"coords.".concat(h[e+c]," = 0;")})).join("\n");var p="";p=s<2&&o>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(h[t+c])})).join(", ");var f="return outputValue;",d=1===K(e.shapeInfo.logicalShape),v=1===K(t.logicalShape);if(1!==o||d||v){if(d&&!v)f=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var m=o-2,g=o-1;u.indexOf(m)>-1&&u.indexOf(g)>-1?f="return vec4(outputValue.x);":u.indexOf(m)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(g)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}}else f="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(i,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(a,"(").concat(p,");\n      ").concat(f,"\n    }\n  ")}function WN(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.texShape,o=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===u&&null==e.shapeInfo.flatOffset&&Y(o,i))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");var l,c=UN(u),h=MN(e.shapeInfo.logicalShape,t.logicalShape),p=u-s,f=["x","y","z","w","u","v"];l=0===s?"":u<2&&h.length>=1?"coords = 0;":h.map((function(e){return"coords.".concat(f[e+p]," = 0;")})).join("\n");var d="";return d=u<2&&s>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(f[t+p])})).join(", "),"\n    float ".concat(a,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(l,"\n      return get").concat(r,"(").concat(d,");\n    }\n  ")}function UN(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function HN(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function GN(e,t){return t.map((function(t){return e[t]})).join(", ")}function jN(e,t,n,r){var a=t.userCode,i=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),o=i.map((function(e){return e.shapeInfo})),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=AN(i,s,a,t.packedInputs),l=e.createProgram(u),c=null,h=e.getUniformLocation(l,"NAN",!1);1===Ce().getNumber("WEBGL_VERSION")&&(c=e.getUniformLocation(l,"INFINITY",!1));for(var p={},f=0;f<t.variableNames.length;f++){var d=t.variableNames[f];p[d]=e.getUniformLocation(l,d,false),p["offset".concat(d)]=e.getUniformLocation(l,"offset".concat(d),false)}return{program:t,source:u,webGLProgram:l,uniformLocations:p,inShapeInfos:o,outShapeInfo:s,infLoc:c,nanLoc:h}}function qN(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach((function(e,n){var r=e.logicalShape,a=t[n],i=a.shape;if(!Y(r,i))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(i," must match"));if(!e.isUniform||!a.isUniform){var o=e.texShape,s=a.isUniform?null:a.texData.texShape;if(!Y(o,s))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(o," and ").concat(s," must match"))}}))}function XN(e,t,n,r,a){qN(t.inShapeInfos,n),qN([t.outShapeInfo],[r]);var i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i,o[0],o[1]):e.setOutputMatrixTexture(i,o[0],o[1]),e.setProgram(t.webGLProgram),1===Ce().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach((function(n,r){var a=t.program.variableNames[r],i=t.uniformLocations[a],o=t.uniformLocations["offset".concat(a)];if(null!=i)if(n.isUniform)if(K(n.shape)<2)e.gl.uniform1f(i,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),e.gl.uniform1fv(i,s)}else null!=n.texData.slice&&null!=o&&e.gl.uniform1i(o,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture,i,r)})),null!=a&&a(e,t.webGLProgram),e.executeProgram()}function KN(e,t,n){var r="";t.concat(n).forEach((function(e){var t=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0,n=e.isUniform?"uniform":e.texData.texShape;r+="".concat(e.shape,"_").concat(n,"_").concat(t)}));var a=e.userCode,i=e.constructor.name;return i+="_"+r+"_"+a}var YN=kw,ZN=f_,QN=d_,$N=g_,JN=__,eE=rS,tE=uS,nE=ES,rE=zS,aE=VS,iE=JS,oE=iI,sE=sI,uE=wI,lE=II,cE=PI,hE=hS,pE=KI,fE=vC,dE=gC,vE=EC,mE=Mw,gE=l_,yE=iT,bE=yS,xE=cT,kE=pT,wE=Pw,_E=bT;function SE(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return"".concat(e,".").concat(t)}))}function IE(e,t){return 1===t?[e]:SE(e,t)}var CE=R((function e(t){A(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var n=t.length;if(0===n)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var r=IE("rc",n),a=UN(n),i=function(e,t,n){if(1===e)return"rc > ".concat(t[0]);for(var r="",a=e-2;a<e;a++)r+="".concat(n[a]," >= ").concat(t[a]),a<e-1&&(r+="||");return r}(n,t,r),o=function(e,t,n,r){if(1===e)return"";var a=r.slice(-2);return"\n    int r = ".concat(a[0],";\n    int c = ").concat(a[1],";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= ").concat(t,";\n    bool rEdge = rp1 >= ").concat(n,";\n  ")}(n,t[t.length-1],t[t.length-2],r),s=function(e,t){var n=e.length,r=function(e,t){for(var n=[],r=0;r<=1;r++)for(var a=0;a<=1;a++){for(var i="".concat(0===r?"r":"rp1",", ").concat(0===a?"c":"cp1"),o=2;o<e;o++)i="".concat(t[t.length-1-o],",")+i;n.push(i)}return n}(n,t);if(1===n)return"getA(rc),\n            rc + 1 >= ".concat(e[0]," ? 0. : getA(rc + 1),\n            0, 0");return"getA(".concat(r[0],"),\n          cEdge ? 0. : getA(").concat(r[1],"),\n          rEdge ? 0. : getA(").concat(r[2],"),\n          rEdge || cEdge ? 0. : getA(").concat(r[3],")")}(t,r);this.userCode="\n        void main() {\n          ".concat(a," rc = getOutputCoords();\n\n          if(").concat(i,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(o,"\n\n            setOutput(vec4(").concat(s,"));\n          }\n        }\n      ")}}));var TE=R((function e(t,n){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r="",a=0;a<4;a++){var i="thisRC = rc;";a%2===1&&(i+="thisRC.z += 1;"),a>1&&(i+="thisRC.y += 1;"),r+="\n        ".concat(i,"\n        ").concat(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(a,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(a>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e){var t=cN(["r","c","d"],e);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(t,"\n      return ivec3(r, c, d);\n    }\n  ")}(n),"\n      ").concat(hN(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(t[1],";\n        int cols = ").concat(t[2],";\n\n        ").concat(r,"\n\n        setOutput(result);\n      }\n    ")}));var NE=function(){function e(t){A(this,e),this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return R(e,[{key:"acquireTexture",value:function(e,t,n){var r=ME(t,n),a=AE(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);var i,o=EE(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return r===TT.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===TT.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===TT.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===TT.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===TT.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(i),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),i}},{key:"releaseTexture",value:function(e,t,n,r){if(null!=this.freeTextures){var a=ME(n,r),i=AE(t,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);var o=EE(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),s=Ce().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==s&&this._numBytesAllocated>s?(this.gpgpu.deleteMatrixTexture(e),this._numBytesAllocated-=o):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;var u=this.usedTextures[i],l=u.indexOf(e);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u.splice(l,1),this.log()}}},{key:"log",value:function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));var t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}}},{key:"numBytesAllocated",get:function(){return this._numBytesAllocated}},{key:"numBytesFree",get:function(){return this._numBytesFree}},{key:"getNumUsedTextures",value:function(){return this.numUsedTextures}},{key:"getNumFreeTextures",value:function(){return this.numFreeTextures}},{key:"dispose",value:function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));for(var n in this.usedTextures)this.usedTextures[n].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}]),e}();function EE(e,t,n,r,a){var i,o=function(e,t){switch(e){case TT.PACKED_2X2_FLOAT32:return CN(t);case TT.PACKED_2X2_FLOAT16:return TN(t);case TT.UNPACKED_FLOAT32:return _N(t);case TT.UNPACKED_FLOAT16:return SN(t);case TT.PACKED_4X1_UNSIGNED_BYTE:return IN(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,r);if(a){var s=N(RT(e[0],e[1]),2);i=s[0]*s[1]}else{var u=N(AT(e[0],e[1]),2);i=u[0]*u[1]}var l=function(e,t){var n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;throw new Error("Unknown internal format ".concat(t))}(n,o);return i*l}function ME(e,t){if(e===CT.UPLOAD)return TT.PACKED_2X2_FLOAT32;if(e===CT.RENDER||null==e)return function(e){return Ce().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?TT.PACKED_2X2_FLOAT32:TT.UNPACKED_FLOAT32:e?TT.PACKED_2X2_FLOAT16:TT.UNPACKED_FLOAT16}(t);if(e===CT.DOWNLOAD||e===CT.PIXELS)return TT.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function AE(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}var DE=R((function e(t,n){A(this,e),this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")})),RE="if (isnan(x)) return x;",OE="return x;",FE="return abs(x);";var LE="return (x >= 0.0) ? x : (exp(x) - 1.0);",PE=RE+"\n  return (x < 0.0) ? 0.0 : x;\n",zE=RE+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",BE="return x;",VE="return x;",WE="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",UE="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",HE="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",GE=R((function e(t,n){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")})),jE=R((function e(t){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var n=t.length,r=IE("rc",n),a=UN(n),i=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(n,r),o=r.slice(-2),s=n<=1?"rc":"vec2(".concat(o.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(i,");\n\n        setOutput(getChannel(packedInput, ").concat(s,"));\n      }\n    ")})),qE=qc,XE={};var KE=function(e){Hr(n,e);var t=Kr(n);function n(e){var r,a;if(A(this,n),(r=t.call(this)).pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.lastGlFlushTime=0,r.warnedAboutMemory=!1,r.warnedAboutCPUBackend=!1,r.pendingDeletes=0,r.disposed=!1,!Ce().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==e){var i=MT(Ce().getNumber("WEBGL_VERSION"));r.binaryCache=((a=Ce().getNumber("WEBGL_VERSION"))in XE||(XE[a]={}),XE[a]),r.gpgpu=new EN(i),r.canvas=i.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=e,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=e.gl.canvas;return r.textureManager=new NE(r.gpgpu),r.numMBBeforeWarning=null==Ce().global.screen?1024:Ce().global.screen.height*Ce().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new P(qr(r),No()),r}return R(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"numDataIds",value:function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes}},{key:"write",value:function(e,t,n){if((Ce().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Ce().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:CT.UPLOAD,refCount:1}),r}},{key:"refCount",value:function(e){return this.texData.has(e)?this.texData.get(e).refCount:0}},{key:"incRef",value:function(e){this.texData.get(e).refCount++}},{key:"decRef",value:function(e){this.texData.has(e)&&this.texData.get(e).refCount--}},{key:"move",value:function(e,t,n,r,a){if(Ce().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:CT.UPLOAD,refCount:a})}},{key:"disposeIntermediateTensorInfo",value:function(e){this.disposeData(e.dataId)}},{key:"readSync",value:function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,a=t.complexTensorInfos,i=t.slice,o=t.shape,s=t.isPacked;if(null!=i){var u;u=s?new GE(o,BE):new DE(o,BE);var l=this.runWebGLProgram(u,[{dataId:e,shape:o,dtype:r}],r),c=this.readSync(l.dataId);return this.disposeIntermediateTensorInfo(l),c}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var h,p,f=null!=this.activeTimers;(f&&(h=Fr()),"complex64"===r)?p=Bc(this.readSync(a.real.dataId),this.readSync(a.imag.dataId)):p=this.getValuesFromTexture(e);return f&&(this.downloadWaitMs+=Fr()-h),this.convertAndCacheOnCPU(e,p)}},{key:"read",value:function(){var e=F(M().mark((function e(t){var n,r,a,i,o,s,u,l,c,h,p,f,d,v,m,g,y,b,x,k,w,_;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pendingRead.has(t)){e.next=3;break}return n=this.pendingRead.get(t),e.abrupt("return",new Promise((function(e){return n.push(e)})));case 3:if(r=this.texData.get(t),a=r.values,i=r.shape,o=r.slice,s=r.dtype,u=r.complexTensorInfos,l=r.isPacked,null==o){e.next=11;break}return c=l?new GE(i,BE):new DE(i,BE),h=this.runWebGLProgram(c,[{dataId:t,shape:i,dtype:s}],s),p=this.read(h.dataId),this.disposeIntermediateTensorInfo(h),e.abrupt("return",p);case 11:if(null==a){e.next=13;break}return e.abrupt("return",this.convertAndCacheOnCPU(t));case 13:if(Ce().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")||2!==Ce().getNumber("WEBGL_VERSION")){e.next=15;break}throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");case 15:if(f=null,"complex64"!==s&&Ce().get("WEBGL_BUFFER_SUPPORTED")&&(d=this.decode(t),m=this.texData.get(d.dataId),f=(v=this.gpgpu).createBufferFromTexture.apply(v,[m.texture].concat(I(DT(i))))),this.pendingRead.set(t,[]),"complex64"===s){e.next=21;break}return e.next=21,this.gpgpu.createAndWaitForFence();case 21:if("complex64"!==s){e.next=30;break}return e.next=24,Promise.all([this.read(u.real.dataId),this.read(u.imag.dataId)]);case 24:y=e.sent,b=y[0],x=y[1],g=Bc(b,x),e.next=31;break;case 30:null==f?g=this.getValuesFromTexture(t):(k=K(i),g=this.gpgpu.downloadFloat32MatrixFromBuffer(f,k));case 31:return null!=d&&this.disposeIntermediateTensorInfo(d),w=this.convertAndCacheOnCPU(t,g),_=this.pendingRead.get(t),this.pendingRead.delete(t),_.forEach((function(e){return e(w)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&No().removeDataId(t,this),this.pendingDeletes--),e.abrupt("return",w);case 38:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map((function(e){return Pr(e)}))}catch(KG){throw new Error("Failed to decode encoded string bytes into utf-8")}return zi(e.shape,e.dtype,n)}},{key:"checkNumericalProblems",value:function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!LT(n)){if(Ce().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}},{key:"getValuesFromTexture",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.isPacked,i=K(n);if(Ce().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var o,s=this.decode(e),u=this.texData.get(s.dataId),l=(o=this.gpgpu).downloadMatrixFromPackedTexture.apply(o,[u.texture].concat(I(DT(n)))).subarray(0,i);return this.disposeIntermediateTensorInfo(s),l}var c=Ce().getBool("WEBGL_PACK")&&!0===a,h=c?eN(n):n,p=c?new mN(h):new vN(h),f=this.runWebGLProgram(p,[{shape:h,dtype:r,dataId:e}],"float32"),d=this.texData.get(f.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(d.texture,d.texShape[0],d.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(f),v}},{key:"timerAvailable",value:function(){return Ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}},{key:"time",value:function(){var e=F(M().mark((function e(t){var n,r,a,i,o,s,u;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.activeTimers,r=[],a=!1,null==this.programTimersStack?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,t(),i=X(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),o=X(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e})),this.activeTimers=n,a&&(this.programTimersStack=null),s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},!(Ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=19;break}return e.next=14,Promise.all(i);case 14:u=e.sent,s.kernelMs=H(u),s.getExtraProfileInfo=function(){return u.map((function(e,t){return{name:o[t],ms:e}})).map((function(e){return"".concat(e.name,": ").concat(e.ms)})).join(", ")},e.next=20;break;case 19:s.kernelMs={error:"WebGL query timers are not supported in this environment."};case 20:return this.uploadWaitMs=0,this.downloadWaitMs=0,e.abrupt("return",s);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"memory",value:function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}},{key:"startTimer",value:function(){return Ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Fr(),endMs:null}}},{key:"endTimer",value:function(e){return Ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Fr(),e)}},{key:"getQueryTime",value:function(){var e=F(M().mark((function e(t){var n;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=2;break}return e.abrupt("return",this.gpgpu.waitForQueryAndGetTime(t));case 2:return n=t,e.abrupt("return",n.endMs-n.startMs);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disposeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);var n=this.texData.get(e),r=n.complexTensorInfos;return null!=r&&(this.disposeData(r.real.dataId,t),this.disposeData(r.imag.dataId,t)),this.texData.delete(e),!0}},{key:"releaseGPUData",value:function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,a=t.texShape,i=t.usage,o=t.isPacked,s=t.slice,u=s&&s.origDataId||e,l=this.dataRefCount.get(u);l>1?this.dataRefCount.set(u,l-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}},{key:"getTexture",value:function(e){return this.uploadToGPU(e),this.texData.get(e).texture}},{key:"getDataInfo",value:function(e){return this.texData.get(e)}},{key:"getCPUBackend",value:function(){return Ce().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=No().findBackend("cpu")),this.cpuBackend):null}},{key:"shouldExecuteOnCPU",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:128,r=this.getCPUBackend();return Ce().getBool("IS_TEST")||this.warnedAboutCPUBackend||null!=r||(console.warn("Your application contains ops that are small enough to be executed on the CPU backend, however the CPU backend cannot be found. Consider importing the CPU backend (@tensorflow/tfjs-backend-cpu) for better performance."),this.warnedAboutCPUBackend=!0),null!=r&&e.every((function(e){return null==t.texData.get(e.dataId).texture&&K(e.shape)<n}))}},{key:"getGPGPUContext",value:function(){return this.gpgpu}},{key:"where",value:function(e){zc("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return qE(e.shape,t)}},{key:"packedUnaryOp",value:function(e,t,n){var r=new GE(e.shape,t),a=this.compileAndRun(r,[e],n);return No().makeTensorFromDataId(a.dataId,a.shape,a.dtype)}},{key:"abs",value:function(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){var t=mE(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(Ce().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,FE,e.dtype);var n=new DE(e.shape,FE),r=this.compileAndRun(n,[e]);return No().makeTensorFromDataId(r.dataId,r.shape,r.dtype)}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&ue(n[0])){var a=n.map((function(e){return Lr(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}},{key:"makeOutput",value:function(e,t,n){var r=this.makeTensorInfo(e,t,n).dataId;return No().makeTensorFromDataId(r,e,t,this)}},{key:"unpackTensor",value:function(e){var t=new jE(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}},{key:"packTensor",value:function(e){var t=new CE(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}},{key:"packedReshape",value:function(e,t){var n=[$T(e.shape)].concat(I(JT(e.shape))),r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[$T(t)].concat(I(JT(t))),i=new TE(a,n),o=this.runWebGLProgram(i,[r],e.dtype,null,!0);return{dataId:o.dataId,shape:t,dtype:o.dtype}}},{key:"decode",value:function(e){var t,n=this.texData.get(e),r=n.isPacked,a=n.shape,i=n.dtype,o=eN(a);t=r?new dN(o):new fN(o);return{dtype:i,shape:a,dataId:this.runWebGLProgram(t,[{shape:o,dtype:i,dataId:e}],i,null,!0).dataId}}},{key:"runWebGLProgram",value:function(e,t,n,r){var a=this,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(o.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===IT.DENSE){var u=DT(e.outputShape);s.texShape=u.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(s.usage=e.outTexUsage),0===K(o.shape))return s.values=re(o.dtype,0),o;var l=[],c=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=a.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&K(t.shape)<=Ce().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}else if(!!n.isPacked!==!!e.packedInputs)t=n.isPacked?a.unpackTensor(t):a.packTensor(t),l.push(t),n=a.texData.get(t.dataId);else if(n.isPacked&&!nN(n.shape,t.shape)){var r=t,i=t.shape;t.shape=n.shape,t=a.packedReshape(t,i),l.push(t),n=a.texData.get(t.dataId),r.shape=i}return a.uploadToGPU(t.dataId),{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(o.dataId);var h,p={shape:o.shape,texData:s,isUniform:!1},f=KN(e,c,p),d=this.getAndSaveBinary(f,(function(){return jN(a.gpgpu,e,c,p)})),v=null!=this.activeTimers;v&&(h=this.startTimer()),XN(this.gpgpu,d,c,p,r),l.forEach((function(e){return a.disposeIntermediateTensorInfo(e)})),v&&(h=this.endTimer(h),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(h)}));var m=Ce().get("WEBGL_FLUSH_THRESHOLD");if(m>0){var g=Fr();g-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=g)}if(!Ce().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===i){var y=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),y}return o}},{key:"compileAndRun",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||t[0].dtype;var i=this.runWebGLProgram(e,t,n,r,a);return i}},{key:"getAndSaveBinary",value:function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}},{key:"getTextureManager",value:function(){return this.textureManager}},{key:"dispose",value:function(){var e=this;if(!this.disposed){if(!Ce().getBool("IS_TEST"))Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]}));this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}},{key:"floatPrecision",value:function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Mo((function(){if(!Ce().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=Ce().getBool("DEBUG");Ce().set("DEBUG",!1);var n=e.abs(Lo(1e-8)).dataSync()[0];if(Ce().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"uploadToGPU",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.values,i=t.texture,o=t.usage,s=t.isPacked;if(null==i){var u,l=null!=this.activeTimers;l&&(u=Fr());var c=t.texShape;if(null==c&&(c=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Ce().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(n*=2,1===(e=e.map((function(t,n){return n>=e.length-2?U(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var r=ne(e);e=r.newShape}var a=K(e);if(e.length<=1&&a<=n)return[1,a];if(2===e.length&&e[0]<=n&&e[1]<=n)return e;if(3===e.length&&e[0]*e[1]<=n&&e[2]<=n)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=n&&e[1]*e[2]<=n)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n)return[e[0],e[1]*e[2]*e[3]];if(t){var i=$T(e),o=2,s=2;if(e.length){var u=N(JT(e),2);o=u[0],s=u[1]}return Q(a=i*(o/2)*(s/2)).map((function(e){return 2*e}))}return Q(a)}(n,s),t.texShape=c),null!=a){var h,p=eN(n),f=c[1],d=c[0],v=a instanceof Uint8Array;if(s){var m=N(RT(c[0],c[1]),2);f=m[0],d=m[1],h=new yN(p,[d,f],v)}else h=new gN(p,[d,f],v);var g=this.makeTensorInfo([d,f],r);this.texData.get(g.dataId).usage=v?CT.PIXELS:CT.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),f,d,a);var y=this.runWebGLProgram(h,[g],r,null,!0),b=this.texData.get(y.dataId);t.texture=b.texture,t.texShape=b.texShape,t.isPacked=b.isPacked,t.usage=b.usage,this.disposeIntermediateTensorInfo(g),this.texData.delete(y.dataId),t.values=null,l&&(this.uploadWaitMs+=Fr()-u)}else{var x=this.acquireTexture(c,o,r,s);t.texture=x}}}},{key:"convertAndCacheOnCPU",value:function(e,t){var n=this.texData.get(e),r=n.dtype;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype ".concat(t))}(t,r)),n.values}},{key:"acquireTexture",value:function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(a," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)}},{key:"computeBytes",value:function(e,t){return e[0]*e[1]*se(t)}}]),n}(z);KE.nextDataId=0;Ca()&&Oo("webgl",(function(){return new KE}),2);var YE=R((function e(t,n,r){A(this,e),this.variableNames=["A","B"],this.outputShape=Ns(n,r),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")})),ZE=R((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];A(this,e),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ns(n,r);var i=this.outputShape.length,o="";if(a)if(0===i||1===K(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{var s=UN(i);if(o="\n          ".concat(s," coords = getOutputCoords();\n        "),1===i)o+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{var u=IE("coords",i);o+="\n            bool nextRowOutOfBounds =\n              (".concat(u[i-2]," + 1) >= ").concat(this.outputShape[i-2],";\n            bool nextColOutOfBounds =\n              (").concat(u[i-1]," + 1) >= ").concat(this.outputShape[i-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(o,"\n\n        setOutput(result);\n      }\n    ")}));function QE(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var $E={kernelName:Wt,backendName:"webgl",kernelFunc:QE};function JE(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),s=QE({inputs:{x:r},backend:n}),u=QE({inputs:{x:a},backend:n});return o.complexTensorInfos={real:s,imag:u},i}var eM={kernelName:tt,backendName:"webgl",kernelFunc:JE},tM="return (a < 0.) ? b * a : a;",nM="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var rM={kernelName:Xt,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.alpha,o=n.makeTensorInfo([],"float32",Rr(i,"float32")),s=Ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ZE(nM,a.shape,o.shape):new YE(tM,a.shape,o.shape),u=n.runWebGLProgram(s,[a,o],a.dtype);return n.disposeIntermediateTensorInfo(o),u}},aM="return (a < 0.) ? b * a : a;",iM="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var oM={kernelName:En,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha,i=Ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ZE(iM,r.shape,a.shape):new YE(aM,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)}};function sM(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.cpuKernelImpl,a=e.dtype;return function(e){var i,o=e.inputs,s=e.backend,u=o.x,l=s,c=a||u.dtype;if(l.shouldExecuteOnCPU([u])&&null!=r){var h=l.texData.get(u.dataId),p=r(h.values,c);return l.makeTensorInfo(u.shape,c,p)}return i=Ce().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new GE(u.shape,n):new DE(u.shape,t),l.runWebGLProgram(i,[u],c)}}function uM(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.checkOutOfBounds,a=void 0!==r&&r,i=e.supportsComplex,o=void 0!==i&&i,s=e.cpuKernelImpl,u=e.dtype;return function(e){var r=e.inputs,i=e.backend,l=r.a,c=r.b,h=i;if(o&&"complex64"===l.dtype){var p=h.texData.get(l.dataId),f=h.texData.get(c.dataId),d=[[p.complexTensorInfos.real,f.complexTensorInfos.real],[p.complexTensorInfos.imag,f.complexTensorInfos.imag]].map((function(e){var n=N(e,2),r=n[0],a=n[1],i={dataId:r.dataId,dtype:r.dtype,shape:l.shape},o={dataId:a.dataId,dtype:a.dtype,shape:c.shape},s=new YE(t,l.shape,c.shape);return h.runWebGLProgram(s,[i,o],pa(r.dtype,a.dtype))})),v=N(d,2),m=v[0],g=v[1],y=JE({inputs:{real:m,imag:g},backend:h});return h.disposeIntermediateTensorInfo(m),h.disposeIntermediateTensorInfo(g),y}var b,x=u||pa(l.dtype,c.dtype);if(h.shouldExecuteOnCPU([l,c])&&null!=s){var k=h.texData.get(l.dataId),w=h.texData.get(c.dataId),_=N(s(l.shape,c.shape,k.values,w.values,x),2),S=_[0],I=_[1],C=h.makeTensorInfo(I,x);return h.texData.get(C.dataId).values=S,C}return b=Ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new ZE(n,l.shape,c.shape,a):new YE(t,l.shape,c.shape),h.runWebGLProgram(b,[l,c],x)}}function lM(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return t?VE:OE;if("relu"===e)return t?UE:PE;if("elu"===e)return t?WE:LE;if("relu6"===e)return t?HE:zE;if("prelu"===e)return t?iM:aM;if("leakyrelu"===e)return t?nM:tM;throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}var cM=R((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];A(this,e),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;var c=a?t[1]:t[2],h=Math.ceil(c/2),p=a?"i * 2, rc.y":"rc.y, i * 2",f=i?"rc.z, i * 2":"i * 2, rc.z",d=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],v=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],m="",g="";s&&(m=u?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(s,"\n        }"):l?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(s,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(s,"\n        }"),g="result = activation(result);");var y=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");var b="rc.x",x="rc.x";t[0]<n[0]?b="int(min(float(rc.x), ".concat(t[0]-1,".))"):n[0]<t[0]&&(x="int(min(float(rc.x), ".concat(n[0]-1,".))")),this.userCode="\n      ".concat(m,"\n\n      const float sharedDimension = ").concat(h,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ").concat(h,"; i++) {\n          int batchA = ").concat(b,";\n          int batchB = ").concat(x,";\n          vec4 a = getMatrixA(batchA, ").concat(p,");\n          vec4 b = getMatrixB(batchB, ").concat(f,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(d[0]," * ").concat(v[0],");\n          result += (").concat(d[1]," * ").concat(v[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(y,"\n\n        ").concat(g,"\n\n        setOutput(result);\n      }\n    ")})),hM="return areal * breal - aimag * bimag;",pM="return areal * bimag + aimag * breal;",fM=R((function e(t,n,r){A(this,e),this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Ns(n,r),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")})),dM="return a * b;";function vM(e){var t,n=e.inputs,r=e.backend,a=n.a,i=n.b,o=pa(a.dtype,i.dtype);if("complex64"===a.dtype){var s=r.texData.get(a.dataId),u=r.texData.get(i.dataId),l=new fM(hM,a.shape,i.shape),c=new fM(pM,a.shape,i.shape),h=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:a.shape},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:a.shape},{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:i.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:i.shape}],p=r.runWebGLProgram(l,h,"float32"),f=r.runWebGLProgram(c,h,"float32"),d=JE({inputs:{real:p,imag:f},backend:r});return r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(f),d}if(r.shouldExecuteOnCPU([a,i])){var v=r.texData.get(a.dataId),m=r.texData.get(i.dataId),g=N(hE(a.shape,i.shape,v.values,m.values,o),2),y=g[0],b=g[1],x=r.makeTensorInfo(b,o);return r.texData.get(x.dataId).values=y,x}return t=Ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ZE(dM,a.shape,i.shape):new YE(dM,a.shape,i.shape),r.runWebGLProgram(t,[a,i],o)}var mM={kernelName:yn,backendName:"webgl",kernelFunc:vM};function gM(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.shape,o=n,s=K(a.shape),u=ee(i,s),l=K(u);G(s===l,(function(){return"The new shape (".concat(u,") has ").concat(l," elements and the old ")+"shape (".concat(a.shape,") has ").concat(s," elements. The new shape and old ")+"shape must have the same number of elements."}));var c=o.texData.get(a.dataId);return!c.isPacked||nN(a.shape,u)||null!==c.texture&&nN(c.shape,u)?(o.incRef(a.dataId),{dataId:a.dataId,shape:u,dtype:a.dtype}):function(e,t,n){var r=[$T(e.shape)].concat(I(JT(e.shape))),a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[$T(t)].concat(I(JT(t))),o=new TE(i,r),s=n.runWebGLProgram(o,[a],e.dtype,null,!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}(a,u,o)}var yM={kernelName:Fn,backendName:"webgl",kernelFunc:gM},bM=R((function e(t,n){A(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var s=4*Math.floor(r/4),u=r%4,l="sumValue += dot(values, ones);";if(null!=n){var c=1/n;l="sumValue += dot(values * ".concat(Z(c)?c.toPrecision(2):c,", ones);")}var h="";i%r>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(h,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===u,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(2===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(3===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(l,"\n        }\n        setOutput(sumValue);\n      }\n    ")})),xM=R((function e(t,n){A(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var s="0.0",u="";"prod"===n?s="1.0":"min"===n?(s="1.0 / 1e-20",u="min"):"max"===n&&(s="-1.0 / 1e-20",u="max");var l="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===n?l="sumValue":"prod"===n?l="prodValue":"all"===n?l="allValue":"any"===n&&(l="anyValue");var c=4*Math.floor(r/4),h=r%4,p="\n      if (".concat("sum"===n,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===n,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(u,"(values, minMaxValue);\n      }\n    "),f="vec4";"all"===n?(s="1.0",p="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",f="bvec4"):"any"===n&&(s="0.0",p="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",f="bvec4");var d="";i%r>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(s,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(d,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        vec4 minMaxValue = vec4(").concat(s,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(f," values = ").concat(f,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(p,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(1===h,") {\n          ").concat(f," values = ").concat(f,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(p,"\n        } else if (").concat(2===h,") {\n          ").concat(f," values = ").concat(f,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(p,"\n        } else if (").concat(3===h,") {\n          ").concat(f," values = ").concat(f,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(p,"\n        }\n        setOutput(").concat(l,");\n      }\n    ")}));function kM(e,t,n,r){for(var a=function(e){for(var t=[];0===t.length||1!==t[t.length-1].outSize;){var n=t.length?t[t.length-1].outSize:e[1],r=xc(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape),i=e,o=0;o<a.length;o++){var s,u=a[o],l=u.inSize,c=u.windowSize,h=u.outSize,p=void 0;p="mean"===n?0===o?new bM({windowSize:c,inSize:l,batchSize:e.shape[0],outSize:h},l):new bM({windowSize:c,inSize:l,batchSize:e.shape[0],outSize:h}):new xM({windowSize:c,inSize:l,batchSize:e.shape[0],outSize:h},n),s=i,i=r.runWebGLProgram(p,[i],t),s.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(s)}return i}var wM=R((function e(t,n){A(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];this.outputShape=r,this.rank=r.length;var i=UN(this.rank),o=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(n);this.userCode="\n    void main() {\n      ".concat(i," resRC = getOutputCoords();\n      setOutput(getA(").concat(o,"));\n    }\n    ")}));var _M=R((function e(t,n){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));for(var i=UN(this.rank),o=SE("rc",this.rank),s=new Array(this.rank),u=0;u<n.length;u++)s[n[u]]=o[u];var l="vec2(".concat(s.slice(-2).join(),")"),c="++".concat(o[this.rank-1]," < ").concat(r[this.rank-1]),h="getChannel(getA(".concat(s.join(),"), ").concat(l,")");this.userCode="\n    void main() {\n      ".concat(i," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(h,";\n      if(").concat(c,") {\n        result[1] = ").concat(h,";\n      }\n      --").concat(o[this.rank-1],";\n      if(++").concat(o[this.rank-2]," < ").concat(r[this.rank-2],") {\n        result[2] = ").concat(h,";\n        if(").concat(c,") {\n          result[3] = ").concat(h,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}));function SM(e,t,n){var r=Ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new _M(e.shape,t):new wM(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function IM(e){var t=e.inputs,n=e.backend,r=e.attrs;return function(e,t,n,r){var a=t,i=e.shape.length,o=te(a,e.shape),s=o,u=ru(s,i),l=null!=u,c=e;l&&(c=SM(e,u,r),s=iu(s.length,i)),nu("sum",s,i);var h=N(eu(c.shape,s),2),p=h[0],f=h[1],d=p;n&&(d=tu(p,o));var v=K(f),m=gM({inputs:{x:c},attrs:{shape:[K(e.shape)/v,v]},backend:r}),g=kM(m,fa(e.dtype),"sum",r),y=gM({inputs:{x:g},attrs:{shape:d},backend:r});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(g),l&&r.disposeIntermediateTensorInfo(c),y}(t.x,r.axis,r.keepDims,n)}var CM={kernelName:er,backendName:"webgl",kernelFunc:IM};function TM(e){for(var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.perm,s=r,u=i.shape.length,l=new Array(u),c=0;c<l.length;c++)l[c]=i.shape[o[c]];if(s.shouldExecuteOnCPU([i])){var h=s.texData.get(i.dataId).values,p=wE(h,i.shape,i.dtype,o,l);t=s.makeTensorInfo(l,i.dtype),s.texData.get(t.dataId).values=p}else t=SM(i,o,s);return t}var NM={kernelName:dr,backendName:"webgl",kernelFunc:TM};function EM(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.backend,o=e.bias,s=void 0===o?null:o,u=e.preluActivationWeights,l=void 0===u?null:u,c=e.leakyreluAlpha,h=void 0===c?0:c,p=e.activation,f=void 0===p?null:p,d=t.shape.length,v=n.shape.length,m=r?t.shape[d-2]:t.shape[d-1],g=a?n.shape[v-1]:n.shape[v-2],y=r?t.shape[d-1]:t.shape[d-2],b=a?n.shape[v-2]:n.shape[v-1],x=t.shape.slice(0,-2),k=n.shape.slice(0,-2),w=K(x),_=K(k);G(d>=2&&v>=2&&(w===_||1===w||1===_),(function(){return"Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input "+"batch dimensions of (".concat(x,") and (").concat(k,").")}));var S=(w>_?t.shape.slice(0,-2):n.shape.slice(0,-2)).concat([y,b]);G(m===g,(function(){return"Error in matMul: inner shapes (".concat(m,") and (")+"".concat(g,") of Tensors with shapes ").concat(t.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match.")}));var I,C=r?[w,m,y]:[w,y,m],T=a?[_,b,g]:[_,g,b],N=gM({inputs:{x:t},backend:i,attrs:{shape:C}}),E=gM({inputs:{x:n},backend:i,attrs:{shape:T}}),M=[N,E],A=Math.max(w,_),D=r?N.shape[1]:N.shape[2],R=null!=s,O=null!=l,F="leakyrelu"===f,L=null!=f?lM(f,!0):null;if((1===y||1===b)&&D>1e3&&!1===(R||O||F||null!=L)){var P=N,z=E;r&&(P=TM({inputs:{x:N},backend:i,attrs:{perm:[0,2,1]}}),M.push(P)),a&&(z=TM({inputs:{x:E},backend:i,attrs:{perm:[0,2,1]}}),M.push(z));var B=1===b,V=P;1!==b&&(V=gM({inputs:{x:P},backend:i,attrs:{shape:[A,D,1]}}),M.push(V));var W=1===b?2:1,U=z;B&&(U=gM({inputs:{x:z},backend:i,attrs:{shape:[A,1,D]}}),M.push(U));var H=vM({inputs:{a:V,b:U},backend:i});I=IM({inputs:{x:H},backend:i,attrs:{axis:W,keepDims:!0}}),M.push(H)}else{var j=pa(t.dtype,n.dtype),q=new cM(C,T,[A,y,b],r,a,R,L,O,F),X=[N,E];if(null!=s&&X.push(s),O&&X.push(l),F){var Y=i.makeTensorInfo([],"float32",Rr(h,"float32"));X.push(Y),M.push(Y)}I=i.runWebGLProgram(q,X,j)}var Z=gM({inputs:{x:I},backend:i,attrs:{shape:S}});M.push(I);for(var Q=0,$=M;Q<$.length;Q++){var J=$[Q];i.disposeIntermediateTensorInfo(J)}return Z}var MM={kernelName:wr,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=t.bias,s=t.preluActivationWeights,u=r.transposeA,l=r.transposeB,c=r.activation;return EM({a:a,b:i,transposeA:u,transposeB:l,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:r.leakyreluAlpha,activation:c})}},AM="return abs(x);";var DM={kernelName:Ae,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])&&"complex64"!==a.dtype){var i=r.texData.get(a.dataId),o=mE(i.values);return r.makeTensorInfo(a.shape,a.dtype,o)}return t=Ce().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new GE(a.shape,AM):new DE(a.shape,AM),r.runWebGLProgram(t,[a],a.dtype)}},RM=sM({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),OM={kernelName:De,backendName:"webgl",kernelFunc:RM},FM=sM({opSnippet:"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),LM={kernelName:Re,backendName:"webgl",kernelFunc:FM},PM="return a + b;",zM=uM({opSnippet:PM,packedOpSnippet:PM,supportsComplex:!0,cpuKernelImpl:YN}),BM={kernelName:Oe,backendName:"webgl",kernelFunc:zM},VM=R((function e(t,n){A(this,e),this.outputShape=[],this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")})),WM=R((function e(t,n){A(this,e),this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}));var UM={kernelName:Fe,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n;if(1===a.length)return QE({inputs:{x:a[0]},backend:r});if(a.length>Ce().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(a.length/2),o=e({inputs:a.slice(0,i),backend:r}),s=e({inputs:a.slice(i),backend:r});return e({inputs:[o,s],backend:r})}var u=a.map((function(e){return e.dtype})).reduce((function(e,t){return pa(e,t)})),l=a.map((function(e){return e.shape})),c=Ce().getBool("WEBGL_PACK")?new WM(a[0].shape,l):new VM(a[0].shape,l);return r.runWebGLProgram(c,a,u)}};var HM={kernelName:Le,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=te(i,a.shape),l=u,c=ru(l,s),h=a;null!=c&&(h=TM({inputs:{x:a},backend:n,attrs:{perm:c}}),l=iu(l.length,s)),nu("all",l,s);var p,f=N(eu(h.shape,l),2),d=f[0],v=gM({inputs:{x:h},backend:n,attrs:{shape:[-1,K(f[1])]}}),m=kM(v,v.dtype,"all",n);return p=gM(o?{inputs:{x:m},backend:n,attrs:{shape:tu(d,u)}}:{inputs:{x:m},backend:n,attrs:{shape:d}}),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m),null!=c&&n.disposeIntermediateTensorInfo(h),p}};var GM={kernelName:Pe,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=te(i,a.shape),l=u,c=ru(l,s),h=a;null!=c&&(h=TM({inputs:{x:a},backend:n,attrs:{perm:c}}),l=iu(l.length,s)),nu("any",l,s);var p,f=N(eu(h.shape,l),2),d=f[0],v=gM({inputs:{x:h},backend:n,attrs:{shape:[-1,K(f[1])]}}),m=kM(v,v.dtype,"any",n);return p=gM(o?{inputs:{x:m},backend:n,attrs:{shape:tu(d,u)}}:{inputs:{x:m},backend:n,attrs:{shape:d}}),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m),null!=c&&n.disposeIntermediateTensorInfo(h),p}},jM=R((function e(t,n,r){A(this,e),this.variableNames=["A"];var a=t.windowSize,i=t.batchSize,o=t.outSize;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var s="max"===n?">":"<",u=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(u,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(s," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")})),qM=R((function e(t,n,r,a){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,G(t.length>2,(function(){return"Packed arg".concat(r.charAt(0).toUpperCase()+r.slice(1)," supports only inputs with rank above 2.")}));var i=t[t.length-1],o=Math.ceil(i/n);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),a||this.variableNames.push("bestIndicesA");var s,u,l=this.outputShape,c=l.length,h=UN(c),p=IE("coords",c);if(1===o){var f=UN(u=c+1);s="\n        ".concat(f," sourceLocR = ").concat(f,"(").concat(p.join(),", 0);\n        ++").concat(p[c-1],";\n        ").concat(f," sourceLocG = ").concat(f,"(").concat(p.join(),", 0);\n        ++").concat(p[c-2],";\n        ").concat(f," sourceLocA = ").concat(f,"(").concat(p.join(),", 0);\n        --").concat(p[c-1],";\n        ").concat(f," sourceLocB = ").concat(f,"(").concat(p.join(),", 0);\n        --").concat(p[c-2],";")}else u=c,s="\n        ".concat(h," sourceLocR = coords;\n        ++").concat(p[c-1],";\n        ").concat(h," sourceLocG = coords;\n        ++").concat(p[c-2],";\n        ").concat(h," sourceLocA = coords;\n        --").concat(p[c-1],";\n        ").concat(h," sourceLocB = coords;\n        --").concat(p[c-2],";");var d=["x","y","z","w","u","v"].slice(0,u),v="."+d[u-1],m=d.map((function(e){return"int "+e})),g=IE("sourceLocR",u-1).concat("inIdx.r"),y=IE("sourceLocG",u-1).concat("inIdx.g"),b=IE("sourceLocB",u-1).concat("inIdx.b"),x=IE("sourceLocA",u-1).concat("inIdx.a"),k="max"===r?"greaterThan":"lessThan",w=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),"),\n                             getBestIndicesAChannel(").concat(x.join(),")));"),_="vec4(\n            getAChannel(".concat(g.join(),"),\n            hasNextCol ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(b.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(x.join(),") : 0.)"),S=a?"":"\n      float getBestIndicesAChannel(".concat(m.join(),") {\n        return getChannel(getBestIndicesA(").concat(d.join(),"),\n                                          vec2(").concat(d.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(m.join(),") {\n        return getChannel(getA(").concat(d.join(),"),\n                               vec2(").concat(d.slice(-2).join(),"));\n      }\n      ").concat(S,"\n      void main() {\n        ").concat(h," coords = getOutputCoords();\n        bool hasNextCol = ").concat(p[c-1]," < ").concat(l[c-1]-1,";\n        bool hasNextRow = ").concat(p[c-2]," < ").concat(l[c-2]-1,";\n        ").concat(s,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(v,", sourceLocG").concat(v,",\n          sourceLocB").concat(v,", sourceLocA").concat(v,") * ").concat(n,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(_,";\n\n        for (int i = 0; i < ").concat(n,"; i++) {\n          inIdx = srcIdx;\n          ").concat(w,"\n          vec4 candidate = ").concat(_,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(k,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}));function XM(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=t.shape[0],i=t.shape[1];null!=r&&(a=r.shape[0],i=r.shape[1]);var o=xc(i),s={windowSize:o,inSize:i,batchSize:a,outSize:Math.ceil(i/o)},u=new jM(s,n,null==r),l=[t];null!=r&&l.push(r);var c=e.runWebGLProgram(u,l,"int32");if(1===c.shape[1])return c;var h=XM(e,t,n,c);return e.disposeIntermediateTensorInfo(c),h}function KM(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=null!=r?r.shape:t.shape,i=a[a.length-1],o=xc(i),s=new qM(a,o,n,null==r),u=null==r?[t]:[t,r],l=e.runWebGLProgram(s,u,"int32");if(l.shape.length===t.shape.length){var c=KM(e,t,n,l);return e.disposeIntermediateTensorInfo(l),c}return l}function YM(e,t,n,r){var a=[n];if(nu("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,t.shape.length),!Ce().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){var i=[],o=N(eu(t.shape,a),2),s=o[0],u=K(o[1]),l=gM({inputs:{x:t},backend:e,attrs:{shape:[-1,u]}});i.push(l);var c=XM(e,l,r);i.push(c);var h=gM({inputs:{x:c},backend:e,attrs:{shape:s}});return i.forEach((function(t){return e.disposeIntermediateTensorInfo(t)})),h}return KM(e,t,r)}var ZM={kernelName:ze,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=te(r.axis,a.shape),o=ru(i,a.shape.length),s=a,u=[];null!=o&&(s=TM({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(s),i=iu(i.length,s.shape.length)),nu("argMax",[i[0]],s.shape.length);var l=YM(n,s,i[0],"max");return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),l}};var QM={kernelName:Be,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=te(r.axis,a.shape),o=ru(i,a.shape.length),s=a,u=[];null!=o&&(s=TM({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(s),i=iu(i.length,s.shape.length)),nu("argMin",[i[0]],s.shape.length);var l=YM(n,s,i[0],"min");return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),l}},$M=sM({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),JM={kernelName:Ve,backendName:"webgl",kernelFunc:$M},eA=sM({opSnippet:"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));"}),tA={kernelName:We,backendName:"webgl",kernelFunc:eA},nA=sM({opSnippet:"if (isnan(x)) return x;\n  return atan(x);\n"}),rA={kernelName:Ue,backendName:"webgl",kernelFunc:nA},aA=uM({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),iA={kernelName:Ge,backendName:"webgl",kernelFunc:aA},oA=sM({opSnippet:"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),sA={kernelName:He,backendName:"webgl",kernelFunc:oA},uA=R((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(A(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideHeight,u=t.strideWidth,l=t.dilationHeight,c=t.dilationWidth,h=t.effectiveFilterHeight,p=t.effectiveFilterWidth,f=t.padInfo.top,d=t.padInfo.left;this.outputShape=t.outShape;var v="avg"===n,m="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),g="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),y="0.0";if(v||(y="-1.0 / 1e-20"),r){var b=">=";this.userCode="\n        const ivec2 strides = ivec2(".concat(s,", ").concat(u,");\n        const ivec2 pads = ivec2(").concat(f,", ").concat(d,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(h,";\n              wR += ").concat(l,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(p,";\n                wC += ").concat(c,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(b," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?i?m:g:"wR * ".concat(p," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var x="max",k="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(k="avgValue / count");var w=4*Math.floor(o/4),_=o%4,S="\n      if (".concat(v,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(x,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(s,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(f,", ").concat(d,");\n      const float initializationValue = ").concat(y,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(y,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(h,";\n            wR += ").concat(l,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(w,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(c,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              getValue(batch, xR, xC + 3 * ").concat(c,", d)\n            );\n\n            ").concat(S,"\n          }\n\n          int xC = xCCorner + ").concat(w,";\n          if (").concat(1===_,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(S,"\n          } else if (").concat(2===_,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(S,"\n          } else if (").concat(3===_,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              initializationValue\n            );\n\n            ").concat(S,"\n          }\n        }\n        setOutput(").concat(k,");\n      }\n    ")}})),lA=R((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(A(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideDepth,u=t.strideHeight,l=t.strideWidth,c=t.dilationDepth,h=t.dilationHeight,p=t.dilationWidth,f=t.effectiveFilterDepth,d=t.effectiveFilterHeight,v=t.effectiveFilterWidth,m=t.padInfo.front,g=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;var b="avg"===n,x="0.0";if(b||(x="-1.0 / 1e-20"),r){var k=">=";this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(s,", ").concat(u,", ").concat(l,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(f,";\n              wD += ").concat(c,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(d,";\n                wR += ").concat(h,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(v,";\n                  wC += ").concat(p,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(k," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?i?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(d," * ").concat(v," +\n                      wR * ").concat(v," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var w="max",_="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(_="avgValue / count");var S=4*Math.floor(o/4),I=o%4,C="\n      if (".concat(b,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(w,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(s,", ").concat(u,", ").concat(l,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n      const float initializationValue = ").concat(x,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(x,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(f,";\n            wD += ").concat(c,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(d,";\n            wR += ").concat(h,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(S,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(p,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(p,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(p,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(p,", ch)\n              );\n\n              ").concat(C,"\n            }\n\n            int xC = xCCorner + ").concat(S,";\n            if (").concat(1===I,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(C,"\n            } else if (").concat(2===I,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(p,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(C,"\n            } else if (").concat(3===I,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(p,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(p,", ch),\n                initializationValue\n              );\n\n              ").concat(C,"\n            }\n          }\n          setOutput(").concat(_,");\n        }\n      }\n    ")}}));var cA={kernelName:je,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;sN(a,"avgPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;G(ns(o,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var l=Go(a.shape,i,o,1,s,u);if(1===l.filterWidth&&1===l.filterHeight&&Y(l.inShape,l.outShape))return QE({inputs:{x:a},backend:n});var c=new uA(l,"avg",!1);return n.runWebGLProgram(c,[a],"float32")}};var hA={kernelName:Xe,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode,l=r.dataFormat,c=jo(a.shape,i,o,[1,1,1],s,u,l),h=new lA(c,"avg",!1);return n.runWebGLProgram(h,[a],"float32")}},pA=R((function e(t){A(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterHeight,l=t.effectiveFilterWidth,c=u-1-t.padInfo.top,h=l-1-t.padInfo.left,p=1/(n*r);this.userCode="\n      const ivec2 pads = ivec2(".concat(c,", ").concat(h,");\n      const float avgMultiplier = float(").concat(p,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(o,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(l,";\n            wC+= ").concat(s,") {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),fA=R((function e(t){A(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=t.dilationDepth,l=t.dilationHeight,c=t.dilationWidth,h=t.effectiveFilterDepth,p=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=h-1-t.padInfo.front,v=p-1-t.padInfo.top,m=f-1-t.padInfo.left,g=1/(n*r*a);this.userCode="\n      const ivec3 pads = ivec3(".concat(d,", ").concat(v,", ").concat(m,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(h,";\n            wD += ").concat(u,") {\n          float dyD = float(dyDCorner + wD) / ").concat(i,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(p,";\n              wR += ").concat(l,") {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(f,";\n                wC += ").concat(c,") {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var dA={kernelName:Ke,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,l=r.dimRoundingMode,c=jo(i.shape,o,s,[1,1,1],u,l),h=new fA(c);return n.runWebGLProgram(h,[a],i.dtype)}};var vA={kernelName:qe,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;sN([a,i],"avgPoolGrad");var s=r.filterSize,u=r.strides,l=r.pad,c=Go(o.shape,s,u,1,l),h=new pA(c);return n.runWebGLProgram(h,[a],o.dtype)}};var mA={kernelName:Ye,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;return EM({a:t.a,b:t.b,transposeA:r.transposeA,transposeB:r.transposeB,backend:n})}},gA=R((function e(t,n,r,a,i,o){A(this,e),this.outputShape=[],this.variableNames=["x","mean","variance"],Ns(t,n),Ns(t,r);var s="0.0";null!=a&&(Ns(t,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="1.0";null!=i&&(Ns(t,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(s,";\n        float scale = ").concat(u,";\n        float inv = scale * inversesqrt(variance + float(").concat(o,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")})),yA=R((function e(t,n,r,a,i,o){A(this,e),this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Ns(t,n),Ns(t,r);var s="vec4(0.0)";null!=a&&(Ns(t,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="vec4(1.0)";null!=i&&(Ns(t,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(s,";\n        vec4 scale = ").concat(u,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(o,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")})),bA={kernelName:Lt,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.mean,o=t.variance,s=t.offset,u=t.scale;G(i.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),G(null==s||i.shape.length===s.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),G(null==u||i.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var l=r.varianceEpsilon;null==l&&(l=.001);var c=[a,i,o],h=null;null!=s&&(h=s.shape,c.push(s));var p=null;null!=u&&(p=u.shape,c.push(u));var f=Ce().getBool("WEBGL_PACK_NORMALIZATION")?new yA(a.shape,i.shape,o.shape,h,p,l):new gA(a.shape,i.shape,o.shape,h,p,l);return n.runWebGLProgram(f,c,c[0].dtype)}},xA=function(){function e(t){A(this,e),this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=UN(this.rank),a="uniform int start[".concat(this.rank,"];"),i=function(e){if(1===e)return"sourceLoc";if(e<=6)return kA.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank),o=t.map((function(e,t){return"sourceLoc.".concat(kA[t]," = start[").concat(t,"] + coords.").concat(kA[t],";")}));n="\n        ".concat(r," sourceLoc;\n        ").concat(r," coords = getOutputCoords();\n        ").concat(o.join("\n"),"\n      "),this.userCode="\n      ".concat(a,"\n      void main() {\n        ").concat(n,"\n        setOutput(getSource(").concat(i,"));\n      }\n    ")}return R(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;if(e.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(e.length,")"));return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}}}]),e}(),kA=["x","y","z","w","u","v"];var wA=function(){function e(t){A(this,e),this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=UN(this.rank),r=IE("coords",this.rank),a=IE("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),o="getChannel(getSource(".concat(a.join(),"), ").concat(i,")"),s="\n      result.x = ".concat(o,";\n      if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(o,";\n        --").concat(a[this.rank-1],";\n      }\n    "),u=1===this.rank?"":"\n      --".concat(r[this.rank-1],";\n      if (++").concat(r[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(o,";\n        if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(o,";\n        }\n      }\n    "),l=this.rank<=4?"sourceLoc = coords +\n            ".concat(n,"(").concat(t.map((function(e,t){return"start[".concat(t,"]")})).join(),");"):t.map((function(e,t){return"".concat(a[t]," = ").concat(r[t]," + start[").concat(t,"];")})).join("\n");this.userCode="\n      uniform int start[".concat(this.rank,"];\n      void main() {\n        ").concat(n," coords = getOutputCoords();\n        ").concat(n," sourceLoc;\n        ").concat(l,"\n        vec4 result = vec4(0.);\n        ").concat(s,"\n        ").concat(u,"\n        setOutput(result);\n      }\n    ")}return R(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;if(e.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(e.length,")"));return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}}}]),e}();function _A(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=N(_o(a,r.begin,r.size),2),o=i[0],s=i[1];if(po(a,o,s),0===K(s))return n.makeTensorInfo(s,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){var u=n.texData.get(a.dataId),l=gE(u.values,o,s,a.shape,a.dtype);return n.makeTensorInfo(s,a.dtype,l)}var c=n.texData.get(a.dataId).isPacked,h=ko(a.shape,o,s);if(c||!h){var p=Ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new wA(s):new xA(s),f=p.getCustomSetupFunc(o);return n.runWebGLProgram(p,[a],a.dtype,f)}return n.uploadToGPU(a.dataId),function(e,t,n,r){var a=r.texData.get(e.dataId),i=r.makeTensorInfo(n,e.dtype),o=r.texData.get(i.dataId);Object.assign(o,a),o.refCount=1,o.shape=n,o.dtype=e.dtype;var s=wo(t,fe(e.shape));a.slice&&(s+=a.slice.flatOffset),o.slice={flatOffset:s,origDataId:a.slice&&a.slice.origDataId||e.dataId};var u=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,u+1),i}(a,o,s,n)}var SA={kernelName:Xn,backendName:"webgl",kernelFunc:_A},IA={kernelName:Ze,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.crops;G(a.shape.length<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var s=i.reduce((function(e,t){return e*t})),u=wc(a.shape,i,s),l=_c(u.length,i.length),c=Sc(a.shape,i,s),h=Ic(o,i.length),p=Cc(c,o,i.length),f=[],d=gM({inputs:{x:a},backend:n,attrs:{shape:u}}),v=TM({inputs:{x:d},backend:n,attrs:{perm:l}}),m=gM({inputs:{x:v},backend:n,attrs:{shape:c}}),g=_A({inputs:{x:m},backend:n,attrs:{begin:h,size:p}});return f.push(d),f.push(v),f.push(m),f.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}};var CA={kernelName:Qe,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=n.readSync(a.dataId),u=n.readSync(i.dataId),l=ZN(s,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,l)}},TA=uM({opSnippet:"return float(a != b);",dtype:"bool"}),NA={kernelName:xn,backendName:"webgl",kernelFunc:TA};function EA(e){var t=e.inputs,n=e.backend,r=t.input;return QE({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}var MA={kernelName:Dn,backendName:"webgl",kernelFunc:EA};var AA={kernelName:$e,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=t.attrs,i=n.x,o=a.dtype;if("complex64"===o){if("complex64"===i.dtype)return QE({inputs:{x:i},backend:r});var s=hu(i.shape),u=e({inputs:{x:i},backend:r,attrs:{dtype:"float32"}}),l=JE({inputs:{real:u,imag:s},backend:r});return s.dispose(),r.disposeIntermediateTensorInfo(u),l}if("complex64"===i.dtype){var c=EA({inputs:{input:i},backend:r}),h=e({inputs:{x:c},backend:r,attrs:{dtype:o}});return r.disposeIntermediateTensorInfo(c),h}if(!ie(i.dtype,o)){var p=QE({inputs:{x:i},backend:r});return{dataId:p.dataId,shape:p.shape,dtype:o}}if("int32"===o)return function(e,t){var n=new DE(e.shape,"return float(int(x));"),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(i,r);if("bool"===o){var f=r.makeTensorInfo([],"bool",re("bool",1)),d=TA({inputs:{a:i,b:f},backend:r});return r.disposeIntermediateTensorInfo(f),d}throw new Error("Error in Cast: failed to cast ".concat(i.dtype," to ").concat(o))}},DA="return ceil(x);",RA=sM({opSnippet:DA,packedOpSnippet:DA,cpuKernelImpl:$N}),OA={kernelName:Je,backendName:"webgl",kernelFunc:RA},FA=function(){function e(t){A(this,e),this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return R(e,[{key:"getCustomSetupFunc",value:function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}}}]),e}(),LA=function(){function e(t){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return R(e,[{key:"getCustomSetupFunc",value:function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}}}]),e}();var PA={kernelName:et,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.clipValueMin,s=a.clipValueMax,u=(t=Ce().getBool("WEBGL_PACK_CLIP")?new LA(i.shape):new FA(i.shape)).getCustomSetupFunc(o,s);return r.runWebGLProgram(t,[i],i.dtype,u)}},zA=R((function e(t){A(this,e),this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}));function BA(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}var VA={kernelName:nt,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n.texData.get(r.dataId),i=new zA(r.shape),o=[BA(r,a.complexTensorInfos.real),BA(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}},WA=R((function e(t){A(this,e),this.outputShape=[],this.outputShape=bc(t,1),this.variableNames=t.map((function(e,t){return"T".concat(t)}));var n=new Array(t.length-1);n[0]=t[0][1];for(var r=1;r<n.length;r++)n[r]=n[r-1]+t[r][1];for(var a=["if (yC < ".concat(n[0],") setOutput(getT0(yR, yC));")],i=1;i<n.length;i++){var o=n[i-1];a.push("else if (yC < ".concat(n[i],") ")+"setOutput(getT".concat(i,"(yR, yC-").concat(o,"));"))}var s=n.length,u=n[n.length-1];a.push("else setOutput(getT".concat(s,"(yR, yC-").concat(u,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(a.join("\n        "),"\n      }\n    ")})),UA=R((function e(t,n){A(this,e),this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=bc(t,n);var r=this.outputShape,a=r.length,i=UN(a),o=IE("coords",a),s=["x","y","z","w","u","v"].slice(0,a);this.variableNames=t.map((function(e,t){return"T".concat(t)}));var u=new Array(t.length-1);u[0]=t[0][n];for(var l=1;l<u.length;l++)u[l]=u[l-1]+t[l][n];for(var c=s[n],h=s.slice(-2),p=s.join(),f="if (".concat(c," < ").concat(u[0],") {\n        return getChannel(\n            getT0(").concat(p,"), vec2(").concat(h.join(),"));\n        }"),d=1;d<u.length;d++){var v=u[d-1];f+="\n        if (".concat(c," < ").concat(u[d],"  && ").concat(c," >= ").concat(u[d-1],") {\n          return getChannel(\n            getT").concat(d,"(").concat(HA(s,c,v),"),\n            vec2(").concat(HA(h,c,v),"));\n        }")}var m=u.length,g=u[u.length-1];f+="\n        return getChannel(\n          getT".concat(m,"(").concat(HA(s,c,g),"),\n          vec2(").concat(HA(h,c,g),"));"),this.userCode="\n      float getValue(".concat(s.map((function(e){return"int "+e})),") {\n        ").concat(f,"\n      }\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(o,"), 0., 0., 0.);\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," + 1;\n        if (").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.g = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-2]," = ").concat(o[a-2]," + 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2],") {\n          result.a = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," - 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2]," &&\n            ").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.b = getValue(").concat(o,");\n        }\n        setOutput(result);\n      }\n    ")}));function HA(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?"".concat(e," - ").concat(n):e})).join()}function GA(e){var t=e.inputs,n=e.backend,r=t.input;return QE({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}var jA={kernelName:Ht,backendName:"webgl",kernelFunc:GA};function qA(e,t,n){var r=e[0].dtype;if("complex64"===r){var a=e.map((function(e){return EA({inputs:{input:e},backend:n})})),i=e.map((function(e){return GA({inputs:{input:e},backend:n})})),o=qA(a,t,n),s=qA(i,t,n),u=JE({inputs:{real:o,imag:s},backend:n});return a.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),i.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}if("string"===r){var l=XA(e,t,n),c=l.tensors2D,h=l.outShape,p=c.map((function(e){return{vals:n.readSync(e.dataId),shape:e.shape}})),f=1===c[0].shape[0],d=JN(p,h,r,f),v=bc(e.map((function(e){return e.shape})),t),m=n.makeTensorInfo(v,r,d);return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),m}if(e.length>Ce().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var g=Math.floor(e.length/2),y=qA(e.slice(0,g),t,n),b=qA(e.slice(g),t,n),x=qA([y,b],t,n);return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),x}if(Ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].shape.length>1){var k=new UA(e.map((function(e){return e.shape})),t);return n.runWebGLProgram(k,e,r)}var w=XA(e,t,n),_=w.tensors2D,S=w.outShape,I=new WA(_.map((function(e){return e.shape}))),C=n.runWebGLProgram(I,_,r);_.forEach((function(e){return n.disposeIntermediateTensorInfo(e)}));var T=gM({inputs:{x:C},attrs:{shape:S},backend:n});return n.disposeIntermediateTensorInfo(C),T}function XA(e,t,n){var r=bc(e.map((function(e){return e.shape})),t);return{tensors2D:e.map((function(e){return gM({inputs:{x:e},attrs:{shape:[-1,K(e.shape.slice(t))]},backend:n})})),outShape:r}}function KA(e){var t=e.inputs,n=e.backend,r=te(e.attrs.axis,t[0].shape)[0],a=bc(t.map((function(e){return e.shape})),r);if(0===K(a))return n.makeTensorInfo(a,t[0].dtype,[]);var i=t.filter((function(e){return K(e.shape)>0}));return 1===i.length?QE({inputs:{x:i[0]},backend:n}):(yc(i.map((function(e){return e.shape})),r),qA(i,r,n))}var YA={kernelName:rt,backendName:"webgl",kernelFunc:KA},ZA=R((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];A(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,h=t.dilationWidth,p=t.filterHeight,f=t.filterWidth,d=4*Math.floor(t.inChannels/4),v=t.inChannels%4,m="channelsLast"===t.dataFormat,g=m?1:2,y=m?2:3,b=m?3:1,x="",k="";r&&(x=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),k="result = activation(result);");var w=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(x,"\n\n      const ivec2 strides = ivec2(").concat(u,", ").concat(l,");\n      const ivec2 pads = ivec2(").concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(b,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(g,"], coords[").concat(y,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(p,"; wR++) {\n          int xR = xRCorner + wR * ").concat(c,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(f,"; wC++) {\n            int xC = xCCorner + wC * ").concat(h,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(d,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(m,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===v,") {\n\n              if (").concat(m,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(d,") *\n                    getW(wR, wC, ").concat(d,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(d,", xR, xC) *\n                    getW(wR, wC, ").concat(d,", d2);\n              }\n\n            } else if (").concat(2===v,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(d,", d2),\n                getW(wR, wC, ").concat(d," + 1, d2)\n              );\n\n              if (").concat(m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(d,"),\n                  getX(batch, xR, xC, ").concat(d," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(d,", xR, xC),\n                  getX(batch, ").concat(d," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===v,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(d,", d2),\n                getW(wR, wC, ").concat(d," + 1, d2),\n                getW(wR, wC, ").concat(d," + 2, d2)\n              );\n\n              if (").concat(m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(d,"),\n                  getX(batch, xR, xC, ").concat(d," + 1),\n                  getX(batch, xR, xC, ").concat(d," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(d,", xR, xC),\n                  getX(batch, ").concat(d," + 1, xR, xC),\n                  getX(batch, ").concat(d," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(w,"\n        ").concat(k,"\n        setOutput(result);\n      }\n    ")})),QA=R((function e(t){A(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.padInfo.front,r=t.padInfo.top,a=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=t.dilationDepth,l=t.dilationHeight,c=t.dilationWidth,h=t.filterDepth,p=t.filterHeight,f=t.filterWidth,d=4*Math.floor(t.inChannels/4),v=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(i,", ").concat(o,", ").concat(s,");\n      const ivec3 pads = ivec3(").concat(n,", ").concat(r,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(h,"; wF++) {\n          int xF = xFCorner + wF * ").concat(u,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,"; wR++) {\n            int xR = xRCorner + wR * ").concat(l,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(f,"; wC++) {\n              int xC = xCCorner + wC * ").concat(c,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(d,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===v,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(d,") *\n                  getW(wF, wR, wC, ").concat(d,", d2);\n              } else if (").concat(2===v,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(d,"),\n                  getX(batch, xF, xR, xC, ").concat(d," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(d,", d2),\n                  getW(wF, wR, wC, ").concat(d," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===v,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(d,"),\n                  getX(batch, xF, xR, xC, ").concat(d," + 1),\n                  getX(batch, xF, xR, xC, ").concat(d," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(d,", d2),\n                  getW(wF, wR, wC, ").concat(d," + 1, d2),\n                  getW(wF, wR, wC, ").concat(d," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),$A=R((function e(t,n,r){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var a=r.filterWidth,i=r.inChannels,o=r.strideWidth,s=r.strideHeight,u=r.padInfo,l=r.outWidth,c=r.dilationWidth,h=r.dilationHeight,p=r.dataFormat,f=u.left,d=u.top,v=i*a,m=lN(),g="channelsLast"===p,y=g?0:1,b=g?1:2,x="",k=0;k<=1;k++)for(var w=0;w<=1;w++)x+="\n          blockIndex = rc.y + ".concat(w,";\n          pos = rc.x + ").concat(k,";\n\n          if(blockIndex < ").concat(t[1]," && pos < ").concat(t[0],") {\n            offsetY = int(blockIndex / (").concat(l,")) * ").concat(s," - ").concat(d,";\n            d0 = offsetY + ").concat(h," * (pos / ").concat(v,");\n\n            if(d0 < ").concat(n[y]," && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), ").concat(l,".) * ").concat(o,". - ").concat(f,".);\n              d1 = offsetX + ").concat(c," * (int(mod(float(pos), ").concat(v,".) / ").concat(i,".));\n\n              if(d1 < ").concat(n[b]," && d1 >= 0) {\n\n                ch = int(mod(float(pos), ").concat(i,".));\n\n                if (").concat(g,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*k+w,"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*k+w,"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(x,"\n\n        ").concat(m.output," = result;\n      }\n    ")}));function JA(e){var t,n=e.x,r=e.filter,a=e.convInfo,i=e.backend,o=e.bias,s=void 0===o?null:o,u=e.preluActivationWeights,l=void 0===u?null:u,c=e.leakyreluAlpha,h=void 0===c?0:c,p=e.activation,f=void 0===p?null:p,d=n.shape,v=i.texData.get(n.dataId),m=a.inChannels,g=d[0]*d[1]*d[2],y=a.outChannels,b="channelsLast"===a.dataFormat,x=[],k=(1===g||1===y)&&m>1e3,w=d[2]%2!==0&&!!v.isPacked;if(!k&&Ce().getBool("WEBGL_LAZILY_UNPACK")&&Ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&w){var _=b?d[0]*d[1]*(d[2]+1):d[0]*d[2]*(d[3]+1),S={dataId:n.dataId,shape:[1,_,a.inChannels],dtype:n.dtype},I=v.shape;v.shape=v.shape.slice(),v.shape[v.shape.length-2]++,G(nN(v.shape,S.shape),(function(){return"packed reshape ".concat(v.shape," to ").concat(S.shape," isn't free")}));var C=gM({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}});x.push(C);var T=EM({a:S,b:C,backend:i,transposeA:false,transposeB:false,bias:s,activation:f,preluActivationWeights:l,leakyreluAlpha:h}),N=i.texData.get(T.dataId);G(N.isPacked,(function(){return"batchMatMul result is expected to be packed"})),v.shape=I,N.shape=a.outShape,(t=QE({inputs:{x:T},backend:i})).shape=a.outShape,x.push(T)}else{var E=gM({inputs:{x:n},backend:i,attrs:{shape:[1,b?d[0]*d[1]*d[2]:d[0]*d[2]*d[3],a.inChannels]}}),M=gM({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}}),A=EM({a:E,b:M,transposeA:false,transposeB:false,backend:i,bias:s,activation:f,preluActivationWeights:l,leakyreluAlpha:h});t=gM({inputs:{x:A},backend:i,attrs:{shape:a.outShape}}),x.push(E),x.push(M),x.push(A)}for(var D=0,R=x;D<R.length;D++){var O=R[D];i.disposeIntermediateTensorInfo(O)}return t}function eD(e){var t=e.x,n=e.filter,r=e.convInfo,a=e.backend,i=e.bias,o=void 0===i?null:i,s=e.preluActivationWeights,u=void 0===s?null:s,l=e.leakyreluAlpha,c=void 0===l?0:l,h=e.activation,p=void 0===h?null:h,f=r.filterWidth,d=r.filterHeight,v=r.inChannels,m=r.outWidth,g=r.outHeight,y="channelsLast"===r.dataFormat,b=f*d*v,x=g*m,k=[b,x],w=[],_=gM({inputs:{x:t},backend:a,attrs:{shape:t.shape.slice(1)}}),S=gM({inputs:{x:n},backend:a,attrs:{shape:[1,b,K(n.shape)/b]}});w.push(_),w.push(S);var I=new $A(k,_.shape,r),C=a.runWebGLProgram(I,[_],"float32"),T=gM({inputs:{x:C},backend:a,attrs:{shape:[1,k[0],k[1]]}});w.push(C),w.push(T);var N=null!=o,E=null!=u,M="leakyrelu"===p,A=p?lM(p,!0):null,D=new cM(T.shape,S.shape,[1,x,r.outChannels],!0,!1,N,A,E,M),R=[T,S];if(o&&R.push(o),E&&R.push(u),M){var O=a.makeTensorInfo([],"float32",Rr(c,"float32"));R.push(O),w.push(O)}var F=a.runWebGLProgram(D,R,"float32"),L=gM({inputs:{x:F},backend:a,attrs:{shape:y?[1,g,m,r.outChannels]:[1,r.outChannels,g,m]}});w.push(F);for(var P=0,z=w;P<z.length;P++){var B=z[P];a.disposeIntermediateTensorInfo(B)}return L}var tD={kernelName:at,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=a.strides,u=a.pad,l=a.dataFormat,c=a.dilations,h=a.dimRoundingMode,p=rs(l),f=qo(i.shape,o.shape,s,c,u,h,!1,p);if(1!==f.filterHeight||1!==f.filterWidth||1!==f.dilationHeight||1!==f.dilationWidth||1!==f.strideHeight||1!==f.strideWidth||"SAME"!==f.padInfo.type&&"VALID"!==f.padInfo.type)if(Ce().getBool("WEBGL_CONV_IM2COL")&&1===i.shape[0])t=eD({x:i,filter:o,convInfo:f,backend:r});else{var d=new ZA(f);t=r.runWebGLProgram(d,[i,o],"float32")}else t=JA({x:i,filter:o,convInfo:f,backend:r});var v=gM({inputs:{x:t},backend:r,attrs:{shape:f.outShape}});return r.disposeIntermediateTensorInfo(t),v}},nD=R((function e(t){A(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              if (").concat(o,") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),rD=R((function e(t){A(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o="channelsLast"===t.dataFormat,s=n-1-t.padInfo.top,u=r-1-t.padInfo.left,l=o?1:2,c=o?2:3,h=o?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(h,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(l,"], coords[").concat(c,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(o,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),aD=R((function e(t){A(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.padInfo.front,o=t.padInfo.top,s=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(n," - ").concat(i,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(r," - ").concat(o,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(s,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),iD=R((function e(t){A(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=n-1-t.padInfo.front,l=r-1-t.padInfo.top,c=a-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(l,", ").concat(c,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(n,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(i,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(n," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(r,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(r," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var oD={kernelName:it,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.dataFormat,l=r.dimRoundingMode,c=r.filterShape,h=rs(u),p=qo(a.shape,c,o,1,s,l,!1,h),f=new nD(p);return n.runWebGLProgram(f,[a,i],"float32")}};var sD={kernelName:ot,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.inputShape,s=r.strides,u=r.pad,l=r.dataFormat,c=r.dimRoundingMode,h=rs(l),p=qo(o,i.shape,s,1,u,c,!1,h),f=new rD(p);return n.runWebGLProgram(f,[a,i],"float32")}};var uD={kernelName:st,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,l=Xo(a.shape,i.shape,o,u,s),c=new QA(l);return n.runWebGLProgram(c,[a,i],"float32")}};var lD={kernelName:ut,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.filterShape,l=Xo(a.shape,u,o,1,s),c=new aD(l);return n.runWebGLProgram(c,[a,i],"float32")}};var cD={kernelName:lt,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.pad,s=r.strides,u=Xo(r.inputShape,i.shape,s,1,o),l=new iD(u);return n.runWebGLProgram(l,[a,i],"float32")}},hD=sM({opSnippet:"if (isnan(x)) return x;\n  return cos(x);\n"}),pD={kernelName:ct,backendName:"webgl",kernelFunc:hD},fD=sM({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),dD={kernelName:ht,backendName:"webgl",kernelFunc:fD},vD=R((function e(t,n,r,a,i){A(this,e),this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=N(t,4),s=o[0],u=o[1],l=o[2],c=o[3],h=N(n,1)[0],p=N(r,2),f=p[0],d=p[1];this.outputShape=[h,f,d,c];var v="bilinear"===a?1:0,m="".concat(u-1,".0"),g="".concat(l-1,".0"),y=N(f>1?["".concat((u-1)/(f-1)),"(y2-y1) * height_ratio","y1*".concat(m," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(m)],3),b=y[0],x=y[1],k=y[2],w=N(d>1?["".concat((l-1)/(d-1)),"(x2-x1) * width_ratio","x1*".concat(g," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(g)],3),_=w[0],S=w[1],I=w[2];this.userCode="\n      const float height_ratio = float(".concat(b,");\n      const float width_ratio = float(").concat(_,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(s,") {\n          return;\n        }\n\n        float height_scale = ").concat(x,";\n        float width_scale = ").concat(S,";\n\n        float in_y = ").concat(k,";\n        if( in_y < 0.0 || in_y > ").concat(m," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n        float in_x = ").concat(I,";\n        if( in_x < 0.0 || in_x > ").concat(g," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(v," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")})),mD={kernelName:ft,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,s=r.cropSize,u=r.method,l=r.extrapolationValue,c=new vD(a.shape,i.shape,s,u,l);return n.runWebGLProgram(c,[a,i,o],"float32")}},gD=function(){function e(t,n,r){A(this,e),this.variableNames=["x"],this.outputShape=t;var a=t.length,i=n?"0.0":"getX(".concat(yD(a,"coords"),")"),o=t[t.length-1],s="",u="";n?(s=r?"end != ".concat(o-1):"end != 0",u=r?"end + 1":"end - 1"):(s=r?"end + pow2 < ".concat(o):"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode="\n      uniform float index;\n      void main() {\n        ".concat(UN(a)," coords = getOutputCoords();\n        int end = ").concat(bD(a,"coords"),";\n        float val = ").concat(i,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(s,") {\n          int idx = ").concat(u,";\n          ").concat(bD(a,"coords")," = idx;\n          val += getX(").concat(yD(a,"coords"),");\n        }\n        setOutput(val);\n      }\n    ")}return R(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.index&&(t.index=n.getUniformLocation(r,"index")),n.gl.uniform1f(t.index,e)}}}]),e}();function yD(e,t){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw Error("Cumulative sum for rank ".concat(e," is not yet supported"))}function bD(e,t){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw Error("Cumulative sum for rank ".concat(e," is not yet supported"))}var xD={kernelName:pt,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse,u=a.shape.length,l=ru([i],u),c=a;null!=l&&(c=TM({inputs:{x:a},backend:n,attrs:{perm:l}}));var h=iu(1,u)[0];if(h!==u-1)throw new Error("WebGL cumsum shader expects an inner-most axis=".concat(a.shape.length-1," ")+"but got axis=".concat(i));for(var p=c.shape[h],f=QE({inputs:{x:c},backend:n}),d=0;d<=Math.ceil(Math.log2(p))-1;d++){var v=new gD(c.shape,!1,s),m=v.getCustomSetupFunc(d),g=f;f=n.runWebGLProgram(v,[f],f.dtype,m),n.disposeIntermediateTensorInfo(g)}if(o){var y=new gD(c.shape,o,s),b=f;f=n.runWebGLProgram(y,[f],f.dtype),n.disposeIntermediateTensorInfo(b)}if(null!=l){var x=TM({inputs:{x:f},backend:n,attrs:{perm:au(l)}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(c),x}return f}};var kD={kernelName:dt,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=r.binaryOutput;if(1===a.shape.length){var u=n.readSync(a.dataId),l=n.readSync(i.dataId),c=ZN(u,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}if(2===a.shape.length){var h=n.bufferSync(a),p=n.bufferSync(i),f=QN(h,p,o,s);return n.makeTensorInfo(f.shape,i.dtype,f.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}},wD=function(){function e(t,n,r){A(this,e),this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(n,";\n      int offset_h = imod(h, ").concat(n,");\n      int in_w = w / ").concat(n,";\n      int offset_w = imod(w, ").concat(n,");\n      int offset_d = (offset_h * ").concat(n," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}return R(e,[{key:"getHeightCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}},{key:"getWidthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}},{key:"getDepthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}},{key:"getOutputDepthSize",value:function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}},{key:"getInputSamplingString",value:function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}]),e}();var _D={kernelName:vt,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockSize,o=r.dataFormat;G(i>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(i)}));var s=a.shape[0],u="NHWC"===o?a.shape[1]:a.shape[2],l="NHWC"===o?a.shape[2]:a.shape[3],c="NHWC"===o?a.shape[3]:a.shape[1],h=u*i,p=l*i,f=c/(i*i),d=new wD("NHWC"===o?[s,h,p,f]:[s,f,h,p],i,o);return n.runWebGLProgram(d,[a],a.dtype)}},SD=R((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];A(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.inHeight,s=t.inWidth,u=t.padInfo.top,l=t.padInfo.left,c=t.strideHeight,h=t.strideWidth,p=t.dilationHeight,f=t.dilationWidth,d=t.filterHeight,v=t.filterWidth,m=t.outChannels/t.inChannels,g="",y="";r&&(g=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),y="result = activation(result);");var b=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(g,"\n\n      const ivec2 strides = ivec2(").concat(c,", ").concat(h,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(l,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(m,";\n        int q = d2 - d1 * ").concat(m,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(d,"; wR++) {\n          int xR = xRCorner + wR * ").concat(p,";\n\n          if (xR < 0 || xR >= ").concat(o,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(v,"; wC++) {\n            int xC = xCCorner + wC * ").concat(f,";\n\n            if (xC < 0 || xC >= ").concat(s,") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(b,"\n        ").concat(y,"\n        setOutput(result);\n      }\n    ")})),ID=R((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];A(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var o=t.inHeight,s=t.inWidth,u=t.padInfo.top,l=t.padInfo.left,c=t.strideHeight,h=t.strideWidth,p=t.dilationHeight,f=t.dilationWidth,d=t.filterHeight,v=t.filterWidth,m=v,g="int xR; int xC; int xCOffset;",y=0;y<d;y++)for(var b=0;b<v;b++)g+="\n          vec4 xTexelR".concat(y,"C").concat(2*b," = vec4(0.);\n          vec4 wR").concat(y,"C").concat(b," = vec4(0.);\n          vec4 xR").concat(y,"C").concat(b," = vec4(0.);");for(var x=0;x<d;x++)for(var k=0;k<m;k++){var w=2*k;if(g+="\n          xR = xRCorner + ".concat(x*p,";\n          xC = xCCorner + ").concat(w*f,";\n        "),1===h){if(w<v&&(g+=l%2===1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < ".concat(o," && xCOffset >= 0 && xCOffset < ").concat(s,") {\n                  xTexelR").concat(x,"C").concat(w," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(s,") {\n                    xTexelR").concat(x,"C").concat(w,".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR").concat(x,"C").concat(w," = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < ").concat(o," && xCOffset >= 0 && xCOffset < ").concat(s,") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(s,") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR").concat(x,"C").concat(w," = vec4(previous.zw, xTexelR").concat(x,"C").concat(w,".xy);\n                } else {\n                  xR").concat(x,"C").concat(w," = vec4(0, 0, xTexelR").concat(x,"C").concat(w,".xy);\n                }\n              "):"\n                if(xR >= 0 && xR < ".concat(o," && xC >= 0 && xC < ").concat(s,") {\n                  xTexelR").concat(x,"C").concat(w," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(x,"C").concat(w," = vec4(0.);\n                }\n\n                xR").concat(x,"C").concat(w," = xTexelR").concat(x,"C").concat(w,";\n              "),w+1<v)){var _=l%2===0?U(f):f;f%2===0&&l%2===1||f%2!==0&&l%2!==1?(g+="\n                  xCOffset = xC + ".concat(l%2," + ").concat(_,";\n\n                  if(xR >= 0 && xR < ").concat(o," &&\n                    xCOffset >= 0 && xCOffset < ").concat(s,") {\n                    xTexelR").concat(x,"C").concat(w+2," = getX(batch, xR, xCOffset, d1);\n                  }\n                "),f>1&&(g+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < ".concat(o," &&\n                      xCOffset >= 0 && xCOffset < ").concat(s,") {\n                      xTexelR").concat(x,"C").concat(w," = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR").concat(x,"C").concat(w," = vec4(0.);\n                    }\n                  ")),g+="\n                  xR".concat(x,"C").concat(w+1," = vec4(\n                    xTexelR").concat(x,"C").concat(w,".zw, xTexelR").concat(x,"C").concat(w+2,".xy);\n                ")):g+="\n                  xCOffset = xC + ".concat(_,";\n\n                  if(xR >= 0 && xR < ").concat(o," &&\n                    xCOffset >= 0 && xCOffset < ").concat(s,") {\n                    xTexelR").concat(x,"C").concat(w+2," = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR").concat(x,"C").concat(w+1," = xTexelR").concat(x,"C").concat(w+2,";\n                ")}}else w<v&&(g+="\n              if(xR >= 0 && xR < ".concat(o,") {\n            "),l%2===1?(g+="\n                xCOffset = xC + 1 - ".concat(h,";\n                if(xCOffset >= 0 && xCOffset < ").concat(s,") {\n                  xTexelR").concat(x,"C").concat(w," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(x,"C").concat(w," = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < ").concat(s,") {\n                  xTexelR").concat(x,"C").concat(w+2," = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR").concat(x,"C").concat(w+2," = vec4(0.);\n                }\n\n                xR").concat(x,"C").concat(w," = vec4(\n                  xTexelR").concat(x,"C").concat(w,".zw, xTexelR").concat(x,"C").concat(w+2,".zw);\n              "),w+1<v&&(g+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + ".concat(h,";\n                  if(xCOffset >= 0 && xCOffset < ").concat(s,") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR").concat(x,"C").concat(w+1," = vec4(xTexelR").concat(x,"C").concat(w+2,".xy, final.xy);\n                "))):(g+="\n                if(xC >= 0 && xC < ".concat(s,") {\n                  xTexelR").concat(x,"C").concat(w," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(x,"C").concat(w," = vec4(0.);\n                }\n\n                xCOffset = xC + ").concat(h,";\n                if(xCOffset >= 0 && xCOffset < ").concat(s,") {\n                  xTexelR").concat(x,"C").concat(w+2," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(x,"C").concat(w+2," = vec4(0.);\n                }\n\n                xR").concat(x,"C").concat(w," = vec4(\n                  xTexelR").concat(x,"C").concat(w,".xy, xTexelR").concat(x,"C").concat(w+2,".xy);\n              "),w+1<v&&(g+="\n                  xR".concat(x,"C").concat(w+1," = vec4(\n                    xTexelR").concat(x,"C").concat(w,".zw, xTexelR").concat(x,"C").concat(w+2,".zw);\n                "))),g+="}");w<v&&(g+="\n            vec4 wTexelR".concat(x,"C").concat(w," = getW(").concat(x,", ").concat(w,", d1, q);\n            wR").concat(x,"C").concat(w," = vec4(wTexelR").concat(x,"C").concat(w,".xz, wTexelR").concat(x,"C").concat(w,".xz);\n          "),w+1<v&&(g+="\n              vec4 wTexelR".concat(x,"C").concat(w+1," = getW(").concat(x,", ").concat(w+1,", d1, q);\n              wR").concat(x,"C").concat(w+1," =\n                vec4(wTexelR").concat(x,"C").concat(w+1,".xz, wTexelR").concat(x,"C").concat(w+1,".xz);")))}for(var S=0;S<d;S++)for(var I=0;I<v;I++)g+="dotProd += xR".concat(S,"C").concat(I," * wR").concat(S,"C").concat(I,";");var C="",T="";r&&(C=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(r,"\n        }"),T="result = activation(result);");var N=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(C,"\n\n      const ivec2 strides = ivec2(").concat(c,", ").concat(h,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(l,");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        ").concat(g,"\n\n        vec4 result = dotProd;\n        ").concat(N,"\n        ").concat(T,"\n        setOutput(result);\n      }\n    ")}));var CD={kernelName:mt,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,l=r.dimRoundingMode,c=u;null==c&&(c=[1,1]),G(ns(o,c),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(c,"'")}));var h,p=qo(a.shape,i.shape,o,c,s,l,!0);return h=Ce().getBool("WEBGL_PACK_DEPTHWISECONV")&&p.strideWidth<=2&&p.outChannels/p.inChannels===1?new ID(p):new SD(p),n.runWebGLProgram(h,[a,i],"float32")}},TD=R((function e(t){A(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(o," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),ND=R((function e(t){A(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=n-1-t.padInfo.top,s=r-1-t.padInfo.left,u=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(u,"; dm++) {\n              int d2 = d1 * ").concat(u," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var ED={kernelName:gt,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.dilations,u=r.pad,l=r.dimRoundingMode,c=r.filterShape,h=qo(a.shape,c,o,s,u,l,!0),p=new TD(h);return n.runWebGLProgram(p,[a,i],"float32")}};var MD={kernelName:yt,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.strides,s=r.dilations,u=r.pad,l=r.dimRoundingMode,c=qo(r.inputShape,i.shape,o,s,u,l,!0),h=new ND(c);return n.runWebGLProgram(h,[a,i],"float32")}},AD=R((function e(t){A(this,e),this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}));var DD={kernelName:bt,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=[].concat(I(r.shape),I(r.shape)),i=K(r.shape),o=gM({inputs:{x:r},backend:n,attrs:{shape:[i]}}),s=new AD(i),u=n.runWebGLProgram(s,[o],o.dtype),l=gM({inputs:{x:u},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),l}},RD=R((function e(t){A(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.inHeight,r=t.inWidth,a=t.padInfo,i=t.strideHeight,o=t.strideWidth,s=t.filterHeight,u=t.filterWidth,l=t.dilationHeight,c=t.dilationWidth,h=a.top,p=a.left;this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(o,");\n      const ivec2 pads = ivec2(").concat(h,", ").concat(p,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(s,"; h++) {\n          int hIn = hBeg + h * ").concat(l,";\n\n          if (hIn >= 0 && hIn < ").concat(n,") {\n            for (int w = 0; w < ").concat(u,"; w++) {\n              int wIn = wBeg + w * ").concat(c,";\n\n              if (wIn >= 0 && wIn < ").concat(r,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}));var OD={kernelName:xt,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=a.strides,u=a.pad,l=a.dilations,c=Ho(i.shape,o.shape,s,u,"NHWC",l),h=new RD(c),p=gM({inputs:{x:t=r.runWebGLProgram(h,[i,o],"float32")},backend:r,attrs:{shape:c.outShape}});return r.disposeIntermediateTensorInfo(t),p}},FD=sM({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),LD={kernelName:St,backendName:"webgl",kernelFunc:FD},PD={kernelName:It,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y,i=Ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ZE("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,a.shape):new YE("return (b >= 1.0) ? a : a * (b + 1.0);",r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)}},zD=uM({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool"}),BD={kernelName:Tt,backendName:"webgl",kernelFunc:zD},VD=sM({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(Dc,";\n  float a1 = ").concat(Rc,";\n  float a2 = ").concat(Oc,";\n  float a3 = ").concat(Fc,";\n  float a4 = ").concat(Lc,";\n  float a5 = ").concat(Pc,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),WD={kernelName:Ct,backendName:"webgl",kernelFunc:VD},UD="return exp(x);",HD=sM({opSnippet:UD,packedOpSnippet:UD,cpuKernelImpl:eE}),GD={kernelName:Nt,backendName:"webgl",kernelFunc:HD};function jD(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.dim,i=t.input,o=i.shape.length,s=i.shape.slice(),u=a;return a<0&&(G(-(o+1)<=a,(function(){return"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")})),u=o+a+1),s.splice(u,0,1),gM({inputs:{x:i},backend:r,attrs:{shape:s}})}var qD={kernelName:Et,backendName:"webgl",kernelFunc:jD},XD="return exp(x) - 1.0;",KD=sM({opSnippet:XD,packedOpSnippet:XD,cpuKernelImpl:tE}),YD={kernelName:Mt,backendName:"webgl",kernelFunc:KD},ZD=R((function e(t,n,r){A(this,e),this.variableNames=["real","imag"];var a=n[1];this.outputShape=n;var i,o=r?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),s=r?"".concat(a,".0"):"1.0";if("real"===t)i="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error('FFT component must be either "real" or "imag", got '.concat(t,"."));i="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(o,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(i,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(s,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}));function QD(e,t,n){var r=n.texData.get(e.dataId),a=K(e.shape),i=e.shape[e.shape.length-1],o=gM({inputs:{x:e},backend:n,attrs:{shape:[a/i,i]}}),s=o.shape,u=new ZD("real",s,t),l=new ZD("imag",s,t),c=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:s},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:s}],h=n.runWebGLProgram(u,c,"float32"),p=n.runWebGLProgram(l,c,"float32"),f=JE({inputs:{real:h,imag:p},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p);var d=gM({inputs:{x:f},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(f),d}var $D={kernelName:At,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return QD(t.input,!1,n)}},JD=function(){function e(t,n){A(this,e),this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return R(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}}}]),e}();function eR(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,i=n.dtype;if("string"===(i=i||ce(a))){var o=ae(i,K(r));return o.fill(a),t.makeTensorInfo(r,i,o)}var s=new JD(r,a),u=s.getCustomSetupFunc(a);return t.runWebGLProgram(s,[],i,u)}var tR,nR={kernelName:Dt,backendName:"webgl",kernelFunc:eR},rR=R((function e(t){A(this,e),this.variableNames=["Image"],this.outputShape=[];var n=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(n," - x;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(n,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")})),aR={kernelName:Rt,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.image,a=n,i=new rR(r.shape);return a.runWebGLProgram(i,[r],r.dtype)}},iR="return floor(x);",oR=sM({opSnippet:iR,packedOpSnippet:iR,cpuKernelImpl:nE}),sR={kernelName:Ot,backendName:"webgl",kernelFunc:oR},uR=uM({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),lR={kernelName:Ft,backendName:"webgl",kernelFunc:uR},cR=R((function e(t){A(this,e),this.variableNames=["A"];var n=lN(),r=N(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(i,".0, ").concat(a,".0);\n\n        vec4 values = ").concat(n.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")})),hR=R((function e(t){A(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=lN(),r=N(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(i,".0, ").concat(a,".0);\n            vec4 values = ").concat(n.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),pR={kernelName:xr,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.pixels,i=r.numChannels,o="undefined"!==typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement,u=N(o?[a.videoWidth,a.videoHeight]:[a.width,a.height],2),l=u[0],c=u[1],h=[c,l],p=[c,l,i];(s||o)&&(null==tR&&(tR=document.createElement("canvas").getContext("2d")),tR.canvas.width=l,tR.canvas.height=c,tR.drawImage(a,0,0,l,c),a=tR.canvas);var f=n.makeTensorInfo(h,"int32");n.texData.get(f.dataId).usage=CT.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(f.dataId),a);var d=Ce().getBool("WEBGL_PACK")?new hR(p):new cR(p),v=n.runWebGLProgram(d,[f],"int32");return n.disposeData(f.dataId),v}};var fR={kernelName:_r,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=n.bias,u=n.preluActivationWeights,l=a.strides,c=a.pad,h=a.dataFormat,p=a.dilations,f=a.dimRoundingMode,d=a.activation,v=a.leakyreluAlpha,m=rs(h),g=qo(i.shape,o.shape,l,p,c,f,!1,m),y=[];if(1!==g.filterHeight||1!==g.filterWidth||1!==g.dilationHeight||1!==g.dilationWidth||1!==g.strideHeight||1!==g.strideWidth||"SAME"!==g.padInfo.type&&"VALID"!==g.padInfo.type)if(Ce().getBool("WEBGL_CONV_IM2COL")&&1===i.shape[0])t=eD({x:i,filter:o,convInfo:g,backend:r,bias:s,activation:d,preluActivationWeights:u,leakyreluAlpha:v});else{var b=null!=s,x=null!=u,k="leakyrelu"===d,w=d?lM(d,!1):null,_=new ZA(g,b,w,x,k),S=[i,o];if(s&&S.push(s),u&&S.push(u),k){var I=r.makeTensorInfo([],"float32",Rr(v,"float32"));S.push(I),y.push(I)}t=r.runWebGLProgram(_,S,"float32")}else t=JA({x:i,filter:o,convInfo:g,backend:r,bias:s,activation:d,preluActivationWeights:u,leakyreluAlpha:v});var C=gM({inputs:{x:t},backend:r,attrs:{shape:g.outShape}});return y.push(t),y.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),C}};var dR={kernelName:Sr,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,l=r.pad,c=r.dilations,h=r.dimRoundingMode,p=r.activation,f=r.leakyreluAlpha,d=[],v=c;null==v&&(v=[1,1]),G(ns(u,v),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(u," and dilations '").concat(v,"'")}));var m,g=qo(a.shape,i.shape,u,v,l,h,!0),y=Ce().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,b=p?lM(p,y):null,x=[a,i],k=null!=o,w=null!=s,_="leakyrelu"===p;if(k&&x.push(o),w&&x.push(s),_){var S=n.makeTensorInfo([],"float32",Rr(f,"float32"));x.push(S),d.push(S)}m=y?new ID(g,k,b,w,_):new SD(g,k,b,w,_);var I=n.runWebGLProgram(m,x,"float32");return d.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),I}},vR=R((function e(t,n,r){A(this,e),this.sliceDim=t,this.strides=n,this.variableNames=["x","indices"],this.outputShape=r;var a=UN(n.length),i=UN(r.length),o=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        ".concat(a," strides = ").concat(a,"(").concat(this.strides,");\n         void main() {\n          ").concat(i," coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < ").concat(this.sliceDim,"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * ").concat(o,";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      ")}));var mR={kernelName:zt,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,i=a.shape,o=i[i.length-1],s=N(Tc(r,a),4),u=s[0],l=s[1],c=s[2],h=s[3],p=gM({inputs:{x:a},backend:n,attrs:{shape:[l,o]}}),f=gM({inputs:{x:r},backend:n,attrs:{shape:[K(r.shape)/c,c]}}),d=new vR(o,h,[l,c]),v=n.runWebGLProgram(d,[f,p],f.dtype),m=gM({inputs:{x:v},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(v),m}},gR=R((function e(t,n){A(this,e),this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;var r=UN(this.rank),a=function(e,t){for(var n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],a=0;a<e.length;a++)2===a?r.push("int(getIndices(resRC.x, resRC.z))"):r.push("".concat(n[a]));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        setOutput(getA(").concat(a,"));\n      }\n    ")}));var yR={kernelName:Pt,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.indices,o=r.axis,s=r.batchDims,u=Gc(a,i,te(o,a.shape)[0],s),l=K(i.shape),c=[],h=gM({inputs:{x:a},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),p=gM({inputs:{x:i},backend:n,attrs:{shape:[u.batchSize,l/u.batchSize]}});c.push(h),c.push(p);var f=[u.batchSize,u.outerSize,l/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([a,i])||"string"===a.dtype){var d=n.bufferSync(p),v=n.bufferSync(h),m=rE(v,d,f);return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(u.outputShape,m.dtype,m.values)}var g=new gR(h.shape,f),y=n.runWebGLProgram(g,[h,p],h.dtype);c.push(y);var b=gM({inputs:{x:y},backend:n,attrs:{shape:u.outputShape}});return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),b}},bR=uM({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:aE,dtype:"bool"}),xR={kernelName:Bt,backendName:"webgl",kernelFunc:bR},kR=uM({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool"}),wR={kernelName:Vt,backendName:"webgl",kernelFunc:kR};var _R={kernelName:Ut,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return QD(t.input,!0,n)}},SR=sM({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),IR={kernelName:Gt,backendName:"webgl",kernelFunc:SR},CR=sM({opSnippet:"return float(isinf(x));",dtype:"bool"}),TR={kernelName:jt,backendName:"webgl",kernelFunc:CR},NR=sM({opSnippet:"return float(isnan(x));",dtype:"bool"}),ER={kernelName:qt,backendName:"webgl",kernelFunc:NR},MR=uM({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:iE,dtype:"bool"}),AR={kernelName:Kt,backendName:"webgl",kernelFunc:MR},DR=uM({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",dtype:"bool"}),RR={kernelName:Yt,backendName:"webgl",kernelFunc:DR};var OR={kernelName:Zt,backendName:"webgl",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.num,o=oE(r,a,i);return t.makeTensorInfo([o.length],"float32",o)}},FR=sM({opSnippet:"if (x < 0.0) return NAN;\n  return log(x);",packedOpSnippet:"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:sE}),LR={kernelName:Qt,backendName:"webgl",kernelFunc:FR},PR=sM({opSnippet:"return log(1.0 + x);"}),zR={kernelName:$t,backendName:"webgl",kernelFunc:PR},BR=uM({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),VR={kernelName:Jt,backendName:"webgl",kernelFunc:BR},WR=sM({opSnippet:"return float(!(x >= 1.0));"}),UR={kernelName:en,backendName:"webgl",kernelFunc:WR},HR=uM({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),GR={kernelName:tn,backendName:"webgl",kernelFunc:HR},jR=R((function e(t,n,r,a,i){A(this,e),this.variableNames=["x"],this.outputShape=[];var o,s=n,u=t[3]-1;this.outputShape=t;var l="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(l,")"):1===i?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(s,"; j <= ").concat(s,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(u,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(o,";\n        setOutput(val);\n      }\n    ")})),qR=R((function e(t,n,r,a,i){A(this,e),this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,s=n,u=t[3]-1;this.outputShape=t;var l="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(l,")"):1===i?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(s,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(s,"; j <= ").concat(s,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(u,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(o,";\n        setOutput(result);\n      }\n    ")})),XR={kernelName:nn,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.depthRadius,o=r.bias,s=r.alpha,u=r.beta,l=Ce().getBool("WEBGL_PACK_NORMALIZATION")?new qR(a.shape,i,o,s,u):new jR(a.shape,i,o,s,u);return n.runWebGLProgram(l,[a],a.dtype)}},KR=R((function e(t,n,r,a,i){A(this,e),this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=a,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(n,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(n," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(r,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(i,")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(i,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")})),YR={kernelName:rn,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,s=r.depthRadius,u=r.bias,l=r.alpha,c=r.beta,h=new KR(a.shape,s,u,l,c);return n.runWebGLProgram(h,[a,i,o],a.dtype)}};function ZR(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reductionIndices,o=r.keepDims,s=a.shape.length,u=te(i,a.shape),l=u,c=ru(l,s),h=null!=c,p=n.shouldExecuteOnCPU([a]),f=a;if(h){if(p){for(var d=n.texData.get(f.dataId).values,v=new Array(s),m=0;m<v.length;m++)v[m]=a.shape[c[m]];var g=wE(d,a.shape,a.dtype,c,v);f=n.makeTensorInfo(v,a.dtype),n.texData.get(f.dataId).values=g}else f=SM(a,c,n);l=iu(l.length,s)}nu("max",l,s);var y,b=N(eu(f.shape,l),2),x=b[0],k=b[1],w=x;if(o&&(w=tu(x,u)),p){d=n.texData.get(f.dataId).values;var _=uE(d,K(k),w,a.dtype);y=n.makeTensorInfo(w,a.dtype),n.texData.get(y.dataId).values=_}else y=function(e,t,n,r){var a=K(t),i=gM({inputs:{x:e},attrs:{shape:[K(e.shape)/a,a]},backend:r}),o=kM(i,e.dtype,"max",r),s=gM({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(f,k,w,n);return h&&n.disposeIntermediateTensorInfo(f),y}var QR={kernelName:an,backendName:"webgl",kernelFunc:ZR},$R=uM({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:lE}),JR={kernelName:on,backendName:"webgl",kernelFunc:$R};var eO={kernelName:sn,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;sN(a,"maxPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;G(ns(o,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var l=Go(a.shape,i,o,1,s,u);if(1===l.filterWidth&&1===l.filterHeight&&Y(l.inShape,l.outShape))return QE({inputs:{x:a},backend:n});var c=new uA(l,"max",!1);return n.runWebGLProgram(c,[a],a.dtype)}};var tO={kernelName:ln,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dataFormat,l=r.dimRoundingMode,c=jo(a.shape,i,o,[1,1,1],s,l,u),h=new lA(c,"max",!1);return n.runWebGLProgram(h,[a],a.dtype)}},nO=R((function e(t){A(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideHeight,r=t.strideWidth,a=t.dilationHeight,i=t.effectiveFilterHeight,o=t.effectiveFilterWidth,s=i-1-t.padInfo.top,u=o-1-t.padInfo.left,l=i*o-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(i,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(o,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(l," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(o," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),rO=R((function e(t){A(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterDepth,l=t.effectiveFilterHeight,c=t.effectiveFilterWidth,h=u-1-t.padInfo.front,p=l-1-t.padInfo.top,f=c-1-t.padInfo.left,d=u*l*c-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(h,", ").concat(p,", ").concat(f,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n           wD += ").concat(i,") {\n          float dyD = float(dyDCorner + wD) / ").concat(n,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(l,";\n              wR += ").concat(o,") {\n            float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(c,";\n                wC += ").concat(s,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(d," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(l," * ").concat(c," +\n                  wR * ").concat(c," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var aO={kernelName:cn,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,l=r.dimRoundingMode,c=jo(i.shape,o,s,[1,1,1],u,l),h=new lA(c,"max",!0),p=n.runWebGLProgram(h,[i],i.dtype),f=new rO(c),d=n.runWebGLProgram(f,[a,p],i.dtype);return n.disposeIntermediateTensorInfo(p),d}};var iO={kernelName:un,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;sN([i,t.output],"maxPoolGrad");var s=r.filterSize,u=r.strides,l=r.pad,c=r.dimRoundingMode,h=Go(o.shape,s,u,1,l,c),p=new uA(h,"max",!0),f=n.runWebGLProgram(p,[o],o.dtype),d=new nO(h),v=n.runWebGLProgram(d,[a,f],o.dtype);return n.disposeIntermediateTensorInfo(f),v}};var oO={kernelName:hn,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.filterSize,o=n.strides,s=n.pad,u=n.includeBatchInIndex,l=r;G(4===a.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,".")}));var c=[1,1];G(ns(o,c),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(c,"'")}));var h=Go(a.shape,i,o,c,s),p=function(e,t,n,r){var a=new uA(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");return a=new uA(n,"max",!0,!0,t),[i,r.runWebGLProgram(a,[e],"float32")]}(a,u,h,l),f=N(p,2);return[f[0],f[1]]}};var sO={kernelName:pn,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.keepDims,o=n.axis,s=r,u=a.shape.length,l=te(o,a.shape),c=l,h=ru(c,u),p=null!=h,f=s.shouldExecuteOnCPU([a]),d=[],v=a;if(p){if(f){for(var m=s.texData.get(v.dataId).values,g=new Array(u),y=0;y<g.length;y++)g[y]=a.shape[h[y]];var b=wE(m,a.shape,a.dtype,h,g);v=s.makeTensorInfo(g,a.dtype),s.texData.get(v.dataId).values=b}else v=SM(a,h,s);d.push(v),c=iu(c.length,u)}nu("sum",c,u);var x=N(eu(v.shape,c),2),k=x[0],w=x[1],_=k;i&&(_=tu(k,l));for(var S=function(e,t,n,r){var a=K(t),i=gM({inputs:{x:e},attrs:{shape:[K(e.shape)/a,a]},backend:r}),o=kM(i,"float32","mean",r),s=gM({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(v,w,_,s),I=0,C=d;I<C.length;I++){y=C[I];s.disposeIntermediateTensorInfo(y)}return S}};var uO={kernelName:fn,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=te(i,a.shape),l=u,c=ru(l,s),h=a;null!=c&&(h=TM({inputs:{x:a},backend:n,attrs:{perm:c}}),l=iu(l.length,a.shape.length)),nu("min",l,s);var p,f=N(eu(h.shape,l),2),d=f[0],v=gM({inputs:{x:h},backend:n,attrs:{shape:[-1,K(f[1])]}}),m=kM(v,v.dtype,"min",n);return p=gM(o?{inputs:{x:m},backend:n,attrs:{shape:tu(d,u)}}:{inputs:{x:m},backend:n,attrs:{shape:d}}),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m),null!=c&&n.disposeIntermediateTensorInfo(h),p}},lO=uM({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:cE}),cO={kernelName:dn,backendName:"webgl",kernelFunc:lO},hO=R((function e(t,n,r){A(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=UN(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),l="reflect"===r?0:1;this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(a,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(l,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(l,";\n          }\n        }\n        ").concat(i," coords = outC - start;\n        setOutput(getX(").concat(u,"));\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(l,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(l,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")})),pO=R((function e(t,n,r){A(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=UN(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=IE("rc",a),l=IE("source",a),c="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),h=1===a?"source":"vec2(".concat(l.slice(-2).join(),")"),p="reflect"===r?0:1,f="";if(1===a){var d="\n        ".concat(i," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(p,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(p,";\n        }\n        source -= start;\n      ");f="\n        ".concat(i," rc = outputLoc;\n        ").concat(d,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(h,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(c,") {\n          ").concat(d,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(h,");\n        }\n      ")}else{var v="\n        ".concat(i," source = rc;\n        ").concat(i," lt = ").concat(i,"(lessThan(source, start));\n        ").concat(i," gte = ").concat(i,"(greaterThanEqual(source, end));\n        ").concat(i," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(p,") +\n                gte * ((end - 1) * 2 - source + ").concat(p,");\n        source -= start;\n      ");f="\n        ".concat(i," rc = outputLoc;\n        ").concat(v,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(h,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(c,") {\n          ").concat(v,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(h,");\n        }\n        rc = outputLoc;\n        ").concat(u[a-2]," += 1;\n        if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(v,"\n          result[2] = getChannel(getX(").concat(l.join(),"), ").concat(h,");\n          ").concat(u[a-1]," += 1;\n          if(").concat(c,") {\n            ").concat(v,"\n            result[3] = getChannel(getX(").concat(l.join(),"), ").concat(h,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(f,"\n        setOutput(result);\n      }\n    ")})),fO={kernelName:vn,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.mode,s=Ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new pO(a.shape,i,o):new hO(a.shape,i,o);return n.runWebGLProgram(s,[a],a.dtype)}},dO=uM({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),vO={kernelName:mn,backendName:"webgl",kernelFunc:dO},mO=function(){function e(t,n,r){A(this,e),this.variableNames=["probs"],this.outputShape=[t,r],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(n-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(n-1,"));\n      }\n    ")}return R(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}}}]),e}(),gO=uM({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),yO={kernelName:_t,backendName:"webgl",kernelFunc:gO},bO="return a - b;",xO=uM({opSnippet:bO,packedOpSnippet:bO,supportsComplex:!0,cpuKernelImpl:bE}),kO={kernelName:or,backendName:"webgl",kernelFunc:xO};function wO(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=te([r.dim],a.shape),o=ZR({inputs:{x:a},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),s=tu(o.shape,i),u=gM({inputs:{x:o},backend:n,attrs:{shape:s}}),l=xO({inputs:{a:a,b:u},backend:n}),c=HD({inputs:{x:l},backend:n}),h=IM({inputs:{x:c},backend:n,attrs:{axis:i,keepDims:!1}}),p=gM({inputs:{x:h},backend:n,attrs:{shape:s}}),f=gO({inputs:{a:c,b:p},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),f}var _O={kernelName:rr,backendName:"webgl",kernelFunc:wO};var SO={kernelName:gn,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,s=r.normalized,u=s?a:wO({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),l=u.shape[0],c=u.shape[1],h=new mO(l,c,i),p=h.getCustomSetupFunc(o),f=n.runWebGLProgram(h,[u],"int32",p);return s||n.disposeIntermediateTensorInfo(u),f}},IO="return -x;";var CO={kernelName:bn,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])){var i=r.texData.get(a.dataId),o=N(pE(i.values,a.shape,a.dtype),2),s=o[0],u=o[1];return r.makeTensorInfo(u,a.dtype,s)}return t=Ce().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new GE(a.shape,IO):new DE(a.shape,IO),r.runWebGLProgram(t,[a],a.dtype)}},TO=Sl;var NO={kernelName:kn,backendName:"webgl",kernelFunc:function(e){zc("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,l=n.readSync(a.dataId),c=n.readSync(i.dataId),h=TO(l,c,o,s,u).selectedIndices;return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},EO=Il;var MO={kernelName:wn,backendName:"webgl",kernelFunc:function(e){zc("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,l=r.padToMaxOutputSize,c=n.readSync(a.dataId),h=n.readSync(i.dataId),p=EO(c,h,o,s,u,l),f=p.selectedIndices,d=p.validOutputs;return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([],"int32",new Int32Array([d]))]}},AO=Cl;var DO={kernelName:_n,backendName:"webgl",kernelFunc:function(e){zc("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,l=r.softNmsSigma,c=n.readSync(a.dataId),h=n.readSync(i.dataId),p=AO(c,h,o,s,u,l),f=p.selectedIndices,d=p.selectedScores;return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([d.length],"float32",new Float32Array(d))]}},RO=R((function e(t,n,r,a){A(this,e),this.variableNames=["indices"],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(r,"),\n                      float(index == coords.y)));\n      }\n    ")})),OO={kernelName:In,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=r.depth,o=r.onValue,s=r.offValue,u=K(a.shape),l=new RO(u,i,o,s),c=gM({inputs:{x:a},backend:n,attrs:{shape:[u]}}),h=n.runWebGLProgram(l,[c],a.dtype);n.disposeIntermediateTensorInfo(c);var p=gM({inputs:{x:h},backend:n,attrs:{shape:[].concat(I(a.shape),[i])}});return n.disposeIntermediateTensorInfo(h),p}};function FO(e){var t=e.inputs,n=e.backend,r=t.x;if("complex64"===r.dtype){var a=EA({inputs:{input:r},backend:n}),i=FO({inputs:{x:a},backend:n}),o=GA({inputs:{input:r},backend:n}),s=FO({inputs:{x:o},backend:n}),u=JE({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}return eR({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}var LO={kernelName:yr,backendName:"webgl",kernelFunc:FO};var PO={kernelName:Sn,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){var i=EA({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),s=GA({inputs:{input:a},backend:r}),u=FO({inputs:{x:s},backend:r}),l=JE({inputs:{real:o,imag:u},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),l}return eR({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}};var zO={kernelName:Cn,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return jD({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,i=t[0].dtype;t.forEach((function(e){j(a,e.shape,"All tensors passed to stack must have matching shapes"),G(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=[],s=KA({inputs:t.map((function(e){var t=jD({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t})),backend:n,attrs:{axis:r}});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),s}},BO=function(){function e(t,n,r){A(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=UN(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(s,");\n      uniform float value;\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(i," coords = outC - start;\n          setOutput(getX(").concat(u,"));\n        }\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n        uniform float value;\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")}return R(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}}}]),e}(),VO=function(){function e(t,n,r){A(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));for(var a=t.length,i=UN(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=IE("rc",a),l=IE("source",a),c="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),h=1===a?"source":"vec2(".concat(l.slice(-2).join(),")"),p=["".concat(i," rc = outputLoc;"),"".concat(u[a-1]," += 1;\n       if(").concat(c,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(u[a-2]," += 1;\n       if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(u[a-1]," += 1;\n         if(").concat(c,") {")],f=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",d="",v=0,m=1===a?2:4;v<m;v++)d+="\n        ".concat(p[v],"\n        if (").concat(f,") {\n          result[").concat(v,"] = float(value);\n        } else {\n          ").concat(i," source = rc - start;\n          result[").concat(v,"] = getChannel(getX(").concat(l.join(),"), ").concat(h,");\n        }\n      ");d+=1===a?"} ":"}}",this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(s,");\n      uniform float value;\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(d,"\n        setOutput(result);\n      }\n    ")}return R(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}}}]),e}(),WO=function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.constantValue,s=Ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new VO(a.shape,i,o):new BO(a.shape,i,o),u=s.getCustomSetupFunc(o);return n.runWebGLProgram(s,[a],a.dtype,u)},UO={kernelName:Tn,backendName:"webgl",kernelFunc:WO},HO=uM({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),GO={kernelName:Nn,backendName:"webgl",kernelFunc:HO};var jO={kernelName:Mn,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.axis,s=a.keepDims,u=i.shape.length,l=[],c=te(o,i.shape),h=c,p=ru(h,u),f=i;if(null!=p&&(f=TM({inputs:{x:i},backend:r,attrs:{perm:p}}),h=iu(h.length,u),l.push(f)),nu("prod",h,u),r.shouldExecuteOnCPU([f])){var d=r.texData.get(f.dataId).values,v=fE(f.shape,f.dtype,d,h),m=v.outVals,g=v.outShape,y=v.outDtype;t=r.makeTensorInfo(g,y,m)}else{var b=N(eu(f.shape,h),2),x=b[0],k=K(b[1]),w=gM({inputs:{x:f},backend:r,attrs:{shape:[-1,k]}}),_=kM(w,fa(i.dtype),"prod",r);t=gM({inputs:{x:_},backend:r,attrs:{shape:x}}),l.push(w),l.push(_)}if(s){l.push(t);var S=tu(t.shape,c);t=gM({inputs:{x:t},backend:r,attrs:{shape:S}})}return l.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),t}},qO=function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.step,o=n.dtype,s=dE(r,a,i,o);return t.makeTensorInfo([s.length],o,s)},XO={kernelName:An,backendName:"webgl",kernelFunc:qO},KO=sM({opSnippet:"return 1.0 / x;"}),YO={kernelName:Rn,backendName:"webgl",kernelFunc:KO},ZO=sM({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),QO={kernelName:On,backendName:"webgl",kernelFunc:ZO},$O=sM({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),JO={kernelName:Vn,backendName:"webgl",kernelFunc:$O},eF=R((function e(t,n,r,a,i){A(this,e),this.variableNames=["A"],this.outputShape=[];var o=N(t,4),s=o[0],u=o[1],l=o[2],c=o[3];this.outputShape=[s,n,r,c];var h,p=[a&&n>1?u-1:u,a&&r>1?l-1:l],f=[a&&n>1?n-1:n,a&&r>1?r-1:r];h=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(p[0]/f[0],",\n          ").concat(p[1]/f[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(l,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")})),tF=R((function e(t,n,r,a,i){A(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=N(t,4),s=o[0],u=o[1],l=o[2],c=o[3];this.outputShape=[s,n,r,c];var h,p=[a&&n>1?u-1:u,a&&r>1?l-1:l],f=[a&&n>1?n-1:n,a&&r>1?r-1:r];h=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(p[0]/f[0],",\n          ").concat(p[1]/f[1],",\n          ").concat(p[1]/f[1],");\n      const vec3 inputShapeRC = vec3(").concat(u,".0, ").concat(l,".0,\n                                     ").concat(l,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(c-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}));var nF={kernelName:zn,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=N(r.size,2),u=s[0],l=s[1],c=Ce().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new tF(a.shape,u,l,i,o):new eF(a.shape,u,l,i,o);return n.runWebGLProgram(c,[a],"float32")}},rF=R((function e(t,n,r){A(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=N(n,3),i=a[1],o=a[2],s=N(t,3),u=s[1],l=s[2],c=[r&&u>1?i-1:i,r&&l>1?o-1:o],h=[r&&u>1?u-1:u,r&&l>1?l-1:l],p=c[0]/h[0],f=c[1]/h[1],d=1/p,v=1/f,m=2*Math.ceil(d)+2,g=2*Math.ceil(v)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(f,");\n\n        const float invHeightScale = float(").concat(d,");\n        const float invWidthScale = float(").concat(v,");\n\n        const int winHeight = int(").concat(m,");\n        const int winWidth = int(").concat(g,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(l,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(i-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(o-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}));var aF={kernelName:Bn,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=new rF(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}},iF=R((function e(t,n,r,a,i){A(this,e),this.variableNames=["A"],this.outputShape=[];var o=N(t,4),s=o[0],u=o[1],l=o[2],c=o[3];this.outputShape=[s,n,r,c];var h,p=[a&&n>1?u-1:u,a&&r>1?l-1:l],f=[a&&n>1?n-1:n,a&&r>1?r-1:r],d=a?"0.5":"0.0";h=i?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(p[0]/f[0],",\n          ").concat(p[1]/f[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(l,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(d,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")}));var oF={kernelName:Ln,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=N(r.size,2),u=s[0],l=s[1],c=new iF(a.shape,u,l,i,o);return n.runWebGLProgram(c,[a],a.dtype)}},sF=R((function e(t,n,r){A(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=N(n,3),i=a[1],o=a[2],s=N(t,3),u=s[1],l=s[2],c=[r&&u>1?i-1:i,r&&l>1?o-1:o],h=[r&&u>1?u-1:u,r&&l>1?l-1:l],p=c[0]/h[0],f=c[1]/h[1],d=1/p,v=1/f,m=2*Math.ceil(d)+2,g=2*Math.ceil(v)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(f,");\n\n        const float invHeightScale = float(").concat(d,");\n        const float invWidthScale = float(").concat(v,");\n\n        const int winHeight = int(").concat(m,");\n        const int winWidth = int(").concat(g,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(l,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(c[0],") *\n                (float(dyR) / float(").concat(h[0],"));\n\n            float sourceFracCol =\n                float(").concat(c[1],") *\n                  (float(dyC) / float(").concat(h[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(r," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(o,") - 1),\n                ").concat(r," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}));var uF={kernelName:Pn,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=new sF(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}},lF=R((function e(t,n){A(this,e),this.variableNames=["x"];var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));if(this.outputShape=t,1!==r){var a=t.map((function(e,r){return function(e){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - coords[").concat(e,"] - 1"):"coords[".concat(e,"]")}(r)})).join(","),i=UN(r);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      ")})),cF=R((function e(t,n){A(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));this.outputShape=t;var a=IE("rc",r),i="".concat(a[r-1]," + 1 < ").concat(this.outputShape[r-1]),o="".concat(a[r-2]," + 1 < ").concat(this.outputShape[r-2]),s=UN(r);function u(e){var r=t.map((function(r,a){return function(e,r){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - ").concat(r[e]," - 1"):"".concat(r[e])}(a,e)})),a=r.join(","),i=r.slice(-2).join(",");return"getChannel(getX(".concat(a,"), vec2(").concat(i,"))")}this.userCode=1===r?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(i,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(s," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(e){return u(e)}(a.slice()),";\n          if(").concat(i,"){\n            result.g = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",u(e)}(a.slice()),";\n          }\n          if(").concat(o,") {\n            result.b = ").concat(function(e){return e[r-2]="("+e[r-2]+" + 1)",u(e)}(a.slice()),";\n            if(").concat(i,") {\n              result.a = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",e[r-2]="("+e[r-2]+" + 1)",u(e)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}));var hF={kernelName:Wn,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dims,o=a.shape.length,s=te(i,a.shape);if(0===o)return QE({inputs:{x:a},backend:n});var u=Ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new cF(a.shape,s):new lF(a.shape,s);return n.runWebGLProgram(u,[a],a.dtype)}},pF=function(){function e(t,n){A(this,e),this.variableNames=["Image"],this.outputShape=[];var r=t[1],a=t[2];this.outputShape=t;var i="";i="number"===typeof n?"float outputValue = ".concat(n.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(n.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        uniform vec4 params;\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(i,"\n          if(coordX >= 0 && coordX < ").concat(a," && coordY >= 0 && coordY < ").concat(r,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}return R(e,[{key:"getCustomSetupFunc",value:function(e,t,n,r){var a=this;return function(i,o){null==a.paramsLoc&&(a.paramsLoc=i.getUniformLocationNoThrow(o,"params")),i.gl.uniform4f(a.paramsLoc,e,t,n,r)}}}]),e}(),fF={kernelName:kr,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=n.radians,o=n.fillValue,s=n.center,u=r,l=new pF(a.shape,o),c=N(kc(s,a.shape[1],a.shape[2]),2),h=c[0],p=c[1],f=l.getCustomSetupFunc(h,p,Math.sin(i),Math.cos(i));return u.runWebGLProgram(l,[a],a.dtype,f)}},dF=sM({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),vF={kernelName:Un,backendName:"webgl",kernelFunc:dF},mF=sM({opSnippet:"return inversesqrt(x);",cpuKernelImpl:vE}),gF={kernelName:Hn,backendName:"webgl",kernelFunc:mF},yF=R((function e(t,n,r,a,i,o){A(this,e),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var s=UN(i.length),u=UN(o.length),l="";1===r?l="i":2===r&&(l="i, j");var c="getIndices(".concat(l,")"),h="";1===a?h="i":2===a&&(h="i, coords[1]");var p="getUpdates(".concat(h,")"),f=n>1?"strides[j]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(i,");\n\n        void main() {\n          ").concat(u," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(n,"; j++) {\n              int index = round(").concat(c,");\n              flattenedIndex += index * ").concat(f,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(p,";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      ")}));var bF={kernelName:Gn,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=t.updates,o=r.shape,s=Ec(0,a,o),u=s.sliceRank,l=s.numUpdates,c=s.sliceSize,h=s.strides,p=s.outputSize,f=[p/c,c];if(0===p)return n.makeTensorInfo(o,a.dtype);var d=gM({inputs:{x:a},backend:n,attrs:{shape:[l,u]}}),v=gM({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0])),g=new yF(l,u,d.shape.length,v.shape.length,h,f),y=n.runWebGLProgram(g,[v,d,m],v.dtype),b=gM({inputs:{x:y},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(m),b}},xF=R((function e(t,n,r){var a,i;if(A(this,e),this.variableNames=["c","a","b"],this.outputShape=n,r>4)throw Error("Where for rank ".concat(r," is not yet supported"));if(1===r)i="resRC",a="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],u=[],l=0;l<n.length;l++)u.push("".concat(o[l])),l<t&&s.push("".concat(o[l]));a=s.join(),i=u.join()}var c=UN(r);this.userCode="\n      void main() {\n        ".concat(c," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(i,"));\n        } else {\n          setOutput(getB(").concat(i,"));\n        }\n      }\n    ")}));var kF={kernelName:jn,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,i=t.e,o=new xF(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(o,[r,a,i],pa(a.dtype,i.dtype))}},wF=sM({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(Mc,";\n  float scale = ").concat(Ac,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),_F={kernelName:qn,backendName:"webgl",kernelFunc:wF},SF=sM({opSnippet:"return 1.0 / (1.0 + exp(-1.0 * x));"}),IF={kernelName:Qn,backendName:"webgl",kernelFunc:SF},CF=sM({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),TF={kernelName:Zn,backendName:"webgl",kernelFunc:CF},NF=sM({opSnippet:"if (isnan(x)) return x;\n  return sin(x);\n"}),EF={kernelName:Kn,backendName:"webgl",kernelFunc:NF},MF=sM({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),AF={kernelName:Yn,backendName:"webgl",kernelFunc:MF},DF=sM({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),RF={kernelName:$n,backendName:"webgl",kernelFunc:DF},OF={kernelName:tr,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.paddings;G(a.shape.length<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var s=i.reduce((function(e,t){return e*t})),u=[[0,0]];u.push.apply(u,I(o));for(var l=1+i.length;l<a.shape.length;++l)u.push([0,0]);var c=[],h=WO({inputs:{x:a},backend:n,attrs:{paddings:u,constantValue:0}}),p=wc(h.shape,i,s,!1),f=_c(p.length,i.length,!1),d=Sc(h.shape,i,s,!1),v=gM({inputs:{x:h},backend:n,attrs:{shape:p}}),m=TM({inputs:{x:v},backend:n,attrs:{perm:f}}),g=gM({inputs:{x:m},backend:n,attrs:{shape:d}});return c.push(h),c.push(v),c.push(m),c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}};var FF={kernelName:sr,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sparseIndices,i=t.sparseValues,o=t.defaultValue,s=r.outputShape,u=Ec(0,a,s),l=u.sliceRank,c=u.numUpdates,h=u.strides,p=u.outputSize,f=new yF(c,l,a.shape.length,i.shape.length,h,[p,1],!1),d=n.runWebGLProgram(f,[i,a,o],i.dtype),v=gM({inputs:{x:d},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(d),v}};var LF={kernelName:nr,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.numOrSizeSplits,o=te(r.axis,a.shape)[0],s=Hc(a,i,o),u=a.shape.length,l=new Array(u).fill(0),c=a.shape.slice();return s.map((function(e){var t=I(c);t[o]=e;var r=_A({inputs:{x:a},backend:n,attrs:{begin:l,size:t}});return l[o]+=e,r}))}},PF=sM({opSnippet:"return sqrt(x);"}),zF={kernelName:Jn,backendName:"webgl",kernelFunc:PF},BF={kernelName:ir,backendName:"webgl",kernelFunc:sM({opSnippet:"return x * x;"})},VF="return (a - b) * (a - b);",WF=uM({opSnippet:VF,packedOpSnippet:VF}),UF={kernelName:ar,backendName:"webgl",kernelFunc:WF};var HF={kernelName:br,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=RE+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),o=new DE(a.shape,i);return r.runWebGLProgram(o,[a],a.dtype)}},GF=R((function e(t,n,r){A(this,e),this.variableNames=["x"],this.outputShape=r;var a=r.length,i=UN(r.length),o=UN(r.length),s="";if(1===a)s="coords * strides + begin";else{var u=0;s=r.map((function(e,t){return u++,1===r.length?"coords * strides[".concat(t,"] + begin[").concat(t,"]"):"coords[".concat(u-1,"] * strides[").concat(t,"] + begin[").concat(t,"]")})).join(",")}this.userCode="\n      ".concat(i," begin = ").concat(i,"(").concat(t,");\n      ").concat(i," strides = ").concat(i,"(").concat(n,");\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(s,"));\n      }\n    ")}));var jF={kernelName:ur,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.begin,s=a.end,u=a.strides,l=a.beginMask,c=a.endMask,h=a.ellipsisMask,p=a.newAxisMask,f=a.shrinkAxisMask,d=So(i.shape,o,s,u,l,c,h,p,f),v=d.nonStrided,m=d.$begin,g=d.$strides,y=d.size,b=d.newShape,x=d.outShape,k=gM({inputs:{x:i},backend:r,attrs:{shape:b}});if(v){var w=_A({inputs:{x:k},backend:r,attrs:{begin:m,size:y}});t=gM({inputs:{x:w},backend:r,attrs:{shape:x}}),r.disposeIntermediateTensorInfo(w)}else if(x.some((function(e){return 0===e})))t=r.makeTensorInfo(x,i.dtype,[]);else{if(r.shouldExecuteOnCPU([k])){var _=r.texData.get(k.dataId).values,S=zi(k.shape,k.dtype,_),I=yE(x,S,g,m);t=r.makeTensorInfo(x,k.dtype,I.values)}else{var C=new GF(m,g,x);t=r.runWebGLProgram(C,[k],k.dtype)}}var T=gM({inputs:{x:t},backend:r,attrs:{shape:x}});return r.disposeIntermediateTensorInfo(k),r.disposeIntermediateTensorInfo(t),T}},qF=sM({opSnippet:"return tan(x);"}),XF={kernelName:lr,backendName:"webgl",kernelFunc:qF},KF=sM({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),YF={kernelName:cr,backendName:"webgl",kernelFunc:KF},ZF=R((function e(t,n){A(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[a]*n[a];this.outputShape=r,this.rank=r.length;var i=UN(this.rank),o=function(e){var t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<e.length;a++)r.push("imod(".concat(n[a],", ").concat(e[a],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")}));function QF(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;if("string"===a.dtype){var o=n.readSync(a.dataId).map((function(e){return Pr(e)})),s=zi(a.shape,a.dtype,o),u=xE(s,i);return n.makeTensorInfo(u.shape,u.dtype,u.values)}var l=new ZF(a.shape,i);return n.runWebGLProgram(l,[a],a.dtype)}var $F={kernelName:hr,backendName:"webgl",kernelFunc:QF};var JF={kernelName:pr,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.k,o=r.sorted,s=n.readSync(a.dataId),u=N(kE(s,a.shape,a.dtype,i,o),2),l=u[0],c=u[1];return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}},eL=R((function e(t,n,r,a,i,o){A(this,e),this.variableNames=["Image","Transforms"],this.outputShape=o;var s,u="nearest"===r?1:2;switch(a){case"constant":default:s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(s," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(t," && 0 <= coordX && coordX < ").concat(n,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(i,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(i,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(n,"));\n                float mapY = mapCoord(inY, float(").concat(t,"));\n\n                if (").concat(u," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}));var tL={kernelName:fr,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.transforms,o=r.interpolation,s=r.fillMode,u=r.fillValue,l=r.outputShape,c=N(a.shape,4),h=c[0],p=c[1],f=c[2],d=c[3],v=N(null!=l?l:[p,f],2),m=v[0],g=v[1],y=new eL(p,f,o,s,u,[h,m,g,d]);return n.runWebGLProgram(y,[a,i],"float32")}};var nL={kernelName:vr,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;sN(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");var o=r.readSync(i.dataId),s=_E(o,a,i.shape,i.dtype),u=s.outputValues,l=s.outputShape,c=s.indices;return[r.makeTensorInfo(l,i.dtype,u),r.makeTensorInfo([c.length],"int32",c)]}};var rL={kernelName:mr,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a,s=o.shape.length,u=a.shape[i],l=new Array(s-1),c=0,h=0;h<s;h++)h!==i&&(l[c++]=o.shape[h]);var p=[],f=new Array(s).fill(0),d=o.shape.slice();d[i]=1;for(var v=new Array(u),m=0;m<v.length;m++){f[i]=m;var g=_A({inputs:{x:o},backend:n,attrs:{begin:f,size:d}}),y=gM({inputs:{x:g},backend:n,attrs:{shape:l}});v[m]=y,p.push(g)}return p.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),v}},aL=R((function e(t,n){A(this,e),this.variableNames=["x","segmentIds"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.numSegments,s=o*Math.ceil(i/r);this.outputShape=[a,s];var u=4*Math.floor(r/4),l=r%4,c="\n        sumValue += dot(values, segFilter);\n    ",h="";i%r>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      "));var p="";i%r>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(h,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(p,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(o,")) * float(").concat(r,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(o,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(u,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(u,";\n        if (").concat(1===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(c,"\n        } else if (").concat(2===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(c,"\n        } else if (").concat(3===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(c,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}));for(var iL={kernelName:gr,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.segmentIds,o=r.numSegments,s=a.shape.length,u=[],l=0,c=ru([l],s),h=a;null!=c&&(h=TM({inputs:{x:a},backend:n,attrs:{perm:c}}),u.push(h),l=iu(1,s)[0]);var p=function(e,t,n){for(var r=[],a=e.length,i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}(h.shape,l,o),f=K([h.shape[l]]),d=gM({inputs:{x:h},backend:n,attrs:{shape:[-1,f]}});u.push(d);var v=function e(t,r,a,i,o){var s=t.shape[0],l=t.shape[1],c=function(e,t){var n,r=!1;for(e<=30?(n=e,r=!0):n=pe(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=pe(e,n+1);return n}(l,o),h=new aL({windowSize:c,inSize:l,batchSize:s,numSegments:o},r),p=n.compileAndRun(h,[t,a],i);if(u.push(p),p.shape[1]===o)return p;var f=qO({backend:n,attrs:{start:0,stop:o,step:1,dtype:"float32"}}),d=QF({inputs:{x:f},backend:n,attrs:{reps:[l/c]}});return u.push(f),u.push(d),e(p,r,d,i,o)}(d,"unsortedSegmentSum",i,fa(a.dtype),o),m=gM({inputs:{x:v},backend:n,attrs:{shape:p}}),g=m;if(null!=c){u.push(m);var y=au(c);g=TM({inputs:{x:g},backend:n,attrs:{perm:y}})}return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}},oL=0,sL=[XR,YR,MM,DM,OM,LM,BM,UM,HM,GM,ZM,QM,JM,tA,iA,rA,sA,hA,cA,dA,vA,mA,bA,IA,CA,AA,OA,PA,VA,eM,YA,oD,sD,tD,lD,cD,uD,pD,dD,mD,xD,kD,_D,ED,MD,CD,DD,OD,LD,PD,BD,WD,GD,qD,YD,$D,nR,aR,sR,lR,pR,fR,dR,mR,yR,xR,wR,$E,_R,jA,IR,TR,ER,rM,AR,RR,OR,zR,LR,VR,UR,GR,QR,tO,eO,aO,iO,oO,JR,sO,uO,cO,fO,vO,SO,mM,CO,NO,MO,DO,NA,OO,PO,zO,UO,GO,oM,jO,XO,MA,yO,YO,JO,QO,yM,nF,aF,oF,uF,hF,fF,vF,gF,bF,kF,_F,IF,TF,EF,AF,SA,_O,RF,OF,FF,LF,zF,BF,UF,HF,jF,kO,CM,XF,YF,$F,JF,tL,NM,nL,rL,iL,LO];oL<sL.length;oL++){Mr(sL[oL])}var uL={flipHorizontal:!1,outputStride:16,imageScaleFactor:1,maxNumBoxes:20,iouThreshold:.2,scoreThreshold:.6,modelType:"ssd320fpnlite",modelSize:"small",bboxLineWidth:"2",fontSize:17,basePath:"https://cdn.jsdelivr.net/npm/handtrackjs@latest/models/webmodel/",labelMap:{1:"open",2:"closed",3:"pinch",4:"point",5:"face",6:"pointtip",7:"pinchtip"},renderThresholds:null},lL={large:"base",medium:"fp16",small:"int8"},cL={open:"#374151",closed:"#B91C1C",pinch:"#F59E0B",point:"#10B981",face:"#3B82F6",pointtip:"#6366F1",pinchtip:"#EC4899"},hL={ssd320fpnlite:["StatefulPartitionedCall/Postprocessor/Slice","StatefulPartitionedCall/Postprocessor/ExpandDims_1"],ssd640fpnlite:["StatefulPartitionedCall/Postprocessor/Slice","StatefulPartitionedCall/Postprocessor/ExpandDims_1"],centernet512fpn:["Identity_4:0","Identity:0","Identity_2:0"]};function pL(){return(pL=F(M().mark((function e(t){var n,r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object.assign({},uL,t),r=new dL(n),e.next=4,r.load();case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fL(){return(fL=F(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.localStream){e.next=4;break}window.localStream.getTracks().forEach((function(e){return e.stop(),!0})),e.next=5;break;case 4:return e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var dL=function(){function e(t){A(this,e),this.modelPath=t.basePath+t.modelType+"/"+(lL[t.modelSize]||"base")+"/model.json ",this.modelParams=t}return R(e,[{key:"load",value:function(){var e=F(M().mark((function e(){var t,n;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.fps=0,e.next=3,pk(this.modelPath);case 3:return this.model=e.sent,t=hu([1,300,300,3],"int32"),e.next=7,this.model.executeAsync(t,hL[this.modelParams.modelType]);case 7:(n=e.sent).map(function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.data();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.map(function(){var e=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.dispose());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Ao(t);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"detect",value:function(){var e=F(M().mark((function e(t){var n,r,a,i,o,s,u,l,c,h=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Date.now(),r=mL(t),a=N(r,2),i=a[0],o=a[1],s=vL(this.modelParams.imageScaleFactor,i,this.modelParams.outputStride),u=vL(this.modelParams.imageScaleFactor,o,this.modelParams.outputStride),l=Mo((function(){var e=ho(t);return h.modelParams.flipHorizontal?e.reverse(1).resizeBilinear([s,u]).expandDims(0).toInt():e.resizeBilinear([s,u]).expandDims(0).toInt()})),c=this,e.abrupt("return",this.model.executeAsync(l,hL[this.modelParams.modelType]).then((function(e){l.dispose();var t=[];if("centernet512fpn"===c.modelParams.modelType){var r=e[0].dataSync(),a=e[1].arraySync(),s=e[2].dataSync();Ao(e),t=c.buildDetectObjectsCenternet(o,i,a[0],r,s),console.log(t)}else{var u=e[0].dataSync(),h=e[1].dataSync();Ao(e);var p=N(gL(u,e[0].shape[1],e[0].shape[2]),2),f=p[0],d=p[1],v=_a.backendName;Ro("cpu");var m=Mo((function(){var t=Bu(h,[e[1].shape[1],e[1].shape[3]]);return ic.nonMaxSuppression(t,f,c.modelParams.maxNumBoxes,c.modelParams.iouThreshold,c.modelParams.scoreThreshold)})),g=m.dataSync();m.dispose(),Ro(v),t=c.buildDetectedObjects(o,i,h,f,g,d)}var y=Date.now();return c.fps=Math.round(1e3/(y-n)),t})));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"buildDetectedObjects",value:function(e,t,n,r,a,i){for(var o=a.length,s=[],u=0;u<o;u++){for(var l=[],c=0;c<4;c++)l[c]=n[4*a[u]+c];var h=l[0]*t,p=l[1]*e,f=l[2]*t,d=l[3]*e;l[0]=p,l[1]=h,l[2]=d-p,l[3]=f-h;var v=Math.round(i[a[u]])+1;s.push({bbox:l,class:v,label:this.modelParams.labelMap[v],score:r[a[u]].toFixed(2)})}return s}},{key:"buildDetectObjectsCenternet",value:function(e,t,n,r,a){for(var i=[],o=0;o<r.length;o++){var s=n[o],u=s[0]*t,l=s[1]*e,c=s[2]*t,h=s[3]*e;s[0]=l,s[1]=u,s[2]=h-l,s[3]=c-u;var p=Math.round(a[o])+1;i.push({bbox:s,class:p,label:this.modelParams.labelMap[p],score:r[o].toFixed(2)})}return i.slice(0,10)}},{key:"getFPS",value:function(){return this.fps}},{key:"setModelParameters",value:function(e){this.modelParams=Object.assign({},this.modelParams,e)}},{key:"getModelParameters",value:function(){return this.modelParams}},{key:"roundRect",value:function(e,t,n,r,a,i,o,s){if("undefined"===typeof s&&(s=!0),"undefined"===typeof i&&(i=5),"number"===typeof i)i={tl:i,tr:i,br:i,bl:i};else{var u={tl:0,tr:0,br:0,bl:0};for(var l in u)i[l]=i[l]||u[l]}e.beginPath(),e.moveTo(t+i.tl,n),e.lineTo(t+r-i.tr,n),e.quadraticCurveTo(t+r,n,t+r,n+i.tr),e.lineTo(t+r,n+a-i.br),e.quadraticCurveTo(t+r,n+a,t+r-i.br,n+a),e.lineTo(t+i.bl,n+a),e.quadraticCurveTo(t,n+a,t,n+a-i.bl),e.lineTo(t,n+i.tl),e.quadraticCurveTo(t,n,t+i.tl,n),e.closePath(),o&&e.fill(),s&&e.stroke()}},{key:"renderPredictions",value:function(e,t,n,r){n.clearRect(0,0,t.width,t.height),t.width=r.width,t.height=r.height,t.style.height=parseInt(t.style.width)*(r.height/r.width).toFixed(2)+"px",n.save(),this.modelParams.flipHorizontal&&(n.scale(-1,1),n.translate(-r.width,0)),n.drawImage(r,0,0,r.width,r.height),n.restore(),n.font="bold "+this.modelParams.fontSize+"px Arial";for(var a=this.modelParams.renderThresholds,i=0;i<e.length;i++){var o=e[i];(!a||o.score>a[o.label])&&(n.beginPath(),n.fillStyle="rgba(255, 255, 255, 0.6)",n.fillRect(o.bbox[0]+1,o.bbox[1]+1,o.bbox[2]-1,1.5*this.modelParams.fontSize),n.lineWidth=this.modelParams.bboxLineWidth,this.roundRect(n,o.bbox[0],o.bbox[1],o.bbox[2],o.bbox[3],5,!1,!0),n.strokeStyle=cL[o.label],n.fillStyle=cL[o.label],n.stroke(),n.beginPath(),n.arc(o.bbox[0]+o.bbox[2]/2,o.bbox[1]+o.bbox[3]/2,2,0,2*Math.PI),n.fill(),n.stroke(),n.fillText(o.score+" | "+o.label,o.bbox[0]+5,o.bbox[1]+1.1*this.modelParams.fontSize))}n.fillStyle="rgba(255, 255, 255, 0.6)",this.roundRect(n,10,10,4.6*this.modelParams.fontSize,this.modelParams.fontSize+8,5,!0,!1),n.strokeStyle="#374151",n.fillStyle="#374151",n.font="bold "+this.modelParams.fontSize+"px Arial",n.fillText("FPS: "+this.fps,18,this.modelParams.fontSize+12)}},{key:"dispose",value:function(){this.model&&this.model.dispose()}}]),e}();function vL(e,t,n){var r=t*e-1;return r-r%n+1}function mL(e){return e instanceof ra?[e.shape[0],e.shape[1]]:[e.height,e.width]}function gL(e,t,n){for(var r=[],a=[],i=0;i<t;i++){for(var o=Number.MIN_VALUE,s=-1,u=0;u<n;u++)e[i*n+u]>o&&(o=e[i*n+u],s=u);r[i]=o,a[i]=s}return[r,a]}var yL=n(197),bL=n(184);var xL=function(e){return(0,bL.jsx)(yL.lr,{className:"my-carousel",infiniteLoop:!0,swipeable:!0,emulateTouch:!0,showThumbs:!1,selectedItem:e.slideIndex,children:e.children})},kL=function(e,t){return kL=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},kL(e,t)};function wL(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}kL(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}Object.create;Object.create;var _L="12px sans-serif";var SL=function(e){var t={};if("undefined"===typeof JSON)return t;for(var n=0;n<e.length;n++){var r=String.fromCharCode(n+32),a=(e.charCodeAt(n)-20)/100;t[r]=a}return t}("007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N"),IL={createCanvas:function(){return"undefined"!==typeof document&&document.createElement("canvas")},measureText:function(){var e,t;return function(n,r){if(!e){var a=IL.createCanvas();e=a&&a.getContext("2d")}if(e)return t!==r&&(t=e.font=r||_L),e.measureText(n);n=n||"";var i=/^([0-9]*?)px$/.exec(r=r||_L),o=+(i&&i[1])||12,s=0;if(r.indexOf("mono")>=0)s=o*n.length;else for(var u=0;u<n.length;u++){var l=SL[n[u]];s+=null==l?o:l*o}return{width:s}}}(),loadImage:function(e,t,n){var r=new Image;return r.onload=t,r.onerror=n,r.src=e,r}};var CL=YL(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],(function(e,t){return e["[object "+t+"]"]=!0,e}),{}),TL=YL(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],(function(e,t){return e["[object "+t+"Array]"]=!0,e}),{}),NL=Object.prototype.toString,EL=Array.prototype,ML=EL.forEach,AL=EL.filter,DL=EL.slice,RL=EL.map,OL=function(){}.constructor,FL=OL?OL.prototype:null,LL="__proto__",PL=2311;function zL(){return PL++}function BL(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];"undefined"!==typeof console&&console.error.apply(console,e)}function VL(e){if(null==e||"object"!==typeof e)return e;var t=e,n=NL.call(e);if("[object Array]"===n){if(!xP(e)){t=[];for(var r=0,a=e.length;r<a;r++)t[r]=VL(e[r])}}else if(TL[n]){if(!xP(e)){var i=e.constructor;if(i.from)t=i.from(e);else{t=new i(e.length);for(r=0,a=e.length;r<a;r++)t[r]=e[r]}}}else if(!CL[n]&&!xP(e)&&!uP(e))for(var o in t={},e)e.hasOwnProperty(o)&&o!==LL&&(t[o]=VL(e[o]));return t}function WL(e,t,n){if(!iP(t)||!iP(e))return n?VL(t):e;for(var r in t)if(t.hasOwnProperty(r)&&r!==LL){var a=e[r],i=t[r];!iP(i)||!iP(a)||eP(i)||eP(a)||uP(i)||uP(a)||oP(i)||oP(a)||xP(i)||xP(a)?!n&&r in e||(e[r]=VL(t[r])):WL(a,i,n)}return e}function UL(e,t){if(Object.assign)Object.assign(e,t);else for(var n in t)t.hasOwnProperty(n)&&n!==LL&&(e[n]=t[n]);return e}function HL(e,t,n){for(var r=QL(t),a=0;a<r.length;a++){var i=r[a];(n?null!=t[i]:null==e[i])&&(e[i]=t[i])}return e}IL.createCanvas;function GL(e,t){if(e){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n}return-1}function jL(e,t,n){if(e="prototype"in e?e.prototype:e,t="prototype"in t?t.prototype:t,Object.getOwnPropertyNames)for(var r=Object.getOwnPropertyNames(t),a=0;a<r.length;a++){var i=r[a];"constructor"!==i&&(n?null!=t[i]:null==e[i])&&(e[i]=t[i])}else HL(e,t,n)}function qL(e){return!!e&&("string"!==typeof e&&"number"===typeof e.length)}function XL(e,t,n){if(e&&t)if(e.forEach&&e.forEach===ML)e.forEach(t,n);else if(e.length===+e.length)for(var r=0,a=e.length;r<a;r++)t.call(n,e[r],r,e);else for(var i in e)e.hasOwnProperty(i)&&t.call(n,e[i],i,e)}function KL(e,t,n){if(!e)return[];if(!t)return dP(e);if(e.map&&e.map===RL)return e.map(t,n);for(var r=[],a=0,i=e.length;a<i;a++)r.push(t.call(n,e[a],a,e));return r}function YL(e,t,n,r){if(e&&t){for(var a=0,i=e.length;a<i;a++)n=t.call(r,n,e[a],a,e);return n}}function ZL(e,t,n){if(!e)return[];if(!t)return dP(e);if(e.filter&&e.filter===AL)return e.filter(t,n);for(var r=[],a=0,i=e.length;a<i;a++)t.call(n,e[a],a,e)&&r.push(e[a]);return r}function QL(e){if(!e)return[];if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}var $L=FL&&tP(FL.bind)?FL.call.bind(FL.bind):function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return function(){return e.apply(t,n.concat(DL.call(arguments)))}};function JL(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){return e.apply(this,t.concat(DL.call(arguments)))}}function eP(e){return Array.isArray?Array.isArray(e):"[object Array]"===NL.call(e)}function tP(e){return"function"===typeof e}function nP(e){return"string"===typeof e}function rP(e){return"[object String]"===NL.call(e)}function aP(e){return"number"===typeof e}function iP(e){var t=typeof e;return"function"===t||!!e&&"object"===t}function oP(e){return!!CL[NL.call(e)]}function sP(e){return!!TL[NL.call(e)]}function uP(e){return"object"===typeof e&&"number"===typeof e.nodeType&&"object"===typeof e.ownerDocument}function lP(e){return null!=e.colorStops}function cP(e){return e!==e}function hP(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,r=e.length;n<r;n++)if(null!=e[n])return e[n]}function pP(e,t){return null!=e?e:t}function fP(e,t,n){return null!=e?e:null!=t?t:n}function dP(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return DL.apply(e,t)}function vP(e){if("number"===typeof e)return[e,e,e,e];var t=e.length;return 2===t?[e[0],e[1],e[0],e[1]]:3===t?[e[0],e[1],e[2],e[1]]:e}function mP(e,t){if(!e)throw new Error(t)}function gP(e){return null==e?null:"function"===typeof e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var yP="__ec_primitive__";function bP(e){e[yP]=!0}function xP(e){return e[yP]}var kP=function(){function e(t){this.data={};var n=eP(t);this.data={};var r=this;function a(e,t){n?r.set(e,t):r.set(t,e)}t instanceof e?t.each(a):t&&XL(t,a)}return e.prototype.get=function(e){return this.data.hasOwnProperty(e)?this.data[e]:null},e.prototype.set=function(e,t){return this.data[e]=t},e.prototype.each=function(e,t){for(var n in this.data)this.data.hasOwnProperty(n)&&e.call(t,this.data[n],n)},e.prototype.keys=function(){return QL(this.data)},e.prototype.removeKey=function(e){delete this.data[e]},e}();function wP(e){return new kP(e)}function _P(e,t){var n;if(Object.create)n=Object.create(e);else{var r=function(){};r.prototype=e,n=new r}return t&&UL(n,t),n}function SP(e){var t=e.style;t.webkitUserSelect="none",t.userSelect="none",t.webkitTapHighlightColor="rgba(0,0,0,0)",t["-webkit-touch-callout"]="none"}function IP(e,t){return e.hasOwnProperty(t)}function CP(){}var TP=180/Math.PI,NP=function(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1},EP=new function(){this.browser=new NP,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow="undefined"!==typeof window};"object"===typeof wx&&"function"===typeof wx.getSystemInfoSync?(EP.wxa=!0,EP.touchEventsSupported=!0):"undefined"===typeof document&&"undefined"!==typeof self?EP.worker=!0:"undefined"===typeof navigator?(EP.node=!0,EP.svgSupported=!0):function(e,t){var n=t.browser,r=e.match(/Firefox\/([\d.]+)/),a=e.match(/MSIE\s([\d.]+)/)||e.match(/Trident\/.+?rv:(([\d.]+))/),i=e.match(/Edge?\/([\d.]+)/),o=/micromessenger/i.test(e);r&&(n.firefox=!0,n.version=r[1]);a&&(n.ie=!0,n.version=a[1]);i&&(n.edge=!0,n.version=i[1],n.newEdge=+i[1].split(".")[0]>18);o&&(n.weChat=!0);t.svgSupported="undefined"!==typeof SVGRect,t.touchEventsSupported="ontouchstart"in window&&!n.ie&&!n.edge,t.pointerEventsSupported="onpointerdown"in window&&(n.edge||n.ie&&+n.version>=11),t.domSupported="undefined"!==typeof document;var s=document.documentElement.style;t.transform3dSupported=(n.ie&&"transition"in s||n.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in s)&&!("OTransition"in s),t.transformSupported=t.transform3dSupported||n.ie&&+n.version>=9}(navigator.userAgent,EP);var MP=EP,AP="___EC__COMPONENT__CONTAINER___",DP="___EC__EXTENDED_CLASS___";function RP(e){var t={main:"",sub:""};if(e){var n=e.split(".");t.main=n[0]||"",t.sub=n[1]||""}return t}function OP(e,t){e.$constructor=e,e.extend=function(e){var t,n=this;return!function(e){return tP(e)&&/^class\s/.test(Function.prototype.toString.call(e))}(n)?(t=function(){(e.$constructor||n).apply(this,arguments)},function(e,t){var n=e.prototype;function r(){}for(var a in r.prototype=t.prototype,e.prototype=new r,n)n.hasOwnProperty(a)&&(e.prototype[a]=n[a]);e.prototype.constructor=e,e.superClass=t}(t,this)):t=function(e){function t(){return e.apply(this,arguments)||this}return wL(t,e),t}(n),UL(t.prototype,e),t[DP]=!0,t.extend=this.extend,t.superCall=PP,t.superApply=zP,t.superClass=n,t}}function FP(e,t){e.extend=t.extend}var LP=Math.round(10*Math.random());function PP(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return this.superClass.prototype[t].apply(e,n)}function zP(e,t,n){return this.superClass.prototype[t].apply(e,n)}function BP(e){var t={};e.registerClass=function(e){var n,r=e.type||e.prototype.type;if(r){mP(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(n=r),'componentType "'+n+'" illegal'),e.prototype.type=r;var a=RP(r);if(a.sub){if(a.sub!==AP){var i=function(e){var n=t[e.main];n&&n[AP]||((n=t[e.main]={})[AP]=!0);return n}(a);i[a.sub]=e}}else t[a.main]=e}return e},e.getClass=function(e,n,r){var a=t[e];if(a&&a[AP]&&(a=n?a[n]:null),r&&!a)throw new Error(n?"Component "+e+"."+(n||"")+" is used but not imported.":e+".type should be specified.");return a},e.getClassesByMainType=function(e){var n=RP(e),r=[],a=t[n.main];return a&&a[AP]?XL(a,(function(e,t){t!==AP&&r.push(e)})):r.push(a),r},e.hasClass=function(e){var n=RP(e);return!!t[n.main]},e.getAllClassMainTypes=function(){var e=[];return XL(t,(function(t,n){e.push(n)})),e},e.hasSubTypes=function(e){var n=RP(e),r=t[n.main];return r&&r[AP]}}function VP(e,t){for(var n=0;n<e.length;n++)e[n][1]||(e[n][1]=e[n][0]);return t=t||!1,function(n,r,a){for(var i={},o=0;o<e.length;o++){var s=e[o][1];if(!(r&&GL(r,s)>=0||a&&GL(a,s)<0)){var u=n.getShallow(s,t);null!=u&&(i[e[o][0]]=u)}}return i}}var WP=VP([["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]]),UP=function(){function e(){}return e.prototype.getAreaStyle=function(e,t){return WP(this,e,t)},e}(),HP=function(e,t){return HP=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},HP(e,t)};function GP(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}HP(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}Object.create;Object.create;var jP=function(e){this.value=e},qP=function(){function e(){this._len=0}return e.prototype.insert=function(e){var t=new jP(e);return this.insertEntry(t),t},e.prototype.insertEntry=function(e){this.head?(this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e):this.head=this.tail=e,this._len++},e.prototype.remove=function(e){var t=e.prev,n=e.next;t?t.next=n:this.head=n,n?n.prev=t:this.tail=t,e.next=e.prev=null,this._len--},e.prototype.len=function(){return this._len},e.prototype.clear=function(){this.head=this.tail=null,this._len=0},e}(),XP=function(){function e(e){this._list=new qP,this._maxSize=10,this._map={},this._maxSize=e}return e.prototype.put=function(e,t){var n=this._list,r=this._map,a=null;if(null==r[e]){var i=n.len(),o=this._lastRemovedEntry;if(i>=this._maxSize&&i>0){var s=n.head;n.remove(s),delete r[s.key],a=s.value,this._lastRemovedEntry=s}o?o.value=t:o=new jP(t),o.key=e,n.insertEntry(o),r[e]=o}return a},e.prototype.get=function(e){var t=this._map[e],n=this._list;if(null!=t)return t!==n.tail&&(n.remove(t),n.insertEntry(t)),t.value},e.prototype.clear=function(){this._list.clear(),this._map={}},e.prototype.len=function(){return this._list.len()},e}(),KP=XP,YP=new KP(50);function ZP(e){if("string"===typeof e){var t=YP.get(e);return t&&t.image}return e}function QP(e,t,n,r,a){if(e){if("string"===typeof e){if(t&&t.__zrImageSrc===e||!n)return t;var i=YP.get(e),o={hostEl:n,cb:r,cbPayload:a};if(i)!JP(t=i.image)&&i.pending.push(o);else{var s=IL.loadImage(e,$P,$P);s.__zrImageSrc=e,YP.put(e,s.__cachedImgObj={image:s,pending:[o]})}return t}return e}return t}function $P(){var e=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var t=0;t<e.pending.length;t++){var n=e.pending[t],r=n.cb;r&&r(this,n.cbPayload),n.hostEl.dirty()}e.pending.length=0}function JP(e){return e&&e.width&&e.height}function ez(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function tz(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function nz(e,t,n){var r=t[0]*n[0]+t[2]*n[1],a=t[1]*n[0]+t[3]*n[1],i=t[0]*n[2]+t[2]*n[3],o=t[1]*n[2]+t[3]*n[3],s=t[0]*n[4]+t[2]*n[5]+t[4],u=t[1]*n[4]+t[3]*n[5]+t[5];return e[0]=r,e[1]=a,e[2]=i,e[3]=o,e[4]=s,e[5]=u,e}function rz(e,t,n){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4]+n[0],e[5]=t[5]+n[1],e}function az(e,t,n){var r=t[0],a=t[2],i=t[4],o=t[1],s=t[3],u=t[5],l=Math.sin(n),c=Math.cos(n);return e[0]=r*c+o*l,e[1]=-r*l+o*c,e[2]=a*c+s*l,e[3]=-a*l+c*s,e[4]=c*i+l*u,e[5]=c*u-l*i,e}function iz(e,t){var n=t[0],r=t[2],a=t[4],i=t[1],o=t[3],s=t[5],u=n*o-i*r;return u?(u=1/u,e[0]=o*u,e[1]=-i*u,e[2]=-r*u,e[3]=n*u,e[4]=(r*s-o*a)*u,e[5]=(i*a-n*s)*u,e):null}var oz=function(){function e(e,t){this.x=e||0,this.y=t||0}return e.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this},e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.set=function(e,t){return this.x=e,this.y=t,this},e.prototype.equal=function(e){return e.x===this.x&&e.y===this.y},e.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},e.prototype.scale=function(e){this.x*=e,this.y*=e},e.prototype.scaleAndAdd=function(e,t){this.x+=e.x*t,this.y+=e.y*t},e.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},e.prototype.dot=function(e){return this.x*e.x+this.y*e.y},e.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},e.prototype.normalize=function(){var e=this.len();return this.x/=e,this.y/=e,this},e.prototype.distance=function(e){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)},e.prototype.distanceSquare=function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},e.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},e.prototype.transform=function(e){if(e){var t=this.x,n=this.y;return this.x=e[0]*t+e[2]*n+e[4],this.y=e[1]*t+e[3]*n+e[5],this}},e.prototype.toArray=function(e){return e[0]=this.x,e[1]=this.y,e},e.prototype.fromArray=function(e){this.x=e[0],this.y=e[1]},e.set=function(e,t,n){e.x=t,e.y=n},e.copy=function(e,t){e.x=t.x,e.y=t.y},e.len=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},e.lenSquare=function(e){return e.x*e.x+e.y*e.y},e.dot=function(e,t){return e.x*t.x+e.y*t.y},e.add=function(e,t,n){e.x=t.x+n.x,e.y=t.y+n.y},e.sub=function(e,t,n){e.x=t.x-n.x,e.y=t.y-n.y},e.scale=function(e,t,n){e.x=t.x*n,e.y=t.y*n},e.scaleAndAdd=function(e,t,n,r){e.x=t.x+n.x*r,e.y=t.y+n.y*r},e.lerp=function(e,t,n,r){var a=1-r;e.x=a*t.x+r*n.x,e.y=a*t.y+r*n.y},e}(),sz=oz,uz=Math.min,lz=Math.max,cz=new sz,hz=new sz,pz=new sz,fz=new sz,dz=new sz,vz=new sz,mz=function(){function e(e,t,n,r){n<0&&(e+=n,n=-n),r<0&&(t+=r,r=-r),this.x=e,this.y=t,this.width=n,this.height=r}return e.prototype.union=function(e){var t=uz(e.x,this.x),n=uz(e.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=lz(e.x+e.width,this.x+this.width)-t:this.width=e.width,isFinite(this.y)&&isFinite(this.height)?this.height=lz(e.y+e.height,this.y+this.height)-n:this.height=e.height,this.x=t,this.y=n},e.prototype.applyTransform=function(t){e.applyTransform(this,this,t)},e.prototype.calculateTransform=function(e){var t=this,n=e.width/t.width,r=e.height/t.height,a=[1,0,0,1,0,0];return rz(a,a,[-t.x,-t.y]),function(e,t,n){var r=n[0],a=n[1];e[0]=t[0]*r,e[1]=t[1]*a,e[2]=t[2]*r,e[3]=t[3]*a,e[4]=t[4]*r,e[5]=t[5]*a}(a,a,[n,r]),rz(a,a,[e.x,e.y]),a},e.prototype.intersect=function(t,n){if(!t)return!1;t instanceof e||(t=e.create(t));var r=this,a=r.x,i=r.x+r.width,o=r.y,s=r.y+r.height,u=t.x,l=t.x+t.width,c=t.y,h=t.y+t.height,p=!(i<u||l<a||s<c||h<o);if(n){var f=1/0,d=0,v=Math.abs(i-u),m=Math.abs(l-a),g=Math.abs(s-c),y=Math.abs(h-o),b=Math.min(v,m),x=Math.min(g,y);i<u||l<a?b>d&&(d=b,v<m?sz.set(vz,-v,0):sz.set(vz,m,0)):b<f&&(f=b,v<m?sz.set(dz,v,0):sz.set(dz,-m,0)),s<c||h<o?x>d&&(d=x,g<y?sz.set(vz,0,-g):sz.set(vz,0,y)):b<f&&(f=b,g<y?sz.set(dz,0,g):sz.set(dz,0,-y))}return n&&sz.copy(n,p?dz:vz),p},e.prototype.contain=function(e,t){var n=this;return e>=n.x&&e<=n.x+n.width&&t>=n.y&&t<=n.y+n.height},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.copy=function(t){e.copy(this,t)},e.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},e.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},e.prototype.isZero=function(){return 0===this.width||0===this.height},e.create=function(t){return new e(t.x,t.y,t.width,t.height)},e.copy=function(e,t){e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height},e.applyTransform=function(t,n,r){if(r){if(r[1]<1e-5&&r[1]>-1e-5&&r[2]<1e-5&&r[2]>-1e-5){var a=r[0],i=r[3],o=r[4],s=r[5];return t.x=n.x*a+o,t.y=n.y*i+s,t.width=n.width*a,t.height=n.height*i,t.width<0&&(t.x+=t.width,t.width=-t.width),void(t.height<0&&(t.y+=t.height,t.height=-t.height))}cz.x=pz.x=n.x,cz.y=fz.y=n.y,hz.x=fz.x=n.x+n.width,hz.y=pz.y=n.y+n.height,cz.transform(r),fz.transform(r),hz.transform(r),pz.transform(r),t.x=uz(cz.x,hz.x,pz.x,fz.x),t.y=uz(cz.y,hz.y,pz.y,fz.y);var u=lz(cz.x,hz.x,pz.x,fz.x),l=lz(cz.y,hz.y,pz.y,fz.y);t.width=u-t.x,t.height=l-t.y}else t!==n&&e.copy(t,n)},e}(),gz=mz,yz={};function bz(e,t){var n=yz[t=t||_L];n||(n=yz[t]=new KP(500));var r=n.get(e);return null==r&&(r=IL.measureText(e,t).width,n.put(e,r)),r}function xz(e,t,n,r){var a=bz(e,t),i=Sz(t),o=wz(0,a,n),s=_z(0,i,r);return new gz(o,s,a,i)}function kz(e,t,n,r){var a=((e||"")+"").split("\n");if(1===a.length)return xz(a[0],t,n,r);for(var i=new gz(0,0,0,0),o=0;o<a.length;o++){var s=xz(a[o],t,n,r);0===o?i.copy(s):i.union(s)}return i}function wz(e,t,n){return"right"===n?e-=t:"center"===n&&(e-=t/2),e}function _z(e,t,n){return"middle"===n?e-=t/2:"bottom"===n&&(e-=t),e}function Sz(e){return bz("\u56fd",e)}function Iz(e,t){return"string"===typeof e?e.lastIndexOf("%")>=0?parseFloat(e)/100*t:parseFloat(e):e}function Cz(e,t,n){var r=t.position||"inside",a=null!=t.distance?t.distance:5,i=n.height,o=n.width,s=i/2,u=n.x,l=n.y,c="left",h="top";if(r instanceof Array)u+=Iz(r[0],n.width),l+=Iz(r[1],n.height),c=null,h=null;else switch(r){case"left":u-=a,l+=s,c="right",h="middle";break;case"right":u+=a+o,l+=s,h="middle";break;case"top":u+=o/2,l-=a,c="center",h="bottom";break;case"bottom":u+=o/2,l+=i+a,c="center";break;case"inside":u+=o/2,l+=s,c="center",h="middle";break;case"insideLeft":u+=a,l+=s,h="middle";break;case"insideRight":u+=o-a,l+=s,c="right",h="middle";break;case"insideTop":u+=o/2,l+=a,c="center";break;case"insideBottom":u+=o/2,l+=i-a,c="center",h="bottom";break;case"insideTopLeft":u+=a,l+=a;break;case"insideTopRight":u+=o-a,l+=a,c="right";break;case"insideBottomLeft":u+=a,l+=i-a,h="bottom";break;case"insideBottomRight":u+=o-a,l+=i-a,c="right",h="bottom"}return(e=e||{}).x=u,e.y=l,e.align=c,e.verticalAlign=h,e}var Tz=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function Nz(e,t,n,r,a){if(!t)return"";var i=(e+"").split("\n");a=Ez(t,n,r,a);for(var o=0,s=i.length;o<s;o++)i[o]=Mz(i[o],a);return i.join("\n")}function Ez(e,t,n,r){var a=UL({},r=r||{});a.font=t,n=pP(n,"..."),a.maxIterations=pP(r.maxIterations,2);var i=a.minChar=pP(r.minChar,0);a.cnCharWidth=bz("\u56fd",t);var o=a.ascCharWidth=bz("a",t);a.placeholder=pP(r.placeholder,"");for(var s=e=Math.max(0,e-1),u=0;u<i&&s>=o;u++)s-=o;var l=bz(n,t);return l>s&&(n="",l=0),s=e-l,a.ellipsis=n,a.ellipsisWidth=l,a.contentWidth=s,a.containerWidth=e,a}function Mz(e,t){var n=t.containerWidth,r=t.font,a=t.contentWidth;if(!n)return"";var i=bz(e,r);if(i<=n)return e;for(var o=0;;o++){if(i<=a||o>=t.maxIterations){e+=t.ellipsis;break}var s=0===o?Az(e,a,t.ascCharWidth,t.cnCharWidth):i>0?Math.floor(e.length*a/i):0;i=bz(e=e.substr(0,s),r)}return""===e&&(e=t.placeholder),e}function Az(e,t,n,r){for(var a=0,i=0,o=e.length;i<o&&a<t;i++){var s=e.charCodeAt(i);a+=0<=s&&s<=127?n:r}return i}var Dz=function(){},Rz=function(e){this.tokens=[],e&&(this.tokens=e)},Oz=function(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[]};function Fz(e,t,n,r,a){var i,o,s=""===t,u=a&&n.rich[a]||{},l=e.lines,c=u.font||n.font,h=!1;if(r){var p=u.padding,f=p?p[1]+p[3]:0;if(null!=u.width&&"auto"!==u.width){var d=Iz(u.width,r.width)+f;l.length>0&&d+r.accumWidth>r.width&&(i=t.split("\n"),h=!0),r.accumWidth=d}else{var v=zz(t,c,r.width,r.breakAll,r.accumWidth);r.accumWidth=v.accumWidth+f,o=v.linesWidths,i=v.lines}}else i=t.split("\n");for(var m=0;m<i.length;m++){var g=i[m],y=new Dz;if(y.styleName=a,y.text=g,y.isLineHolder=!g&&!s,"number"===typeof u.width?y.width=u.width:y.width=o?o[m]:bz(g,c),m||h)l.push(new Rz([y]));else{var b=(l[l.length-1]||(l[0]=new Rz)).tokens,x=b.length;1===x&&b[0].isLineHolder?b[0]=y:(g||!x||s)&&b.push(y)}}}var Lz=YL(",&?/;] ".split(""),(function(e,t){return e[t]=!0,e}),{});function Pz(e){return!function(e){var t=e.charCodeAt(0);return t>=33&&t<=383}(e)||!!Lz[e]}function zz(e,t,n,r,a){for(var i=[],o=[],s="",u="",l=0,c=0,h=0;h<e.length;h++){var p=e.charAt(h);if("\n"!==p){var f=bz(p,t),d=!r&&!Pz(p);(i.length?c+f>n:a+c+f>n)?c?(s||u)&&(d?(s||(s=u,u="",c=l=0),i.push(s),o.push(c-l),u+=p,s="",c=l+=f):(u&&(s+=u,u="",l=0),i.push(s),o.push(c),s=p,c=f)):d?(i.push(u),o.push(l),u=p,l=f):(i.push(p),o.push(f)):(c+=f,d?(u+=p,l+=f):(u&&(s+=u,u="",l=0),s+=p))}else u&&(s+=u,c+=l),i.push(s),o.push(c),s="",u="",l=0,c=0}return i.length||s||(s=e,u="",l=0),u&&(s+=u),s&&(i.push(s),o.push(c)),1===i.length&&(c+=a),{accumWidth:c,lines:i,linesWidths:o}}function Bz(e,t){return null==e&&(e=0),null==t&&(t=0),[e,t]}function Vz(e){return[e[0],e[1]]}function Wz(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function Uz(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function Hz(e){return Math.sqrt(Gz(e))}function Gz(e){return e[0]*e[0]+e[1]*e[1]}function jz(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}function qz(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}var Xz=qz;var Kz=function(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])};function Yz(e,t,n,r){return e[0]=t[0]+r*(n[0]-t[0]),e[1]=t[1]+r*(n[1]-t[1]),e}function Zz(e,t,n){var r=t[0],a=t[1];return e[0]=n[0]*r+n[2]*a+n[4],e[1]=n[1]*r+n[3]*a+n[5],e}function Qz(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e}function $z(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}var Jz=ez,eB=5e-5;function tB(e){return e>eB||e<-5e-5}var nB=[],rB=[],aB=[1,0,0,1,0,0],iB=Math.abs,oB=function(){function e(){}return e.prototype.getLocalTransform=function(t){return e.getLocalTransform(this,t)},e.prototype.setPosition=function(e){this.x=e[0],this.y=e[1]},e.prototype.setScale=function(e){this.scaleX=e[0],this.scaleY=e[1]},e.prototype.setSkew=function(e){this.skewX=e[0],this.skewY=e[1]},e.prototype.setOrigin=function(e){this.originX=e[0],this.originY=e[1]},e.prototype.needLocalTransform=function(){return tB(this.rotation)||tB(this.x)||tB(this.y)||tB(this.scaleX-1)||tB(this.scaleY-1)||tB(this.skewX)||tB(this.skewY)},e.prototype.updateTransform=function(){var e=this.parent&&this.parent.transform,t=this.needLocalTransform(),n=this.transform;t||e?(n=n||[1,0,0,1,0,0],t?this.getLocalTransform(n):Jz(n),e&&(t?nz(n,e,n):tz(n,e)),this.transform=n,this._resolveGlobalScaleRatio(n)):n&&Jz(n)},e.prototype._resolveGlobalScaleRatio=function(e){var t=this.globalScaleRatio;if(null!=t&&1!==t){this.getGlobalScale(nB);var n=nB[0]<0?-1:1,r=nB[1]<0?-1:1,a=((nB[0]-n)*t+n)/nB[0]||0,i=((nB[1]-r)*t+r)/nB[1]||0;e[0]*=a,e[1]*=a,e[2]*=i,e[3]*=i}this.invTransform=this.invTransform||[1,0,0,1,0,0],iz(this.invTransform,e)},e.prototype.getComputedTransform=function(){for(var e=this,t=[];e;)t.push(e),e=e.parent;for(;e=t.pop();)e.updateTransform();return this.transform},e.prototype.setLocalTransform=function(e){if(e){var t=e[0]*e[0]+e[1]*e[1],n=e[2]*e[2]+e[3]*e[3],r=Math.atan2(e[1],e[0]),a=Math.PI/2+r-Math.atan2(e[3],e[2]);n=Math.sqrt(n)*Math.cos(a),t=Math.sqrt(t),this.skewX=a,this.skewY=0,this.rotation=-r,this.x=+e[4],this.y=+e[5],this.scaleX=t,this.scaleY=n,this.originX=0,this.originY=0}},e.prototype.decomposeTransform=function(){if(this.transform){var e=this.parent,t=this.transform;e&&e.transform&&(nz(rB,e.invTransform,t),t=rB);var n=this.originX,r=this.originY;(n||r)&&(aB[4]=n,aB[5]=r,nz(rB,t,aB),rB[4]-=n,rB[5]-=r,t=rB),this.setLocalTransform(t)}},e.prototype.getGlobalScale=function(e){var t=this.transform;return e=e||[],t?(e[0]=Math.sqrt(t[0]*t[0]+t[1]*t[1]),e[1]=Math.sqrt(t[2]*t[2]+t[3]*t[3]),t[0]<0&&(e[0]=-e[0]),t[3]<0&&(e[1]=-e[1]),e):(e[0]=1,e[1]=1,e)},e.prototype.transformCoordToLocal=function(e,t){var n=[e,t],r=this.invTransform;return r&&Zz(n,n,r),n},e.prototype.transformCoordToGlobal=function(e,t){var n=[e,t],r=this.transform;return r&&Zz(n,n,r),n},e.prototype.getLineScale=function(){var e=this.transform;return e&&iB(e[0]-1)>1e-10&&iB(e[3]-1)>1e-10?Math.sqrt(iB(e[0]*e[3]-e[2]*e[1])):1},e.prototype.copyTransform=function(e){!function(e,t){for(var n=0;n<sB.length;n++){var r=sB[n];e[r]=t[r]}}(this,e)},e.getLocalTransform=function(e,t){t=t||[];var n=e.originX||0,r=e.originY||0,a=e.scaleX,i=e.scaleY,o=e.anchorX,s=e.anchorY,u=e.rotation||0,l=e.x,c=e.y,h=e.skewX?Math.tan(e.skewX):0,p=e.skewY?Math.tan(-e.skewY):0;if(n||r||o||s){var f=n+o,d=r+s;t[4]=-f*a-h*d*i,t[5]=-d*i-p*f*a}else t[4]=t[5]=0;return t[0]=a,t[3]=i,t[1]=p*a,t[2]=h*i,u&&az(t,t,u),t[4]+=n+l,t[5]+=r+c,t},e.initDefaultProps=function(){var t=e.prototype;t.scaleX=t.scaleY=t.globalScaleRatio=1,t.x=t.y=t.originX=t.originY=t.skewX=t.skewY=t.rotation=t.anchorX=t.anchorY=0}(),e}(),sB=["x","y","originX","originY","anchorX","anchorY","rotation","scaleX","scaleY","skewX","skewY"];var uB=oB,lB={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},quarticIn:function(e){return e*e*e*e},quarticOut:function(e){return 1- --e*e*e*e},quarticInOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},quinticIn:function(e){return e*e*e*e*e},quinticOut:function(e){return--e*e*e*e*e+1},quinticInOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},sinusoidalIn:function(e){return 1-Math.cos(e*Math.PI/2)},sinusoidalOut:function(e){return Math.sin(e*Math.PI/2)},sinusoidalInOut:function(e){return.5*(1-Math.cos(Math.PI*e))},exponentialIn:function(e){return 0===e?0:Math.pow(1024,e-1)},exponentialOut:function(e){return 1===e?1:1-Math.pow(2,-10*e)},exponentialInOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))},circularIn:function(e){return 1-Math.sqrt(1-e*e)},circularOut:function(e){return Math.sqrt(1- --e*e)},circularInOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},elasticIn:function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),-n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4))},elasticOut:function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/.4)+1)},elasticInOut:function(e){var t,n=.1,r=.4;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=r*Math.asin(1/n)/(2*Math.PI),(e*=2)<1?n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/r)*-.5:n*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/r)*.5+1)},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},backInOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)},bounceIn:function(e){return 1-lB.bounceOut(1-e)},bounceOut:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},bounceInOut:function(e){return e<.5?.5*lB.bounceIn(2*e):.5*lB.bounceOut(2*e-1)+.5}},cB=lB,hB=Math.pow,pB=Math.sqrt,fB=1e-8,dB=1e-4,vB=pB(3),mB=1/3,gB=Bz(),yB=Bz(),bB=Bz();function xB(e){return e>-1e-8&&e<fB}function kB(e){return e>fB||e<-1e-8}function wB(e,t,n,r,a){var i=1-a;return i*i*(i*e+3*a*t)+a*a*(a*r+3*i*n)}function _B(e,t,n,r,a){var i=1-a;return 3*(((t-e)*i+2*(n-t)*a)*i+(r-n)*a*a)}function SB(e,t,n,r,a,i){var o=r+3*(t-n)-e,s=3*(n-2*t+e),u=3*(t-e),l=e-a,c=s*s-3*o*u,h=s*u-9*o*l,p=u*u-3*s*l,f=0;if(xB(c)&&xB(h)){if(xB(s))i[0]=0;else(S=-u/s)>=0&&S<=1&&(i[f++]=S)}else{var d=h*h-4*c*p;if(xB(d)){var v=h/c,m=-v/2;(S=-s/o+v)>=0&&S<=1&&(i[f++]=S),m>=0&&m<=1&&(i[f++]=m)}else if(d>0){var g=pB(d),y=c*s+1.5*o*(-h+g),b=c*s+1.5*o*(-h-g);(S=(-s-((y=y<0?-hB(-y,mB):hB(y,mB))+(b=b<0?-hB(-b,mB):hB(b,mB))))/(3*o))>=0&&S<=1&&(i[f++]=S)}else{var x=(2*c*s-3*o*h)/(2*pB(c*c*c)),k=Math.acos(x)/3,w=pB(c),_=Math.cos(k),S=(-s-2*w*_)/(3*o),I=(m=(-s+w*(_+vB*Math.sin(k)))/(3*o),(-s+w*(_-vB*Math.sin(k)))/(3*o));S>=0&&S<=1&&(i[f++]=S),m>=0&&m<=1&&(i[f++]=m),I>=0&&I<=1&&(i[f++]=I)}}return f}function IB(e,t,n,r,a){var i=6*n-12*t+6*e,o=9*t+3*r-3*e-9*n,s=3*t-3*e,u=0;if(xB(o)){if(kB(i))(c=-s/i)>=0&&c<=1&&(a[u++]=c)}else{var l=i*i-4*o*s;if(xB(l))a[0]=-i/(2*o);else if(l>0){var c,h=pB(l),p=(-i-h)/(2*o);(c=(-i+h)/(2*o))>=0&&c<=1&&(a[u++]=c),p>=0&&p<=1&&(a[u++]=p)}}return u}function CB(e,t,n,r,a,i){var o=(t-e)*a+e,s=(n-t)*a+t,u=(r-n)*a+n,l=(s-o)*a+o,c=(u-s)*a+s,h=(c-l)*a+l;i[0]=e,i[1]=o,i[2]=l,i[3]=h,i[4]=h,i[5]=c,i[6]=u,i[7]=r}function TB(e,t,n,r,a,i,o,s,u){for(var l=e,c=t,h=0,p=1/u,f=1;f<=u;f++){var d=f*p,v=wB(e,n,a,o,d),m=wB(t,r,i,s,d),g=v-l,y=m-c;h+=Math.sqrt(g*g+y*y),l=v,c=m}return h}function NB(e,t,n,r){var a=1-r;return a*(a*e+2*r*t)+r*r*n}function EB(e,t,n,r){return 2*((1-r)*(t-e)+r*(n-t))}function MB(e,t,n){var r=e+n-2*t;return 0===r?.5:(e-t)/r}function AB(e,t,n,r,a){var i=(t-e)*r+e,o=(n-t)*r+t,s=(o-i)*r+i;a[0]=e,a[1]=i,a[2]=s,a[3]=s,a[4]=o,a[5]=n}function DB(e,t,n,r,a,i,o){for(var s=e,u=t,l=0,c=1/o,h=1;h<=o;h++){var p=h*c,f=NB(e,n,a,p),d=NB(t,r,i,p),v=f-s,m=d-u;l+=Math.sqrt(v*v+m*m),s=f,u=d}return l}var RB=/cubic-bezier\(([0-9,\.e ]+)\)/;function OB(e){var t=e&&RB.exec(e);if(t){var n=t[1].split(","),r=+gP(n[0]),a=+gP(n[1]),i=+gP(n[2]),o=+gP(n[3]);if(isNaN(r+a+i+o))return;var s=[];return function(e){return e<=0?0:e>=1?1:SB(0,r,i,1,e,s)&&wB(0,a,o,1,s[0])}}}var FB=function(){function e(e){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=e.life||1e3,this._delay=e.delay||0,this.loop=e.loop||!1,this.onframe=e.onframe||CP,this.ondestroy=e.ondestroy||CP,this.onrestart=e.onrestart||CP,e.easing&&this.setEasing(e.easing)}return e.prototype.step=function(e,t){if(this._inited||(this._startTime=e+this._delay,this._inited=!0),!this._paused){var n=this._life,r=e-this._startTime-this._pausedTime,a=r/n;a<0&&(a=0),a=Math.min(a,1);var i=this.easingFunc,o=i?i(a):a;if(this.onframe(o),1===a){if(!this.loop)return!0;var s=r%n;this._startTime=e-s,this._pausedTime=0,this.onrestart()}return!1}this._pausedTime+=t},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1},e.prototype.setEasing=function(e){this.easing=e,this.easingFunc=tP(e)?e:cB[e]||OB(e)},e}(),LB={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function PB(e){return(e=Math.round(e))<0?0:e>255?255:e}function zB(e){return e<0?0:e>1?1:e}function BB(e){var t=e;return t.length&&"%"===t.charAt(t.length-1)?PB(parseFloat(t)/100*255):PB(parseInt(t,10))}function VB(e){var t=e;return t.length&&"%"===t.charAt(t.length-1)?zB(parseFloat(t)/100):zB(parseFloat(t))}function WB(e,t,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?e+(t-e)*n*6:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}function UB(e,t,n){return e+(t-e)*n}function HB(e,t,n,r,a){return e[0]=t,e[1]=n,e[2]=r,e[3]=a,e}function GB(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}var jB=new KP(20),qB=null;function XB(e,t){qB&&GB(qB,t),qB=jB.put(e,qB||t.slice())}function KB(e,t){if(e){t=t||[];var n=jB.get(e);if(n)return GB(t,n);var r=(e+="").replace(/ /g,"").toLowerCase();if(r in LB)return GB(t,LB[r]),XB(e,t),t;var a,i=r.length;if("#"===r.charAt(0))return 4===i||5===i?(a=parseInt(r.slice(1,4),16))>=0&&a<=4095?(HB(t,(3840&a)>>4|(3840&a)>>8,240&a|(240&a)>>4,15&a|(15&a)<<4,5===i?parseInt(r.slice(4),16)/15:1),XB(e,t),t):void HB(t,0,0,0,1):7===i||9===i?(a=parseInt(r.slice(1,7),16))>=0&&a<=16777215?(HB(t,(16711680&a)>>16,(65280&a)>>8,255&a,9===i?parseInt(r.slice(7),16)/255:1),XB(e,t),t):void HB(t,0,0,0,1):void 0;var o=r.indexOf("("),s=r.indexOf(")");if(-1!==o&&s+1===i){var u=r.substr(0,o),l=r.substr(o+1,s-(o+1)).split(","),c=1;switch(u){case"rgba":if(4!==l.length)return 3===l.length?HB(t,+l[0],+l[1],+l[2],1):HB(t,0,0,0,1);c=VB(l.pop());case"rgb":return 3!==l.length?void HB(t,0,0,0,1):(HB(t,BB(l[0]),BB(l[1]),BB(l[2]),c),XB(e,t),t);case"hsla":return 4!==l.length?void HB(t,0,0,0,1):(l[3]=VB(l[3]),YB(l,t),XB(e,t),t);case"hsl":return 3!==l.length?void HB(t,0,0,0,1):(YB(l,t),XB(e,t),t);default:return}}HB(t,0,0,0,1)}}function YB(e,t){var n=(parseFloat(e[0])%360+360)%360/360,r=VB(e[1]),a=VB(e[2]),i=a<=.5?a*(r+1):a+r-a*r,o=2*a-i;return HB(t=t||[],PB(255*WB(o,i,n+1/3)),PB(255*WB(o,i,n)),PB(255*WB(o,i,n-1/3)),1),4===e.length&&(t[3]=e[3]),t}function ZB(e,t){var n=KB(e);if(n){for(var r=0;r<3;r++)n[r]=t<0?n[r]*(1-t)|0:(255-n[r])*t+n[r]|0,n[r]>255?n[r]=255:n[r]<0&&(n[r]=0);return eV(n,4===n.length?"rgba":"rgb")}}function QB(e,t,n){if(t&&t.length&&e>=0&&e<=1){n=n||[];var r=e*(t.length-1),a=Math.floor(r),i=Math.ceil(r),o=t[a],s=t[i],u=r-a;return n[0]=PB(UB(o[0],s[0],u)),n[1]=PB(UB(o[1],s[1],u)),n[2]=PB(UB(o[2],s[2],u)),n[3]=zB(UB(o[3],s[3],u)),n}}function $B(e,t,n){if(t&&t.length&&e>=0&&e<=1){var r=e*(t.length-1),a=Math.floor(r),i=Math.ceil(r),o=KB(t[a]),s=KB(t[i]),u=r-a,l=eV([PB(UB(o[0],s[0],u)),PB(UB(o[1],s[1],u)),PB(UB(o[2],s[2],u)),zB(UB(o[3],s[3],u))],"rgba");return n?{color:l,leftIndex:a,rightIndex:i,value:r}:l}}function JB(e,t,n,r){var a,i=KB(e);if(e)return i=function(e){if(e){var t,n,r=e[0]/255,a=e[1]/255,i=e[2]/255,o=Math.min(r,a,i),s=Math.max(r,a,i),u=s-o,l=(s+o)/2;if(0===u)t=0,n=0;else{n=l<.5?u/(s+o):u/(2-s-o);var c=((s-r)/6+u/2)/u,h=((s-a)/6+u/2)/u,p=((s-i)/6+u/2)/u;r===s?t=p-h:a===s?t=1/3+c-p:i===s&&(t=2/3+h-c),t<0&&(t+=1),t>1&&(t-=1)}var f=[360*t,n,l];return null!=e[3]&&f.push(e[3]),f}}(i),null!=t&&(i[0]=(a=t,(a=Math.round(a))<0?0:a>360?360:a)),null!=n&&(i[1]=VB(n)),null!=r&&(i[2]=VB(r)),eV(YB(i),"rgba")}function eV(e,t){if(e&&e.length){var n=e[0]+","+e[1]+","+e[2];return"rgba"!==t&&"hsva"!==t&&"hsla"!==t||(n+=","+e[3]),t+"("+n+")"}}function tV(e,t){var n=KB(e);return n?(.299*n[0]+.587*n[1]+.114*n[2])*n[3]/255+(1-n[3])*t:0}Math.round;MP.hasGlobalWindow&&tP(window.btoa);var nV=Array.prototype.slice;function rV(e,t,n){return(t-e)*n+e}function aV(e,t,n,r){for(var a=t.length,i=0;i<a;i++)e[i]=rV(t[i],n[i],r);return e}function iV(e,t,n,r){for(var a=t.length,i=0;i<a;i++)e[i]=t[i]+n[i]*r;return e}function oV(e,t,n,r){for(var a=t.length,i=a&&t[0].length,o=0;o<a;o++){e[o]||(e[o]=[]);for(var s=0;s<i;s++)e[o][s]=t[o][s]+n[o][s]*r}return e}function sV(e,t){for(var n=e.length,r=t.length,a=n>r?t:e,i=Math.min(n,r),o=a[i-1]||{color:[0,0,0,0],offset:0},s=i;s<Math.max(n,r);s++)a.push({offset:o.offset,color:o.color.slice()})}function uV(e,t,n){var r=e,a=t;if(r.push&&a.push){var i=r.length,o=a.length;if(i!==o)if(i>o)r.length=o;else for(var s=i;s<o;s++)r.push(1===n?a[s]:nV.call(a[s]));var u=r[0]&&r[0].length;for(s=0;s<r.length;s++)if(1===n)isNaN(r[s])&&(r[s]=a[s]);else for(var l=0;l<u;l++)isNaN(r[s][l])&&(r[s][l]=a[s][l])}}function lV(e){if(qL(e)){var t=e.length;if(qL(e[0])){for(var n=[],r=0;r<t;r++)n.push(nV.call(e[r]));return n}return nV.call(e)}return e}function cV(e){return e[0]=Math.floor(e[0])||0,e[1]=Math.floor(e[1])||0,e[2]=Math.floor(e[2])||0,e[3]=null==e[3]?1:e[3],"rgba("+e.join(",")+")"}function hV(e){return 4===e||5===e}function pV(e){return 1===e||2===e}var fV=[0,0,0,0],dV=function(){function e(e){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=e}return e.prototype.isFinished=function(){return this._finished},e.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},e.prototype.needsAnimate=function(){return this.keyframes.length>=1},e.prototype.getAdditiveTrack=function(){return this._additiveTrack},e.prototype.addKeyframe=function(e,t,n){this._needsSort=!0;var r=this.keyframes,a=r.length,i=!1,o=6,s=t;if(qL(t)){var u=function(e){return qL(e&&e[0])?2:1}(t);o=u,(1===u&&!aP(t[0])||2===u&&!aP(t[0][0]))&&(i=!0)}else if(aP(t)&&!cP(t))o=0;else if(nP(t))if(isNaN(+t)){var l=KB(t);l&&(s=l,o=3)}else o=0;else if(lP(t)){var c=UL({},s);c.colorStops=KL(t.colorStops,(function(e){return{offset:e.offset,color:KB(e.color)}})),"linear"===t.type?o=4:function(e){return"radial"===e.type}(t)&&(o=5),s=c}0===a?this.valType=o:o===this.valType&&6!==o||(i=!0),this.discrete=this.discrete||i;var h={time:e,value:s,rawValue:t,percent:0};return n&&(h.easing=n,h.easingFunc=tP(n)?n:cB[n]||OB(n)),r.push(h),h},e.prototype.prepare=function(e,t){var n=this.keyframes;this._needsSort&&n.sort((function(e,t){return e.time-t.time}));for(var r=this.valType,a=n.length,i=n[a-1],o=this.discrete,s=pV(r),u=hV(r),l=0;l<a;l++){var c=n[l],h=c.value,p=i.value;c.percent=c.time/e,o||(s&&l!==a-1?uV(h,p,r):u&&sV(h.colorStops,p.colorStops))}if(!o&&5!==r&&t&&this.needsAnimate()&&t.needsAnimate()&&r===t.valType&&!t._finished){this._additiveTrack=t;var f=n[0].value;for(l=0;l<a;l++)0===r?n[l].additiveValue=n[l].value-f:3===r?n[l].additiveValue=iV([],n[l].value,f,-1):pV(r)&&(n[l].additiveValue=1===r?iV([],n[l].value,f,-1):oV([],n[l].value,f,-1))}},e.prototype.step=function(e,t){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var n,r,a,i=null!=this._additiveTrack,o=i?"additiveValue":"value",s=this.valType,u=this.keyframes,l=u.length,c=this.propName,h=3===s,p=this._lastFr,f=Math.min;if(1===l)r=a=u[0];else{if(t<0)n=0;else if(t<this._lastFrP){for(n=f(p+1,l-1);n>=0&&!(u[n].percent<=t);n--);n=f(n,l-2)}else{for(n=p;n<l&&!(u[n].percent>t);n++);n=f(n-1,l-2)}a=u[n+1],r=u[n]}if(r&&a){this._lastFr=n,this._lastFrP=t;var d=a.percent-r.percent,v=0===d?1:f((t-r.percent)/d,1);a.easingFunc&&(v=a.easingFunc(v));var m=i?this._additiveValue:h?fV:e[c];if(!pV(s)&&!h||m||(m=this._additiveValue=[]),this.discrete)e[c]=v<1?r.rawValue:a.rawValue;else if(pV(s))1===s?aV(m,r[o],a[o],v):function(e,t,n,r){for(var a=t.length,i=a&&t[0].length,o=0;o<a;o++){e[o]||(e[o]=[]);for(var s=0;s<i;s++)e[o][s]=rV(t[o][s],n[o][s],r)}}(m,r[o],a[o],v);else if(hV(s)){var g=r[o],y=a[o],b=4===s;e[c]={type:b?"linear":"radial",x:rV(g.x,y.x,v),y:rV(g.y,y.y,v),colorStops:KL(g.colorStops,(function(e,t){var n=y.colorStops[t];return{offset:rV(e.offset,n.offset,v),color:cV(aV([],e.color,n.color,v))}})),global:y.global},b?(e[c].x2=rV(g.x2,y.x2,v),e[c].y2=rV(g.y2,y.y2,v)):e[c].r=rV(g.r,y.r,v)}else if(h)aV(m,r[o],a[o],v),i||(e[c]=cV(m));else{var x=rV(r[o],a[o],v);i?this._additiveValue=x:e[c]=x}i&&this._addToTarget(e)}}},e.prototype._addToTarget=function(e){var t=this.valType,n=this.propName,r=this._additiveValue;0===t?e[n]=e[n]+r:3===t?(KB(e[n],fV),iV(fV,fV,r,1),e[n]=cV(fV)):1===t?iV(e[n],e[n],r,1):2===t&&oV(e[n],e[n],r,1)},e}(),vV=function(){function e(e,t,n,r){this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=e,this._loop=t,t&&r?BL("Can' use additive animation on looped animation."):(this._additiveAnimators=r,this._allowDiscrete=n)}return e.prototype.getMaxTime=function(){return this._maxTime},e.prototype.getDelay=function(){return this._delay},e.prototype.getLoop=function(){return this._loop},e.prototype.getTarget=function(){return this._target},e.prototype.changeTarget=function(e){this._target=e},e.prototype.when=function(e,t,n){return this.whenWithKeys(e,t,QL(t),n)},e.prototype.whenWithKeys=function(e,t,n,r){for(var a=this._tracks,i=0;i<n.length;i++){var o=n[i],s=a[o];if(!s){s=a[o]=new dV(o);var u=void 0,l=this._getAdditiveTrack(o);if(l){var c=l.keyframes,h=c[c.length-1];u=h&&h.value,3===l.valType&&u&&(u=cV(u))}else u=this._target[o];if(null==u)continue;e>0&&s.addKeyframe(0,lV(u),r),this._trackKeys.push(o)}s.addKeyframe(e,lV(t[o]),r)}return this._maxTime=Math.max(this._maxTime,e),this},e.prototype.pause=function(){this._clip.pause(),this._paused=!0},e.prototype.resume=function(){this._clip.resume(),this._paused=!1},e.prototype.isPaused=function(){return!!this._paused},e.prototype.duration=function(e){return this._maxTime=e,this._force=!0,this},e.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var e=this._doneCbs;if(e)for(var t=e.length,n=0;n<t;n++)e[n].call(this)},e.prototype._abortedCallback=function(){this._setTracksFinished();var e=this.animation,t=this._abortedCbs;if(e&&e.removeClip(this._clip),this._clip=null,t)for(var n=0;n<t.length;n++)t[n].call(this)},e.prototype._setTracksFinished=function(){for(var e=this._tracks,t=this._trackKeys,n=0;n<t.length;n++)e[t[n]].setFinished()},e.prototype._getAdditiveTrack=function(e){var t,n=this._additiveAnimators;if(n)for(var r=0;r<n.length;r++){var a=n[r].getTrack(e);a&&(t=a)}return t},e.prototype.start=function(e){if(!(this._started>0)){this._started=1;for(var t=this,n=[],r=this._maxTime||0,a=0;a<this._trackKeys.length;a++){var i=this._trackKeys[a],o=this._tracks[i],s=this._getAdditiveTrack(i),u=o.keyframes,l=u.length;if(o.prepare(r,s),o.needsAnimate())if(!this._allowDiscrete&&o.discrete){var c=u[l-1];c&&(t._target[o.propName]=c.rawValue),o.setFinished()}else n.push(o)}if(n.length||this._force){var h=new FB({life:r,loop:this._loop,delay:this._delay||0,onframe:function(e){t._started=2;var r=t._additiveAnimators;if(r){for(var a=!1,i=0;i<r.length;i++)if(r[i]._clip){a=!0;break}a||(t._additiveAnimators=null)}for(i=0;i<n.length;i++)n[i].step(t._target,e);var o=t._onframeCbs;if(o)for(i=0;i<o.length;i++)o[i](t._target,e)},ondestroy:function(){t._doneCallback()}});this._clip=h,this.animation&&this.animation.addClip(h),e&&h.setEasing(e)}else this._doneCallback();return this}},e.prototype.stop=function(e){if(this._clip){var t=this._clip;e&&t.onframe(1),this._abortedCallback()}},e.prototype.delay=function(e){return this._delay=e,this},e.prototype.during=function(e){return e&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(e)),this},e.prototype.done=function(e){return e&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(e)),this},e.prototype.aborted=function(e){return e&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(e)),this},e.prototype.getClip=function(){return this._clip},e.prototype.getTrack=function(e){return this._tracks[e]},e.prototype.getTracks=function(){var e=this;return KL(this._trackKeys,(function(t){return e._tracks[t]}))},e.prototype.stopTracks=function(e,t){if(!e.length||!this._clip)return!0;for(var n=this._tracks,r=this._trackKeys,a=0;a<e.length;a++){var i=n[e[a]];i&&!i.isFinished()&&(t?i.step(this._target,1):1===this._started&&i.step(this._target,0),i.setFinished())}var o=!0;for(a=0;a<r.length;a++)if(!n[r[a]].isFinished()){o=!1;break}return o&&this._abortedCallback(),o},e.prototype.saveTo=function(e,t,n){if(e){t=t||this._trackKeys;for(var r=0;r<t.length;r++){var a=t[r],i=this._tracks[a];if(i&&!i.isFinished()){var o=i.keyframes,s=o[n?0:o.length-1];s&&(e[a]=lV(s.rawValue))}}}},e.prototype.__changeFinalValue=function(e,t){t=t||QL(e);for(var n=0;n<t.length;n++){var r=t[n],a=this._tracks[r];if(a){var i=a.keyframes;if(i.length>1){var o=i.pop();a.addKeyframe(o.time,e[r]),a.prepare(this._maxTime,a.getAdditiveTrack())}}}},e}(),mV=vV,gV=function(){function e(e){e&&(this._$eventProcessor=e)}return e.prototype.on=function(e,t,n,r){this._$handlers||(this._$handlers={});var a=this._$handlers;if("function"===typeof t&&(r=n,n=t,t=null),!n||!e)return this;var i=this._$eventProcessor;null!=t&&i&&i.normalizeQuery&&(t=i.normalizeQuery(t)),a[e]||(a[e]=[]);for(var o=0;o<a[e].length;o++)if(a[e][o].h===n)return this;var s={h:n,query:t,ctx:r||this,callAtLast:n.zrEventfulCallAtLast},u=a[e].length-1,l=a[e][u];return l&&l.callAtLast?a[e].splice(u,0,s):a[e].push(s),this},e.prototype.isSilent=function(e){var t=this._$handlers;return!t||!t[e]||!t[e].length},e.prototype.off=function(e,t){var n=this._$handlers;if(!n)return this;if(!e)return this._$handlers={},this;if(t){if(n[e]){for(var r=[],a=0,i=n[e].length;a<i;a++)n[e][a].h!==t&&r.push(n[e][a]);n[e]=r}n[e]&&0===n[e].length&&delete n[e]}else delete n[e];return this},e.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!this._$handlers)return this;var r=this._$handlers[e],a=this._$eventProcessor;if(r)for(var i=t.length,o=r.length,s=0;s<o;s++){var u=r[s];if(!a||!a.filter||null==u.query||a.filter(e,u.query))switch(i){case 0:u.h.call(u.ctx);break;case 1:u.h.call(u.ctx,t[0]);break;case 2:u.h.call(u.ctx,t[0],t[1]);break;default:u.h.apply(u.ctx,t)}}return a&&a.afterTrigger&&a.afterTrigger(e),this},e.prototype.triggerWithContext=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!this._$handlers)return this;var r=this._$handlers[e],a=this._$eventProcessor;if(r)for(var i=t.length,o=t[i-1],s=r.length,u=0;u<s;u++){var l=r[u];if(!a||!a.filter||null==l.query||a.filter(e,l.query))switch(i){case 0:l.h.call(o);break;case 1:l.h.call(o,t[0]);break;case 2:l.h.call(o,t[0],t[1]);break;default:l.h.apply(o,t.slice(1,i-1))}}return a&&a.afterTrigger&&a.afterTrigger(e),this},e}(),yV=gV,bV=1;MP.hasGlobalWindow&&(bV=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var xV=bV,kV="#333",wV="#ccc",_V="__zr_normal__",SV=sB.concat(["ignore"]),IV=YL(sB,(function(e,t){return e[t]=!0,e}),{ignore:!1}),CV={},TV=new gz(0,0,0,0),NV=function(){function e(e){this.id=zL(),this.animators=[],this.currentStates=[],this.states={},this._init(e)}return e.prototype._init=function(e){this.attr(e)},e.prototype.drift=function(e,t,n){switch(this.draggable){case"horizontal":t=0;break;case"vertical":e=0}var r=this.transform;r||(r=this.transform=[1,0,0,1,0,0]),r[4]+=e,r[5]+=t,this.decomposeTransform(),this.markRedraw()},e.prototype.beforeUpdate=function(){},e.prototype.afterUpdate=function(){},e.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},e.prototype.updateInnerText=function(e){var t=this._textContent;if(t&&(!t.ignore||e)){this.textConfig||(this.textConfig={});var n=this.textConfig,r=n.local,a=t.innerTransformable,i=void 0,o=void 0,s=!1;a.parent=r?this:null;var u=!1;if(a.copyTransform(t),null!=n.position){var l=TV;n.layoutRect?l.copy(n.layoutRect):l.copy(this.getBoundingRect()),r||l.applyTransform(this.transform),this.calculateTextPosition?this.calculateTextPosition(CV,n,l):Cz(CV,n,l),a.x=CV.x,a.y=CV.y,i=CV.align,o=CV.verticalAlign;var c=n.origin;if(c&&null!=n.rotation){var h=void 0,p=void 0;"center"===c?(h=.5*l.width,p=.5*l.height):(h=Iz(c[0],l.width),p=Iz(c[1],l.height)),u=!0,a.originX=-a.x+h+(r?0:l.x),a.originY=-a.y+p+(r?0:l.y)}}null!=n.rotation&&(a.rotation=n.rotation);var f=n.offset;f&&(a.x+=f[0],a.y+=f[1],u||(a.originX=-f[0],a.originY=-f[1]));var d=null==n.inside?"string"===typeof n.position&&n.position.indexOf("inside")>=0:n.inside,v=this._innerTextDefaultStyle||(this._innerTextDefaultStyle={}),m=void 0,g=void 0,y=void 0;d&&this.canBeInsideText()?(m=n.insideFill,g=n.insideStroke,null!=m&&"auto"!==m||(m=this.getInsideTextFill()),null!=g&&"auto"!==g||(g=this.getInsideTextStroke(m),y=!0)):(m=n.outsideFill,g=n.outsideStroke,null!=m&&"auto"!==m||(m=this.getOutsideFill()),null!=g&&"auto"!==g||(g=this.getOutsideStroke(m),y=!0)),(m=m||"#000")===v.fill&&g===v.stroke&&y===v.autoStroke&&i===v.align&&o===v.verticalAlign||(s=!0,v.fill=m,v.stroke=g,v.autoStroke=y,v.align=i,v.verticalAlign=o,t.setDefaultTextStyle(v)),t.__dirty|=1,s&&t.dirtyStyle(!0)}},e.prototype.canBeInsideText=function(){return!0},e.prototype.getInsideTextFill=function(){return"#fff"},e.prototype.getInsideTextStroke=function(e){return"#000"},e.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?wV:kV},e.prototype.getOutsideStroke=function(e){var t=this.__zr&&this.__zr.getBackgroundColor(),n="string"===typeof t&&KB(t);n||(n=[255,255,255,1]);for(var r=n[3],a=this.__zr.isDarkMode(),i=0;i<3;i++)n[i]=n[i]*r+(a?0:255)*(1-r);return n[3]=1,eV(n,"rgba")},e.prototype.traverse=function(e,t){},e.prototype.attrKV=function(e,t){"textConfig"===e?this.setTextConfig(t):"textContent"===e?this.setTextContent(t):"clipPath"===e?this.setClipPath(t):"extra"===e?(this.extra=this.extra||{},UL(this.extra,t)):this[e]=t},e.prototype.hide=function(){this.ignore=!0,this.markRedraw()},e.prototype.show=function(){this.ignore=!1,this.markRedraw()},e.prototype.attr=function(e,t){if("string"===typeof e)this.attrKV(e,t);else if(iP(e))for(var n=QL(e),r=0;r<n.length;r++){var a=n[r];this.attrKV(a,e[a])}return this.markRedraw(),this},e.prototype.saveCurrentToNormalState=function(e){this._innerSaveToNormal(e);for(var t=this._normalState,n=0;n<this.animators.length;n++){var r=this.animators[n],a=r.__fromStateTransition;if(!(r.getLoop()||a&&a!==_V)){var i=r.targetName,o=i?t[i]:t;r.saveTo(o)}}},e.prototype._innerSaveToNormal=function(e){var t=this._normalState;t||(t=this._normalState={}),e.textConfig&&!t.textConfig&&(t.textConfig=this.textConfig),this._savePrimaryToNormal(e,t,SV)},e.prototype._savePrimaryToNormal=function(e,t,n){for(var r=0;r<n.length;r++){var a=n[r];null==e[a]||a in t||(t[a]=this[a])}},e.prototype.hasState=function(){return this.currentStates.length>0},e.prototype.getState=function(e){return this.states[e]},e.prototype.ensureState=function(e){var t=this.states;return t[e]||(t[e]={}),t[e]},e.prototype.clearStates=function(e){this.useState(_V,!1,e)},e.prototype.useState=function(e,t,n,r){var a=e===_V;if(this.hasState()||!a){var i=this.currentStates,o=this.stateTransition;if(!(GL(i,e)>=0)||!t&&1!==i.length){var s;if(this.stateProxy&&!a&&(s=this.stateProxy(e)),s||(s=this.states&&this.states[e]),s||a){a||this.saveCurrentToNormalState(s);var u=!!(s&&s.hoverLayer||r);u&&this._toggleHoverLayerFlag(!0),this._applyStateObj(e,s,this._normalState,t,!n&&!this.__inHover&&o&&o.duration>0,o);var l=this._textContent,c=this._textGuide;return l&&l.useState(e,t,n,u),c&&c.useState(e,t,n,u),a?(this.currentStates=[],this._normalState={}):t?this.currentStates.push(e):this.currentStates=[e],this._updateAnimationTargets(),this.markRedraw(),!u&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=-2),s}BL("State "+e+" not exists.")}}},e.prototype.useStates=function(e,t,n){if(e.length){var r=[],a=this.currentStates,i=e.length,o=i===a.length;if(o)for(var s=0;s<i;s++)if(e[s]!==a[s]){o=!1;break}if(o)return;for(s=0;s<i;s++){var u=e[s],l=void 0;this.stateProxy&&(l=this.stateProxy(u,e)),l||(l=this.states[u]),l&&r.push(l)}var c=r[i-1],h=!!(c&&c.hoverLayer||n);h&&this._toggleHoverLayerFlag(!0);var p=this._mergeStates(r),f=this.stateTransition;this.saveCurrentToNormalState(p),this._applyStateObj(e.join(","),p,this._normalState,!1,!t&&!this.__inHover&&f&&f.duration>0,f);var d=this._textContent,v=this._textGuide;d&&d.useStates(e,t,h),v&&v.useStates(e,t,h),this._updateAnimationTargets(),this.currentStates=e.slice(),this.markRedraw(),!h&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=-2)}else this.clearStates()},e.prototype._updateAnimationTargets=function(){for(var e=0;e<this.animators.length;e++){var t=this.animators[e];t.targetName&&t.changeTarget(this[t.targetName])}},e.prototype.removeState=function(e){var t=GL(this.currentStates,e);if(t>=0){var n=this.currentStates.slice();n.splice(t,1),this.useStates(n)}},e.prototype.replaceState=function(e,t,n){var r=this.currentStates.slice(),a=GL(r,e),i=GL(r,t)>=0;a>=0?i?r.splice(a,1):r[a]=t:n&&!i&&r.push(t),this.useStates(r)},e.prototype.toggleState=function(e,t){t?this.useState(e,!0):this.removeState(e)},e.prototype._mergeStates=function(e){for(var t,n={},r=0;r<e.length;r++){var a=e[r];UL(n,a),a.textConfig&&UL(t=t||{},a.textConfig)}return t&&(n.textConfig=t),n},e.prototype._applyStateObj=function(e,t,n,r,a,i){var o=!(t&&r);t&&t.textConfig?(this.textConfig=UL({},r?this.textConfig:n.textConfig),UL(this.textConfig,t.textConfig)):o&&n.textConfig&&(this.textConfig=n.textConfig);for(var s={},u=!1,l=0;l<SV.length;l++){var c=SV[l],h=a&&IV[c];t&&null!=t[c]?h?(u=!0,s[c]=t[c]):this[c]=t[c]:o&&null!=n[c]&&(h?(u=!0,s[c]=n[c]):this[c]=n[c])}if(!a)for(l=0;l<this.animators.length;l++){var p=this.animators[l],f=p.targetName;p.getLoop()||p.__changeFinalValue(f?(t||n)[f]:t||n)}u&&this._transitionState(e,s,i)},e.prototype._attachComponent=function(e){if((!e.__zr||e.__hostTarget)&&e!==this){var t=this.__zr;t&&e.addSelfToZr(t),e.__zr=t,e.__hostTarget=this}},e.prototype._detachComponent=function(e){e.__zr&&e.removeSelfFromZr(e.__zr),e.__zr=null,e.__hostTarget=null},e.prototype.getClipPath=function(){return this._clipPath},e.prototype.setClipPath=function(e){this._clipPath&&this._clipPath!==e&&this.removeClipPath(),this._attachComponent(e),this._clipPath=e,this.markRedraw()},e.prototype.removeClipPath=function(){var e=this._clipPath;e&&(this._detachComponent(e),this._clipPath=null,this.markRedraw())},e.prototype.getTextContent=function(){return this._textContent},e.prototype.setTextContent=function(e){var t=this._textContent;t!==e&&(t&&t!==e&&this.removeTextContent(),e.innerTransformable=new uB,this._attachComponent(e),this._textContent=e,this.markRedraw())},e.prototype.setTextConfig=function(e){this.textConfig||(this.textConfig={}),UL(this.textConfig,e),this.markRedraw()},e.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},e.prototype.removeTextContent=function(){var e=this._textContent;e&&(e.innerTransformable=null,this._detachComponent(e),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},e.prototype.getTextGuideLine=function(){return this._textGuide},e.prototype.setTextGuideLine=function(e){this._textGuide&&this._textGuide!==e&&this.removeTextGuideLine(),this._attachComponent(e),this._textGuide=e,this.markRedraw()},e.prototype.removeTextGuideLine=function(){var e=this._textGuide;e&&(this._detachComponent(e),this._textGuide=null,this.markRedraw())},e.prototype.markRedraw=function(){this.__dirty|=1;var e=this.__zr;e&&(this.__inHover?e.refreshHover():e.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},e.prototype.dirty=function(){this.markRedraw()},e.prototype._toggleHoverLayerFlag=function(e){this.__inHover=e;var t=this._textContent,n=this._textGuide;t&&(t.__inHover=e),n&&(n.__inHover=e)},e.prototype.addSelfToZr=function(e){if(this.__zr!==e){this.__zr=e;var t=this.animators;if(t)for(var n=0;n<t.length;n++)e.animation.addAnimator(t[n]);this._clipPath&&this._clipPath.addSelfToZr(e),this._textContent&&this._textContent.addSelfToZr(e),this._textGuide&&this._textGuide.addSelfToZr(e)}},e.prototype.removeSelfFromZr=function(e){if(this.__zr){this.__zr=null;var t=this.animators;if(t)for(var n=0;n<t.length;n++)e.animation.removeAnimator(t[n]);this._clipPath&&this._clipPath.removeSelfFromZr(e),this._textContent&&this._textContent.removeSelfFromZr(e),this._textGuide&&this._textGuide.removeSelfFromZr(e)}},e.prototype.animate=function(e,t,n){var r=e?this[e]:this;var a=new mV(r,t,n);return e&&(a.targetName=e),this.addAnimator(a,e),a},e.prototype.addAnimator=function(e,t){var n=this.__zr,r=this;e.during((function(){r.updateDuringAnimation(t)})).done((function(){var t=r.animators,n=GL(t,e);n>=0&&t.splice(n,1)})),this.animators.push(e),n&&n.animation.addAnimator(e),n&&n.wakeUp()},e.prototype.updateDuringAnimation=function(e){this.markRedraw()},e.prototype.stopAnimation=function(e,t){for(var n=this.animators,r=n.length,a=[],i=0;i<r;i++){var o=n[i];e&&e!==o.scope?a.push(o):o.stop(t)}return this.animators=a,this},e.prototype.animateTo=function(e,t,n){EV(this,e,t,n)},e.prototype.animateFrom=function(e,t,n){EV(this,e,t,n,!0)},e.prototype._transitionState=function(e,t,n,r){for(var a=EV(this,t,n,r),i=0;i<a.length;i++)a[i].__fromStateTransition=e},e.prototype.getBoundingRect=function(){return null},e.prototype.getPaintRect=function(){return null},e.initDefaultProps=function(){var t=e.prototype;t.type="element",t.name="",t.ignore=t.silent=t.isGroup=t.draggable=t.dragging=t.ignoreClip=t.__inHover=!1,t.__dirty=1;function n(e,n,r,a){function i(e,t){Object.defineProperty(t,0,{get:function(){return e[r]},set:function(t){e[r]=t}}),Object.defineProperty(t,1,{get:function(){return e[a]},set:function(t){e[a]=t}})}Object.defineProperty(t,e,{get:function(){this[n]||i(this,this[n]=[]);return this[n]},set:function(e){this[r]=e[0],this[a]=e[1],this[n]=e,i(this,e)}})}Object.defineProperty&&(n("position","_legacyPos","x","y"),n("scale","_legacyScale","scaleX","scaleY"),n("origin","_legacyOrigin","originX","originY"))}(),e}();function EV(e,t,n,r,a){var i=[];DV(e,"",e,t,n=n||{},r,i,a);var o=i.length,s=!1,u=n.done,l=n.aborted,c=function(){s=!0,--o<=0&&(s?u&&u():l&&l())},h=function(){--o<=0&&(s?u&&u():l&&l())};o||u&&u(),i.length>0&&n.during&&i[0].during((function(e,t){n.during(t)}));for(var p=0;p<i.length;p++){var f=i[p];c&&f.done(c),h&&f.aborted(h),n.force&&f.duration(n.duration),f.start(n.easing)}return i}function MV(e,t,n){for(var r=0;r<n;r++)e[r]=t[r]}function AV(e,t,n){if(qL(t[n]))if(qL(e[n])||(e[n]=[]),sP(t[n])){var r=t[n].length;e[n].length!==r&&(e[n]=new t[n].constructor(r),MV(e[n],t[n],r))}else{var a=t[n],i=e[n],o=a.length;if(qL(a[0]))for(var s=a[0].length,u=0;u<o;u++)i[u]?MV(i[u],a[u],s):i[u]=Array.prototype.slice.call(a[u]);else MV(i,a,o);i.length=a.length}else e[n]=t[n]}function DV(e,t,n,r,a,i,o,s){for(var u=QL(r),l=a.duration,c=a.delay,h=a.additive,p=a.setToFinal,f=!iP(i),d=e.animators,v=[],m=0;m<u.length;m++){var g=u[m],y=r[g];if(null!=y&&null!=n[g]&&(f||i[g]))if(!iP(y)||qL(y)||lP(y))v.push(g);else{if(t){s||(n[g]=y,e.updateDuringAnimation(t));continue}DV(e,g,n[g],y,a,i&&i[g],o,s)}else s||(n[g]=y,e.updateDuringAnimation(t),v.push(g))}var b=v.length;if(!h&&b)for(var x=0;x<d.length;x++){if((w=d[x]).targetName===t)if(w.stopTracks(v)){var k=GL(d,w);d.splice(k,1)}}if(a.force||(v=ZL(v,(function(e){return t=r[e],a=n[e],!(t===a||qL(t)&&qL(a)&&function(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}(t,a));var t,a})),b=v.length),b>0||a.force&&!o.length){var w,_=void 0,S=void 0,I=void 0;if(s){S={},p&&(_={});for(x=0;x<b;x++){S[g=v[x]]=n[g],p?_[g]=r[g]:n[g]=r[g]}}else if(p){I={};for(x=0;x<b;x++){I[g=v[x]]=lV(n[g]),AV(n,r,g)}}(w=new mV(n,!1,!1,h?ZL(d,(function(e){return e.targetName===t})):null)).targetName=t,a.scope&&(w.scope=a.scope),p&&_&&w.whenWithKeys(0,_,v),I&&w.whenWithKeys(0,I,v),w.whenWithKeys(null==l?500:l,s?S:r,v).delay(c||0),e.addAnimator(w,t),o.push(w)}}jL(NV,yV),jL(NV,uB);var RV=NV,OV="__zr_style_"+Math.round(10*Math.random()),FV={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},LV={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};FV[OV]=!0;var PV=["z","z2","invisible"],zV=["invisible"],BV=function(e){function t(t){return e.call(this,t)||this}return GP(t,e),t.prototype._init=function(t){for(var n=QL(t),r=0;r<n.length;r++){var a=n[r];"style"===a?this.useStyle(t[a]):e.prototype.attrKV.call(this,a,t[a])}this.style||this.useStyle({})},t.prototype.beforeBrush=function(){},t.prototype.afterBrush=function(){},t.prototype.innerBeforeBrush=function(){},t.prototype.innerAfterBrush=function(){},t.prototype.shouldBePainted=function(e,t,n,r){var a=this.transform;if(this.ignore||this.invisible||0===this.style.opacity||this.culling&&function(e,t,n){VV.copy(e.getBoundingRect()),e.transform&&VV.applyTransform(e.transform);return WV.width=t,WV.height=n,!VV.intersect(WV)}(this,e,t)||a&&!a[0]&&!a[3])return!1;if(n&&this.__clipPaths)for(var i=0;i<this.__clipPaths.length;++i)if(this.__clipPaths[i].isZeroArea())return!1;if(r&&this.parent)for(var o=this.parent;o;){if(o.ignore)return!1;o=o.parent}return!0},t.prototype.contain=function(e,t){return this.rectContain(e,t)},t.prototype.traverse=function(e,t){e.call(t,this)},t.prototype.rectContain=function(e,t){var n=this.transformCoordToLocal(e,t);return this.getBoundingRect().contain(n[0],n[1])},t.prototype.getPaintRect=function(){var e=this._paintRect;if(!this._paintRect||this.__dirty){var t=this.transform,n=this.getBoundingRect(),r=this.style,a=r.shadowBlur||0,i=r.shadowOffsetX||0,o=r.shadowOffsetY||0;e=this._paintRect||(this._paintRect=new gz(0,0,0,0)),t?gz.applyTransform(e,n,t):e.copy(n),(a||i||o)&&(e.width+=2*a+Math.abs(i),e.height+=2*a+Math.abs(o),e.x=Math.min(e.x,e.x+i-a),e.y=Math.min(e.y,e.y+o-a));var s=this.dirtyRectTolerance;e.isZero()||(e.x=Math.floor(e.x-s),e.y=Math.floor(e.y-s),e.width=Math.ceil(e.width+1+2*s),e.height=Math.ceil(e.height+1+2*s))}return e},t.prototype.setPrevPaintRect=function(e){e?(this._prevPaintRect=this._prevPaintRect||new gz(0,0,0,0),this._prevPaintRect.copy(e)):this._prevPaintRect=null},t.prototype.getPrevPaintRect=function(){return this._prevPaintRect},t.prototype.animateStyle=function(e){return this.animate("style",e)},t.prototype.updateDuringAnimation=function(e){"style"===e?this.dirtyStyle():this.markRedraw()},t.prototype.attrKV=function(t,n){"style"!==t?e.prototype.attrKV.call(this,t,n):this.style?this.setStyle(n):this.useStyle(n)},t.prototype.setStyle=function(e,t){return"string"===typeof e?this.style[e]=t:UL(this.style,e),this.dirtyStyle(),this},t.prototype.dirtyStyle=function(e){e||this.markRedraw(),this.__dirty|=2,this._rect&&(this._rect=null)},t.prototype.dirty=function(){this.dirtyStyle()},t.prototype.styleChanged=function(){return!!(2&this.__dirty)},t.prototype.styleUpdated=function(){this.__dirty&=-3},t.prototype.createStyle=function(e){return _P(FV,e)},t.prototype.useStyle=function(e){e[OV]||(e=this.createStyle(e)),this.__inHover?this.__hoverStyle=e:this.style=e,this.dirtyStyle()},t.prototype.isStyleObject=function(e){return e[OV]},t.prototype._innerSaveToNormal=function(t){e.prototype._innerSaveToNormal.call(this,t);var n=this._normalState;t.style&&!n.style&&(n.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(t,n,PV)},t.prototype._applyStateObj=function(t,n,r,a,i,o){e.prototype._applyStateObj.call(this,t,n,r,a,i,o);var s,u=!(n&&a);if(n&&n.style?i?a?s=n.style:(s=this._mergeStyle(this.createStyle(),r.style),this._mergeStyle(s,n.style)):(s=this._mergeStyle(this.createStyle(),a?this.style:r.style),this._mergeStyle(s,n.style)):u&&(s=r.style),s)if(i){var l=this.style;if(this.style=this.createStyle(u?{}:l),u)for(var c=QL(l),h=0;h<c.length;h++){(f=c[h])in s&&(s[f]=s[f],this.style[f]=l[f])}var p=QL(s);for(h=0;h<p.length;h++){var f=p[h];this.style[f]=this.style[f]}this._transitionState(t,{style:s},o,this.getAnimationStyleProps())}else this.useStyle(s);var d=this.__inHover?zV:PV;for(h=0;h<d.length;h++){f=d[h];n&&null!=n[f]?this[f]=n[f]:u&&null!=r[f]&&(this[f]=r[f])}},t.prototype._mergeStates=function(t){for(var n,r=e.prototype._mergeStates.call(this,t),a=0;a<t.length;a++){var i=t[a];i.style&&(n=n||{},this._mergeStyle(n,i.style))}return n&&(r.style=n),r},t.prototype._mergeStyle=function(e,t){return UL(e,t),e},t.prototype.getAnimationStyleProps=function(){return LV},t.initDefaultProps=function(){var e=t.prototype;e.type="displayable",e.invisible=!1,e.z=0,e.z2=0,e.zlevel=0,e.culling=!1,e.cursor="pointer",e.rectHover=!1,e.incremental=!1,e._rect=null,e.dirtyRectTolerance=0,e.__dirty=3}(),t}(RV),VV=new gz(0,0,0,0),WV=new gz(0,0,0,0);var UV=BV,HV=Math.min,GV=Math.max,jV=Math.sin,qV=Math.cos,XV=2*Math.PI,KV=Bz(),YV=Bz(),ZV=Bz();function QV(e,t,n){if(0!==e.length){for(var r=e[0],a=r[0],i=r[0],o=r[1],s=r[1],u=1;u<e.length;u++)r=e[u],a=HV(a,r[0]),i=GV(i,r[0]),o=HV(o,r[1]),s=GV(s,r[1]);t[0]=a,t[1]=o,n[0]=i,n[1]=s}}function $V(e,t,n,r,a,i){a[0]=HV(e,n),a[1]=HV(t,r),i[0]=GV(e,n),i[1]=GV(t,r)}var JV=[],eW=[];function tW(e,t,n,r,a,i,o,s,u,l){var c=IB,h=wB,p=c(e,n,a,o,JV);u[0]=1/0,u[1]=1/0,l[0]=-1/0,l[1]=-1/0;for(var f=0;f<p;f++){var d=h(e,n,a,o,JV[f]);u[0]=HV(d,u[0]),l[0]=GV(d,l[0])}p=c(t,r,i,s,eW);for(f=0;f<p;f++){var v=h(t,r,i,s,eW[f]);u[1]=HV(v,u[1]),l[1]=GV(v,l[1])}u[0]=HV(e,u[0]),l[0]=GV(e,l[0]),u[0]=HV(o,u[0]),l[0]=GV(o,l[0]),u[1]=HV(t,u[1]),l[1]=GV(t,l[1]),u[1]=HV(s,u[1]),l[1]=GV(s,l[1])}function nW(e,t,n,r,a,i,o,s){var u=MB,l=NB,c=GV(HV(u(e,n,a),1),0),h=GV(HV(u(t,r,i),1),0),p=l(e,n,a,c),f=l(t,r,i,h);o[0]=HV(e,a,p),o[1]=HV(t,i,f),s[0]=GV(e,a,p),s[1]=GV(t,i,f)}function rW(e,t,n,r,a,i,o,s,u){var l=Qz,c=$z,h=Math.abs(a-i);if(h%XV<1e-4&&h>1e-4)return s[0]=e-n,s[1]=t-r,u[0]=e+n,void(u[1]=t+r);if(KV[0]=qV(a)*n+e,KV[1]=jV(a)*r+t,YV[0]=qV(i)*n+e,YV[1]=jV(i)*r+t,l(s,KV,YV),c(u,KV,YV),(a%=XV)<0&&(a+=XV),(i%=XV)<0&&(i+=XV),a>i&&!o?i+=XV:a<i&&o&&(a+=XV),o){var p=i;i=a,a=p}for(var f=0;f<i;f+=Math.PI/2)f>a&&(ZV[0]=qV(f)*n+e,ZV[1]=jV(f)*r+t,l(s,ZV,s),c(u,ZV,u))}var aW={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},iW=[],oW=[],sW=[],uW=[],lW=[],cW=[],hW=Math.min,pW=Math.max,fW=Math.cos,dW=Math.sin,vW=Math.abs,mW=Math.PI,gW=2*mW,yW="undefined"!==typeof Float32Array,bW=[];function xW(e){return Math.round(e/mW*1e8)/1e8%2*mW}var kW=function(){function e(e){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,e&&(this._saveData=!1),this._saveData&&(this.data=[])}return e.prototype.increaseVersion=function(){this._version++},e.prototype.getVersion=function(){return this._version},e.prototype.setScale=function(e,t,n){(n=n||0)>0&&(this._ux=vW(n/xV/e)||0,this._uy=vW(n/xV/t)||0)},e.prototype.setDPR=function(e){this.dpr=e},e.prototype.setContext=function(e){this._ctx=e},e.prototype.getContext=function(){return this._ctx},e.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},e.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},e.prototype.moveTo=function(e,t){return this._drawPendingPt(),this.addData(aW.M,e,t),this._ctx&&this._ctx.moveTo(e,t),this._x0=e,this._y0=t,this._xi=e,this._yi=t,this},e.prototype.lineTo=function(e,t){var n=vW(e-this._xi),r=vW(t-this._yi),a=n>this._ux||r>this._uy;if(this.addData(aW.L,e,t),this._ctx&&a&&this._ctx.lineTo(e,t),a)this._xi=e,this._yi=t,this._pendingPtDist=0;else{var i=n*n+r*r;i>this._pendingPtDist&&(this._pendingPtX=e,this._pendingPtY=t,this._pendingPtDist=i)}return this},e.prototype.bezierCurveTo=function(e,t,n,r,a,i){return this._drawPendingPt(),this.addData(aW.C,e,t,n,r,a,i),this._ctx&&this._ctx.bezierCurveTo(e,t,n,r,a,i),this._xi=a,this._yi=i,this},e.prototype.quadraticCurveTo=function(e,t,n,r){return this._drawPendingPt(),this.addData(aW.Q,e,t,n,r),this._ctx&&this._ctx.quadraticCurveTo(e,t,n,r),this._xi=n,this._yi=r,this},e.prototype.arc=function(e,t,n,r,a,i){this._drawPendingPt(),bW[0]=r,bW[1]=a,function(e,t){var n=xW(e[0]);n<0&&(n+=gW);var r=n-e[0],a=e[1];a+=r,!t&&a-n>=gW?a=n+gW:t&&n-a>=gW?a=n-gW:!t&&n>a?a=n+(gW-xW(n-a)):t&&n<a&&(a=n-(gW-xW(a-n))),e[0]=n,e[1]=a}(bW,i),r=bW[0];var o=(a=bW[1])-r;return this.addData(aW.A,e,t,n,n,r,o,0,i?0:1),this._ctx&&this._ctx.arc(e,t,n,r,a,i),this._xi=fW(a)*n+e,this._yi=dW(a)*n+t,this},e.prototype.arcTo=function(e,t,n,r,a){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(e,t,n,r,a),this},e.prototype.rect=function(e,t,n,r){return this._drawPendingPt(),this._ctx&&this._ctx.rect(e,t,n,r),this.addData(aW.R,e,t,n,r),this},e.prototype.closePath=function(){this._drawPendingPt(),this.addData(aW.Z);var e=this._ctx,t=this._x0,n=this._y0;return e&&e.closePath(),this._xi=t,this._yi=n,this},e.prototype.fill=function(e){e&&e.fill(),this.toStatic()},e.prototype.stroke=function(e){e&&e.stroke(),this.toStatic()},e.prototype.len=function(){return this._len},e.prototype.setData=function(e){var t=e.length;this.data&&this.data.length===t||!yW||(this.data=new Float32Array(t));for(var n=0;n<t;n++)this.data[n]=e[n];this._len=t},e.prototype.appendPath=function(e){e instanceof Array||(e=[e]);for(var t=e.length,n=0,r=this._len,a=0;a<t;a++)n+=e[a].len();yW&&this.data instanceof Float32Array&&(this.data=new Float32Array(r+n));for(a=0;a<t;a++)for(var i=e[a].data,o=0;o<i.length;o++)this.data[r++]=i[o];this._len=r},e.prototype.addData=function(e,t,n,r,a,i,o,s,u){if(this._saveData){var l=this.data;this._len+arguments.length>l.length&&(this._expandData(),l=this.data);for(var c=0;c<arguments.length;c++)l[this._len++]=arguments[c]}},e.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},e.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var e=[],t=0;t<this._len;t++)e[t]=this.data[t];this.data=e}},e.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var e=this.data;e instanceof Array&&(e.length=this._len,yW&&this._len>11&&(this.data=new Float32Array(e)))}},e.prototype.getBoundingRect=function(){sW[0]=sW[1]=lW[0]=lW[1]=Number.MAX_VALUE,uW[0]=uW[1]=cW[0]=cW[1]=-Number.MAX_VALUE;var e,t=this.data,n=0,r=0,a=0,i=0;for(e=0;e<this._len;){var o=t[e++],s=1===e;switch(s&&(a=n=t[e],i=r=t[e+1]),o){case aW.M:n=a=t[e++],r=i=t[e++],lW[0]=a,lW[1]=i,cW[0]=a,cW[1]=i;break;case aW.L:$V(n,r,t[e],t[e+1],lW,cW),n=t[e++],r=t[e++];break;case aW.C:tW(n,r,t[e++],t[e++],t[e++],t[e++],t[e],t[e+1],lW,cW),n=t[e++],r=t[e++];break;case aW.Q:nW(n,r,t[e++],t[e++],t[e],t[e+1],lW,cW),n=t[e++],r=t[e++];break;case aW.A:var u=t[e++],l=t[e++],c=t[e++],h=t[e++],p=t[e++],f=t[e++]+p;e+=1;var d=!t[e++];s&&(a=fW(p)*c+u,i=dW(p)*h+l),rW(u,l,c,h,p,f,d,lW,cW),n=fW(f)*c+u,r=dW(f)*h+l;break;case aW.R:$V(a=n=t[e++],i=r=t[e++],a+t[e++],i+t[e++],lW,cW);break;case aW.Z:n=a,r=i}Qz(sW,sW,lW),$z(uW,uW,cW)}return 0===e&&(sW[0]=sW[1]=uW[0]=uW[1]=0),new gz(sW[0],sW[1],uW[0]-sW[0],uW[1]-sW[1])},e.prototype._calculateLength=function(){var e=this.data,t=this._len,n=this._ux,r=this._uy,a=0,i=0,o=0,s=0;this._pathSegLen||(this._pathSegLen=[]);for(var u=this._pathSegLen,l=0,c=0,h=0;h<t;){var p=e[h++],f=1===h;f&&(o=a=e[h],s=i=e[h+1]);var d=-1;switch(p){case aW.M:a=o=e[h++],i=s=e[h++];break;case aW.L:var v=e[h++],m=(b=e[h++])-i;(vW(E=v-a)>n||vW(m)>r||h===t-1)&&(d=Math.sqrt(E*E+m*m),a=v,i=b);break;case aW.C:var g=e[h++],y=e[h++],b=(v=e[h++],e[h++]),x=e[h++],k=e[h++];d=TB(a,i,g,y,v,b,x,k,10),a=x,i=k;break;case aW.Q:d=DB(a,i,g=e[h++],y=e[h++],v=e[h++],b=e[h++],10),a=v,i=b;break;case aW.A:var w=e[h++],_=e[h++],S=e[h++],I=e[h++],C=e[h++],T=e[h++],N=T+C;h+=1;e[h++];f&&(o=fW(C)*S+w,s=dW(C)*I+_),d=pW(S,I)*hW(gW,Math.abs(T)),a=fW(N)*S+w,i=dW(N)*I+_;break;case aW.R:o=a=e[h++],s=i=e[h++],d=2*e[h++]+2*e[h++];break;case aW.Z:var E=o-a;m=s-i;d=Math.sqrt(E*E+m*m),a=o,i=s}d>=0&&(u[c++]=d,l+=d)}return this._pathLen=l,l},e.prototype.rebuildPath=function(e,t){var n,r,a,i,o,s,u,l,c,h,p=this.data,f=this._ux,d=this._uy,v=this._len,m=t<1,g=0,y=0,b=0;if(!m||(this._pathSegLen||this._calculateLength(),u=this._pathSegLen,l=t*this._pathLen))e:for(var x=0;x<v;){var k=p[x++],w=1===x;switch(w&&(n=a=p[x],r=i=p[x+1]),k!==aW.L&&b>0&&(e.lineTo(c,h),b=0),k){case aW.M:n=a=p[x++],r=i=p[x++],e.moveTo(a,i);break;case aW.L:o=p[x++],s=p[x++];var _=vW(o-a),S=vW(s-i);if(_>f||S>d){if(m){if(g+(K=u[y++])>l){var I=(l-g)/K;e.lineTo(a*(1-I)+o*I,i*(1-I)+s*I);break e}g+=K}e.lineTo(o,s),a=o,i=s,b=0}else{var C=_*_+S*S;C>b&&(c=o,h=s,b=C)}break;case aW.C:var T=p[x++],N=p[x++],E=p[x++],M=p[x++],A=p[x++],D=p[x++];if(m){if(g+(K=u[y++])>l){CB(a,T,E,A,I=(l-g)/K,iW),CB(i,N,M,D,I,oW),e.bezierCurveTo(iW[1],oW[1],iW[2],oW[2],iW[3],oW[3]);break e}g+=K}e.bezierCurveTo(T,N,E,M,A,D),a=A,i=D;break;case aW.Q:T=p[x++],N=p[x++],E=p[x++],M=p[x++];if(m){if(g+(K=u[y++])>l){AB(a,T,E,I=(l-g)/K,iW),AB(i,N,M,I,oW),e.quadraticCurveTo(iW[1],oW[1],iW[2],oW[2]);break e}g+=K}e.quadraticCurveTo(T,N,E,M),a=E,i=M;break;case aW.A:var R=p[x++],O=p[x++],F=p[x++],L=p[x++],P=p[x++],z=p[x++],B=p[x++],V=!p[x++],W=F>L?F:L,U=vW(F-L)>.001,H=P+z,G=!1;if(m)g+(K=u[y++])>l&&(H=P+z*(l-g)/K,G=!0),g+=K;if(U&&e.ellipse?e.ellipse(R,O,F,L,B,P,H,V):e.arc(R,O,W,P,H,V),G)break e;w&&(n=fW(P)*F+R,r=dW(P)*L+O),a=fW(H)*F+R,i=dW(H)*L+O;break;case aW.R:n=a=p[x],r=i=p[x+1],o=p[x++],s=p[x++];var j=p[x++],q=p[x++];if(m){if(g+(K=u[y++])>l){var X=l-g;e.moveTo(o,s),e.lineTo(o+hW(X,j),s),(X-=j)>0&&e.lineTo(o+j,s+hW(X,q)),(X-=q)>0&&e.lineTo(o+pW(j-X,0),s+q),(X-=j)>0&&e.lineTo(o,s+pW(q-X,0));break e}g+=K}e.rect(o,s,j,q);break;case aW.Z:if(m){var K;if(g+(K=u[y++])>l){I=(l-g)/K;e.lineTo(a*(1-I)+n*I,i*(1-I)+r*I);break e}g+=K}e.closePath(),a=n,i=r}}},e.prototype.clone=function(){var t=new e,n=this.data;return t.data=n.slice?n.slice():Array.prototype.slice.call(n),t._len=this._len,t},e.CMD=aW,e.initDefaultProps=function(){var t=e.prototype;t._saveData=!0,t._ux=0,t._uy=0,t._pendingPtDist=0,t._version=0}(),e}(),wW=kW;function _W(e,t,n,r,a,i,o){if(0===a)return!1;var s=a,u=0;if(o>t+s&&o>r+s||o<t-s&&o<r-s||i>e+s&&i>n+s||i<e-s&&i<n-s)return!1;if(e===n)return Math.abs(i-e)<=s/2;var l=(u=(t-r)/(e-n))*i-o+(e*r-n*t)/(e-n);return l*l/(u*u+1)<=s/2*s/2}function SW(e,t,n,r,a,i,o,s,u,l,c){if(0===u)return!1;var h=u;if(c>t+h&&c>r+h&&c>i+h&&c>s+h||c<t-h&&c<r-h&&c<i-h&&c<s-h||l>e+h&&l>n+h&&l>a+h&&l>o+h||l<e-h&&l<n-h&&l<a-h&&l<o-h)return!1;var p=function(e,t,n,r,a,i,o,s,u,l,c){var h,p,f,d,v,m=.005,g=1/0;gB[0]=u,gB[1]=l;for(var y=0;y<1;y+=.05)yB[0]=wB(e,n,a,o,y),yB[1]=wB(t,r,i,s,y),(d=Kz(gB,yB))<g&&(h=y,g=d);g=1/0;for(var b=0;b<32&&!(m<dB);b++)p=h-m,f=h+m,yB[0]=wB(e,n,a,o,p),yB[1]=wB(t,r,i,s,p),d=Kz(yB,gB),p>=0&&d<g?(h=p,g=d):(bB[0]=wB(e,n,a,o,f),bB[1]=wB(t,r,i,s,f),v=Kz(bB,gB),f<=1&&v<g?(h=f,g=v):m*=.5);return c&&(c[0]=wB(e,n,a,o,h),c[1]=wB(t,r,i,s,h)),pB(g)}(e,t,n,r,a,i,o,s,l,c,null);return p<=h/2}function IW(e,t,n,r,a,i,o,s,u){if(0===o)return!1;var l=o;if(u>t+l&&u>r+l&&u>i+l||u<t-l&&u<r-l&&u<i-l||s>e+l&&s>n+l&&s>a+l||s<e-l&&s<n-l&&s<a-l)return!1;var c=function(e,t,n,r,a,i,o,s,u){var l,c=.005,h=1/0;gB[0]=o,gB[1]=s;for(var p=0;p<1;p+=.05)yB[0]=NB(e,n,a,p),yB[1]=NB(t,r,i,p),(m=Kz(gB,yB))<h&&(l=p,h=m);h=1/0;for(var f=0;f<32&&!(c<dB);f++){var d=l-c,v=l+c;yB[0]=NB(e,n,a,d),yB[1]=NB(t,r,i,d);var m=Kz(yB,gB);if(d>=0&&m<h)l=d,h=m;else{bB[0]=NB(e,n,a,v),bB[1]=NB(t,r,i,v);var g=Kz(bB,gB);v<=1&&g<h?(l=v,h=g):c*=.5}}return u&&(u[0]=NB(e,n,a,l),u[1]=NB(t,r,i,l)),pB(h)}(e,t,n,r,a,i,s,u,null);return c<=l/2}var CW=2*Math.PI;function TW(e){return(e%=CW)<0&&(e+=CW),e}var NW=2*Math.PI;function EW(e,t,n,r,a,i,o,s,u){if(0===o)return!1;var l=o;s-=e,u-=t;var c=Math.sqrt(s*s+u*u);if(c-l>n||c+l<n)return!1;if(Math.abs(r-a)%NW<1e-4)return!0;if(i){var h=r;r=TW(a),a=TW(h)}else r=TW(r),a=TW(a);r>a&&(a+=NW);var p=Math.atan2(u,s);return p<0&&(p+=NW),p>=r&&p<=a||p+NW>=r&&p+NW<=a}function MW(e,t,n,r,a,i){if(i>t&&i>r||i<t&&i<r)return 0;if(r===t)return 0;var o=(i-t)/(r-t),s=r<t?1:-1;1!==o&&0!==o||(s=r<t?.5:-.5);var u=o*(n-e)+e;return u===a?1/0:u>a?s:0}var AW=wW.CMD,DW=2*Math.PI;var RW=[-1,-1,-1],OW=[-1,-1];function FW(){var e=OW[0];OW[0]=OW[1],OW[1]=e}function LW(e,t,n,r,a,i,o,s,u,l){if(l>t&&l>r&&l>i&&l>s||l<t&&l<r&&l<i&&l<s)return 0;var c=SB(t,r,i,s,l,RW);if(0===c)return 0;for(var h=0,p=-1,f=void 0,d=void 0,v=0;v<c;v++){var m=RW[v],g=0===m||1===m?.5:1;wB(e,n,a,o,m)<u||(p<0&&(p=IB(t,r,i,s,OW),OW[1]<OW[0]&&p>1&&FW(),f=wB(t,r,i,s,OW[0]),p>1&&(d=wB(t,r,i,s,OW[1]))),2===p?m<OW[0]?h+=f<t?g:-g:m<OW[1]?h+=d<f?g:-g:h+=s<d?g:-g:m<OW[0]?h+=f<t?g:-g:h+=s<f?g:-g)}return h}function PW(e,t,n,r,a,i,o,s){if(s>t&&s>r&&s>i||s<t&&s<r&&s<i)return 0;var u=function(e,t,n,r,a){var i=e-2*t+n,o=2*(t-e),s=e-r,u=0;if(xB(i))kB(o)&&(c=-s/o)>=0&&c<=1&&(a[u++]=c);else{var l=o*o-4*i*s;if(xB(l))(c=-o/(2*i))>=0&&c<=1&&(a[u++]=c);else if(l>0){var c,h=pB(l),p=(-o-h)/(2*i);(c=(-o+h)/(2*i))>=0&&c<=1&&(a[u++]=c),p>=0&&p<=1&&(a[u++]=p)}}return u}(t,r,i,s,RW);if(0===u)return 0;var l=MB(t,r,i);if(l>=0&&l<=1){for(var c=0,h=NB(t,r,i,l),p=0;p<u;p++){var f=0===RW[p]||1===RW[p]?.5:1;NB(e,n,a,RW[p])<o||(RW[p]<l?c+=h<t?f:-f:c+=i<h?f:-f)}return c}f=0===RW[0]||1===RW[0]?.5:1;return NB(e,n,a,RW[0])<o?0:i<t?f:-f}function zW(e,t,n,r,a,i,o,s){if((s-=t)>n||s<-n)return 0;var u=Math.sqrt(n*n-s*s);RW[0]=-u,RW[1]=u;var l=Math.abs(r-a);if(l<1e-4)return 0;if(l>=DW-1e-4){r=0,a=DW;var c=i?1:-1;return o>=RW[0]+e&&o<=RW[1]+e?c:0}if(r>a){var h=r;r=a,a=h}r<0&&(r+=DW,a+=DW);for(var p=0,f=0;f<2;f++){var d=RW[f];if(d+e>o){var v=Math.atan2(s,d);c=i?1:-1;v<0&&(v=DW+v),(v>=r&&v<=a||v+DW>=r&&v+DW<=a)&&(v>Math.PI/2&&v<1.5*Math.PI&&(c=-c),p+=c)}}return p}function BW(e,t,n,r,a){for(var i,o,s,u,l=e.data,c=e.len(),h=0,p=0,f=0,d=0,v=0,m=0;m<c;){var g=l[m++],y=1===m;switch(g===AW.M&&m>1&&(n||(h+=MW(p,f,d,v,r,a))),y&&(d=p=l[m],v=f=l[m+1]),g){case AW.M:p=d=l[m++],f=v=l[m++];break;case AW.L:if(n){if(_W(p,f,l[m],l[m+1],t,r,a))return!0}else h+=MW(p,f,l[m],l[m+1],r,a)||0;p=l[m++],f=l[m++];break;case AW.C:if(n){if(SW(p,f,l[m++],l[m++],l[m++],l[m++],l[m],l[m+1],t,r,a))return!0}else h+=LW(p,f,l[m++],l[m++],l[m++],l[m++],l[m],l[m+1],r,a)||0;p=l[m++],f=l[m++];break;case AW.Q:if(n){if(IW(p,f,l[m++],l[m++],l[m],l[m+1],t,r,a))return!0}else h+=PW(p,f,l[m++],l[m++],l[m],l[m+1],r,a)||0;p=l[m++],f=l[m++];break;case AW.A:var b=l[m++],x=l[m++],k=l[m++],w=l[m++],_=l[m++],S=l[m++];m+=1;var I=!!(1-l[m++]);i=Math.cos(_)*k+b,o=Math.sin(_)*w+x,y?(d=i,v=o):h+=MW(p,f,i,o,r,a);var C=(r-b)*w/k+b;if(n){if(EW(b,x,w,_,_+S,I,t,C,a))return!0}else h+=zW(b,x,w,_,_+S,I,C,a);p=Math.cos(_+S)*k+b,f=Math.sin(_+S)*w+x;break;case AW.R:if(d=p=l[m++],v=f=l[m++],i=d+l[m++],o=v+l[m++],n){if(_W(d,v,i,v,t,r,a)||_W(i,v,i,o,t,r,a)||_W(i,o,d,o,t,r,a)||_W(d,o,d,v,t,r,a))return!0}else h+=MW(i,v,i,o,r,a),h+=MW(d,o,d,v,r,a);break;case AW.Z:if(n){if(_W(p,f,d,v,t,r,a))return!0}else h+=MW(p,f,d,v,r,a);p=d,f=v}}return n||(s=f,u=v,Math.abs(s-u)<1e-4)||(h+=MW(p,f,d,v,r,a)||0),0!==h}var VW=HL({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},FV),WW={style:HL({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},LV.style)},UW=sB.concat(["invisible","culling","z","z2","zlevel","parent"]),HW=function(e){function t(t){return e.call(this,t)||this}return GP(t,e),t.prototype.update=function(){var n=this;e.prototype.update.call(this);var r=this.style;if(r.decal){var a=this._decalEl=this._decalEl||new t;a.buildPath===t.prototype.buildPath&&(a.buildPath=function(e){n.buildPath(e,n.shape)}),a.silent=!0;var i=a.style;for(var o in r)i[o]!==r[o]&&(i[o]=r[o]);i.fill=r.fill?r.decal:null,i.decal=null,i.shadowColor=null,r.strokeFirst&&(i.stroke=null);for(var s=0;s<UW.length;++s)a[UW[s]]=this[UW[s]];a.__dirty|=1}else this._decalEl&&(this._decalEl=null)},t.prototype.getDecalElement=function(){return this._decalEl},t.prototype._init=function(t){var n=QL(t);this.shape=this.getDefaultShape();var r=this.getDefaultStyle();r&&this.useStyle(r);for(var a=0;a<n.length;a++){var i=n[a],o=t[i];"style"===i?this.style?UL(this.style,o):this.useStyle(o):"shape"===i?UL(this.shape,o):e.prototype.attrKV.call(this,i,o)}this.style||this.useStyle({})},t.prototype.getDefaultStyle=function(){return null},t.prototype.getDefaultShape=function(){return{}},t.prototype.canBeInsideText=function(){return this.hasFill()},t.prototype.getInsideTextFill=function(){var e=this.style.fill;if("none"!==e){if(nP(e)){var t=tV(e,0);return t>.5?kV:t>.2?"#eee":wV}if(e)return wV}return kV},t.prototype.getInsideTextStroke=function(e){var t=this.style.fill;if(nP(t)){var n=this.__zr;if(!(!n||!n.isDarkMode())===tV(e,0)<.4)return t}},t.prototype.buildPath=function(e,t,n){},t.prototype.pathUpdated=function(){this.__dirty&=-5},t.prototype.getUpdatedPathProxy=function(e){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,e),this.path},t.prototype.createPathProxy=function(){this.path=new wW(!1)},t.prototype.hasStroke=function(){var e=this.style,t=e.stroke;return!(null==t||"none"===t||!(e.lineWidth>0))},t.prototype.hasFill=function(){var e=this.style.fill;return null!=e&&"none"!==e},t.prototype.getBoundingRect=function(){var e=this._rect,t=this.style,n=!e;if(n){var r=!1;this.path||(r=!0,this.createPathProxy());var a=this.path;(r||4&this.__dirty)&&(a.beginPath(),this.buildPath(a,this.shape,!1),this.pathUpdated()),e=a.getBoundingRect()}if(this._rect=e,this.hasStroke()&&this.path&&this.path.len()>0){var i=this._rectStroke||(this._rectStroke=e.clone());if(this.__dirty||n){i.copy(e);var o=t.strokeNoScale?this.getLineScale():1,s=t.lineWidth;if(!this.hasFill()){var u=this.strokeContainThreshold;s=Math.max(s,null==u?4:u)}o>1e-10&&(i.width+=s/o,i.height+=s/o,i.x-=s/o/2,i.y-=s/o/2)}return i}return e},t.prototype.contain=function(e,t){var n=this.transformCoordToLocal(e,t),r=this.getBoundingRect(),a=this.style;if(e=n[0],t=n[1],r.contain(e,t)){var i=this.path;if(this.hasStroke()){var o=a.lineWidth,s=a.strokeNoScale?this.getLineScale():1;if(s>1e-10&&(this.hasFill()||(o=Math.max(o,this.strokeContainThreshold)),function(e,t,n,r){return BW(e,t,!0,n,r)}(i,o/s,e,t)))return!0}if(this.hasFill())return function(e,t,n){return BW(e,0,!1,t,n)}(i,e,t)}return!1},t.prototype.dirtyShape=function(){this.__dirty|=4,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},t.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},t.prototype.animateShape=function(e){return this.animate("shape",e)},t.prototype.updateDuringAnimation=function(e){"style"===e?this.dirtyStyle():"shape"===e?this.dirtyShape():this.markRedraw()},t.prototype.attrKV=function(t,n){"shape"===t?this.setShape(n):e.prototype.attrKV.call(this,t,n)},t.prototype.setShape=function(e,t){var n=this.shape;return n||(n=this.shape={}),"string"===typeof e?n[e]=t:UL(n,e),this.dirtyShape(),this},t.prototype.shapeChanged=function(){return!!(4&this.__dirty)},t.prototype.createStyle=function(e){return _P(VW,e)},t.prototype._innerSaveToNormal=function(t){e.prototype._innerSaveToNormal.call(this,t);var n=this._normalState;t.shape&&!n.shape&&(n.shape=UL({},this.shape))},t.prototype._applyStateObj=function(t,n,r,a,i,o){e.prototype._applyStateObj.call(this,t,n,r,a,i,o);var s,u=!(n&&a);if(n&&n.shape?i?a?s=n.shape:(s=UL({},r.shape),UL(s,n.shape)):(s=UL({},a?this.shape:r.shape),UL(s,n.shape)):u&&(s=r.shape),s)if(i){this.shape=UL({},this.shape);for(var l={},c=QL(s),h=0;h<c.length;h++){var p=c[h];"object"===typeof s[p]?this.shape[p]=s[p]:l[p]=s[p]}this._transitionState(t,{shape:l},o)}else this.shape=s,this.dirtyShape()},t.prototype._mergeStates=function(t){for(var n,r=e.prototype._mergeStates.call(this,t),a=0;a<t.length;a++){var i=t[a];i.shape&&(n=n||{},this._mergeStyle(n,i.shape))}return n&&(r.shape=n),r},t.prototype.getAnimationStyleProps=function(){return WW},t.prototype.isZeroArea=function(){return!1},t.extend=function(e){var n=function(t){function n(n){var r=t.call(this,n)||this;return e.init&&e.init.call(r,n),r}return GP(n,t),n.prototype.getDefaultStyle=function(){return VL(e.style)},n.prototype.getDefaultShape=function(){return VL(e.shape)},n}(t);for(var r in e)"function"===typeof e[r]&&(n.prototype[r]=e[r]);return n},t.initDefaultProps=function(){var e=t.prototype;e.type="path",e.strokeContainThreshold=5,e.segmentIgnoreThreshold=0,e.subPixelOptimize=!1,e.autoBatch=!1,e.__dirty=7}(),t}(UV),GW=HW,jW=HL({strokeFirst:!0,font:_L,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},VW),qW=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return GP(t,e),t.prototype.hasStroke=function(){var e=this.style,t=e.stroke;return null!=t&&"none"!==t&&e.lineWidth>0},t.prototype.hasFill=function(){var e=this.style.fill;return null!=e&&"none"!==e},t.prototype.createStyle=function(e){return _P(jW,e)},t.prototype.setBoundingRect=function(e){this._rect=e},t.prototype.getBoundingRect=function(){var e=this.style;if(!this._rect){var t=e.text;null!=t?t+="":t="";var n=kz(t,e.font,e.textAlign,e.textBaseline);if(n.x+=e.x||0,n.y+=e.y||0,this.hasStroke()){var r=e.lineWidth;n.x-=r/2,n.y-=r/2,n.width+=r,n.height+=r}this._rect=n}return this._rect},t.initDefaultProps=void(t.prototype.dirtyRectTolerance=10),t}(UV);qW.prototype.type="tspan";var XW=qW,KW=HL({x:0,y:0},FV),YW={style:HL({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},LV.style)};var ZW=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return GP(t,e),t.prototype.createStyle=function(e){return _P(KW,e)},t.prototype._getSize=function(e){var t=this.style,n=t[e];if(null!=n)return n;var r,a=(r=t.image)&&"string"!==typeof r&&r.width&&r.height?t.image:this.__image;if(!a)return 0;var i="width"===e?"height":"width",o=t[i];return null==o?a[e]:a[e]/a[i]*o},t.prototype.getWidth=function(){return this._getSize("width")},t.prototype.getHeight=function(){return this._getSize("height")},t.prototype.getAnimationStyleProps=function(){return YW},t.prototype.getBoundingRect=function(){var e=this.style;return this._rect||(this._rect=new gz(e.x||0,e.y||0,this.getWidth(),this.getHeight())),this._rect},t}(UV);ZW.prototype.type="image";var QW=ZW;var $W=Math.round;function JW(e,t,n){if(t){var r=t.x1,a=t.x2,i=t.y1,o=t.y2;e.x1=r,e.x2=a,e.y1=i,e.y2=o;var s=n&&n.lineWidth;return s?($W(2*r)===$W(2*a)&&(e.x1=e.x2=tU(r,s,!0)),$W(2*i)===$W(2*o)&&(e.y1=e.y2=tU(i,s,!0)),e):e}}function eU(e,t,n){if(t){var r=t.x,a=t.y,i=t.width,o=t.height;e.x=r,e.y=a,e.width=i,e.height=o;var s=n&&n.lineWidth;return s?(e.x=tU(r,s,!0),e.y=tU(a,s,!0),e.width=Math.max(tU(r+i,s,!1)-e.x,0===i?0:1),e.height=Math.max(tU(a+o,s,!1)-e.y,0===o?0:1),e):e}}function tU(e,t,n){if(!t)return e;var r=$W(2*e);return(r+$W(t))%2===0?r/2:(r+(n?1:-1))/2}var nU=function(){this.x=0,this.y=0,this.width=0,this.height=0},rU={},aU=function(e){function t(t){return e.call(this,t)||this}return GP(t,e),t.prototype.getDefaultShape=function(){return new nU},t.prototype.buildPath=function(e,t){var n,r,a,i;if(this.subPixelOptimize){var o=eU(rU,t,this.style);n=o.x,r=o.y,a=o.width,i=o.height,o.r=t.r,t=o}else n=t.x,r=t.y,a=t.width,i=t.height;t.r?function(e,t){var n,r,a,i,o,s=t.x,u=t.y,l=t.width,c=t.height,h=t.r;l<0&&(s+=l,l=-l),c<0&&(u+=c,c=-c),"number"===typeof h?n=r=a=i=h:h instanceof Array?1===h.length?n=r=a=i=h[0]:2===h.length?(n=a=h[0],r=i=h[1]):3===h.length?(n=h[0],r=i=h[1],a=h[2]):(n=h[0],r=h[1],a=h[2],i=h[3]):n=r=a=i=0,n+r>l&&(n*=l/(o=n+r),r*=l/o),a+i>l&&(a*=l/(o=a+i),i*=l/o),r+a>c&&(r*=c/(o=r+a),a*=c/o),n+i>c&&(n*=c/(o=n+i),i*=c/o),e.moveTo(s+n,u),e.lineTo(s+l-r,u),0!==r&&e.arc(s+l-r,u+r,r,-Math.PI/2,0),e.lineTo(s+l,u+c-a),0!==a&&e.arc(s+l-a,u+c-a,a,0,Math.PI/2),e.lineTo(s+i,u+c),0!==i&&e.arc(s+i,u+c-i,i,Math.PI/2,Math.PI),e.lineTo(s,u+n),0!==n&&e.arc(s+n,u+n,n,Math.PI,1.5*Math.PI)}(e,t):e.rect(n,r,a,i)},t.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},t}(GW);aU.prototype.type="rect";var iU=aU,oU={fill:"#000"},sU={style:HL({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},LV.style)},uU=function(e){function t(t){var n=e.call(this)||this;return n.type="text",n._children=[],n._defaultStyle=oU,n.attr(t),n}return GP(t,e),t.prototype.childrenRef=function(){return this._children},t.prototype.update=function(){e.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var t=0;t<this._children.length;t++){var n=this._children[t];n.zlevel=this.zlevel,n.z=this.z,n.z2=this.z2,n.culling=this.culling,n.cursor=this.cursor,n.invisible=this.invisible}},t.prototype.updateTransform=function(){var t=this.innerTransformable;t?(t.updateTransform(),t.transform&&(this.transform=t.transform)):e.prototype.updateTransform.call(this)},t.prototype.getLocalTransform=function(t){var n=this.innerTransformable;return n?n.getLocalTransform(t):e.prototype.getLocalTransform.call(this,t)},t.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),e.prototype.getComputedTransform.call(this)},t.prototype._updateSubTexts=function(){var e;this._childCursor=0,dU(e=this.style),XL(e.rich,dU),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},t.prototype.addSelfToZr=function(t){e.prototype.addSelfToZr.call(this,t);for(var n=0;n<this._children.length;n++)this._children[n].__zr=t},t.prototype.removeSelfFromZr=function(t){e.prototype.removeSelfFromZr.call(this,t);for(var n=0;n<this._children.length;n++)this._children[n].__zr=null},t.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var e=new gz(0,0,0,0),t=this._children,n=[],r=null,a=0;a<t.length;a++){var i=t[a],o=i.getBoundingRect(),s=i.getLocalTransform(n);s?(e.copy(o),e.applyTransform(s),(r=r||e.clone()).union(e)):(r=r||o.clone()).union(o)}this._rect=r||e}return this._rect},t.prototype.setDefaultTextStyle=function(e){this._defaultStyle=e||oU},t.prototype.setTextContent=function(e){0},t.prototype._mergeStyle=function(e,t){if(!t)return e;var n=t.rich,r=e.rich||n&&{};return UL(e,t),n&&r?(this._mergeRich(r,n),e.rich=r):r&&(e.rich=r),e},t.prototype._mergeRich=function(e,t){for(var n=QL(t),r=0;r<n.length;r++){var a=n[r];e[a]=e[a]||{},UL(e[a],t[a])}},t.prototype.getAnimationStyleProps=function(){return sU},t.prototype._getOrCreateChild=function(e){var t=this._children[this._childCursor];return t&&t instanceof e||(t=new e),this._children[this._childCursor++]=t,t.__zr=this.__zr,t.parent=this,t},t.prototype._updatePlainTexts=function(){var e=this.style,t=e.font||_L,n=e.padding,r=function(e,t){null!=e&&(e+="");var n,r=t.overflow,a=t.padding,i=t.font,o="truncate"===r,s=Sz(i),u=pP(t.lineHeight,s),l=!!t.backgroundColor,c="truncate"===t.lineOverflow,h=t.width,p=(n=null==h||"break"!==r&&"breakAll"!==r?e?e.split("\n"):[]:e?zz(e,t.font,h,"breakAll"===r,0).lines:[]).length*u,f=pP(t.height,p);if(p>f&&c){var d=Math.floor(f/u);n=n.slice(0,d)}if(e&&o&&null!=h)for(var v=Ez(h,i,t.ellipsis,{minChar:t.truncateMinChar,placeholder:t.placeholder}),m=0;m<n.length;m++)n[m]=Mz(n[m],v);var g=f,y=0;for(m=0;m<n.length;m++)y=Math.max(bz(n[m],i),y);null==h&&(h=y);var b=y;return a&&(g+=a[0]+a[2],b+=a[1]+a[3],h+=a[1]+a[3]),l&&(b=h),{lines:n,height:f,outerWidth:b,outerHeight:g,lineHeight:u,calculatedLineHeight:s,contentWidth:y,contentHeight:p,width:h}}(yU(e),e),a=bU(e),i=!!e.backgroundColor,o=r.outerHeight,s=r.outerWidth,u=r.contentWidth,l=r.lines,c=r.lineHeight,h=this._defaultStyle,p=e.x||0,f=e.y||0,d=e.align||h.align||"left",v=e.verticalAlign||h.verticalAlign||"top",m=p,g=_z(f,r.contentHeight,v);if(a||n){var y=wz(p,s,d),b=_z(f,o,v);a&&this._renderBackground(e,e,y,b,s,o)}g+=c/2,n&&(m=gU(p,d,n),"top"===v?g+=n[0]:"bottom"===v&&(g-=n[2]));for(var x=0,k=!1,w=(mU("fill"in e?e.fill:(k=!0,h.fill))),_=(vU("stroke"in e?e.stroke:i||h.autoStroke&&!k?null:(x=2,h.stroke))),S=e.textShadowBlur>0,I=null!=e.width&&("truncate"===e.overflow||"break"===e.overflow||"breakAll"===e.overflow),C=r.calculatedLineHeight,T=0;T<l.length;T++){var N=this._getOrCreateChild(XW),E=N.createStyle();N.useStyle(E),E.text=l[T],E.x=m,E.y=g,d&&(E.textAlign=d),E.textBaseline="middle",E.opacity=e.opacity,E.strokeFirst=!0,S&&(E.shadowBlur=e.textShadowBlur||0,E.shadowColor=e.textShadowColor||"transparent",E.shadowOffsetX=e.textShadowOffsetX||0,E.shadowOffsetY=e.textShadowOffsetY||0),E.stroke=_,E.fill=w,_&&(E.lineWidth=e.lineWidth||x,E.lineDash=e.lineDash,E.lineDashOffset=e.lineDashOffset||0),E.font=t,fU(E,e),g+=c,I&&N.setBoundingRect(new gz(wz(E.x,e.width,E.textAlign),_z(E.y,C,E.textBaseline),u,C))}},t.prototype._updateRichTexts=function(){var e=this.style,t=function(e,t){var n=new Oz;if(null!=e&&(e+=""),!e)return n;for(var r,a=t.width,i=t.height,o=t.overflow,s="break"!==o&&"breakAll"!==o||null==a?null:{width:a,accumWidth:0,breakAll:"breakAll"===o},u=Tz.lastIndex=0;null!=(r=Tz.exec(e));){var l=r.index;l>u&&Fz(n,e.substring(u,l),t,s),Fz(n,r[2],t,s,r[1]),u=Tz.lastIndex}u<e.length&&Fz(n,e.substring(u,e.length),t,s);var c=[],h=0,p=0,f=t.padding,d="truncate"===o,v="truncate"===t.lineOverflow;function m(e,t,n){e.width=t,e.lineHeight=n,h+=n,p=Math.max(p,t)}e:for(var g=0;g<n.lines.length;g++){for(var y=n.lines[g],b=0,x=0,k=0;k<y.tokens.length;k++){var w=(D=y.tokens[k]).styleName&&t.rich[D.styleName]||{},_=D.textPadding=w.padding,S=_?_[1]+_[3]:0,I=D.font=w.font||t.font;D.contentHeight=Sz(I);var C=pP(w.height,D.contentHeight);if(D.innerHeight=C,_&&(C+=_[0]+_[2]),D.height=C,D.lineHeight=fP(w.lineHeight,t.lineHeight,C),D.align=w&&w.align||t.align,D.verticalAlign=w&&w.verticalAlign||"middle",v&&null!=i&&h+D.lineHeight>i){k>0?(y.tokens=y.tokens.slice(0,k),m(y,x,b),n.lines=n.lines.slice(0,g+1)):n.lines=n.lines.slice(0,g);break e}var T=w.width,N=null==T||"auto"===T;if("string"===typeof T&&"%"===T.charAt(T.length-1))D.percentWidth=T,c.push(D),D.contentWidth=bz(D.text,I);else{if(N){var E=w.backgroundColor,M=E&&E.image;M&&JP(M=ZP(M))&&(D.width=Math.max(D.width,M.width*C/M.height))}var A=d&&null!=a?a-x:null;null!=A&&A<D.width?!N||A<S?(D.text="",D.width=D.contentWidth=0):(D.text=Nz(D.text,A-S,I,t.ellipsis,{minChar:t.truncateMinChar}),D.width=D.contentWidth=bz(D.text,I)):D.contentWidth=bz(D.text,I)}D.width+=S,x+=D.width,w&&(b=Math.max(b,D.lineHeight))}m(y,x,b)}for(n.outerWidth=n.width=pP(a,p),n.outerHeight=n.height=pP(i,h),n.contentHeight=h,n.contentWidth=p,f&&(n.outerWidth+=f[1]+f[3],n.outerHeight+=f[0]+f[2]),g=0;g<c.length;g++){var D,R=(D=c[g]).percentWidth;D.width=parseInt(R,10)/100*n.width}return n}(yU(e),e),n=t.width,r=t.outerWidth,a=t.outerHeight,i=e.padding,o=e.x||0,s=e.y||0,u=this._defaultStyle,l=e.align||u.align,c=e.verticalAlign||u.verticalAlign,h=wz(o,r,l),p=_z(s,a,c),f=h,d=p;i&&(f+=i[3],d+=i[0]);var v=f+n;bU(e)&&this._renderBackground(e,e,h,p,r,a);for(var m=!!e.backgroundColor,g=0;g<t.lines.length;g++){for(var y=t.lines[g],b=y.tokens,x=b.length,k=y.lineHeight,w=y.width,_=0,S=f,I=v,C=x-1,T=void 0;_<x&&(!(T=b[_]).align||"left"===T.align);)this._placeToken(T,e,k,d,S,"left",m),w-=T.width,S+=T.width,_++;for(;C>=0&&"right"===(T=b[C]).align;)this._placeToken(T,e,k,d,I,"right",m),w-=T.width,I-=T.width,C--;for(S+=(n-(S-f)-(v-I)-w)/2;_<=C;)T=b[_],this._placeToken(T,e,k,d,S+T.width/2,"center",m),S+=T.width,_++;d+=k}},t.prototype._placeToken=function(e,t,n,r,a,i,o){var s=t.rich[e.styleName]||{};s.text=e.text;var u=e.verticalAlign,l=r+n/2;"top"===u?l=r+e.height/2:"bottom"===u&&(l=r+n-e.height/2),!e.isLineHolder&&bU(s)&&this._renderBackground(s,t,"right"===i?a-e.width:"center"===i?a-e.width/2:a,l-e.height/2,e.width,e.height);var c=!!s.backgroundColor,h=e.textPadding;h&&(a=gU(a,i,h),l-=e.height/2-h[0]-e.innerHeight/2);var p=this._getOrCreateChild(XW),f=p.createStyle();p.useStyle(f);var d=this._defaultStyle,v=!1,m=0,g=mU("fill"in s?s.fill:"fill"in t?t.fill:(v=!0,d.fill)),y=vU("stroke"in s?s.stroke:"stroke"in t?t.stroke:c||o||d.autoStroke&&!v?null:(m=2,d.stroke)),b=s.textShadowBlur>0||t.textShadowBlur>0;f.text=e.text,f.x=a,f.y=l,b&&(f.shadowBlur=s.textShadowBlur||t.textShadowBlur||0,f.shadowColor=s.textShadowColor||t.textShadowColor||"transparent",f.shadowOffsetX=s.textShadowOffsetX||t.textShadowOffsetX||0,f.shadowOffsetY=s.textShadowOffsetY||t.textShadowOffsetY||0),f.textAlign=i,f.textBaseline="middle",f.font=e.font||_L,f.opacity=fP(s.opacity,t.opacity,1),fU(f,s),y&&(f.lineWidth=fP(s.lineWidth,t.lineWidth,m),f.lineDash=pP(s.lineDash,t.lineDash),f.lineDashOffset=t.lineDashOffset||0,f.stroke=y),g&&(f.fill=g);var x=e.contentWidth,k=e.contentHeight;p.setBoundingRect(new gz(wz(f.x,x,f.textAlign),_z(f.y,k,f.textBaseline),x,k))},t.prototype._renderBackground=function(e,t,n,r,a,i){var o,s,u,l=e.backgroundColor,c=e.borderWidth,h=e.borderColor,p=l&&l.image,f=l&&!p,d=e.borderRadius,v=this;if(f||e.lineHeight||c&&h){(o=this._getOrCreateChild(iU)).useStyle(o.createStyle()),o.style.fill=null;var m=o.shape;m.x=n,m.y=r,m.width=a,m.height=i,m.r=d,o.dirtyShape()}if(f)(u=o.style).fill=l||null,u.fillOpacity=pP(e.fillOpacity,1);else if(p){(s=this._getOrCreateChild(QW)).onload=function(){v.dirtyStyle()};var g=s.style;g.image=l.image,g.x=n,g.y=r,g.width=a,g.height=i}c&&h&&((u=o.style).lineWidth=c,u.stroke=h,u.strokeOpacity=pP(e.strokeOpacity,1),u.lineDash=e.borderDash,u.lineDashOffset=e.borderDashOffset||0,o.strokeContainThreshold=0,o.hasFill()&&o.hasStroke()&&(u.strokeFirst=!0,u.lineWidth*=2));var y=(o||s).style;y.shadowBlur=e.shadowBlur||0,y.shadowColor=e.shadowColor||"transparent",y.shadowOffsetX=e.shadowOffsetX||0,y.shadowOffsetY=e.shadowOffsetY||0,y.opacity=fP(e.opacity,t.opacity,1)},t.makeFont=function(e){var t="";return function(e){return null!=e.fontSize||e.fontFamily||e.fontWeight}(e)&&(t=[e.fontStyle,e.fontWeight,pU(e.fontSize),e.fontFamily||"sans-serif"].join(" ")),t&&gP(t)||e.textFont||e.font},t}(UV),lU={left:!0,right:1,center:1},cU={top:1,bottom:1,middle:1},hU=["fontStyle","fontWeight","fontSize","fontFamily"];function pU(e){return"string"!==typeof e||-1===e.indexOf("px")&&-1===e.indexOf("rem")&&-1===e.indexOf("em")?isNaN(+e)?"12px":e+"px":e}function fU(e,t){for(var n=0;n<hU.length;n++){var r=hU[n],a=t[r];null!=a&&(e[r]=a)}}function dU(e){if(e){e.font=uU.makeFont(e);var t=e.align;"middle"===t&&(t="center"),e.align=null==t||lU[t]?t:"left";var n=e.verticalAlign;"center"===n&&(n="middle"),e.verticalAlign=null==n||cU[n]?n:"top",e.padding&&(e.padding=vP(e.padding))}}function vU(e,t){return null==e||t<=0||"transparent"===e||"none"===e?null:e.image||e.colorStops?"#000":e}function mU(e){return null==e||"none"===e?null:e.image||e.colorStops?"#000":e}function gU(e,t,n){return"right"===t?e-n[1]:"center"===t?e+n[3]/2-n[1]/2:e+n[3]}function yU(e){var t=e.text;return null!=t&&(t+=""),t}function bU(e){return!!(e.backgroundColor||e.lineHeight||e.borderWidth&&e.borderColor)}var xU=uU,kU=1e-4;function wU(e,t,n,r){var a=t[0],i=t[1],o=n[0],s=n[1],u=i-a,l=s-o;if(0===u)return 0===l?o:(o+s)/2;if(r)if(u>0){if(e<=a)return o;if(e>=i)return s}else{if(e>=a)return o;if(e<=i)return s}else{if(e===a)return o;if(e===i)return s}return(e-a)/u*l+o}function _U(e,t){switch(e){case"center":case"middle":e="50%";break;case"left":case"top":e="0%";break;case"right":case"bottom":e="100%"}return nP(e)?(n=e,n.replace(/^\s+|\s+$/g,"")).match(/%$/)?parseFloat(e)/100*t:parseFloat(e):null==e?NaN:+e;var n}function SU(e,t,n){return null==t&&(t=10),t=Math.min(Math.max(0,t),20),e=(+e).toFixed(t),n?e:+e}function IU(e){return e.sort((function(e,t){return e-t})),e}function CU(e){if(e=+e,isNaN(e))return 0;if(e>1e-14)for(var t=1,n=0;n<15;n++,t*=10)if(Math.round(e*t)/t===e)return n;return function(e){var t=e.toString().toLowerCase(),n=t.indexOf("e"),r=n>0?+t.slice(n+1):0,a=n>0?n:t.length,i=t.indexOf("."),o=i<0?0:a-1-i;return Math.max(0,o-r)}(e)}function TU(e,t){var n=Math.max(CU(e),CU(t)),r=e+t;return n>20?r:SU(r,n)}function NU(e){var t=2*Math.PI;return(e%t+t)%t}function EU(e){return e>-1e-4&&e<kU}var MU=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function AU(e){if(e instanceof Date)return e;if(nP(e)){var t=MU.exec(e);if(!t)return new Date(NaN);if(t[8]){var n=+t[4]||0;return"Z"!==t[8].toUpperCase()&&(n-=+t[8].slice(0,3)),new Date(Date.UTC(+t[1],+(t[2]||1)-1,+t[3]||1,n,+(t[5]||0),+t[6]||0,t[7]?+t[7].substring(0,3):0))}return new Date(+t[1],+(t[2]||1)-1,+t[3]||1,+t[4]||0,+(t[5]||0),+t[6]||0,t[7]?+t[7].substring(0,3):0)}return null==e?new Date(NaN):new Date(Math.round(e))}function DU(e){if(0===e)return 0;var t=Math.floor(Math.log(e)/Math.LN10);return e/Math.pow(10,t)>=10&&t++,t}function RU(e,t){var n=DU(e),r=Math.pow(10,n),a=e/r;return e=(t?a<1.5?1:a<2.5?2:a<4?3:a<7?5:10:a<1?1:a<2?2:a<3?3:a<5?5:10)*r,n>=-20?+e.toFixed(n<0?-n:0):e}function OU(e){e.sort((function(e,t){return s(e,t,0)?-1:1}));for(var t=-1/0,n=1,r=0;r<e.length;){for(var a=e[r].interval,i=e[r].close,o=0;o<2;o++)a[o]<=t&&(a[o]=t,i[o]=o?1:1-n),t=a[o],n=i[o];a[0]===a[1]&&i[0]*i[1]!==1?e.splice(r,1):r++}return e;function s(e,t,n){return e.interval[n]<t.interval[n]||e.interval[n]===t.interval[n]&&(e.close[n]-t.close[n]===(n?-1:1)||!n&&s(e,t,1))}}function FU(e){var t=parseFloat(e);return t==e&&(0!==t||!nP(e)||e.indexOf("x")<=0)?t:NaN}function LU(){return Math.round(9*Math.random())}function PU(e,t){return 0===t?e:PU(t,e%t)}function zU(e,t){return null==e?t:null==t?e:e*t/PU(e,t)}function BU(e,t,n){return(t-e)*n+e}var VU="series\0",WU="\0_ec_\0";function UU(e){return e instanceof Array?e:null==e?[]:[e]}function HU(e,t,n){if(e){e[t]=e[t]||{},e.emphasis=e.emphasis||{},e.emphasis[t]=e.emphasis[t]||{};for(var r=0,a=n.length;r<a;r++){var i=n[r];!e.emphasis[t].hasOwnProperty(i)&&e[t].hasOwnProperty(i)&&(e.emphasis[t][i]=e[t][i])}}}var GU=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function jU(e){return!iP(e)||eP(e)||e instanceof Date?e:e.value}function qU(e){return iP(e)&&!(e instanceof Array)}function XU(e,t,n){var r="normalMerge"===n,a="replaceMerge"===n,i="replaceAll"===n;e=e||[],t=(t||[]).slice();var o=wP();XL(t,(function(e,n){iP(e)||(t[n]=null)}));var s=function(e,t,n){var r=[];if("replaceAll"===n)return r;for(var a=0;a<e.length;a++){var i=e[a];i&&null!=i.id&&t.set(i.id,a),r.push({existing:"replaceMerge"===n||$U(i)?null:i,newOption:null,keyInfo:null,brandNew:null})}return r}(e,o,n);return(r||a)&&function(e,t,n,r){XL(r,(function(a,i){if(a&&null!=a.id){var o=YU(a.id),s=n.get(o);if(null!=s){var u=e[s];mP(!u.newOption,'Duplicated option on id "'+o+'".'),u.newOption=a,u.existing=t[s],r[i]=null}}}))}(s,e,o,t),r&&function(e,t){XL(t,(function(n,r){if(n&&null!=n.name)for(var a=0;a<e.length;a++){var i=e[a].existing;if(!e[a].newOption&&i&&(null==i.id||null==n.id)&&!$U(n)&&!$U(i)&&KU("name",i,n))return e[a].newOption=n,void(t[r]=null)}}))}(s,t),r||a?function(e,t,n){XL(t,(function(t){if(t){for(var r,a=0;(r=e[a])&&(r.newOption||$U(r.existing)||r.existing&&null!=t.id&&!KU("id",t,r.existing));)a++;r?(r.newOption=t,r.brandNew=n):e.push({newOption:t,brandNew:n,existing:null,keyInfo:null}),a++}}))}(s,t,a):i&&function(e,t){XL(t,(function(t){e.push({newOption:t,brandNew:!0,existing:null,keyInfo:null})}))}(s,t),function(e){var t=wP();XL(e,(function(e){var n=e.existing;n&&t.set(n.id,e)})),XL(e,(function(e){var n=e.newOption;mP(!n||null==n.id||!t.get(n.id)||t.get(n.id)===e,"id duplicates: "+(n&&n.id)),n&&null!=n.id&&t.set(n.id,e),!e.keyInfo&&(e.keyInfo={})})),XL(e,(function(e,n){var r=e.existing,a=e.newOption,i=e.keyInfo;if(iP(a)){if(i.name=null!=a.name?YU(a.name):r?r.name:VU+n,r)i.id=YU(r.id);else if(null!=a.id)i.id=YU(a.id);else{var o=0;do{i.id="\0"+i.name+"\0"+o++}while(t.get(i.id))}t.set(i.id,e)}}))}(s),s}function KU(e,t,n){var r=ZU(t[e],null),a=ZU(n[e],null);return null!=r&&null!=a&&r===a}function YU(e){return ZU(e,"")}function ZU(e,t){return null==e?t:nP(e)?e:aP(e)||rP(e)?e+"":t}function QU(e){var t=e.name;return!(!t||!t.indexOf(VU))}function $U(e){return e&&null!=e.id&&0===YU(e.id).indexOf(WU)}function JU(e,t){return null!=t.dataIndexInside?t.dataIndexInside:null!=t.dataIndex?eP(t.dataIndex)?KL(t.dataIndex,(function(t){return e.indexOfRawIndex(t)})):e.indexOfRawIndex(t.dataIndex):null!=t.name?eP(t.name)?KL(t.name,(function(t){return e.indexOfName(t)})):e.indexOfName(t.name):void 0}function eH(){var e="__ec_inner_"+tH++;return function(t){return t[e]||(t[e]={})}}var tH=LU();function nH(e,t,n){var r=rH(t,n),a=r.mainTypeSpecified,i=r.queryOptionMap,o=r.others,s=n?n.defaultMainType:null;return!a&&s&&i.set(s,{}),i.each((function(t,r){var a=iH(e,r,t,{useDefault:s===r,enableAll:!n||null==n.enableAll||n.enableAll,enableNone:!n||null==n.enableNone||n.enableNone});o[r+"Models"]=a.models,o[r+"Model"]=a.models[0]})),o}function rH(e,t){var n;if(nP(e)){var r={};r[e+"Index"]=0,n=r}else n=e;var a=wP(),i={},o=!1;return XL(n,(function(e,n){if("dataIndex"!==n&&"dataIndexInside"!==n){var r=n.match(/^(\w+)(Index|Id|Name)$/)||[],s=r[1],u=(r[2]||"").toLowerCase();if(s&&u&&!(t&&t.includeMainTypes&&GL(t.includeMainTypes,s)<0))o=o||!!s,(a.get(s)||a.set(s,{}))[u]=e}else i[n]=e})),{mainTypeSpecified:o,queryOptionMap:a,others:i}}var aH={useDefault:!0,enableAll:!1,enableNone:!1};function iH(e,t,n,r){r=r||aH;var a=n.index,i=n.id,o=n.name,s={models:null,specified:null!=a||null!=i||null!=o};if(!s.specified){var u=void 0;return s.models=r.useDefault&&(u=e.getComponent(t))?[u]:[],s}return"none"===a||!1===a?(mP(r.enableNone,'`"none"` or `false` is not a valid value on index option.'),s.models=[],s):("all"===a&&(mP(r.enableAll,'`"all"` is not a valid value on index option.'),a=i=o=null),s.models=e.queryComponents({mainType:t,index:a,id:i,name:o}),s)}function oH(e,t,n){e.setAttribute?e.setAttribute(t,n):e[t]=n}var sH=eH(),uH=1,lH={},cH=eH(),hH=eH(),pH=["emphasis","blur","select"],fH=["normal","emphasis","blur","select"],dH="highlight",vH="downplay",mH="select",gH="unselect",yH="toggleSelect";function bH(e){return null!=e&&"none"!==e}var xH=new KP(100);function kH(e){if(nP(e)){var t=xH.get(e);return t||(t=ZB(e,-.1),xH.put(e,t)),t}if(lP(e)){var n=UL({},e);return n.colorStops=KL(e.colorStops,(function(e){return{offset:e.offset,color:ZB(e.color,-.1)}})),n}return e}function wH(e,t,n){e.onHoverStateChange&&(e.hoverState||0)!==n&&e.onHoverStateChange(t),e.hoverState=n}function _H(e){wH(e,"emphasis",2)}function SH(e){2===e.hoverState&&wH(e,"normal",0)}function IH(e){wH(e,"blur",1)}function CH(e){1===e.hoverState&&wH(e,"normal",0)}function TH(e){e.selected=!0}function NH(e){e.selected=!1}function EH(e,t,n){t(e,n)}function MH(e,t,n){EH(e,t,n),e.isGroup&&e.traverse((function(e){EH(e,t,n)}))}function AH(e,t){switch(t){case"emphasis":e.hoverState=2;break;case"normal":e.hoverState=0;break;case"blur":e.hoverState=1;break;case"select":e.selected=!0}}function DH(e,t){var n=this.states[e];if(this.style){if("emphasis"===e)return function(e,t,n,r){var a=n&&GL(n,"select")>=0,i=!1;if(e instanceof GW){var o=cH(e),s=a&&o.selectFill||o.normalFill,u=a&&o.selectStroke||o.normalStroke;if(bH(s)||bH(u)){var l=(r=r||{}).style||{};"inherit"===l.fill?(i=!0,r=UL({},r),(l=UL({},l)).fill=s):!bH(l.fill)&&bH(s)?(i=!0,r=UL({},r),(l=UL({},l)).fill=kH(s)):!bH(l.stroke)&&bH(u)&&(i||(r=UL({},r),l=UL({},l)),l.stroke=kH(u)),r.style=l}}if(r&&null==r.z2){i||(r=UL({},r));var c=e.z2EmphasisLift;r.z2=e.z2+(null!=c?c:10)}return r}(this,0,t,n);if("blur"===e)return function(e,t,n){var r=GL(e.currentStates,t)>=0,a=e.style.opacity,i=r?null:function(e,t,n,r){for(var a=e.style,i={},o=0;o<t.length;o++){var s=t[o],u=a[s];i[s]=null==u?r&&r[s]:u}for(o=0;o<e.animators.length;o++){var l=e.animators[o];l.__fromStateTransition&&l.__fromStateTransition.indexOf(n)<0&&"style"===l.targetName&&l.saveTo(i,t)}return i}(e,["opacity"],t,{opacity:1}),o=(n=n||{}).style||{};return null==o.opacity&&(n=UL({},n),o=UL({opacity:r?a:.1*i.opacity},o),n.style=o),n}(this,e,n);if("select"===e)return function(e,t,n){if(n&&null==n.z2){n=UL({},n);var r=e.z2SelectLift;n.z2=e.z2+(null!=r?r:9)}return n}(this,0,n)}return n}function RH(e){e.stateProxy=DH;var t=e.getTextContent(),n=e.getTextGuideLine();t&&(t.stateProxy=DH),n&&(n.stateProxy=DH)}function OH(e,t){!WH(e,t)&&!e.__highByOuter&&MH(e,_H)}function FH(e,t){!WH(e,t)&&!e.__highByOuter&&MH(e,SH)}function LH(e,t){e.__highByOuter|=1<<(t||0),MH(e,_H)}function PH(e,t){!(e.__highByOuter&=~(1<<(t||0)))&&MH(e,SH)}function zH(e){MH(e,CH)}function BH(e){MH(e,TH)}function VH(e){MH(e,NH)}function WH(e,t){return e.__highDownSilentOnTouch&&t.zrByTouch}function UH(e){var t=e.getModel(),n=[],r=[];t.eachComponent((function(t,a){var i=hH(a),o="series"===t,s=o?e.getViewOfSeriesModel(a):e.getViewOfComponentModel(a);!o&&r.push(s),i.isBlured&&(s.group.traverse((function(e){CH(e)})),o&&n.push(a)),i.isBlured=!1})),XL(r,(function(e){e&&e.toggleBlurSeries&&e.toggleBlurSeries(n,!1,t)}))}function HH(e,t,n,r){var a=r.getModel();function i(e,t){for(var n=0;n<t.length;n++){var r=e.getItemGraphicEl(t[n]);r&&zH(r)}}if(n=n||"coordinateSystem",null!=e&&t&&"none"!==t){var o=a.getSeriesByIndex(e),s=o.coordinateSystem;s&&s.master&&(s=s.master);var u=[];a.eachSeries((function(e){var a=o===e,l=e.coordinateSystem;if(l&&l.master&&(l=l.master),!("series"===n&&!a||"coordinateSystem"===n&&!(l&&s?l===s:a)||"series"===t&&a)){if(r.getViewOfSeriesModel(e).group.traverse((function(e){IH(e)})),qL(t))i(e.getData(),t);else if(iP(t))for(var c=QL(t),h=0;h<c.length;h++)i(e.getData(c[h]),t[c[h]]);u.push(e),hH(e).isBlured=!0}})),a.eachComponent((function(e,t){if("series"!==e){var n=r.getViewOfComponentModel(t);n&&n.toggleBlurSeries&&n.toggleBlurSeries(u,!0,a)}}))}}function GH(e,t,n){if(null!=e&&null!=t){var r=n.getModel().getComponent(e,t);if(r){hH(r).isBlured=!0;var a=n.getViewOfComponentModel(r);a&&a.focusBlurEnabled&&a.group.traverse((function(e){IH(e)}))}}}function jH(e,t,n,r){var a={focusSelf:!1,dispatchers:null};if(null==e||"series"===e||null==t||null==n)return a;var i=r.getModel().getComponent(e,t);if(!i)return a;var o=r.getViewOfComponentModel(i);if(!o||!o.findHighDownDispatchers)return a;for(var s,u=o.findHighDownDispatchers(n),l=0;l<u.length;l++)if("self"===sH(u[l]).focus){s=!0;break}return{focusSelf:s,dispatchers:u}}function qH(e){XL(e.getAllData(),(function(t){var n=t.data,r=t.type;n.eachItemGraphicEl((function(t,n){e.isSelected(n,r)?BH(t):VH(t)}))}))}function XH(e){var t=[];return e.eachSeries((function(e){XL(e.getAllData(),(function(n){n.data;var r=n.type,a=e.getSelectedDataIndices();if(a.length>0){var i={dataIndex:a,seriesIndex:e.seriesIndex};null!=r&&(i.dataType=r),t.push(i)}}))})),t}function KH(e,t,n){JH(e,!0),MH(e,RH),function(e,t,n){var r=sH(e);null!=t?(r.focus=t,r.blurScope=n):r.focus&&(r.focus=null)}(e,t,n)}function YH(e,t,n,r){r?function(e){JH(e,!1)}(e):KH(e,t,n)}var ZH=["emphasis","blur","select"],QH={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function $H(e,t,n,r){n=n||"itemStyle";for(var a=0;a<ZH.length;a++){var i=ZH[a],o=t.getModel([i,n]);e.ensureState(i).style=r?r(o):o[QH[n]]()}}function JH(e,t){var n=!1===t,r=e;e.highDownSilentOnTouch&&(r.__highDownSilentOnTouch=e.highDownSilentOnTouch),n&&!r.__highDownDispatcher||(r.__highByOuter=r.__highByOuter||0,r.__highDownDispatcher=!n)}function eG(e){return!(!e||!e.__highDownDispatcher)}function tG(e){var t=e.type;return t===mH||t===gH||t===yH}function nG(e){var t=e.type;return t===dH||t===vH}var rG={};function aG(e,t){for(var n=0;n<pH.length;n++){var r=pH[n],a=t[r],i=e.ensureState(r);i.style=i.style||{},i.style.text=a}var o=e.currentStates.slice();e.clearStates(!0),e.setStyle({text:t.normal}),e.useStates(o,!0)}function iG(e,t,n){var r,a=e.labelFetcher,i=e.labelDataIndex,o=e.labelDimIndex,s=t.normal;a&&(r=a.getFormattedLabel(i,"normal",null,o,s&&s.get("formatter"),null!=n?{interpolatedValue:n}:null)),null==r&&(r=tP(e.defaultText)?e.defaultText(i,e,n):e.defaultText);for(var u={normal:r},l=0;l<pH.length;l++){var c=pH[l],h=t[c];u[c]=pP(a?a.getFormattedLabel(i,c,null,o,h&&h.get("formatter")):null,r)}return u}function oG(e,t,n,r){n=n||rG;for(var a=e instanceof xU,i=!1,o=0;o<fH.length;o++){if((p=t[fH[o]])&&p.getShallow("show")){i=!0;break}}var s=a?e:e.getTextContent();if(i){a||(s||(s=new xU,e.setTextContent(s)),e.stateProxy&&(s.stateProxy=e.stateProxy));var u=iG(n,t),l=t.normal,c=!!l.getShallow("show"),h=uG(l,r&&r.normal,n,!1,!a);h.text=u.normal,a||e.setTextConfig(lG(l,n,!1));for(o=0;o<pH.length;o++){var p,f=pH[o];if(p=t[f]){var d=s.ensureState(f),v=!!pP(p.getShallow("show"),c);if(v!==c&&(d.ignore=!v),d.style=uG(p,r&&r[f],n,!0,!a),d.style.text=u[f],!a)e.ensureState(f).textConfig=lG(p,n,!0)}}s.silent=!!l.getShallow("silent"),null!=s.style.x&&(h.x=s.style.x),null!=s.style.y&&(h.y=s.style.y),s.ignore=!c,s.useStyle(h),s.dirty(),n.enableTextSetter&&(dG(s).setLabelText=function(e){var r=iG(n,t,e);aG(s,r)})}else s&&(s.ignore=!0);e.dirty()}function sG(e,t){t=t||"label";for(var n={normal:e.getModel(t)},r=0;r<pH.length;r++){var a=pH[r];n[a]=e.getModel([a,t])}return n}function uG(e,t,n,r,a){var i={};return function(e,t,n,r,a){n=n||rG;var i,o=t.ecModel,s=o&&o.option.textStyle,u=function(e){var t;for(;e&&e!==e.ecModel;){var n=(e.option||rG).rich;if(n){t=t||{};for(var r=QL(n),a=0;a<r.length;a++){t[r[a]]=1}}e=e.parentModel}return t}(t);if(u)for(var l in i={},u)if(u.hasOwnProperty(l)){var c=t.getModel(["rich",l]);fG(i[l]={},c,s,n,r,a,!1,!0)}i&&(e.rich=i);var h=t.get("overflow");h&&(e.overflow=h);var p=t.get("minMargin");null!=p&&(e.margin=p);fG(e,t,s,n,r,a,!0,!1)}(i,e,n,r,a),t&&UL(i,t),i}function lG(e,t,n){t=t||{};var r,a={},i=e.getShallow("rotate"),o=pP(e.getShallow("distance"),n?null:5),s=e.getShallow("offset");return"outside"===(r=e.getShallow("position")||(n?null:"inside"))&&(r=t.defaultOutsidePosition||"top"),null!=r&&(a.position=r),null!=s&&(a.offset=s),null!=i&&(i*=Math.PI/180,a.rotation=i),null!=o&&(a.distance=o),a.outsideFill="inherit"===e.get("color")?t.inheritColor||null:"auto",a}var cG=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],hG=["align","lineHeight","width","height","tag","verticalAlign"],pG=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function fG(e,t,n,r,a,i,o,s){n=!a&&n||rG;var u=r&&r.inheritColor,l=t.getShallow("color"),c=t.getShallow("textBorderColor"),h=pP(t.getShallow("opacity"),n.opacity);"inherit"!==l&&"auto"!==l||(l=u||null),"inherit"!==c&&"auto"!==c||(c=u||null),i||(l=l||n.color,c=c||n.textBorderColor),null!=l&&(e.fill=l),null!=c&&(e.stroke=c);var p=pP(t.getShallow("textBorderWidth"),n.textBorderWidth);null!=p&&(e.lineWidth=p);var f=pP(t.getShallow("textBorderType"),n.textBorderType);null!=f&&(e.lineDash=f);var d=pP(t.getShallow("textBorderDashOffset"),n.textBorderDashOffset);null!=d&&(e.lineDashOffset=d),a||null!=h||s||(h=r&&r.defaultOpacity),null!=h&&(e.opacity=h),a||i||null==e.fill&&r.inheritColor&&(e.fill=r.inheritColor);for(var v=0;v<cG.length;v++){var m=cG[v];null!=(y=pP(t.getShallow(m),n[m]))&&(e[m]=y)}for(v=0;v<hG.length;v++){m=hG[v];null!=(y=t.getShallow(m))&&(e[m]=y)}if(null==e.verticalAlign){var g=t.getShallow("baseline");null!=g&&(e.verticalAlign=g)}if(!o||!r.disableBox){for(v=0;v<pG.length;v++){var y;m=pG[v];null!=(y=t.getShallow(m))&&(e[m]=y)}var b=t.getShallow("borderType");null!=b&&(e.borderDash=b),"auto"!==e.backgroundColor&&"inherit"!==e.backgroundColor||!u||(e.backgroundColor=u),"auto"!==e.borderColor&&"inherit"!==e.borderColor||!u||(e.borderColor=u)}}var dG=eH();var vG=["textStyle","color"],mG=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],gG=new xU,yG=function(){function e(){}return e.prototype.getTextColor=function(e){var t=this.ecModel;return this.getShallow("color")||(!e&&t?t.get(vG):null)},e.prototype.getFont=function(){return function(e,t){var n=t&&t.getModel("textStyle");return gP([e.fontStyle||n&&n.getShallow("fontStyle")||"",e.fontWeight||n&&n.getShallow("fontWeight")||"",(e.fontSize||n&&n.getShallow("fontSize")||12)+"px",e.fontFamily||n&&n.getShallow("fontFamily")||"sans-serif"].join(" "))}({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},e.prototype.getTextRect=function(e){for(var t={text:e,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},n=0;n<mG.length;n++)t[mG[n]]=this.getShallow(mG[n]);return gG.useStyle(t),gG.update(),gG.getBoundingRect()},e}(),bG=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],xG=VP(bG),kG=function(){function e(){}return e.prototype.getLineStyle=function(e){return xG(this,e)},e}(),wG=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],_G=VP(wG),SG=function(){function e(){}return e.prototype.getItemStyle=function(e,t){return _G(this,e,t)},e}(),IG=function(){function e(e,t,n){this.parentModel=t,this.ecModel=n,this.option=e}return e.prototype.init=function(e,t,n){for(var r=[],a=3;a<arguments.length;a++)r[a-3]=arguments[a]},e.prototype.mergeOption=function(e,t){WL(this.option,e,!0)},e.prototype.get=function(e,t){return null==e?this.option:this._doGet(this.parsePath(e),!t&&this.parentModel)},e.prototype.getShallow=function(e,t){var n=this.option,r=null==n?n:n[e];if(null==r&&!t){var a=this.parentModel;a&&(r=a.getShallow(e))}return r},e.prototype.getModel=function(t,n){var r=null!=t,a=r?this.parsePath(t):null;return new e(r?this._doGet(a):this.option,n=n||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(a)),this.ecModel)},e.prototype.isEmpty=function(){return null==this.option},e.prototype.restoreData=function(){},e.prototype.clone=function(){return new(0,this.constructor)(VL(this.option))},e.prototype.parsePath=function(e){return"string"===typeof e?e.split("."):e},e.prototype.resolveParentPath=function(e){return e},e.prototype.isAnimationEnabled=function(){if(!MP.node&&this.option){if(null!=this.option.animation)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},e.prototype._doGet=function(e,t){var n=this.option;if(!e)return n;for(var r=0;r<e.length&&(!e[r]||null!=(n=n&&"object"===typeof n?n[e[r]]:null));r++);return null==n&&t&&(n=t._doGet(this.resolveParentPath(e),t.parentModel)),n},e}();OP(IG),function(e){var t=["__\0is_clz",LP++].join("_");e.prototype[t]=!0,e.isInstance=function(e){return!(!e||!e[t])}}(IG),jL(IG,kG),jL(IG,SG),jL(IG,UP),jL(IG,yG);var CG=IG;function TG(e){return null==e?0:e.length||1}function NG(e){return e}var EG=function(){function e(e,t,n,r,a,i){this._old=e,this._new=t,this._oldKeyGetter=n||NG,this._newKeyGetter=r||NG,this.context=a,this._diffModeMultiple="multiple"===i}return e.prototype.add=function(e){return this._add=e,this},e.prototype.update=function(e){return this._update=e,this},e.prototype.updateManyToOne=function(e){return this._updateManyToOne=e,this},e.prototype.updateOneToMany=function(e){return this._updateOneToMany=e,this},e.prototype.updateManyToMany=function(e){return this._updateManyToMany=e,this},e.prototype.remove=function(e){return this._remove=e,this},e.prototype.execute=function(){this[this._diffModeMultiple?"_executeMultiple":"_executeOneToOne"]()},e.prototype._executeOneToOne=function(){var e=this._old,t=this._new,n={},r=new Array(e.length),a=new Array(t.length);this._initIndexMap(e,null,r,"_oldKeyGetter"),this._initIndexMap(t,n,a,"_newKeyGetter");for(var i=0;i<e.length;i++){var o=r[i],s=n[o],u=TG(s);if(u>1){var l=s.shift();1===s.length&&(n[o]=s[0]),this._update&&this._update(l,i)}else 1===u?(n[o]=null,this._update&&this._update(s,i)):this._remove&&this._remove(i)}this._performRestAdd(a,n)},e.prototype._executeMultiple=function(){var e=this._old,t=this._new,n={},r={},a=[],i=[];this._initIndexMap(e,n,a,"_oldKeyGetter"),this._initIndexMap(t,r,i,"_newKeyGetter");for(var o=0;o<a.length;o++){var s=a[o],u=n[s],l=r[s],c=TG(u),h=TG(l);if(c>1&&1===h)this._updateManyToOne&&this._updateManyToOne(l,u),r[s]=null;else if(1===c&&h>1)this._updateOneToMany&&this._updateOneToMany(l,u),r[s]=null;else if(1===c&&1===h)this._update&&this._update(l,u),r[s]=null;else if(c>1&&h>1)this._updateManyToMany&&this._updateManyToMany(l,u),r[s]=null;else if(c>1)for(var p=0;p<c;p++)this._remove&&this._remove(u[p]);else this._remove&&this._remove(u)}this._performRestAdd(i,r)},e.prototype._performRestAdd=function(e,t){for(var n=0;n<e.length;n++){var r=e[n],a=t[r],i=TG(a);if(i>1)for(var o=0;o<i;o++)this._add&&this._add(a[o]);else 1===i&&this._add&&this._add(a);t[r]=null}},e.prototype._initIndexMap=function(e,t,n,r){for(var a=this._diffModeMultiple,i=0;i<e.length;i++){var o="_ec_"+this[r](e[i],i);if(a||(n[i]=o),t){var s=t[o],u=TG(s);0===u?(t[o]=i,a&&n.push(o)):1===u?t[o]=[s,i]:s.push(i)}}},e}(),MG=EG,AG=wP(["tooltip","label","itemName","itemId","itemGroupId","seriesName"]),DG="original",RG="arrayRows",OG="objectRows",FG="keyedColumns",LG="typedArray",PG="unknown",zG="column",BG="row",VG=1,WG=2,UG=3,HG=eH();function GG(e,t,n){var r={},a=jG(t);if(!a||!e)return r;var i,o,s=[],u=[],l=t.ecModel,c=HG(l).datasetMap,h=a.uid+"_"+n.seriesLayoutBy;XL(e=e.slice(),(function(t,n){var a=iP(t)?t:e[n]={name:t};"ordinal"===a.type&&null==i&&(i=n,o=d(a)),r[a.name]=[]}));var p=c.get(h)||c.set(h,{categoryWayDim:o,valueWayDim:0});function f(e,t,n){for(var r=0;r<n;r++)e.push(t+r)}function d(e){var t=e.dimsDef;return t?t.length:1}return XL(e,(function(e,t){var n=e.name,a=d(e);if(null==i){var o=p.valueWayDim;f(r[n],o,a),f(u,o,a),p.valueWayDim+=a}else if(i===t)f(r[n],0,a),f(s,0,a);else{o=p.categoryWayDim;f(r[n],o,a),f(u,o,a),p.categoryWayDim+=a}})),s.length&&(r.itemName=s),u.length&&(r.seriesName=u),r}function jG(e){if(!e.get("data",!0))return iH(e.ecModel,"dataset",{index:e.get("datasetIndex",!0),id:e.get("datasetId",!0)},aH).models[0]}function qG(e,t){return XG(e.data,e.sourceFormat,e.seriesLayoutBy,e.dimensionsDefine,e.startIndex,t)}function XG(e,t,n,r,a,i){var o,s,u;if(sP(e))return UG;if(r){var l=r[i];iP(l)?(s=l.name,u=l.type):nP(l)&&(s=l)}if(null!=u)return"ordinal"===u?VG:UG;if(t===RG){var c=e;if(n===BG){for(var h=c[i],p=0;p<(h||[]).length&&p<5;p++)if(null!=(o=y(h[a+p])))return o}else for(p=0;p<c.length&&p<5;p++){var f=c[a+p];if(f&&null!=(o=y(f[i])))return o}}else if(t===OG){var d=e;if(!s)return UG;for(p=0;p<d.length&&p<5;p++){if((m=d[p])&&null!=(o=y(m[s])))return o}}else if(t===FG){if(!s)return UG;if(!(h=e[s])||sP(h))return UG;for(p=0;p<h.length&&p<5;p++)if(null!=(o=y(h[p])))return o}else if(t===DG){var v=e;for(p=0;p<v.length&&p<5;p++){var m,g=jU(m=v[p]);if(!eP(g))return UG;if(null!=(o=y(g[i])))return o}}function y(e){var t=nP(e);return null!=e&&isFinite(e)&&""!==e?t?WG:UG:t&&"-"!==e?VG:void 0}return UG}var KG,YG,ZG,QG,$G,JG=function(e){this.data=e.data||(e.sourceFormat===FG?{}:[]),this.sourceFormat=e.sourceFormat||PG,this.seriesLayoutBy=e.seriesLayoutBy||zG,this.startIndex=e.startIndex||0,this.dimensionsDetectedCount=e.dimensionsDetectedCount,this.metaRawOption=e.metaRawOption;var t=this.dimensionsDefine=e.dimensionsDefine;if(t)for(var n=0;n<t.length;n++){var r=t[n];null==r.type&&qG(this,n)===VG&&(r.type="ordinal")}};function ej(e){return e instanceof JG}function tj(e,t,n){n=n||rj(e);var r=t.seriesLayoutBy,a=function(e,t,n,r,a){var i,o;if(!e)return{dimensionsDefine:aj(a),startIndex:o,dimensionsDetectedCount:i};if(t===RG){var s=e;"auto"===r||null==r?ij((function(e){null!=e&&"-"!==e&&(nP(e)?null==o&&(o=1):o=0)}),n,s,10):o=aP(r)?r:r?1:0,a||1!==o||(a=[],ij((function(e,t){a[t]=null!=e?e+"":""}),n,s,1/0)),i=a?a.length:n===BG?s.length:s[0]?s[0].length:null}else if(t===OG)a||(a=function(e){var t,n=0;for(;n<e.length&&!(t=e[n++]););if(t){var r=[];return XL(t,(function(e,t){r.push(t)})),r}}(e));else if(t===FG)a||(a=[],XL(e,(function(e,t){a.push(t)})));else if(t===DG){var u=jU(e[0]);i=eP(u)&&u.length||1}return{startIndex:o,dimensionsDefine:aj(a),dimensionsDetectedCount:i}}(e,n,r,t.sourceHeader,t.dimensions);return new JG({data:e,sourceFormat:n,seriesLayoutBy:r,dimensionsDefine:a.dimensionsDefine,startIndex:a.startIndex,dimensionsDetectedCount:a.dimensionsDetectedCount,metaRawOption:VL(t)})}function nj(e){return new JG({data:e,sourceFormat:sP(e)?LG:DG})}function rj(e){var t=PG;if(sP(e))t=LG;else if(eP(e)){0===e.length&&(t=RG);for(var n=0,r=e.length;n<r;n++){var a=e[n];if(null!=a){if(eP(a)){t=RG;break}if(iP(a)){t=OG;break}}}}else if(iP(e))for(var i in e)if(IP(e,i)&&qL(e[i])){t=FG;break}return t}function aj(e){if(e){var t=wP();return KL(e,(function(e,n){var r={name:(e=iP(e)?e:{name:e}).name,displayName:e.displayName,type:e.type};if(null==r.name)return r;r.name+="",null==r.displayName&&(r.displayName=r.name);var a=t.get(r.name);return a?r.name+="-"+a.count++:t.set(r.name,{count:1}),r}))}}function ij(e,t,n,r){if(t===BG)for(var a=0;a<n.length&&a<r;a++)e(n[a]?n[a][0]:null,a);else{var i=n[0]||[];for(a=0;a<i.length&&a<r;a++)e(i[a],a)}}function oj(e){var t=e.sourceFormat;return t===OG||t===FG}var sj=function(){function e(e,t){var n=ej(e)?e:nj(e);this._source=n;var r=this._data=n.data;n.sourceFormat===LG&&(this._offset=0,this._dimSize=t,this._data=r),$G(this,r,n)}return e.prototype.getSource=function(){return this._source},e.prototype.count=function(){return 0},e.prototype.getItem=function(e,t){},e.prototype.appendData=function(e){},e.prototype.clean=function(){},e.protoInitialize=function(){var t=e.prototype;t.pure=!1,t.persistent=!0}(),e.internalField=function(){var e;$G=function(e,a,i){var o=i.sourceFormat,s=i.seriesLayoutBy,u=i.startIndex,l=i.dimensionsDefine;if(UL(e,QG[gj(o,s)]),o===LG)e.getItem=t,e.count=r,e.fillStorage=n;else{var c=cj(o,s);e.getItem=$L(c,null,a,u,l);var h=fj(o,s);e.count=$L(h,null,a,u,l)}};var t=function(e,t){e-=this._offset,t=t||[];for(var n=this._data,r=this._dimSize,a=r*e,i=0;i<r;i++)t[i]=n[a+i];return t},n=function(e,t,n,r){for(var a=this._data,i=this._dimSize,o=0;o<i;o++){for(var s=r[o],u=null==s[0]?1/0:s[0],l=null==s[1]?-1/0:s[1],c=t-e,h=n[o],p=0;p<c;p++){var f=a[p*i+o];h[e+p]=f,f<u&&(u=f),f>l&&(l=f)}s[0]=u,s[1]=l}},r=function(){return this._data?this._data.length/this._dimSize:0};function a(e){for(var t=0;t<e.length;t++)this._data.push(e[t])}(e={}).arrayRows_column={pure:!0,appendData:a},e.arrayRows_row={pure:!0,appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},e.objectRows={pure:!0,appendData:a},e.keyedColumns={pure:!0,appendData:function(e){var t=this._data;XL(e,(function(e,n){for(var r=t[n]||(t[n]=[]),a=0;a<(e||[]).length;a++)r.push(e[a])}))}},e.original={appendData:a},e.typedArray={persistent:!1,pure:!0,appendData:function(e){this._data=e},clean:function(){this._offset+=this.count(),this._data=null}},QG=e}(),e}(),uj=function(e,t,n,r){return e[r]},lj=((KG={}).arrayRows_column=function(e,t,n,r){return e[r+t]},KG.arrayRows_row=function(e,t,n,r,a){r+=t;for(var i=a||[],o=e,s=0;s<o.length;s++){var u=o[s];i[s]=u?u[r]:null}return i},KG.objectRows=uj,KG.keyedColumns=function(e,t,n,r,a){for(var i=a||[],o=0;o<n.length;o++){0;var s=e[n[o].name];i[o]=s?s[r]:null}return i},KG.original=uj,KG);function cj(e,t){return lj[gj(e,t)]}var hj=function(e,t,n){return e.length},pj=((YG={}).arrayRows_column=function(e,t,n){return Math.max(0,e.length-t)},YG.arrayRows_row=function(e,t,n){var r=e[0];return r?Math.max(0,r.length-t):0},YG.objectRows=hj,YG.keyedColumns=function(e,t,n){var r=e[n[0].name];return r?r.length:0},YG.original=hj,YG);function fj(e,t){return pj[gj(e,t)]}var dj=function(e,t,n){return e[t]},vj=((ZG={}).arrayRows=dj,ZG.objectRows=function(e,t,n){return e[n]},ZG.keyedColumns=dj,ZG.original=function(e,t,n){var r=jU(e);return r instanceof Array?r[t]:r},ZG.typedArray=dj,ZG);function mj(e){return vj[e]}function gj(e,t){return e===RG?e+"_"+t:e}function yj(e,t,n){if(e){var r=e.getRawDataItem(t);if(null!=r){var a=e.getStore(),i=a.getSource().sourceFormat;if(null!=n){var o=e.getDimensionIndex(n),s=a.getDimensionProperty(o);return mj(i)(r,o,s)}var u=r;return i===DG&&(u=jU(r)),u}}}var bj=function(){function e(e,t){this._encode=e,this._schema=t}return e.prototype.get=function(){return{fullDimensions:this._getFullDimensionNames(),encode:this._encode}},e.prototype._getFullDimensionNames=function(){return this._cachedDimNames||(this._cachedDimNames=this._schema?this._schema.makeOutputDimensionNames():[]),this._cachedDimNames},e}();function xj(e,t){return e.hasOwnProperty(t)||(e[t]=[]),e[t]}var kj=function(e){this.otherDims={},null!=e&&UL(this,e)};"undefined"!==typeof console&&console.warn&&console.log;function wj(e){0}function _j(e){throw new Error(e)}function Sj(e,t){var n=t&&t.type;return"ordinal"===n?e:("time"!==n||aP(e)||null==e||"-"===e||(e=+AU(e)),null==e||""===e?NaN:+e)}wP({number:function(e){return parseFloat(e)},time:function(e){return+AU(e)},trim:function(e){return nP(e)?gP(e):e}});var Ij={lt:function(e,t){return e<t},lte:function(e,t){return e<=t},gt:function(e,t){return e>t},gte:function(e,t){return e>=t}},Cj=(function(){function e(e,t){if(!aP(t)){0,_j("")}this._opFn=Ij[e],this._rvalFloat=FU(t)}e.prototype.evaluate=function(e){return aP(e)?this._opFn(e,this._rvalFloat):this._opFn(FU(e),this._rvalFloat)}}(),function(){function e(e,t){var n="desc"===e;this._resultLT=n?1:-1,null==t&&(t=n?"min":"max"),this._incomparable="min"===t?-1/0:1/0}return e.prototype.evaluate=function(e,t){var n=aP(e)?e:FU(e),r=aP(t)?t:FU(t),a=isNaN(n),i=isNaN(r);if(a&&(n=this._incomparable),i&&(r=this._incomparable),a&&i){var o=nP(e),s=nP(t);o&&(n=s?e:0),s&&(r=o?t:0)}return n<r?this._resultLT:n>r?-this._resultLT:0},e}());!function(){function e(e,t){this._rval=t,this._isEQ=e,this._rvalTypeof=typeof t,this._rvalFloat=FU(t)}e.prototype.evaluate=function(e){var t=e===this._rval;if(!t){var n=typeof e;n===this._rvalTypeof||"number"!==n&&"number"!==this._rvalTypeof||(t=FU(e)===this._rvalFloat)}return this._isEQ?t:!t}}();var Tj,Nj="undefined",Ej=typeof Uint32Array===Nj?Array:Uint32Array,Mj=typeof Uint16Array===Nj?Array:Uint16Array,Aj=typeof Int32Array===Nj?Array:Int32Array,Dj=typeof Float64Array===Nj?Array:Float64Array,Rj={float:Dj,int:Aj,ordinal:Array,number:Array,time:Dj};function Oj(e){return e>65535?Ej:Mj}function Fj(e){var t=e.constructor;return t===Array?e.slice():new t(e)}function Lj(e,t,n,r,a){var i=Rj[n||"float"];if(a){var o=e[t],s=o&&o.length;if(s!==r){for(var u=new i(r),l=0;l<s;l++)u[l]=o[l];e[t]=u}}else e[t]=new i(r)}var Pj=function(){function e(){this._chunks=[],this._rawExtent=[],this._extent=[],this._count=0,this._rawCount=0,this._calcDimNameToIdx=wP()}return e.prototype.initData=function(e,t,n){this._provider=e,this._chunks=[],this._indices=null,this.getRawIndex=this._getRawIdxIdentity;var r=e.getSource(),a=this.defaultDimValueGetter=Tj[r.sourceFormat];this._dimValueGetter=n||a,this._rawExtent=[];oj(r);this._dimensions=KL(t,(function(e){return{type:e.type,property:e.property}})),this._initDataFromProvider(0,e.count())},e.prototype.getProvider=function(){return this._provider},e.prototype.getSource=function(){return this._provider.getSource()},e.prototype.ensureCalculationDimension=function(e,t){var n=this._calcDimNameToIdx,r=this._dimensions,a=n.get(e);if(null!=a){if(r[a].type===t)return a}else a=r.length;return r[a]={type:t},n.set(e,a),this._chunks[a]=new Rj[t||"float"](this._rawCount),this._rawExtent[a]=[1/0,-1/0],a},e.prototype.collectOrdinalMeta=function(e,t){var n=this._chunks[e],r=this._dimensions[e],a=this._rawExtent,i=r.ordinalOffset||0,o=n.length;0===i&&(a[e]=[1/0,-1/0]);for(var s=a[e],u=i;u<o;u++){var l=n[u]=t.parseAndCollect(n[u]);isNaN(l)||(s[0]=Math.min(l,s[0]),s[1]=Math.max(l,s[1]))}r.ordinalMeta=t,r.ordinalOffset=o,r.type="ordinal"},e.prototype.getOrdinalMeta=function(e){return this._dimensions[e].ordinalMeta},e.prototype.getDimensionProperty=function(e){var t=this._dimensions[e];return t&&t.property},e.prototype.appendData=function(e){var t=this._provider,n=this.count();t.appendData(e);var r=t.count();return t.persistent||(r+=n),n<r&&this._initDataFromProvider(n,r,!0),[n,r]},e.prototype.appendValues=function(e,t){for(var n=this._chunks,r=this._dimensions,a=r.length,i=this._rawExtent,o=this.count(),s=o+Math.max(e.length,t||0),u=0;u<a;u++){Lj(n,u,(f=r[u]).type,s,!0)}for(var l=[],c=o;c<s;c++)for(var h=c-o,p=0;p<a;p++){var f=r[p],d=Tj.arrayRows.call(this,e[h]||l,f.property,h,p);n[p][c]=d;var v=i[p];d<v[0]&&(v[0]=d),d>v[1]&&(v[1]=d)}return this._rawCount=this._count=s,{start:o,end:s}},e.prototype._initDataFromProvider=function(e,t,n){for(var r=this._provider,a=this._chunks,i=this._dimensions,o=i.length,s=this._rawExtent,u=KL(i,(function(e){return e.property})),l=0;l<o;l++){var c=i[l];s[l]||(s[l]=[1/0,-1/0]),Lj(a,l,c.type,t,n)}if(r.fillStorage)r.fillStorage(e,t,a,s);else for(var h=[],p=e;p<t;p++){h=r.getItem(p,h);for(var f=0;f<o;f++){var d=a[f],v=this._dimValueGetter(h,u[f],p,f);d[p]=v;var m=s[f];v<m[0]&&(m[0]=v),v>m[1]&&(m[1]=v)}}!r.persistent&&r.clean&&r.clean(),this._rawCount=this._count=t,this._extent=[]},e.prototype.count=function(){return this._count},e.prototype.get=function(e,t){if(!(t>=0&&t<this._count))return NaN;var n=this._chunks[e];return n?n[this.getRawIndex(t)]:NaN},e.prototype.getValues=function(e,t){var n=[],r=[];if(null==t){t=e,e=[];for(var a=0;a<this._dimensions.length;a++)r.push(a)}else r=e;a=0;for(var i=r.length;a<i;a++)n.push(this.get(r[a],t));return n},e.prototype.getByRawIndex=function(e,t){if(!(t>=0&&t<this._rawCount))return NaN;var n=this._chunks[e];return n?n[t]:NaN},e.prototype.getSum=function(e){var t=0;if(this._chunks[e])for(var n=0,r=this.count();n<r;n++){var a=this.get(e,n);isNaN(a)||(t+=a)}return t},e.prototype.getMedian=function(e){var t=[];this.each([e],(function(e){isNaN(e)||t.push(e)}));var n=t.sort((function(e,t){return e-t})),r=this.count();return 0===r?0:r%2===1?n[(r-1)/2]:(n[r/2]+n[r/2-1])/2},e.prototype.indexOfRawIndex=function(e){if(e>=this._rawCount||e<0)return-1;if(!this._indices)return e;var t=this._indices,n=t[e];if(null!=n&&n<this._count&&n===e)return e;for(var r=0,a=this._count-1;r<=a;){var i=(r+a)/2|0;if(t[i]<e)r=i+1;else{if(!(t[i]>e))return i;a=i-1}}return-1},e.prototype.indicesOfNearest=function(e,t,n){var r=this._chunks[e],a=[];if(!r)return a;null==n&&(n=1/0);for(var i=1/0,o=-1,s=0,u=0,l=this.count();u<l;u++){var c=t-r[this.getRawIndex(u)],h=Math.abs(c);h<=n&&((h<i||h===i&&c>=0&&o<0)&&(i=h,o=c,s=0),c===o&&(a[s++]=u))}return a.length=s,a},e.prototype.getIndices=function(){var e,t=this._indices;if(t){var n=t.constructor,r=this._count;if(n===Array){e=new n(r);for(var a=0;a<r;a++)e[a]=t[a]}else e=new n(t.buffer,0,r)}else{e=new(n=Oj(this._rawCount))(this.count());for(a=0;a<e.length;a++)e[a]=a}return e},e.prototype.filter=function(e,t){if(!this._count)return this;for(var n=this.clone(),r=n.count(),a=new(Oj(n._rawCount))(r),i=[],o=e.length,s=0,u=e[0],l=n._chunks,c=0;c<r;c++){var h=void 0,p=n.getRawIndex(c);if(0===o)h=t(c);else if(1===o){h=t(l[u][p],c)}else{for(var f=0;f<o;f++)i[f]=l[e[f]][p];i[f]=c,h=t.apply(null,i)}h&&(a[s++]=p)}return s<r&&(n._indices=a),n._count=s,n._extent=[],n._updateGetRawIdx(),n},e.prototype.selectRange=function(e){var t=this.clone(),n=t._count;if(!n)return this;var r=QL(e),a=r.length;if(!a)return this;var i=t.count(),o=new(Oj(t._rawCount))(i),s=0,u=r[0],l=e[u][0],c=e[u][1],h=t._chunks,p=!1;if(!t._indices){var f=0;if(1===a){for(var d=h[r[0]],v=0;v<n;v++){((b=d[v])>=l&&b<=c||isNaN(b))&&(o[s++]=f),f++}p=!0}else if(2===a){d=h[r[0]];var m=h[r[1]],g=e[r[1]][0],y=e[r[1]][1];for(v=0;v<n;v++){var b=d[v],x=m[v];(b>=l&&b<=c||isNaN(b))&&(x>=g&&x<=y||isNaN(x))&&(o[s++]=f),f++}p=!0}}if(!p)if(1===a)for(v=0;v<i;v++){var k=t.getRawIndex(v);((b=h[r[0]][k])>=l&&b<=c||isNaN(b))&&(o[s++]=k)}else for(v=0;v<i;v++){for(var w=!0,_=(k=t.getRawIndex(v),0);_<a;_++){var S=r[_];((b=h[S][k])<e[S][0]||b>e[S][1])&&(w=!1)}w&&(o[s++]=t.getRawIndex(v))}return s<i&&(t._indices=o),t._count=s,t._extent=[],t._updateGetRawIdx(),t},e.prototype.map=function(e,t){var n=this.clone(e);return this._updateDims(n,e,t),n},e.prototype.modify=function(e,t){this._updateDims(this,e,t)},e.prototype._updateDims=function(e,t,n){for(var r=e._chunks,a=[],i=t.length,o=e.count(),s=[],u=e._rawExtent,l=0;l<t.length;l++)u[t[l]]=[1/0,-1/0];for(var c=0;c<o;c++){for(var h=e.getRawIndex(c),p=0;p<i;p++)s[p]=r[t[p]][h];s[i]=c;var f=n&&n.apply(null,s);if(null!=f){"object"!==typeof f&&(a[0]=f,f=a);for(l=0;l<f.length;l++){var d=t[l],v=f[l],m=u[d],g=r[d];g&&(g[h]=v),v<m[0]&&(m[0]=v),v>m[1]&&(m[1]=v)}}}},e.prototype.lttbDownSample=function(e,t){var n,r,a,i=this.clone([e],!0),o=i._chunks[e],s=this.count(),u=0,l=Math.floor(1/t),c=this.getRawIndex(0),h=new(Oj(this._rawCount))(Math.min(2*(Math.ceil(s/l)+2),s));h[u++]=c;for(var p=1;p<s-1;p+=l){for(var f=Math.min(p+l,s-1),d=Math.min(p+2*l,s),v=(d+f)/2,m=0,g=f;g<d;g++){var y=o[I=this.getRawIndex(g)];isNaN(y)||(m+=y)}m/=d-f;var b=p,x=Math.min(p+l,s),k=p-1,w=o[c];n=-1,a=b;var _=-1,S=0;for(g=b;g<x;g++){var I;y=o[I=this.getRawIndex(g)];isNaN(y)?(S++,_<0&&(_=I)):(r=Math.abs((k-v)*(y-w)-(k-g)*(m-w)))>n&&(n=r,a=I)}S>0&&S<x-b&&(h[u++]=Math.min(_,a),a=Math.max(_,a)),h[u++]=a,c=a}return h[u++]=this.getRawIndex(s-1),i._count=u,i._indices=h,i.getRawIndex=this._getRawIdx,i},e.prototype.downSample=function(e,t,n,r){for(var a=this.clone([e],!0),i=a._chunks,o=[],s=Math.floor(1/t),u=i[e],l=this.count(),c=a._rawExtent[e]=[1/0,-1/0],h=new(Oj(this._rawCount))(Math.ceil(l/s)),p=0,f=0;f<l;f+=s){s>l-f&&(s=l-f,o.length=s);for(var d=0;d<s;d++){var v=this.getRawIndex(f+d);o[d]=u[v]}var m=n(o),g=this.getRawIndex(Math.min(f+r(o,m)||0,l-1));u[g]=m,m<c[0]&&(c[0]=m),m>c[1]&&(c[1]=m),h[p++]=g}return a._count=p,a._indices=h,a._updateGetRawIdx(),a},e.prototype.each=function(e,t){if(this._count)for(var n=e.length,r=this._chunks,a=0,i=this.count();a<i;a++){var o=this.getRawIndex(a);switch(n){case 0:t(a);break;case 1:t(r[e[0]][o],a);break;case 2:t(r[e[0]][o],r[e[1]][o],a);break;default:for(var s=0,u=[];s<n;s++)u[s]=r[e[s]][o];u[s]=a,t.apply(null,u)}}},e.prototype.getDataExtent=function(e){var t=this._chunks[e],n=[1/0,-1/0];if(!t)return n;var r,a=this.count();if(!this._indices)return this._rawExtent[e].slice();if(r=this._extent[e])return r.slice();for(var i=(r=n)[0],o=r[1],s=0;s<a;s++){var u=t[this.getRawIndex(s)];u<i&&(i=u),u>o&&(o=u)}return r=[i,o],this._extent[e]=r,r},e.prototype.getRawDataItem=function(e){var t=this.getRawIndex(e);if(this._provider.persistent)return this._provider.getItem(t);for(var n=[],r=this._chunks,a=0;a<r.length;a++)n.push(r[a][t]);return n},e.prototype.clone=function(t,n){var r=new e,a=this._chunks,i=t&&YL(t,(function(e,t){return e[t]=!0,e}),{});if(i)for(var o=0;o<a.length;o++)r._chunks[o]=i[o]?Fj(a[o]):a[o];else r._chunks=a;return this._copyCommonProps(r),n||(r._indices=this._cloneIndices()),r._updateGetRawIdx(),r},e.prototype._copyCommonProps=function(e){e._count=this._count,e._rawCount=this._rawCount,e._provider=this._provider,e._dimensions=this._dimensions,e._extent=VL(this._extent),e._rawExtent=VL(this._rawExtent)},e.prototype._cloneIndices=function(){if(this._indices){var e=this._indices.constructor,t=void 0;if(e===Array){var n=this._indices.length;t=new e(n);for(var r=0;r<n;r++)t[r]=this._indices[r]}else t=new e(this._indices);return t}return null},e.prototype._getRawIdxIdentity=function(e){return e},e.prototype._getRawIdx=function(e){return e<this._count&&e>=0?this._indices[e]:-1},e.prototype._updateGetRawIdx=function(){this.getRawIndex=this._indices?this._getRawIdx:this._getRawIdxIdentity},e.internalField=function(){function e(e,t,n,r){return Sj(e[r],this._dimensions[r])}Tj={arrayRows:e,objectRows:function(e,t,n,r){return Sj(e[t],this._dimensions[r])},keyedColumns:e,original:function(e,t,n,r){var a=e&&(null==e.value?e:e.value);return Sj(a instanceof Array?a[r]:a,this._dimensions[r])},typedArray:function(e,t,n,r){return e[r]}}}(),e}(),zj=Pj,Bj=eH(),Vj={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},Wj=function(){function e(e){this.dimensions=e.dimensions,this._dimOmitted=e.dimensionOmitted,this.source=e.source,this._fullDimCount=e.fullDimensionCount,this._updateDimOmitted(e.dimensionOmitted)}return e.prototype.isDimensionOmitted=function(){return this._dimOmitted},e.prototype._updateDimOmitted=function(e){this._dimOmitted=e,e&&(this._dimNameMap||(this._dimNameMap=Gj(this.source)))},e.prototype.getSourceDimensionIndex=function(e){return pP(this._dimNameMap.get(e),-1)},e.prototype.getSourceDimension=function(e){var t=this.source.dimensionsDefine;if(t)return t[e]},e.prototype.makeStoreSchema=function(){for(var e=this._fullDimCount,t=oj(this.source),n=!jj(e),r="",a=[],i=0,o=0;i<e;i++){var s=void 0,u=void 0,l=void 0,c=this.dimensions[o];if(c&&c.storeDimIndex===i)s=t?c.name:null,u=c.type,l=c.ordinalMeta,o++;else{var h=this.getSourceDimension(i);h&&(s=t?h.name:null,u=h.type)}a.push({property:s,type:u,ordinalMeta:l}),!t||null==s||c&&c.isCalculationCoord||(r+=n?s.replace(/\`/g,"`1").replace(/\$/g,"`2"):s),r+="$",r+=Vj[u]||"f",l&&(r+=l.uid),r+="$"}var p=this.source;return{dimensions:a,hash:[p.seriesLayoutBy,p.startIndex,r].join("$$")}},e.prototype.makeOutputDimensionNames=function(){for(var e=[],t=0,n=0;t<this._fullDimCount;t++){var r=void 0,a=this.dimensions[n];if(a&&a.storeDimIndex===t)a.isCalculationCoord||(r=a.name),n++;else{var i=this.getSourceDimension(t);i&&(r=i.name)}e.push(r)}return e},e.prototype.appendCalculationDimension=function(e){this.dimensions.push(e),e.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},e}();function Uj(e){return e instanceof Wj}function Hj(e){for(var t=wP(),n=0;n<(e||[]).length;n++){var r=e[n],a=iP(r)?r.name:r;null!=a&&null==t.get(a)&&t.set(a,n)}return t}function Gj(e){var t=Bj(e);return t.dimNameMap||(t.dimNameMap=Hj(e.dimensionsDefine))}function jj(e){return e>30}var qj,Xj,Kj,Yj,Zj,Qj,$j,Jj=iP,eq=KL,tq="undefined"===typeof Int32Array?Array:Int32Array,nq=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_dimSummary","userOutput","_rawData","_dimValueGetter","_nameDimIdx","_idDimIdx","_nameRepeatCount"],rq=["_approximateExtent"],aq=function(){function e(e,t){var n;this.type="list",this._dimOmitted=!1,this._nameList=[],this._idList=[],this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._approximateExtent={},this._calculationInfo={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=["cloneShallow","downSample","lttbDownSample","map"],this.CHANGABLE_METHODS=["filterSelf","selectRange"],this.DOWNSAMPLE_METHODS=["downSample","lttbDownSample"];var r=!1;Uj(e)?(n=e.dimensions,this._dimOmitted=e.isDimensionOmitted(),this._schema=e):(r=!0,n=e),n=n||["x","y"];for(var a={},i=[],o={},s=!1,u={},l=0;l<n.length;l++){var c=n[l],h=nP(c)?new kj({name:c}):c instanceof kj?c:new kj(c),p=h.name;h.type=h.type||"float",h.coordDim||(h.coordDim=p,h.coordDimIndex=0);var f=h.otherDims=h.otherDims||{};i.push(p),a[p]=h,null!=u[p]&&(s=!0),h.createInvertedIndices&&(o[p]=[]),0===f.itemName&&(this._nameDimIdx=l),0===f.itemId&&(this._idDimIdx=l),r&&(h.storeDimIndex=l)}if(this.dimensions=i,this._dimInfos=a,this._initGetDimensionInfo(s),this.hostModel=t,this._invertedIndicesMap=o,this._dimOmitted){var d=this._dimIdxToName=wP();XL(i,(function(e){d.set(a[e].storeDimIndex,e)}))}}return e.prototype.getDimension=function(e){var t=this._recognizeDimIndex(e);if(null==t)return e;if(t=e,!this._dimOmitted)return this.dimensions[t];var n=this._dimIdxToName.get(t);if(null!=n)return n;var r=this._schema.getSourceDimension(t);return r?r.name:void 0},e.prototype.getDimensionIndex=function(e){var t=this._recognizeDimIndex(e);if(null!=t)return t;if(null==e)return-1;var n=this._getDimInfo(e);return n?n.storeDimIndex:this._dimOmitted?this._schema.getSourceDimensionIndex(e):-1},e.prototype._recognizeDimIndex=function(e){if(aP(e)||null!=e&&!isNaN(e)&&!this._getDimInfo(e)&&(!this._dimOmitted||this._schema.getSourceDimensionIndex(e)<0))return+e},e.prototype._getStoreDimIndex=function(e){return this.getDimensionIndex(e)},e.prototype.getDimensionInfo=function(e){return this._getDimInfo(this.getDimension(e))},e.prototype._initGetDimensionInfo=function(e){var t=this._dimInfos;this._getDimInfo=e?function(e){return t.hasOwnProperty(e)?t[e]:void 0}:function(e){return t[e]}},e.prototype.getDimensionsOnCoord=function(){return this._dimSummary.dataDimsOnCoord.slice()},e.prototype.mapDimension=function(e,t){var n=this._dimSummary;if(null==t)return n.encodeFirstDimNotExtra[e];var r=n.encode[e];return r?r[t]:null},e.prototype.mapDimensionsAll=function(e){return(this._dimSummary.encode[e]||[]).slice()},e.prototype.getStore=function(){return this._store},e.prototype.initData=function(e,t,n){var r,a=this;if(e instanceof zj&&(r=e),!r){var i=this.dimensions,o=ej(e)||qL(e)?new sj(e,i.length):e;r=new zj;var s=eq(i,(function(e){return{type:a._dimInfos[e].type,property:e}}));r.initData(o,s,n)}this._store=r,this._nameList=(t||[]).slice(),this._idList=[],this._nameRepeatCount={},this._doInit(0,r.count()),this._dimSummary=function(e,t){var n={},r=n.encode={},a=wP(),i=[],o=[],s={};XL(e.dimensions,(function(t){var n,u=e.getDimensionInfo(t),l=u.coordDim;if(l){var c=u.coordDimIndex;xj(r,l)[c]=t,u.isExtraCoord||(a.set(l,1),"ordinal"!==(n=u.type)&&"time"!==n&&(i[0]=t),xj(s,l)[c]=e.getDimensionIndex(u.name)),u.defaultTooltip&&o.push(t)}AG.each((function(e,t){var n=xj(r,t),a=u.otherDims[t];null!=a&&!1!==a&&(n[a]=u.name)}))}));var u=[],l={};a.each((function(e,t){var n=r[t];l[t]=n[0],u=u.concat(n)})),n.dataDimsOnCoord=u,n.dataDimIndicesOnCoord=KL(u,(function(t){return e.getDimensionInfo(t).storeDimIndex})),n.encodeFirstDimNotExtra=l;var c=r.label;c&&c.length&&(i=c.slice());var h=r.tooltip;return h&&h.length?o=h.slice():o.length||(o=i.slice()),r.defaultedLabel=i,r.defaultedTooltip=o,n.userOutput=new bj(s,t),n}(this,this._schema),this.userOutput=this._dimSummary.userOutput},e.prototype.appendData=function(e){var t=this._store.appendData(e);this._doInit(t[0],t[1])},e.prototype.appendValues=function(e,t){var n=this._store.appendValues(e,t.length),r=n.start,a=n.end,i=this._shouldMakeIdFromName();if(this._updateOrdinalMeta(),t)for(var o=r;o<a;o++){var s=o-r;this._nameList[o]=t[s],i&&$j(this,o)}},e.prototype._updateOrdinalMeta=function(){for(var e=this._store,t=this.dimensions,n=0;n<t.length;n++){var r=this._dimInfos[t[n]];r.ordinalMeta&&e.collectOrdinalMeta(r.storeDimIndex,r.ordinalMeta)}},e.prototype._shouldMakeIdFromName=function(){var e=this._store.getProvider();return null==this._idDimIdx&&e.getSource().sourceFormat!==LG&&!e.fillStorage},e.prototype._doInit=function(e,t){if(!(e>=t)){var n=this._store.getProvider();this._updateOrdinalMeta();var r=this._nameList,a=this._idList;if(n.getSource().sourceFormat===DG&&!n.pure)for(var i=[],o=e;o<t;o++){var s=n.getItem(o,i);if(!this.hasItemOption&&qU(s)&&(this.hasItemOption=!0),s){var u=s.name;null==r[o]&&null!=u&&(r[o]=ZU(u,null));var l=s.id;null==a[o]&&null!=l&&(a[o]=ZU(l,null))}}if(this._shouldMakeIdFromName())for(o=e;o<t;o++)$j(this,o);qj(this)}},e.prototype.getApproximateExtent=function(e){return this._approximateExtent[e]||this._store.getDataExtent(this._getStoreDimIndex(e))},e.prototype.setApproximateExtent=function(e,t){t=this.getDimension(t),this._approximateExtent[t]=e.slice()},e.prototype.getCalculationInfo=function(e){return this._calculationInfo[e]},e.prototype.setCalculationInfo=function(e,t){Jj(e)?UL(this._calculationInfo,e):this._calculationInfo[e]=t},e.prototype.getName=function(e){var t=this.getRawIndex(e),n=this._nameList[t];return null==n&&null!=this._nameDimIdx&&(n=Kj(this,this._nameDimIdx,t)),null==n&&(n=""),n},e.prototype._getCategory=function(e,t){var n=this._store.get(e,t),r=this._store.getOrdinalMeta(e);return r?r.categories[n]:n},e.prototype.getId=function(e){return Xj(this,this.getRawIndex(e))},e.prototype.count=function(){return this._store.count()},e.prototype.get=function(e,t){var n=this._store,r=this._dimInfos[e];if(r)return n.get(r.storeDimIndex,t)},e.prototype.getByRawIndex=function(e,t){var n=this._store,r=this._dimInfos[e];if(r)return n.getByRawIndex(r.storeDimIndex,t)},e.prototype.getIndices=function(){return this._store.getIndices()},e.prototype.getDataExtent=function(e){return this._store.getDataExtent(this._getStoreDimIndex(e))},e.prototype.getSum=function(e){return this._store.getSum(this._getStoreDimIndex(e))},e.prototype.getMedian=function(e){return this._store.getMedian(this._getStoreDimIndex(e))},e.prototype.getValues=function(e,t){var n=this,r=this._store;return eP(e)?r.getValues(eq(e,(function(e){return n._getStoreDimIndex(e)})),t):r.getValues(e)},e.prototype.hasValue=function(e){for(var t=this._dimSummary.dataDimIndicesOnCoord,n=0,r=t.length;n<r;n++)if(isNaN(this._store.get(t[n],e)))return!1;return!0},e.prototype.indexOfName=function(e){for(var t=0,n=this._store.count();t<n;t++)if(this.getName(t)===e)return t;return-1},e.prototype.getRawIndex=function(e){return this._store.getRawIndex(e)},e.prototype.indexOfRawIndex=function(e){return this._store.indexOfRawIndex(e)},e.prototype.rawIndexOf=function(e,t){var n=(e&&this._invertedIndicesMap[e])[t];return null==n||isNaN(n)?-1:n},e.prototype.indicesOfNearest=function(e,t,n){return this._store.indicesOfNearest(this._getStoreDimIndex(e),t,n)},e.prototype.each=function(e,t,n){tP(e)&&(n=t,t=e,e=[]);var r=n||this,a=eq(Yj(e),this._getStoreDimIndex,this);this._store.each(a,r?$L(t,r):t)},e.prototype.filterSelf=function(e,t,n){tP(e)&&(n=t,t=e,e=[]);var r=n||this,a=eq(Yj(e),this._getStoreDimIndex,this);return this._store=this._store.filter(a,r?$L(t,r):t),this},e.prototype.selectRange=function(e){var t=this,n={},r=QL(e),a=[];return XL(r,(function(r){var i=t._getStoreDimIndex(r);n[i]=e[r],a.push(i)})),this._store=this._store.selectRange(n),this},e.prototype.mapArray=function(e,t,n){tP(e)&&(n=t,t=e,e=[]),n=n||this;var r=[];return this.each(e,(function(){r.push(t&&t.apply(this,arguments))}),n),r},e.prototype.map=function(e,t,n,r){var a=n||r||this,i=eq(Yj(e),this._getStoreDimIndex,this),o=Qj(this);return o._store=this._store.map(i,a?$L(t,a):t),o},e.prototype.modify=function(e,t,n,r){var a=n||r||this;var i=eq(Yj(e),this._getStoreDimIndex,this);this._store.modify(i,a?$L(t,a):t)},e.prototype.downSample=function(e,t,n,r){var a=Qj(this);return a._store=this._store.downSample(this._getStoreDimIndex(e),t,n,r),a},e.prototype.lttbDownSample=function(e,t){var n=Qj(this);return n._store=this._store.lttbDownSample(this._getStoreDimIndex(e),t),n},e.prototype.getRawDataItem=function(e){return this._store.getRawDataItem(e)},e.prototype.getItemModel=function(e){var t=this.hostModel,n=this.getRawDataItem(e);return new CG(n,t,t&&t.ecModel)},e.prototype.diff=function(e){var t=this;return new MG(e?e.getStore().getIndices():[],this.getStore().getIndices(),(function(t){return Xj(e,t)}),(function(e){return Xj(t,e)}))},e.prototype.getVisual=function(e){var t=this._visual;return t&&t[e]},e.prototype.setVisual=function(e,t){this._visual=this._visual||{},Jj(e)?UL(this._visual,e):this._visual[e]=t},e.prototype.getItemVisual=function(e,t){var n=this._itemVisuals[e],r=n&&n[t];return null==r?this.getVisual(t):r},e.prototype.hasItemVisual=function(){return this._itemVisuals.length>0},e.prototype.ensureUniqueItemVisual=function(e,t){var n=this._itemVisuals,r=n[e];r||(r=n[e]={});var a=r[t];return null==a&&(eP(a=this.getVisual(t))?a=a.slice():Jj(a)&&(a=UL({},a)),r[t]=a),a},e.prototype.setItemVisual=function(e,t,n){var r=this._itemVisuals[e]||{};this._itemVisuals[e]=r,Jj(t)?UL(r,t):r[t]=n},e.prototype.clearAllVisual=function(){this._visual={},this._itemVisuals=[]},e.prototype.setLayout=function(e,t){Jj(e)?UL(this._layout,e):this._layout[e]=t},e.prototype.getLayout=function(e){return this._layout[e]},e.prototype.getItemLayout=function(e){return this._itemLayouts[e]},e.prototype.setItemLayout=function(e,t,n){this._itemLayouts[e]=n?UL(this._itemLayouts[e]||{},t):t},e.prototype.clearItemLayouts=function(){this._itemLayouts.length=0},e.prototype.setItemGraphicEl=function(e,t){!function(e,t,n,r){if(r){var a=sH(r);a.dataIndex=n,a.dataType=t,a.seriesIndex=e,"group"===r.type&&r.traverse((function(r){var a=sH(r);a.seriesIndex=e,a.dataIndex=n,a.dataType=t}))}}(this.hostModel&&this.hostModel.seriesIndex,this.dataType,e,t),this._graphicEls[e]=t},e.prototype.getItemGraphicEl=function(e){return this._graphicEls[e]},e.prototype.eachItemGraphicEl=function(e,t){XL(this._graphicEls,(function(n,r){n&&e&&e.call(t,n,r)}))},e.prototype.cloneShallow=function(t){return t||(t=new e(this._schema?this._schema:eq(this.dimensions,this._getDimInfo,this),this.hostModel)),Zj(t,this),t._store=this._store,t},e.prototype.wrapMethod=function(e,t){var n=this[e];tP(n)&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(e),this[e]=function(){var e=n.apply(this,arguments);return t.apply(this,[e].concat(dP(arguments)))})},e.internalField=(qj=function(e){var t=e._invertedIndicesMap;XL(t,(function(n,r){var a=e._dimInfos[r],i=a.ordinalMeta,o=e._store;if(i){n=t[r]=new tq(i.categories.length);for(var s=0;s<n.length;s++)n[s]=-1;for(s=0;s<o.count();s++)n[o.get(a.storeDimIndex,s)]=s}}))},Kj=function(e,t,n){return ZU(e._getCategory(t,n),null)},Xj=function(e,t){var n=e._idList[t];return null==n&&null!=e._idDimIdx&&(n=Kj(e,e._idDimIdx,t)),null==n&&(n="e\0\0"+t),n},Yj=function(e){return eP(e)||(e=null!=e?[e]:[]),e},Qj=function(t){var n=new e(t._schema?t._schema:eq(t.dimensions,t._getDimInfo,t),t.hostModel);return Zj(n,t),n},Zj=function(e,t){XL(nq.concat(t.__wrappedMethods||[]),(function(n){t.hasOwnProperty(n)&&(e[n]=t[n])})),e.__wrappedMethods=t.__wrappedMethods,XL(rq,(function(n){e[n]=VL(t[n])})),e._calculationInfo=UL({},t._calculationInfo)},void($j=function(e,t){var n=e._nameList,r=e._idList,a=e._nameDimIdx,i=e._idDimIdx,o=n[t],s=r[t];if(null==o&&null!=a&&(n[t]=o=Kj(e,a,t)),null==s&&null!=i&&(r[t]=s=Kj(e,i,t)),null==s&&null!=o){var u=e._nameRepeatCount,l=u[o]=(u[o]||0)+1;s=o,l>1&&(s+="__ec__"+l),r[t]=s}})),e}(),iq=aq;function oq(e,t){ej(e)||(e=nj(e));var n=(t=t||{}).coordDimensions||[],r=t.dimensionsDefine||e.dimensionsDefine||[],a=wP(),i=[],o=function(e,t,n,r){var a=Math.max(e.dimensionsDetectedCount||1,t.length,n.length,r||0);return XL(t,(function(e){var t;iP(e)&&(t=e.dimsDef)&&(a=Math.max(a,t.length))})),a}(e,n,r,t.dimensionsCount),s=t.canOmitUnusedDimensions&&jj(o),u=r===e.dimensionsDefine,l=u?Gj(e):Hj(r),c=t.encodeDefine;!c&&t.encodeDefaulter&&(c=t.encodeDefaulter(e,o));for(var h=wP(c),p=new Aj(o),f=0;f<p.length;f++)p[f]=-1;function d(e){var t=p[e];if(t<0){var n=r[e],a=iP(n)?n:{name:n},o=new kj,s=a.name;null!=s&&null!=l.get(s)&&(o.name=o.displayName=s),null!=a.type&&(o.type=a.type),null!=a.displayName&&(o.displayName=a.displayName);var u=i.length;return p[e]=u,o.storeDimIndex=e,i.push(o),o}return i[t]}if(!s)for(f=0;f<o;f++)d(f);h.each((function(e,t){var n=UU(e).slice();if(1===n.length&&!nP(n[0])&&n[0]<0)h.set(t,!1);else{var r=h.set(t,[]);XL(n,(function(e,n){var a=nP(e)?l.get(e):e;null!=a&&a<o&&(r[n]=a,m(d(a),t,n))}))}}));var v=0;function m(e,t,n){null!=AG.get(t)?e.otherDims[t]=n:(e.coordDim=t,e.coordDimIndex=n,a.set(t,!0))}XL(n,(function(e){var t,n,r,a;if(nP(e))t=e,a={};else{t=(a=e).name;var i=a.ordinalMeta;a.ordinalMeta=null,(a=UL({},a)).ordinalMeta=i,n=a.dimsDef,r=a.otherDims,a.name=a.coordDim=a.coordDimIndex=a.dimsDef=a.otherDims=null}var s=h.get(t);if(!1!==s){if(!(s=UU(s)).length)for(var l=0;l<(n&&n.length||1);l++){for(;v<o&&null!=d(v).coordDim;)v++;v<o&&s.push(v++)}XL(s,(function(e,i){var o=d(e);if(u&&null!=a.type&&(o.type=a.type),m(HL(o,a),t,i),null==o.name&&n){var s=n[i];!iP(s)&&(s={name:s}),o.name=o.displayName=s.name,o.defaultTooltip=s.defaultTooltip}r&&HL(o.otherDims,r)}))}}));var g=t.generateCoord,y=t.generateCoordCount,b=null!=y;y=g?y||1:0;var x=g||"value";function k(e){null==e.name&&(e.name=e.coordDim)}if(s)XL(i,(function(e){k(e)})),i.sort((function(e,t){return e.storeDimIndex-t.storeDimIndex}));else for(var w=0;w<o;w++){var _=d(w);null==_.coordDim&&(_.coordDim=sq(x,a,b),_.coordDimIndex=0,(!g||y<=0)&&(_.isExtraCoord=!0),y--),k(_),null!=_.type||qG(e,w)!==VG&&(!_.isExtraCoord||null==_.otherDims.itemName&&null==_.otherDims.seriesName)||(_.type="ordinal")}return function(e){for(var t=wP(),n=0;n<e.length;n++){var r=e[n],a=r.name,i=t.get(a)||0;i>0&&(r.name=a+(i-1)),i++,t.set(a,i)}}(i),new Wj({source:e,dimensions:i,fullDimensionCount:o,dimensionOmitted:s})}function sq(e,t,n){var r=t.data;if(n||r.hasOwnProperty(e)){for(var a=0;r.hasOwnProperty(e+a);)a++;e+=a}return t.set(e,!0),e}var uq={},lq=function(){function e(){this._coordinateSystems=[]}return e.prototype.create=function(e,t){var n=[];XL(uq,(function(r,a){var i=r.create(e,t);n=n.concat(i||[])})),this._coordinateSystems=n},e.prototype.update=function(e,t){XL(this._coordinateSystems,(function(n){n.update&&n.update(e,t)}))},e.prototype.getCoordinateSystems=function(){return this._coordinateSystems.slice()},e.register=function(e,t){uq[e]=t},e.get=function(e){return uq[e]},e}(),cq=function(e){this.coordSysDims=[],this.axisMap=wP(),this.categoryAxisMap=wP(),this.coordSysName=e};var hq={cartesian2d:function(e,t,n,r){var a=e.getReferringComponents("xAxis",aH).models[0],i=e.getReferringComponents("yAxis",aH).models[0];t.coordSysDims=["x","y"],n.set("x",a),n.set("y",i),pq(a)&&(r.set("x",a),t.firstCategoryDimIndex=0),pq(i)&&(r.set("y",i),null==t.firstCategoryDimIndex&&(t.firstCategoryDimIndex=1))},singleAxis:function(e,t,n,r){var a=e.getReferringComponents("singleAxis",aH).models[0];t.coordSysDims=["single"],n.set("single",a),pq(a)&&(r.set("single",a),t.firstCategoryDimIndex=0)},polar:function(e,t,n,r){var a=e.getReferringComponents("polar",aH).models[0],i=a.findAxisModel("radiusAxis"),o=a.findAxisModel("angleAxis");t.coordSysDims=["radius","angle"],n.set("radius",i),n.set("angle",o),pq(i)&&(r.set("radius",i),t.firstCategoryDimIndex=0),pq(o)&&(r.set("angle",o),null==t.firstCategoryDimIndex&&(t.firstCategoryDimIndex=1))},geo:function(e,t,n,r){t.coordSysDims=["lng","lat"]},parallel:function(e,t,n,r){var a=e.ecModel,i=a.getComponent("parallel",e.get("parallelIndex")),o=t.coordSysDims=i.dimensions.slice();XL(i.parallelAxisIndex,(function(e,i){var s=a.getComponent("parallelAxis",e),u=o[i];n.set(u,s),pq(s)&&(r.set(u,s),null==t.firstCategoryDimIndex&&(t.firstCategoryDimIndex=i))}))}};function pq(e){return"category"===e.get("type")}function fq(e,t,n){var r,a,i,o=(n=n||{}).byIndex,s=n.stackedCoordDimension;!function(e){return!Uj(e.schema)}(t)?(a=t.schema,r=a.dimensions,i=t.store):r=t;var u,l,c,h,p=!(!e||!e.get("stack"));if(XL(r,(function(e,t){nP(e)&&(r[t]=e={name:e}),p&&!e.isExtraCoord&&(o||u||!e.ordinalMeta||(u=e),l||"ordinal"===e.type||"time"===e.type||s&&s!==e.coordDim||(l=e))})),!l||o||u||(o=!0),l){c="__\0ecstackresult_"+e.id,h="__\0ecstackedover_"+e.id,u&&(u.createInvertedIndices=!0);var f=l.coordDim,d=l.type,v=0;XL(r,(function(e){e.coordDim===f&&v++}));var m={name:c,coordDim:f,coordDimIndex:v,type:d,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:r.length},g={name:h,coordDim:h,coordDimIndex:v+1,type:d,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:r.length+1};a?(i&&(m.storeDimIndex=i.ensureCalculationDimension(h,d),g.storeDimIndex=i.ensureCalculationDimension(c,d)),a.appendCalculationDimension(m),a.appendCalculationDimension(g)):(r.push(m),r.push(g))}return{stackedDimension:l&&l.name,stackedByDimension:u&&u.name,isStackedByIndex:o,stackedOverDimension:h,stackResultDimension:c}}function dq(e,t){return!!t&&t===e.getCalculationInfo("stackedDimension")}var vq=function(e,t,n){n=n||{};var r,a=t.getSourceManager(),i=!1;e?(i=!0,r=nj(e)):i=(r=a.getSource()).sourceFormat===DG;var o=function(e){var t=e.get("coordinateSystem"),n=new cq(t),r=hq[t];if(r)return r(e,n,n.axisMap,n.categoryAxisMap),n}(t),s=function(e,t){var n,r=e.get("coordinateSystem"),a=lq.get(r);return t&&t.coordSysDims&&(n=KL(t.coordSysDims,(function(e){var n={name:e},r=t.axisMap.get(e);if(r){var a=r.get("type");n.type=function(e){return"category"===e?"ordinal":"time"===e?"time":"float"}(a)}return n}))),n||(n=a&&(a.getDimensionsInfo?a.getDimensionsInfo():a.dimensions.slice())||["x","y"]),n}(t,o),u=n.useEncodeDefaulter,l=tP(u)?u:u?JL(GG,s,t):null,c=oq(r,{coordDimensions:s,generateCoord:n.generateCoord,encodeDefine:t.getEncode(),encodeDefaulter:l,canOmitUnusedDimensions:!i}),h=function(e,t,n){var r,a;return n&&XL(e,(function(e,i){var o=e.coordDim,s=n.categoryAxisMap.get(o);s&&(null==r&&(r=i),e.ordinalMeta=s.getOrdinalMeta(),t&&(e.createInvertedIndices=!0)),null!=e.otherDims.itemName&&(a=!0)})),a||null==r||(e[r].otherDims.itemName=0),r}(c.dimensions,n.createInvertedIndices,o),p=i?null:a.getSharedDataStore(c),f=fq(t,{schema:c,store:p}),d=new iq(c,t);d.setCalculationInfo(f);var v=null!=h&&function(e){if(e.sourceFormat===DG){return!eP(jU(function(e){var t=0;for(;t<e.length&&null==e[t];)t++;return e[t]}(e.data||[])))}}(r)?function(e,t,n,r){return r===h?n:this.defaultDimValueGetter(e,t,n,r)}:null;return d.hasItemOption=!1,d.initData(i?r:p,null,v),d},mq=Math.round(10*Math.random());function gq(e){return[e||"",mq++].join("_")}function yq(e,t){return WL(WL({},e,!0),t,!0)}var bq="ZH",xq="EN",kq=xq,wq={},_q={},Sq=MP.domSupported&&(document.documentElement.lang||navigator.language||navigator.browserLanguage).toUpperCase().indexOf(bq)>-1?bq:kq;function Iq(e,t){e=e.toUpperCase(),_q[e]=new CG(t),wq[e]=t}Iq(xq,{time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}}),Iq(bq,{time:{month:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"],monthAbbr:["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],dayOfWeek:["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],dayOfWeekAbbr:["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"]},legend:{selector:{all:"\u5168\u9009",inverse:"\u53cd\u9009"}},toolbox:{brush:{title:{rect:"\u77e9\u5f62\u9009\u62e9",polygon:"\u5708\u9009",lineX:"\u6a2a\u5411\u9009\u62e9",lineY:"\u7eb5\u5411\u9009\u62e9",keep:"\u4fdd\u6301\u9009\u62e9",clear:"\u6e05\u9664\u9009\u62e9"}},dataView:{title:"\u6570\u636e\u89c6\u56fe",lang:["\u6570\u636e\u89c6\u56fe","\u5173\u95ed","\u5237\u65b0"]},dataZoom:{title:{zoom:"\u533a\u57df\u7f29\u653e",back:"\u533a\u57df\u7f29\u653e\u8fd8\u539f"}},magicType:{title:{line:"\u5207\u6362\u4e3a\u6298\u7ebf\u56fe",bar:"\u5207\u6362\u4e3a\u67f1\u72b6\u56fe",stack:"\u5207\u6362\u4e3a\u5806\u53e0",tiled:"\u5207\u6362\u4e3a\u5e73\u94fa"}},restore:{title:"\u8fd8\u539f"},saveAsImage:{title:"\u4fdd\u5b58\u4e3a\u56fe\u7247",lang:["\u53f3\u952e\u53e6\u5b58\u4e3a\u56fe\u7247"]}},series:{typeNames:{pie:"\u997c\u56fe",bar:"\u67f1\u72b6\u56fe",line:"\u6298\u7ebf\u56fe",scatter:"\u6563\u70b9\u56fe",effectScatter:"\u6d9f\u6f2a\u6563\u70b9\u56fe",radar:"\u96f7\u8fbe\u56fe",tree:"\u6811\u56fe",treemap:"\u77e9\u5f62\u6811\u56fe",boxplot:"\u7bb1\u578b\u56fe",candlestick:"K\u7ebf\u56fe",k:"K\u7ebf\u56fe",heatmap:"\u70ed\u529b\u56fe",map:"\u5730\u56fe",parallel:"\u5e73\u884c\u5750\u6807\u56fe",lines:"\u7ebf\u56fe",graph:"\u5173\u7cfb\u56fe",sankey:"\u6851\u57fa\u56fe",funnel:"\u6f0f\u6597\u56fe",gauge:"\u4eea\u8868\u76d8\u56fe",pictorialBar:"\u8c61\u5f62\u67f1\u56fe",themeRiver:"\u4e3b\u9898\u6cb3\u6d41\u56fe",sunburst:"\u65ed\u65e5\u56fe"}},aria:{general:{withTitle:"\u8fd9\u662f\u4e00\u4e2a\u5173\u4e8e\u201c{title}\u201d\u7684\u56fe\u8868\u3002",withoutTitle:"\u8fd9\u662f\u4e00\u4e2a\u56fe\u8868\uff0c"},series:{single:{prefix:"",withName:"\u56fe\u8868\u7c7b\u578b\u662f{seriesType}\uff0c\u8868\u793a{seriesName}\u3002",withoutName:"\u56fe\u8868\u7c7b\u578b\u662f{seriesType}\u3002"},multiple:{prefix:"\u5b83\u7531{seriesCount}\u4e2a\u56fe\u8868\u7cfb\u5217\u7ec4\u6210\u3002",withName:"\u7b2c{seriesId}\u4e2a\u7cfb\u5217\u662f\u4e00\u4e2a\u8868\u793a{seriesName}\u7684{seriesType}\uff0c",withoutName:"\u7b2c{seriesId}\u4e2a\u7cfb\u5217\u662f\u4e00\u4e2a{seriesType}\uff0c",separator:{middle:"\uff1b",end:"\u3002"}}},data:{allData:"\u5176\u6570\u636e\u662f\u2014\u2014",partialData:"\u5176\u4e2d\uff0c\u524d{displayCnt}\u9879\u662f\u2014\u2014",withName:"{name}\u7684\u6570\u636e\u662f{value}",withoutName:"{value}",separator:{middle:"\uff0c",end:""}}}});var Cq=1e3,Tq=6e4,Nq=36e5,Eq=864e5,Mq=31536e6,Aq={year:"{yyyy}",month:"{MMM}",day:"{d}",hour:"{HH}:{mm}",minute:"{HH}:{mm}",second:"{HH}:{mm}:{ss}",millisecond:"{HH}:{mm}:{ss} {SSS}",none:"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}"},Dq="{yyyy}-{MM}-{dd}",Rq={year:"{yyyy}",month:"{yyyy}-{MM}",day:Dq,hour:"{yyyy}-{MM}-{dd} "+Aq.hour,minute:"{yyyy}-{MM}-{dd} "+Aq.minute,second:"{yyyy}-{MM}-{dd} "+Aq.second,millisecond:Aq.none},Oq=["year","month","day","hour","minute","second","millisecond"],Fq=["year","half-year","quarter","month","week","half-week","day","half-day","quarter-day","hour","minute","second","millisecond"];function Lq(e,t){return"0000".substr(0,t-(e+="").length)+e}function Pq(e){switch(e){case"half-year":case"quarter":return"month";case"week":case"half-week":return"day";case"half-day":case"quarter-day":return"hour";default:return e}}function zq(e){return e===Pq(e)}function Bq(e,t,n,r){var a=AU(e),i=a[Uq(n)](),o=a[Hq(n)]()+1,s=Math.floor((o-1)/4)+1,u=a[Gq(n)](),l=a["get"+(n?"UTC":"")+"Day"](),c=a[jq(n)](),h=(c-1)%12+1,p=a[qq(n)](),f=a[Xq(n)](),d=a[Kq(n)](),v=r instanceof CG?r:function(e){return _q[e]}(r||Sq)||_q.EN,m=v.getModel("time"),g=m.get("month"),y=m.get("monthAbbr"),b=m.get("dayOfWeek"),x=m.get("dayOfWeekAbbr");return(t||"").replace(/{yyyy}/g,i+"").replace(/{yy}/g,i%100+"").replace(/{Q}/g,s+"").replace(/{MMMM}/g,g[o-1]).replace(/{MMM}/g,y[o-1]).replace(/{MM}/g,Lq(o,2)).replace(/{M}/g,o+"").replace(/{dd}/g,Lq(u,2)).replace(/{d}/g,u+"").replace(/{eeee}/g,b[l]).replace(/{ee}/g,x[l]).replace(/{e}/g,l+"").replace(/{HH}/g,Lq(c,2)).replace(/{H}/g,c+"").replace(/{hh}/g,Lq(h+"",2)).replace(/{h}/g,h+"").replace(/{mm}/g,Lq(p,2)).replace(/{m}/g,p+"").replace(/{ss}/g,Lq(f,2)).replace(/{s}/g,f+"").replace(/{SSS}/g,Lq(d,3)).replace(/{S}/g,d+"")}function Vq(e,t){var n=AU(e),r=n[Hq(t)]()+1,a=n[Gq(t)](),i=n[jq(t)](),o=n[qq(t)](),s=n[Xq(t)](),u=0===n[Kq(t)](),l=u&&0===s,c=l&&0===o,h=c&&0===i,p=h&&1===a;return p&&1===r?"year":p?"month":h?"day":c?"hour":l?"minute":u?"second":"millisecond"}function Wq(e,t,n){var r=aP(e)?AU(e):e;switch(t=t||Vq(e,n)){case"year":return r[Uq(n)]();case"half-year":return r[Hq(n)]()>=6?1:0;case"quarter":return Math.floor((r[Hq(n)]()+1)/4);case"month":return r[Hq(n)]();case"day":return r[Gq(n)]();case"half-day":return r[jq(n)]()/24;case"hour":return r[jq(n)]();case"minute":return r[qq(n)]();case"second":return r[Xq(n)]();case"millisecond":return r[Kq(n)]()}}function Uq(e){return e?"getUTCFullYear":"getFullYear"}function Hq(e){return e?"getUTCMonth":"getMonth"}function Gq(e){return e?"getUTCDate":"getDate"}function jq(e){return e?"getUTCHours":"getHours"}function qq(e){return e?"getUTCMinutes":"getMinutes"}function Xq(e){return e?"getUTCSeconds":"getSeconds"}function Kq(e){return e?"getUTCMilliseconds":"getMilliseconds"}function Yq(e){return e?"setUTCFullYear":"setFullYear"}function Zq(e){return e?"setUTCMonth":"setMonth"}function Qq(e){return e?"setUTCDate":"setDate"}function $q(e){return e?"setUTCHours":"setHours"}function Jq(e){return e?"setUTCMinutes":"setMinutes"}function eX(e){return e?"setUTCSeconds":"setSeconds"}function tX(e){return e?"setUTCMilliseconds":"setMilliseconds"}function nX(e){if(isNaN(FU(e)))return nP(e)?e:"-";var t=(e+"").split(".");return t[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(t.length>1?"."+t[1]:"")}function rX(e,t){return e=(e||"").toLowerCase().replace(/-(.)/g,(function(e,t){return t.toUpperCase()})),t&&e&&(e=e.charAt(0).toUpperCase()+e.slice(1)),e}var aX=vP,iX=/([&<>"'])/g,oX={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function sX(e){return null==e?"":(e+"").replace(iX,(function(e,t){return oX[t]}))}function uX(e,t,n){function r(e){return e&&gP(e)?e:"-"}function a(e){return!(null==e||isNaN(e)||!isFinite(e))}var i="time"===t,o=e instanceof Date;if(i||o){var s=i?AU(e):e;if(!isNaN(+s))return Bq(s,"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}",n);if(o)return"-"}if("ordinal"===t)return rP(e)?r(e):aP(e)&&a(e)?e+"":"-";var u=FU(e);return a(u)?nX(u):rP(e)?r(e):"boolean"===typeof e?e+"":"-"}var lX=["a","b","c","d","e","f","g"],cX=function(e,t){return"{"+e+(null==t?"":t)+"}"};function hX(e,t,n){eP(t)||(t=[t]);var r=t.length;if(!r)return"";for(var a=t[0].$vars||[],i=0;i<a.length;i++){var o=lX[i];e=e.replace(cX(o),cX(o,0))}for(var s=0;s<r;s++)for(var u=0;u<a.length;u++){var l=t[s][a[u]];e=e.replace(cX(lX[u],s),n?sX(l):l)}return e}function pX(e,t){return t=t||"transparent",nP(e)?e:iP(e)&&e.colorStops&&(e.colorStops[0]||{}).color||t}function fX(e,t){if("_blank"===t||"blank"===t){var n=window.open();n.opener=null,n.location.href=e}else window.open(e,t)}var dX=XL,vX=["left","right","top","bottom","width","height"],mX=[["width","left","right"],["height","top","bottom"]];function gX(e,t,n,r,a){var i=0,o=0;null==r&&(r=1/0),null==a&&(a=1/0);var s=0;t.eachChild((function(u,l){var c,h,p=u.getBoundingRect(),f=t.childAt(l+1),d=f&&f.getBoundingRect();if("horizontal"===e){var v=p.width+(d?-d.x+p.x:0);(c=i+v)>r||u.newline?(i=0,c=v,o+=s+n,s=p.height):s=Math.max(s,p.height)}else{var m=p.height+(d?-d.y+p.y:0);(h=o+m)>a||u.newline?(i+=s+n,o=0,h=m,s=p.width):s=Math.max(s,p.width)}u.newline||(u.x=i,u.y=o,u.markRedraw(),"horizontal"===e?i=c+n:o=h+n)}))}var yX=gX;JL(gX,"vertical"),JL(gX,"horizontal");function bX(e,t,n){n=aX(n||0);var r=t.width,a=t.height,i=_U(e.left,r),o=_U(e.top,a),s=_U(e.right,r),u=_U(e.bottom,a),l=_U(e.width,r),c=_U(e.height,a),h=n[2]+n[0],p=n[1]+n[3],f=e.aspect;switch(isNaN(l)&&(l=r-s-p-i),isNaN(c)&&(c=a-u-h-o),null!=f&&(isNaN(l)&&isNaN(c)&&(f>r/a?l=.8*r:c=.8*a),isNaN(l)&&(l=f*c),isNaN(c)&&(c=l/f)),isNaN(i)&&(i=r-s-l-p),isNaN(o)&&(o=a-u-c-h),e.left||e.right){case"center":i=r/2-l/2-n[3];break;case"right":i=r-l-p}switch(e.top||e.bottom){case"middle":case"center":o=a/2-c/2-n[0];break;case"bottom":o=a-c-h}i=i||0,o=o||0,isNaN(l)&&(l=r-p-i-(s||0)),isNaN(c)&&(c=a-h-o-(u||0));var d=new gz(i+n[3],o+n[0],l,c);return d.margin=n,d}function xX(e){var t=e.layoutMode||e.constructor.layoutMode;return iP(t)?t:t?{type:t}:null}function kX(e,t,n){var r=n&&n.ignoreSize;!eP(r)&&(r=[r,r]);var a=o(mX[0],0),i=o(mX[1],1);function o(n,a){var i={},o=0,l={},c=0;if(dX(n,(function(t){l[t]=e[t]})),dX(n,(function(e){s(t,e)&&(i[e]=l[e]=t[e]),u(i,e)&&o++,u(l,e)&&c++})),r[a])return u(t,n[1])?l[n[2]]=null:u(t,n[2])&&(l[n[1]]=null),l;if(2!==c&&o){if(o>=2)return i;for(var h=0;h<n.length;h++){var p=n[h];if(!s(i,p)&&s(e,p)){i[p]=e[p];break}}return i}return l}function s(e,t){return e.hasOwnProperty(t)}function u(e,t){return null!=e[t]&&"auto"!==e[t]}function l(e,t,n){dX(e,(function(e){t[e]=n[e]}))}l(mX[0],e,a),l(mX[1],e,i)}function wX(e){return function(e,t){return t&&e&&dX(vX,(function(n){t.hasOwnProperty(n)&&(e[n]=t[n])})),e}({},e)}var _X=eH(),SX=function(e){function t(t,n,r){var a=e.call(this,t,n,r)||this;return a.uid=gq("ec_cpt_model"),a}return wL(t,e),t.prototype.init=function(e,t,n){this.mergeDefaultAndTheme(e,n)},t.prototype.mergeDefaultAndTheme=function(e,t){var n=xX(this),r=n?wX(e):{};WL(e,t.getTheme().get(this.mainType)),WL(e,this.getDefaultOption()),n&&kX(e,r,n)},t.prototype.mergeOption=function(e,t){WL(this.option,e,!0);var n=xX(this);n&&kX(this.option,e,n)},t.prototype.optionUpdated=function(e,t){},t.prototype.getDefaultOption=function(){var e=this.constructor;if(!function(e){return!(!e||!e[DP])}(e))return e.defaultOption;var t=_X(this);if(!t.defaultOption){for(var n=[],r=e;r;){var a=r.prototype.defaultOption;a&&n.push(a),r=r.superClass}for(var i={},o=n.length-1;o>=0;o--)i=WL(i,n[o],!0);t.defaultOption=i}return t.defaultOption},t.prototype.getReferringComponents=function(e,t){var n=e+"Index",r=e+"Id";return iH(this.ecModel,e,{index:this.get(n,!0),id:this.get(r,!0)},t)},t.prototype.getBoxLayoutParams=function(){var e=this;return{left:e.get("left"),top:e.get("top"),right:e.get("right"),bottom:e.get("bottom"),width:e.get("width"),height:e.get("height")}},t.prototype.getZLevelKey=function(){return""},t.prototype.setZLevel=function(e){this.option.zlevel=e},t.protoInitialize=function(){var e=t.prototype;e.type="component",e.id="",e.name="",e.mainType="",e.subType="",e.componentIndex=0}(),t}(CG);FP(SX,CG),BP(SX),function(e){var t={};e.registerSubTypeDefaulter=function(e,n){var r=RP(e);t[r.main]=n},e.determineSubType=function(n,r){var a=r.type;if(!a){var i=RP(n).main;e.hasSubTypes(n)&&t[i]&&(a=t[i](r))}return a}}(SX),function(e,t){function n(e,t){return e[t]||(e[t]={predecessor:[],successor:[]}),e[t]}e.topologicalTravel=function(e,r,a,i){if(e.length){var o=function(e){var r={},a=[];return XL(e,(function(i){var o=n(r,i),s=function(e,t){var n=[];return XL(e,(function(e){GL(t,e)>=0&&n.push(e)})),n}(o.originalDeps=t(i),e);o.entryCount=s.length,0===o.entryCount&&a.push(i),XL(s,(function(e){GL(o.predecessor,e)<0&&o.predecessor.push(e);var t=n(r,e);GL(t.successor,e)<0&&t.successor.push(i)}))})),{graph:r,noEntryList:a}}(r),s=o.graph,u=o.noEntryList,l={};for(XL(e,(function(e){l[e]=!0}));u.length;){var c=u.pop(),h=s[c],p=!!l[c];p&&(a.call(i,c,h.originalDeps.slice()),delete l[c]),XL(h.successor,p?d:f)}XL(l,(function(){throw new Error("")}))}function f(e){s[e].entryCount--,0===s[e].entryCount&&u.push(e)}function d(e){l[e]=!0,f(e)}}}(SX,(function(e){var t=[];XL(SX.getClassesByMainType(e),(function(e){t=t.concat(e.dependencies||e.prototype.dependencies||[])})),t=KL(t,(function(e){return RP(e).main})),"dataset"!==e&&GL(t,"dataset")<=0&&t.unshift("dataset");return t}));var IX=SX,CX=eH(),TX=(eH(),function(){function e(){}return e.prototype.getColorFromPalette=function(e,t,n){var r=UU(this.get("color",!0)),a=this.get("colorLayer",!0);return NX(this,CX,r,a,e,t,n)},e.prototype.clearColorPalette=function(){!function(e,t){t(e).paletteIdx=0,t(e).paletteNameMap={}}(this,CX)},e}());function NX(e,t,n,r,a,i,o){var s=t(i=i||e),u=s.paletteIdx||0,l=s.paletteNameMap=s.paletteNameMap||{};if(l.hasOwnProperty(a))return l[a];var c=null!=o&&r?function(e,t){for(var n=e.length,r=0;r<n;r++)if(e[r].length>t)return e[r];return e[n-1]}(r,o):n;if((c=c||n)&&c.length){var h=c[u];return a&&(l[a]=h),s.paletteIdx=(u+1)%c.length,h}}var EX=/\{@(.+?)\}/g,MX=function(){function e(){}return e.prototype.getDataParams=function(e,t){var n=this.getData(t),r=this.getRawValue(e,t),a=n.getRawIndex(e),i=n.getName(e),o=n.getRawDataItem(e),s=n.getItemVisual(e,"style"),u=s&&s[n.getItemVisual(e,"drawType")||"fill"],l=s&&s.stroke,c=this.mainType,h="series"===c,p=n.userOutput&&n.userOutput.get();return{componentType:c,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:h?this.subType:null,seriesIndex:this.seriesIndex,seriesId:h?this.id:null,seriesName:h?this.name:null,name:i,dataIndex:a,data:o,dataType:t,value:r,color:u,borderColor:l,dimensionNames:p?p.fullDimensions:null,encode:p?p.encode:null,$vars:["seriesName","name","value"]}},e.prototype.getFormattedLabel=function(e,t,n,r,a,i){t=t||"normal";var o=this.getData(n),s=this.getDataParams(e,n);(i&&(s.value=i.interpolatedValue),null!=r&&eP(s.value)&&(s.value=s.value[r]),a)||(a=o.getItemModel(e).get("normal"===t?["label","formatter"]:[t,"label","formatter"]));return tP(a)?(s.status=t,s.dimensionIndex=r,a(s)):nP(a)?hX(a,s).replace(EX,(function(t,n){var r=n.length,a=n;"["===a.charAt(0)&&"]"===a.charAt(r-1)&&(a=+a.slice(1,r-1));var s=yj(o,e,a);if(i&&eP(i.interpolatedValue)){var u=o.getDimensionIndex(a);u>=0&&(s=i.interpolatedValue[u])}return null!=s?s+"":""})):void 0},e.prototype.getRawValue=function(e,t){return yj(this.getData(t),e)},e.prototype.formatTooltip=function(e,t,n){},e}();function AX(e){var t,n;return iP(e)?e.type&&(n=e):t=e,{text:t,frag:n}}function DX(e){return new RX(e)}var RX=function(){function e(e){e=e||{},this._reset=e.reset,this._plan=e.plan,this._count=e.count,this._onDirty=e.onDirty,this._dirty=!0}return e.prototype.perform=function(e){var t,n=this._upstream,r=e&&e.skip;if(this._dirty&&n){var a=this.context;a.data=a.outputData=n.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this),this._plan&&!r&&(t=this._plan(this.context));var i,o=c(this._modBy),s=this._modDataCount||0,u=c(e&&e.modBy),l=e&&e.modDataCount||0;function c(e){return!(e>=1)&&(e=1),e}o===u&&s===l||(t="reset"),(this._dirty||"reset"===t)&&(this._dirty=!1,i=this._doReset(r)),this._modBy=u,this._modDataCount=l;var h=e&&e.step;if(this._dueEnd=n?n._outputDueEnd:this._count?this._count(this.context):1/0,this._progress){var p=this._dueIndex,f=Math.min(null!=h?this._dueIndex+h:1/0,this._dueEnd);if(!r&&(i||p<f)){var d=this._progress;if(eP(d))for(var v=0;v<d.length;v++)this._doProgress(d[v],p,f,u,l);else this._doProgress(d,p,f,u,l)}this._dueIndex=f;var m=null!=this._settedOutputEnd?this._settedOutputEnd:f;0,this._outputDueEnd=m}else this._dueIndex=this._outputDueEnd=null!=this._settedOutputEnd?this._settedOutputEnd:this._dueEnd;return this.unfinished()},e.prototype.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},e.prototype._doProgress=function(e,t,n,r,a){OX.reset(t,n,r,a),this._callingProgress=e,this._callingProgress({start:t,end:n,count:n-t,next:OX.next},this.context)},e.prototype._doReset=function(e){var t,n;this._dueIndex=this._outputDueEnd=this._dueEnd=0,this._settedOutputEnd=null,!e&&this._reset&&((t=this._reset(this.context))&&t.progress&&(n=t.forceFirstProgress,t=t.progress),eP(t)&&!t.length&&(t=null)),this._progress=t,this._modBy=this._modDataCount=null;var r=this._downstream;return r&&r.dirty(),n},e.prototype.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},e.prototype.pipe=function(e){(this._downstream!==e||this._dirty)&&(this._downstream=e,e._upstream=this,e.dirty())},e.prototype.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},e.prototype.getUpstream=function(){return this._upstream},e.prototype.getDownstream=function(){return this._downstream},e.prototype.setOutputEnd=function(e){this._outputDueEnd=this._settedOutputEnd=e},e}(),OX=function(){var e,t,n,r,a,i={reset:function(u,l,c,h){t=u,e=l,n=c,r=h,a=Math.ceil(r/n),i.next=n>1&&r>0?s:o}};return i;function o(){return t<e?t++:null}function s(){var i=t%a*n+Math.ceil(t/a),o=t>=e?null:i<r?i:t;return t++,o}}(),FX=function(){function e(){}return e.prototype.getRawData=function(){throw new Error("not supported")},e.prototype.getRawDataItem=function(e){throw new Error("not supported")},e.prototype.cloneRawData=function(){},e.prototype.getDimensionInfo=function(e){},e.prototype.cloneAllDimensionInfo=function(){},e.prototype.count=function(){},e.prototype.retrieveValue=function(e,t){},e.prototype.retrieveValueFromItem=function(e,t){},e.prototype.convertValue=function(e,t){return Sj(e,t)},e}();function LX(e){if(!UX(e.sourceFormat)){0,_j("")}return e.data}function PX(e){var t=e.sourceFormat,n=e.data;if(!UX(t)){0,_j("")}if(t===RG){for(var r=[],a=0,i=n.length;a<i;a++)r.push(n[a].slice());return r}if(t===OG){for(r=[],a=0,i=n.length;a<i;a++)r.push(UL({},n[a]));return r}}function zX(e,t,n){if(null!=n)return aP(n)||!isNaN(n)&&!IP(t,n)?e[n]:IP(t,n)?t[n]:void 0}function BX(e){return VL(e)}var VX=wP();function WX(e,t,n,r){t.length||_j(""),iP(e)||_j("");var a=e.type,i=VX.get(a);i||_j("");var o=KL(t,(function(e){return function(e,t){var n=new FX,r=e.data,a=n.sourceFormat=e.sourceFormat,i=e.startIndex;e.seriesLayoutBy!==zG&&_j("");var o=[],s={},u=e.dimensionsDefine;if(u)XL(u,(function(e,t){var n=e.name,r={index:t,name:n,displayName:e.displayName};o.push(r),null!=n&&(IP(s,n)&&_j(""),s[n]=r)}));else for(var l=0;l<e.dimensionsDetectedCount;l++)o.push({index:l});var c=cj(a,zG);t.__isBuiltIn&&(n.getRawDataItem=function(e){return c(r,i,o,e)},n.getRawData=$L(LX,null,e)),n.cloneRawData=$L(PX,null,e);var h=fj(a,zG);n.count=$L(h,null,r,i,o);var p=mj(a);n.retrieveValue=function(e,t){var n=c(r,i,o,e);return f(n,t)};var f=n.retrieveValueFromItem=function(e,t){if(null!=e){var n=o[t];return n?p(e,t,n.name):void 0}};return n.getDimensionInfo=$L(zX,null,o,s),n.cloneAllDimensionInfo=$L(BX,null,o),n}(e,i)}));return KL(UU(i.transform({upstream:o[0],upstreamList:o,config:VL(e.config)})),(function(e,n){var r;iP(e)||_j(""),e.data||_j(""),UX(rj(e.data))||_j("");var a=t[0];if(a&&0===n&&!e.dimensions){var i=a.startIndex;i&&(e.data=a.data.slice(0,i).concat(e.data)),r={seriesLayoutBy:zG,sourceHeader:i,dimensions:a.metaRawOption.dimensions}}else r={seriesLayoutBy:zG,sourceHeader:0,dimensions:e.dimensions};return tj(e.data,r,null)}))}function UX(e){return e===RG||e===OG}var HX=function(){function e(e){this._sourceList=[],this._storeList=[],this._upstreamSignList=[],this._versionSignBase=0,this._dirty=!0,this._sourceHost=e}return e.prototype.dirty=function(){this._setLocalSource([],[]),this._storeList=[],this._dirty=!0},e.prototype._setLocalSource=function(e,t){this._sourceList=e,this._upstreamSignList=t,this._versionSignBase++,this._versionSignBase>9e10&&(this._versionSignBase=0)},e.prototype._getVersionSign=function(){return this._sourceHost.uid+"_"+this._versionSignBase},e.prototype.prepareSource=function(){this._isDirty()&&(this._createSource(),this._dirty=!1)},e.prototype._createSource=function(){this._setLocalSource([],[]);var e,t,n=this._sourceHost,r=this._getUpstreamSourceManagers(),a=!!r.length;if(GX(n)){var i=n,o=void 0,s=void 0,u=void 0;if(a){var l=r[0];l.prepareSource(),o=(u=l.getSource()).data,s=u.sourceFormat,t=[l._getVersionSign()]}else s=sP(o=i.get("data",!0))?LG:DG,t=[];var c=this._getSourceMetaRawOption()||{},h=u&&u.metaRawOption||{},p=pP(c.seriesLayoutBy,h.seriesLayoutBy)||null,f=pP(c.sourceHeader,h.sourceHeader),d=pP(c.dimensions,h.dimensions);e=p!==h.seriesLayoutBy||!!f!==!!h.sourceHeader||d?[tj(o,{seriesLayoutBy:p,sourceHeader:f,dimensions:d},s)]:[]}else{var v=n;if(a){var m=this._applyTransform(r);e=m.sourceList,t=m.upstreamSignList}else{e=[tj(v.get("source",!0),this._getSourceMetaRawOption(),null)],t=[]}}this._setLocalSource(e,t)},e.prototype._applyTransform=function(e){var t,n=this._sourceHost,r=n.get("transform",!0),a=n.get("fromTransformResult",!0);if(null!=a){1!==e.length&&jX("")}var i,o=[],s=[];return XL(e,(function(e){e.prepareSource();var t=e.getSource(a||0);null==a||t||jX(""),o.push(t),s.push(e._getVersionSign())})),r?t=function(e,t,n){var r=UU(e),a=r.length;a||_j("");for(var i=0,o=a;i<o;i++)t=WX(r[i],t),i!==o-1&&(t.length=Math.max(t.length,1));return t}(r,o,n.componentIndex):null!=a&&(t=[(i=o[0],new JG({data:i.data,sourceFormat:i.sourceFormat,seriesLayoutBy:i.seriesLayoutBy,dimensionsDefine:VL(i.dimensionsDefine),startIndex:i.startIndex,dimensionsDetectedCount:i.dimensionsDetectedCount}))]),{sourceList:t,upstreamSignList:s}},e.prototype._isDirty=function(){if(this._dirty)return!0;for(var e=this._getUpstreamSourceManagers(),t=0;t<e.length;t++){var n=e[t];if(n._isDirty()||this._upstreamSignList[t]!==n._getVersionSign())return!0}},e.prototype.getSource=function(e){e=e||0;var t=this._sourceList[e];if(!t){var n=this._getUpstreamSourceManagers();return n[0]&&n[0].getSource(e)}return t},e.prototype.getSharedDataStore=function(e){var t=e.makeStoreSchema();return this._innerGetDataStore(t.dimensions,e.source,t.hash)},e.prototype._innerGetDataStore=function(e,t,n){var r=this._storeList,a=r[0];a||(a=r[0]={});var i=a[n];if(!i){var o=this._getUpstreamSourceManagers()[0];GX(this._sourceHost)&&o?i=o._innerGetDataStore(e,t,n):(i=new zj).initData(new sj(t,e.length),e),a[n]=i}return i},e.prototype._getUpstreamSourceManagers=function(){var e=this._sourceHost;if(GX(e)){var t=jG(e);return t?[t.getSourceManager()]:[]}return KL(function(e){return e.get("transform",!0)||e.get("fromTransformResult",!0)?iH(e.ecModel,"dataset",{index:e.get("fromDatasetIndex",!0),id:e.get("fromDatasetId",!0)},aH).models:[]}(e),(function(e){return e.getSourceManager()}))},e.prototype._getSourceMetaRawOption=function(){var e,t,n,r=this._sourceHost;if(GX(r))e=r.get("seriesLayoutBy",!0),t=r.get("sourceHeader",!0),n=r.get("dimensions",!0);else if(!this._getUpstreamSourceManagers().length){var a=r;e=a.get("seriesLayoutBy",!0),t=a.get("sourceHeader",!0),n=a.get("dimensions",!0)}return{seriesLayoutBy:e,sourceHeader:t,dimensions:n}},e}();function GX(e){return"series"===e.mainType}function jX(e){throw new Error(e)}function qX(e,t){var n=e.color||"#6e7079",r=e.fontSize||12,a=e.fontWeight||"400",i=e.color||"#464646",o=e.fontSize||14,s=e.fontWeight||"900";return"html"===t?{nameStyle:"font-size:"+sX(r+"")+"px;color:"+sX(n)+";font-weight:"+sX(a+""),valueStyle:"font-size:"+sX(o+"")+"px;color:"+sX(i)+";font-weight:"+sX(s+"")}:{nameStyle:{fontSize:r,fill:n,fontWeight:a},valueStyle:{fontSize:o,fill:i,fontWeight:s}}}var XX=[0,10,20,30],KX=["","\n","\n\n","\n\n\n"];function YX(e,t){return t.type=e,t}function ZX(e){return"section"===e.type}function QX(e){return ZX(e)?JX:eK}function $X(e){if(ZX(e)){var t=0,n=e.blocks.length,r=n>1||n>0&&!e.noHeader;return XL(e.blocks,(function(e){var n=$X(e);n>=t&&(t=n+ +(r&&(!n||ZX(e)&&!e.noHeader)))})),t}return 0}function JX(e,t,n,r){var a,i=t.noHeader,o=(a=$X(t),{html:XX[a],richText:KX[a]}),s=[],u=t.blocks||[];mP(!u||eP(u)),u=u||[];var l=e.orderMode;if(t.sortBlocks&&l){u=u.slice();var c={valueAsc:"asc",valueDesc:"desc"};if(IP(c,l)){var h=new Cj(c[l],null);u.sort((function(e,t){return h.evaluate(e.sortParam,t.sortParam)}))}else"seriesDesc"===l&&u.reverse()}XL(u,(function(n,a){var i=t.valueFormatter,u=QX(n)(i?UL(UL({},e),{valueFormatter:i}):e,n,a>0?o.html:0,r);null!=u&&s.push(u)}));var p="richText"===e.renderMode?s.join(o.richText):nK(s.join(""),i?n:o.html);if(i)return p;var f=uX(t.header,"ordinal",e.useUTC),d=qX(r,e.renderMode).nameStyle;return"richText"===e.renderMode?rK(e,f,d)+o.richText+p:nK('<div style="'+d+";"+'line-height:1;">'+sX(f)+"</div>"+p,n)}function eK(e,t,n,r){var a=e.renderMode,i=t.noName,o=t.noValue,s=!t.markerType,u=t.name,l=e.useUTC,c=t.valueFormatter||e.valueFormatter||function(e){return KL(e=eP(e)?e:[e],(function(e,t){return uX(e,eP(f)?f[t]:f,l)}))};if(!i||!o){var h=s?"":e.markupStyleCreator.makeTooltipMarker(t.markerType,t.markerColor||"#333",a),p=i?"":uX(u,"ordinal",l),f=t.valueType,d=o?[]:c(t.value),v=!s||!i,m=!s&&i,g=qX(r,a),y=g.nameStyle,b=g.valueStyle;return"richText"===a?(s?"":h)+(i?"":rK(e,p,y))+(o?"":function(e,t,n,r,a){var i=[a],o=r?10:20;return n&&i.push({padding:[0,0,0,o],align:"right"}),e.markupStyleCreator.wrapRichTextStyle(eP(t)?t.join("  "):t,i)}(e,d,v,m,b)):nK((s?"":h)+(i?"":function(e,t,n){return'<span style="'+n+";"+(t?"margin-left:2px":"")+'">'+sX(e)+"</span>"}(p,!s,y))+(o?"":function(e,t,n,r){var a=n?"10px":"20px",i=t?"float:right;margin-left:"+a:"";return e=eP(e)?e:[e],'<span style="'+i+";"+r+'">'+KL(e,(function(e){return sX(e)})).join("&nbsp;&nbsp;")+"</span>"}(d,v,m,b)),n)}}function tK(e,t,n,r,a,i){if(e)return QX(e)({useUTC:a,renderMode:n,orderMode:r,markupStyleCreator:t,valueFormatter:e.valueFormatter},e,0,i)}function nK(e,t){return'<div style="'+("margin: "+t+"px 0 0")+";"+'line-height:1;">'+e+'<div style="clear:both"></div></div>'}function rK(e,t,n){return e.markupStyleCreator.wrapRichTextStyle(t,n)}function aK(e,t){var n=e.get("padding");return null!=n?n:"richText"===t?[8,10]:10}var iK=function(){function e(){this.richTextStyles={},this._nextStyleNameId=LU()}return e.prototype._generateStyleName=function(){return"__EC_aUTo_"+this._nextStyleNameId++},e.prototype.makeTooltipMarker=function(e,t,n){var r="richText"===n?this._generateStyleName():null,a=function(e,t){var n=nP(e)?{color:e,extraCssText:t}:e||{},r=n.color,a=n.type;t=n.extraCssText;var i=n.renderMode||"html";return r?"html"===i?"subItem"===a?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+sX(r)+";"+(t||"")+'"></span>':'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'+sX(r)+";"+(t||"")+'"></span>':{renderMode:i,content:"{"+(n.markerId||"markerX")+"|}  ",style:"subItem"===a?{width:4,height:4,borderRadius:2,backgroundColor:r}:{width:10,height:10,borderRadius:5,backgroundColor:r}}:""}({color:t,type:e,renderMode:n,markerId:r});return nP(a)?a:(this.richTextStyles[r]=a.style,a.content)},e.prototype.wrapRichTextStyle=function(e,t){var n={};eP(t)?XL(t,(function(e){return UL(n,e)})):UL(n,t);var r=this._generateStyleName();return this.richTextStyles[r]=n,"{"+r+"|"+e+"}"},e}();function oK(e){var t,n,r,a,i=e.series,o=e.dataIndex,s=e.multipleSeries,u=i.getData(),l=u.mapDimensionsAll("defaultedTooltip"),c=l.length,h=i.getRawValue(o),p=eP(h),f=function(e,t){return pX(e.getData().getItemVisual(t,"style")[e.visualDrawType])}(i,o);if(c>1||p&&!c){var d=function(e,t,n,r,a){var i=t.getData(),o=YL(e,(function(e,t,n){var r=i.getDimensionInfo(n);return e||r&&!1!==r.tooltip&&null!=r.displayName}),!1),s=[],u=[],l=[];function c(e,t){var n=i.getDimensionInfo(t);n&&!1!==n.otherDims.tooltip&&(o?l.push(YX("nameValue",{markerType:"subItem",markerColor:a,name:n.displayName,value:e,valueType:n.type})):(s.push(e),u.push(n.type)))}return r.length?XL(r,(function(e){c(yj(i,n,e),e)})):XL(e,c),{inlineValues:s,inlineValueTypes:u,blocks:l}}(h,i,o,l,f);t=d.inlineValues,n=d.inlineValueTypes,r=d.blocks,a=d.inlineValues[0]}else if(c){var v=u.getDimensionInfo(l[0]);a=t=yj(u,o,l[0]),n=v.type}else a=t=p?h[0]:h;var m=QU(i),g=m&&i.name||"",y=u.getName(o),b=s?g:y;return YX("section",{header:g,noHeader:s||!m,sortParam:a,blocks:[YX("nameValue",{markerType:"item",markerColor:f,name:b,noName:!gP(b),value:t,valueType:n})].concat(r||[])})}var sK=eH();function uK(e,t){return e.getName(t)||e.getId(t)}var lK=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._selectedDataIndicesMap={},t}return wL(t,e),t.prototype.init=function(e,t,n){this.seriesIndex=this.componentIndex,this.dataTask=DX({count:hK,reset:pK}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(e,n),(sK(this).sourceManager=new HX(this)).prepareSource();var r=this.getInitialData(e,n);dK(r,this),this.dataTask.context.data=r,sK(this).dataBeforeProcessed=r,cK(this),this._initSelectedMapFromData(r)},t.prototype.mergeDefaultAndTheme=function(e,t){var n=xX(this),r=n?wX(e):{},a=this.subType;IX.hasClass(a)&&(a+="Series"),WL(e,t.getTheme().get(this.subType)),WL(e,this.getDefaultOption()),HU(e,"label",["show"]),this.fillDataTextStyle(e.data),n&&kX(e,r,n)},t.prototype.mergeOption=function(e,t){e=WL(this.option,e,!0),this.fillDataTextStyle(e.data);var n=xX(this);n&&kX(this.option,e,n);var r=sK(this).sourceManager;r.dirty(),r.prepareSource();var a=this.getInitialData(e,t);dK(a,this),this.dataTask.dirty(),this.dataTask.context.data=a,sK(this).dataBeforeProcessed=a,cK(this),this._initSelectedMapFromData(a)},t.prototype.fillDataTextStyle=function(e){if(e&&!sP(e))for(var t=["show"],n=0;n<e.length;n++)e[n]&&e[n].label&&HU(e[n],"label",t)},t.prototype.getInitialData=function(e,t){},t.prototype.appendData=function(e){this.getRawData().appendData(e.data)},t.prototype.getData=function(e){var t=mK(this);if(t){var n=t.context.data;return null==e?n:n.getLinkedData(e)}return sK(this).data},t.prototype.getAllData=function(){var e=this.getData();return e&&e.getLinkedDataAll?e.getLinkedDataAll():[{data:e}]},t.prototype.setData=function(e){var t=mK(this);if(t){var n=t.context;n.outputData=e,t!==this.dataTask&&(n.data=e)}sK(this).data=e},t.prototype.getEncode=function(){var e=this.get("encode",!0);if(e)return wP(e)},t.prototype.getSourceManager=function(){return sK(this).sourceManager},t.prototype.getSource=function(){return this.getSourceManager().getSource()},t.prototype.getRawData=function(){return sK(this).dataBeforeProcessed},t.prototype.getColorBy=function(){return this.get("colorBy")||"series"},t.prototype.isColorBySeries=function(){return"series"===this.getColorBy()},t.prototype.getBaseAxis=function(){var e=this.coordinateSystem;return e&&e.getBaseAxis&&e.getBaseAxis()},t.prototype.formatTooltip=function(e,t,n){return oK({series:this,dataIndex:e,multipleSeries:t})},t.prototype.isAnimationEnabled=function(){var e=this.ecModel;if(MP.node&&(!e||!e.ssr))return!1;var t=this.getShallow("animation");return t&&this.getData().count()>this.getShallow("animationThreshold")&&(t=!1),!!t},t.prototype.restoreData=function(){this.dataTask.dirty()},t.prototype.getColorFromPalette=function(e,t,n){var r=this.ecModel,a=TX.prototype.getColorFromPalette.call(this,e,t,n);return a||(a=r.getColorFromPalette(e,t,n)),a},t.prototype.coordDimToDataDim=function(e){return this.getRawData().mapDimensionsAll(e)},t.prototype.getProgressive=function(){return this.get("progressive")},t.prototype.getProgressiveThreshold=function(){return this.get("progressiveThreshold")},t.prototype.select=function(e,t){this._innerSelect(this.getData(t),e)},t.prototype.unselect=function(e,t){var n=this.option.selectedMap;if(n){var r=this.option.selectedMode,a=this.getData(t);if("series"===r||"all"===n)return this.option.selectedMap={},void(this._selectedDataIndicesMap={});for(var i=0;i<e.length;i++){var o=uK(a,e[i]);n[o]=!1,this._selectedDataIndicesMap[o]=-1}}},t.prototype.toggleSelect=function(e,t){for(var n=[],r=0;r<e.length;r++)n[0]=e[r],this.isSelected(e[r],t)?this.unselect(n,t):this.select(n,t)},t.prototype.getSelectedDataIndices=function(){if("all"===this.option.selectedMap)return[].slice.call(this.getData().getIndices());for(var e=this._selectedDataIndicesMap,t=QL(e),n=[],r=0;r<t.length;r++){var a=e[t[r]];a>=0&&n.push(a)}return n},t.prototype.isSelected=function(e,t){var n=this.option.selectedMap;if(!n)return!1;var r=this.getData(t);return("all"===n||n[uK(r,e)])&&!r.getItemModel(e).get(["select","disabled"])},t.prototype.isUniversalTransitionEnabled=function(){if(this.__universalTransitionEnabled)return!0;var e=this.option.universalTransition;return!!e&&(!0===e||e&&e.enabled)},t.prototype._innerSelect=function(e,t){var n,r,a=this.option,i=a.selectedMode,o=t.length;if(i&&o)if("series"===i)a.selectedMap="all";else if("multiple"===i){iP(a.selectedMap)||(a.selectedMap={});for(var s=a.selectedMap,u=0;u<o;u++){var l=t[u];s[h=uK(e,l)]=!0,this._selectedDataIndicesMap[h]=e.getRawIndex(l)}}else if("single"===i||!0===i){var c=t[o-1],h=uK(e,c);a.selectedMap=((n={})[h]=!0,n),this._selectedDataIndicesMap=((r={})[h]=e.getRawIndex(c),r)}},t.prototype._initSelectedMapFromData=function(e){if(!this.option.selectedMap){var t=[];e.hasItemOption&&e.each((function(n){var r=e.getRawDataItem(n);r&&r.selected&&t.push(n)})),t.length>0&&this._innerSelect(e,t)}},t.registerClass=function(e){return IX.registerClass(e)},t.protoInitialize=function(){var e=t.prototype;e.type="series.__base__",e.seriesIndex=0,e.ignoreStyleOnData=!1,e.hasSymbolVisual=!1,e.defaultSymbol="circle",e.visualStyleAccessPath="itemStyle",e.visualDrawType="fill"}(),t}(IX);function cK(e){var t=e.name;QU(e)||(e.name=function(e){var t=e.getRawData(),n=t.mapDimensionsAll("seriesName"),r=[];return XL(n,(function(e){var n=t.getDimensionInfo(e);n.displayName&&r.push(n.displayName)})),r.join(" ")}(e)||t)}function hK(e){return e.model.getRawData().count()}function pK(e){var t=e.model;return t.setData(t.getRawData().cloneShallow()),fK}function fK(e,t){t.outputData&&e.end>t.outputData.count()&&t.model.getRawData().cloneShallow(t.outputData)}function dK(e,t){XL(function(e,t){for(var n=new e.constructor(e.length+t.length),r=0;r<e.length;r++)n[r]=e[r];var a=e.length;for(r=0;r<t.length;r++)n[r+a]=t[r];return n}(e.CHANGABLE_METHODS,e.DOWNSAMPLE_METHODS),(function(n){e.wrapMethod(n,JL(vK,t))}))}function vK(e,t){var n=mK(e);return n&&n.setOutputEnd((t||this).count()),t}function mK(e){var t=(e.ecModel||{}).scheduler,n=t&&t.getPipeline(e.uid);if(n){var r=n.currentTask;if(r){var a=r.agentStubMap;a&&(r=a.get(e.uid))}return r}}jL(lK,MX),jL(lK,TX),FP(lK,IX);var gK=lK,yK=wW.CMD,bK=[[],[],[]],xK=Math.sqrt,kK=Math.atan2;function wK(e,t){if(t){var n,r,a,i,o,s,u=e.data,l=e.len(),c=yK.M,h=yK.C,p=yK.L,f=yK.R,d=yK.A,v=yK.Q;for(a=0,i=0;a<l;){switch(n=u[a++],i=a,r=0,n){case c:case p:r=1;break;case h:r=3;break;case v:r=2;break;case d:var m=t[4],g=t[5],y=xK(t[0]*t[0]+t[1]*t[1]),b=xK(t[2]*t[2]+t[3]*t[3]),x=kK(-t[1]/b,t[0]/y);u[a]*=y,u[a++]+=m,u[a]*=b,u[a++]+=g,u[a++]*=y,u[a++]*=b,u[a++]+=x,u[a++]+=x,i=a+=2;break;case f:s[0]=u[a++],s[1]=u[a++],Zz(s,s,t),u[i++]=s[0],u[i++]=s[1],s[0]+=u[a++],s[1]+=u[a++],Zz(s,s,t),u[i++]=s[0],u[i++]=s[1]}for(o=0;o<r;o++){var k=bK[o];k[0]=u[a++],k[1]=u[a++],Zz(k,k,t),u[i++]=k[0],u[i++]=k[1]}}e.increaseVersion()}}var _K=Math.sqrt,SK=Math.sin,IK=Math.cos,CK=Math.PI;function TK(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function NK(e,t){return(e[0]*t[0]+e[1]*t[1])/(TK(e)*TK(t))}function EK(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(NK(e,t))}function MK(e,t,n,r,a,i,o,s,u,l,c){var h=u*(CK/180),p=IK(h)*(e-n)/2+SK(h)*(t-r)/2,f=-1*SK(h)*(e-n)/2+IK(h)*(t-r)/2,d=p*p/(o*o)+f*f/(s*s);d>1&&(o*=_K(d),s*=_K(d));var v=(a===i?-1:1)*_K((o*o*(s*s)-o*o*(f*f)-s*s*(p*p))/(o*o*(f*f)+s*s*(p*p)))||0,m=v*o*f/s,g=v*-s*p/o,y=(e+n)/2+IK(h)*m-SK(h)*g,b=(t+r)/2+SK(h)*m+IK(h)*g,x=EK([1,0],[(p-m)/o,(f-g)/s]),k=[(p-m)/o,(f-g)/s],w=[(-1*p-m)/o,(-1*f-g)/s],_=EK(k,w);if(NK(k,w)<=-1&&(_=CK),NK(k,w)>=1&&(_=0),_<0){var S=Math.round(_/CK*1e6)/1e6;_=2*CK+S%2*CK}c.addData(l,y,b,o,s,x,_,h,i)}var AK=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/gi,DK=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;var RK=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return GP(t,e),t.prototype.applyTransform=function(e){},t}(GW);function OK(e){return null!=e.setData}function FK(e,t){var n=function(e){var t=new wW;if(!e)return t;var n,r=0,a=0,i=r,o=a,s=wW.CMD,u=e.match(AK);if(!u)return t;for(var l=0;l<u.length;l++){for(var c=u[l],h=c.charAt(0),p=void 0,f=c.match(DK)||[],d=f.length,v=0;v<d;v++)f[v]=parseFloat(f[v]);for(var m=0;m<d;){var g=void 0,y=void 0,b=void 0,x=void 0,k=void 0,w=void 0,_=void 0,S=r,I=a,C=void 0,T=void 0;switch(h){case"l":r+=f[m++],a+=f[m++],p=s.L,t.addData(p,r,a);break;case"L":r=f[m++],a=f[m++],p=s.L,t.addData(p,r,a);break;case"m":r+=f[m++],a+=f[m++],p=s.M,t.addData(p,r,a),i=r,o=a,h="l";break;case"M":r=f[m++],a=f[m++],p=s.M,t.addData(p,r,a),i=r,o=a,h="L";break;case"h":r+=f[m++],p=s.L,t.addData(p,r,a);break;case"H":r=f[m++],p=s.L,t.addData(p,r,a);break;case"v":a+=f[m++],p=s.L,t.addData(p,r,a);break;case"V":a=f[m++],p=s.L,t.addData(p,r,a);break;case"C":p=s.C,t.addData(p,f[m++],f[m++],f[m++],f[m++],f[m++],f[m++]),r=f[m-2],a=f[m-1];break;case"c":p=s.C,t.addData(p,f[m++]+r,f[m++]+a,f[m++]+r,f[m++]+a,f[m++]+r,f[m++]+a),r+=f[m-2],a+=f[m-1];break;case"S":g=r,y=a,C=t.len(),T=t.data,n===s.C&&(g+=r-T[C-4],y+=a-T[C-3]),p=s.C,S=f[m++],I=f[m++],r=f[m++],a=f[m++],t.addData(p,g,y,S,I,r,a);break;case"s":g=r,y=a,C=t.len(),T=t.data,n===s.C&&(g+=r-T[C-4],y+=a-T[C-3]),p=s.C,S=r+f[m++],I=a+f[m++],r+=f[m++],a+=f[m++],t.addData(p,g,y,S,I,r,a);break;case"Q":S=f[m++],I=f[m++],r=f[m++],a=f[m++],p=s.Q,t.addData(p,S,I,r,a);break;case"q":S=f[m++]+r,I=f[m++]+a,r+=f[m++],a+=f[m++],p=s.Q,t.addData(p,S,I,r,a);break;case"T":g=r,y=a,C=t.len(),T=t.data,n===s.Q&&(g+=r-T[C-4],y+=a-T[C-3]),r=f[m++],a=f[m++],p=s.Q,t.addData(p,g,y,r,a);break;case"t":g=r,y=a,C=t.len(),T=t.data,n===s.Q&&(g+=r-T[C-4],y+=a-T[C-3]),r+=f[m++],a+=f[m++],p=s.Q,t.addData(p,g,y,r,a);break;case"A":b=f[m++],x=f[m++],k=f[m++],w=f[m++],_=f[m++],MK(S=r,I=a,r=f[m++],a=f[m++],w,_,b,x,k,p=s.A,t);break;case"a":b=f[m++],x=f[m++],k=f[m++],w=f[m++],_=f[m++],MK(S=r,I=a,r+=f[m++],a+=f[m++],w,_,b,x,k,p=s.A,t)}}"z"!==h&&"Z"!==h||(p=s.Z,t.addData(p),r=i,a=o),n=p}return t.toStatic(),t}(e),r=UL({},t);return r.buildPath=function(e){if(OK(e)){e.setData(n.data),(t=e.getContext())&&e.rebuildPath(t,1)}else{var t=e;n.rebuildPath(t,1)}},r.applyTransform=function(e){wK(n,e),this.dirtyShape()},r}function LK(e,t){t=t||{};var n=new GW;return e.shape&&n.setShape(e.shape),n.setStyle(e.style),t.bakeTransform?wK(n.path,e.getComputedTransform()):t.toLocal?n.setLocalTransform(e.getComputedTransform()):n.copyTransform(e),n.buildPath=e.buildPath,n.applyTransform=n.applyTransform,n.z=e.z,n.z2=e.z2,n.zlevel=e.zlevel,n}var PK=function(e){function t(t){var n=e.call(this)||this;return n.isGroup=!0,n._children=[],n.attr(t),n}return GP(t,e),t.prototype.childrenRef=function(){return this._children},t.prototype.children=function(){return this._children.slice()},t.prototype.childAt=function(e){return this._children[e]},t.prototype.childOfName=function(e){for(var t=this._children,n=0;n<t.length;n++)if(t[n].name===e)return t[n]},t.prototype.childCount=function(){return this._children.length},t.prototype.add=function(e){return e&&e!==this&&e.parent!==this&&(this._children.push(e),this._doAdd(e)),this},t.prototype.addBefore=function(e,t){if(e&&e!==this&&e.parent!==this&&t&&t.parent===this){var n=this._children,r=n.indexOf(t);r>=0&&(n.splice(r,0,e),this._doAdd(e))}return this},t.prototype.replace=function(e,t){var n=GL(this._children,e);return n>=0&&this.replaceAt(t,n),this},t.prototype.replaceAt=function(e,t){var n=this._children,r=n[t];if(e&&e!==this&&e.parent!==this&&e!==r){n[t]=e,r.parent=null;var a=this.__zr;a&&r.removeSelfFromZr(a),this._doAdd(e)}return this},t.prototype._doAdd=function(e){e.parent&&e.parent.remove(e),e.parent=this;var t=this.__zr;t&&t!==e.__zr&&e.addSelfToZr(t),t&&t.refresh()},t.prototype.remove=function(e){var t=this.__zr,n=this._children,r=GL(n,e);return r<0||(n.splice(r,1),e.parent=null,t&&e.removeSelfFromZr(t),t&&t.refresh()),this},t.prototype.removeAll=function(){for(var e=this._children,t=this.__zr,n=0;n<e.length;n++){var r=e[n];t&&r.removeSelfFromZr(t),r.parent=null}return e.length=0,this},t.prototype.eachChild=function(e,t){for(var n=this._children,r=0;r<n.length;r++){var a=n[r];e.call(t,a,r)}return this},t.prototype.traverse=function(e,t){for(var n=0;n<this._children.length;n++){var r=this._children[n],a=e.call(t,r);r.isGroup&&!a&&r.traverse(e,t)}return this},t.prototype.addSelfToZr=function(t){e.prototype.addSelfToZr.call(this,t);for(var n=0;n<this._children.length;n++){this._children[n].addSelfToZr(t)}},t.prototype.removeSelfFromZr=function(t){e.prototype.removeSelfFromZr.call(this,t);for(var n=0;n<this._children.length;n++){this._children[n].removeSelfFromZr(t)}},t.prototype.getBoundingRect=function(e){for(var t=new gz(0,0,0,0),n=e||this._children,r=[],a=null,i=0;i<n.length;i++){var o=n[i];if(!o.ignore&&!o.invisible){var s=o.getBoundingRect(),u=o.getLocalTransform(r);u?(gz.applyTransform(t,s,u),(a=a||t.clone()).union(t)):(a=a||s.clone()).union(s)}}return a||t},t}(RV);PK.prototype.type="group";var zK=PK,BK=function(){this.cx=0,this.cy=0,this.r=0},VK=function(e){function t(t){return e.call(this,t)||this}return GP(t,e),t.prototype.getDefaultShape=function(){return new BK},t.prototype.buildPath=function(e,t){e.moveTo(t.cx+t.r,t.cy),e.arc(t.cx,t.cy,t.r,0,2*Math.PI)},t}(GW);VK.prototype.type="circle";var WK=VK,UK=function(){this.cx=0,this.cy=0,this.rx=0,this.ry=0},HK=function(e){function t(t){return e.call(this,t)||this}return GP(t,e),t.prototype.getDefaultShape=function(){return new UK},t.prototype.buildPath=function(e,t){var n=.5522848,r=t.cx,a=t.cy,i=t.rx,o=t.ry,s=i*n,u=o*n;e.moveTo(r-i,a),e.bezierCurveTo(r-i,a-u,r-s,a-o,r,a-o),e.bezierCurveTo(r+s,a-o,r+i,a-u,r+i,a),e.bezierCurveTo(r+i,a+u,r+s,a+o,r,a+o),e.bezierCurveTo(r-s,a+o,r-i,a+u,r-i,a),e.closePath()},t}(GW);HK.prototype.type="ellipse";var GK=HK,jK=Math.PI,qK=2*jK,XK=Math.sin,KK=Math.cos,YK=Math.acos,ZK=Math.atan2,QK=Math.abs,$K=Math.sqrt,JK=Math.max,eY=Math.min,tY=1e-4;function nY(e,t,n,r,a,i,o){var s=e-n,u=t-r,l=(o?i:-i)/$K(s*s+u*u),c=l*u,h=-l*s,p=e+c,f=t+h,d=n+c,v=r+h,m=(p+d)/2,g=(f+v)/2,y=d-p,b=v-f,x=y*y+b*b,k=a-i,w=p*v-d*f,_=(b<0?-1:1)*$K(JK(0,k*k*x-w*w)),S=(w*b-y*_)/x,I=(-w*y-b*_)/x,C=(w*b+y*_)/x,T=(-w*y+b*_)/x,N=S-m,E=I-g,M=C-m,A=T-g;return N*N+E*E>M*M+A*A&&(S=C,I=T),{cx:S,cy:I,x0:-c,y0:-h,x1:S*(a/k-1),y1:I*(a/k-1)}}function rY(e,t){var n,r=JK(t.r,0),a=JK(t.r0||0,0),i=r>0;if(i||a>0){if(i||(r=a,a=0),a>r){var o=r;r=a,a=o}var s=t.startAngle,u=t.endAngle;if(!isNaN(s)&&!isNaN(u)){var l=t.cx,c=t.cy,h=!!t.clockwise,p=QK(u-s),f=p>qK&&p%qK;if(f>tY&&(p=f),r>tY)if(p>qK-tY)e.moveTo(l+r*KK(s),c+r*XK(s)),e.arc(l,c,r,s,u,!h),a>tY&&(e.moveTo(l+a*KK(u),c+a*XK(u)),e.arc(l,c,a,u,s,h));else{var d=void 0,v=void 0,m=void 0,g=void 0,y=void 0,b=void 0,x=void 0,k=void 0,w=void 0,_=void 0,S=void 0,I=void 0,C=void 0,T=void 0,N=void 0,E=void 0,M=r*KK(s),A=r*XK(s),D=a*KK(u),R=a*XK(u),O=p>tY;if(O){var F=t.cornerRadius;F&&(n=function(e){var t;if(eP(e)){var n=e.length;if(!n)return e;t=1===n?[e[0],e[0],0,0]:2===n?[e[0],e[0],e[1],e[1]]:3===n?e.concat(e[2]):e}else t=[e,e,e,e];return t}(F),d=n[0],v=n[1],m=n[2],g=n[3]);var L=QK(r-a)/2;if(y=eY(L,m),b=eY(L,g),x=eY(L,d),k=eY(L,v),S=w=JK(y,b),I=_=JK(x,k),(w>tY||_>tY)&&(C=r*KK(u),T=r*XK(u),N=a*KK(s),E=a*XK(s),p<jK)){var P=function(e,t,n,r,a,i,o,s){var u=n-e,l=r-t,c=o-a,h=s-i,p=h*u-c*l;if(!(p*p<tY))return[e+(p=(c*(t-i)-h*(e-a))/p)*u,t+p*l]}(M,A,N,E,C,T,D,R);if(P){var z=M-P[0],B=A-P[1],V=C-P[0],W=T-P[1],U=1/XK(YK((z*V+B*W)/($K(z*z+B*B)*$K(V*V+W*W)))/2),H=$K(P[0]*P[0]+P[1]*P[1]);S=eY(w,(r-H)/(U+1)),I=eY(_,(a-H)/(U-1))}}}if(O)if(S>tY){var G=eY(m,S),j=eY(g,S),q=nY(N,E,M,A,r,G,h),X=nY(C,T,D,R,r,j,h);e.moveTo(l+q.cx+q.x0,c+q.cy+q.y0),S<w&&G===j?e.arc(l+q.cx,c+q.cy,S,ZK(q.y0,q.x0),ZK(X.y0,X.x0),!h):(G>0&&e.arc(l+q.cx,c+q.cy,G,ZK(q.y0,q.x0),ZK(q.y1,q.x1),!h),e.arc(l,c,r,ZK(q.cy+q.y1,q.cx+q.x1),ZK(X.cy+X.y1,X.cx+X.x1),!h),j>0&&e.arc(l+X.cx,c+X.cy,j,ZK(X.y1,X.x1),ZK(X.y0,X.x0),!h))}else e.moveTo(l+M,c+A),e.arc(l,c,r,s,u,!h);else e.moveTo(l+M,c+A);if(a>tY&&O)if(I>tY){G=eY(d,I),q=nY(D,R,C,T,a,-(j=eY(v,I)),h),X=nY(M,A,N,E,a,-G,h);e.lineTo(l+q.cx+q.x0,c+q.cy+q.y0),I<_&&G===j?e.arc(l+q.cx,c+q.cy,I,ZK(q.y0,q.x0),ZK(X.y0,X.x0),!h):(j>0&&e.arc(l+q.cx,c+q.cy,j,ZK(q.y0,q.x0),ZK(q.y1,q.x1),!h),e.arc(l,c,a,ZK(q.cy+q.y1,q.cx+q.x1),ZK(X.cy+X.y1,X.cx+X.x1),h),G>0&&e.arc(l+X.cx,c+X.cy,G,ZK(X.y1,X.x1),ZK(X.y0,X.x0),!h))}else e.lineTo(l+D,c+R),e.arc(l,c,a,u,s,h);else e.lineTo(l+D,c+R)}else e.moveTo(l,c);e.closePath()}}}var aY=function(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.cornerRadius=0},iY=function(e){function t(t){return e.call(this,t)||this}return GP(t,e),t.prototype.getDefaultShape=function(){return new aY},t.prototype.buildPath=function(e,t){rY(e,t)},t.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},t}(GW);iY.prototype.type="sector";var oY=iY,sY=function(){this.cx=0,this.cy=0,this.r=0,this.r0=0},uY=function(e){function t(t){return e.call(this,t)||this}return GP(t,e),t.prototype.getDefaultShape=function(){return new sY},t.prototype.buildPath=function(e,t){var n=t.cx,r=t.cy,a=2*Math.PI;e.moveTo(n+t.r,r),e.arc(n,r,t.r,0,a,!1),e.moveTo(n+t.r0,r),e.arc(n,r,t.r0,0,a,!0)},t}(GW);uY.prototype.type="ring";var lY=uY;function cY(e,t,n){var r=t.smooth,a=t.points;if(a&&a.length>=2){if(r){var i=function(e,t,n,r){var a,i,o,s,u=[],l=[],c=[],h=[];if(r){o=[1/0,1/0],s=[-1/0,-1/0];for(var p=0,f=e.length;p<f;p++)Qz(o,o,e[p]),$z(s,s,e[p]);Qz(o,o,r[0]),$z(s,s,r[1])}for(p=0,f=e.length;p<f;p++){var d=e[p];if(n)a=e[p?p-1:f-1],i=e[(p+1)%f];else{if(0===p||p===f-1){u.push(Vz(e[p]));continue}a=e[p-1],i=e[p+1]}Uz(l,i,a),jz(l,l,t);var v=qz(d,a),m=qz(d,i),g=v+m;0!==g&&(v/=g,m/=g),jz(c,l,-v),jz(h,l,m);var y=Wz([],d,c),b=Wz([],d,h);r&&($z(y,y,o),Qz(y,y,s),$z(b,b,o),Qz(b,b,s)),u.push(y),u.push(b)}return n&&u.push(u.shift()),u}(a,r,n,t.smoothConstraint);e.moveTo(a[0][0],a[0][1]);for(var o=a.length,s=0;s<(n?o:o-1);s++){var u=i[2*s],l=i[2*s+1],c=a[(s+1)%o];e.bezierCurveTo(u[0],u[1],l[0],l[1],c[0],c[1])}}else{e.moveTo(a[0][0],a[0][1]);s=1;for(var h=a.length;s<h;s++)e.lineTo(a[s][0],a[s][1])}n&&e.closePath()}}var hY=function(){this.points=null,this.smooth=0,this.smoothConstraint=null},pY=function(e){function t(t){return e.call(this,t)||this}return GP(t,e),t.prototype.getDefaultShape=function(){return new hY},t.prototype.buildPath=function(e,t){cY(e,t,!0)},t}(GW);pY.prototype.type="polygon";var fY=pY,dY=function(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null},vY=function(e){function t(t){return e.call(this,t)||this}return GP(t,e),t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new dY},t.prototype.buildPath=function(e,t){cY(e,t,!1)},t}(GW);vY.prototype.type="polyline";var mY=vY,gY={},yY=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1},bY=function(e){function t(t){return e.call(this,t)||this}return GP(t,e),t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new yY},t.prototype.buildPath=function(e,t){var n,r,a,i;if(this.subPixelOptimize){var o=JW(gY,t,this.style);n=o.x1,r=o.y1,a=o.x2,i=o.y2}else n=t.x1,r=t.y1,a=t.x2,i=t.y2;var s=t.percent;0!==s&&(e.moveTo(n,r),s<1&&(a=n*(1-s)+a*s,i=r*(1-s)+i*s),e.lineTo(a,i))},t.prototype.pointAt=function(e){var t=this.shape;return[t.x1*(1-e)+t.x2*e,t.y1*(1-e)+t.y2*e]},t}(GW);bY.prototype.type="line";var xY=bY,kY=[],wY=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1};function _Y(e,t,n){var r=e.cpx2,a=e.cpy2;return null!=r||null!=a?[(n?_B:wB)(e.x1,e.cpx1,e.cpx2,e.x2,t),(n?_B:wB)(e.y1,e.cpy1,e.cpy2,e.y2,t)]:[(n?EB:NB)(e.x1,e.cpx1,e.x2,t),(n?EB:NB)(e.y1,e.cpy1,e.y2,t)]}var SY=function(e){function t(t){return e.call(this,t)||this}return GP(t,e),t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new wY},t.prototype.buildPath=function(e,t){var n=t.x1,r=t.y1,a=t.x2,i=t.y2,o=t.cpx1,s=t.cpy1,u=t.cpx2,l=t.cpy2,c=t.percent;0!==c&&(e.moveTo(n,r),null==u||null==l?(c<1&&(AB(n,o,a,c,kY),o=kY[1],a=kY[2],AB(r,s,i,c,kY),s=kY[1],i=kY[2]),e.quadraticCurveTo(o,s,a,i)):(c<1&&(CB(n,o,u,a,c,kY),o=kY[1],u=kY[2],a=kY[3],CB(r,s,l,i,c,kY),s=kY[1],l=kY[2],i=kY[3]),e.bezierCurveTo(o,s,u,l,a,i)))},t.prototype.pointAt=function(e){return _Y(this.shape,e,!1)},t.prototype.tangentAt=function(e){var t=_Y(this.shape,e,!0);return function(e,t){var n=Hz(t);return 0===n?(e[0]=0,e[1]=0):(e[0]=t[0]/n,e[1]=t[1]/n),e}(t,t)},t}(GW);SY.prototype.type="bezier-curve";var IY=SY,CY=function(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0},TY=function(e){function t(t){return e.call(this,t)||this}return GP(t,e),t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new CY},t.prototype.buildPath=function(e,t){var n=t.cx,r=t.cy,a=Math.max(t.r,0),i=t.startAngle,o=t.endAngle,s=t.clockwise,u=Math.cos(i),l=Math.sin(i);e.moveTo(u*a+n,l*a+r),e.arc(n,r,a,i,o,!s)},t}(GW);TY.prototype.type="arc";var NY=TY,EY=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="compound",t}return GP(t,e),t.prototype._updatePathDirty=function(){for(var e=this.shape.paths,t=this.shapeChanged(),n=0;n<e.length;n++)t=t||e[n].shapeChanged();t&&this.dirtyShape()},t.prototype.beforeBrush=function(){this._updatePathDirty();for(var e=this.shape.paths||[],t=this.getGlobalScale(),n=0;n<e.length;n++)e[n].path||e[n].createPathProxy(),e[n].path.setScale(t[0],t[1],e[n].segmentIgnoreThreshold)},t.prototype.buildPath=function(e,t){for(var n=t.paths||[],r=0;r<n.length;r++)n[r].buildPath(e,n[r].shape,!0)},t.prototype.afterBrush=function(){for(var e=this.shape.paths||[],t=0;t<e.length;t++)e[t].pathUpdated()},t.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),GW.prototype.getBoundingRect.call(this)},t}(GW),MY=EY,AY=function(){function e(e){this.colorStops=e||[]}return e.prototype.addColorStop=function(e,t){this.colorStops.push({offset:e,color:t})},e}(),DY=function(e){function t(t,n,r,a,i,o){var s=e.call(this,i)||this;return s.x=null==t?0:t,s.y=null==n?0:n,s.x2=null==r?1:r,s.y2=null==a?0:a,s.type="linear",s.global=o||!1,s}return GP(t,e),t}(AY),RY=function(e){function t(t,n,r,a,i){var o=e.call(this,a)||this;return o.x=null==t?.5:t,o.y=null==n?.5:n,o.r=null==r?.5:r,o.type="radial",o.global=i||!1,o}return GP(t,e),t}(AY),OY=[0,0],FY=[0,0],LY=new sz,PY=new sz,zY=function(){function e(e,t){this._corners=[],this._axes=[],this._origin=[0,0];for(var n=0;n<4;n++)this._corners[n]=new sz;for(n=0;n<2;n++)this._axes[n]=new sz;e&&this.fromBoundingRect(e,t)}return e.prototype.fromBoundingRect=function(e,t){var n=this._corners,r=this._axes,a=e.x,i=e.y,o=a+e.width,s=i+e.height;if(n[0].set(a,i),n[1].set(o,i),n[2].set(o,s),n[3].set(a,s),t)for(var u=0;u<4;u++)n[u].transform(t);sz.sub(r[0],n[1],n[0]),sz.sub(r[1],n[3],n[0]),r[0].normalize(),r[1].normalize();for(u=0;u<2;u++)this._origin[u]=r[u].dot(n[0])},e.prototype.intersect=function(e,t){var n=!0,r=!t;return LY.set(1/0,1/0),PY.set(0,0),!this._intersectCheckOneSide(this,e,LY,PY,r,1)&&(n=!1,r)||!this._intersectCheckOneSide(e,this,LY,PY,r,-1)&&(n=!1,r)||r||sz.copy(t,n?LY:PY),n},e.prototype._intersectCheckOneSide=function(e,t,n,r,a,i){for(var o=!0,s=0;s<2;s++){var u=this._axes[s];if(this._getProjMinMaxOnAxis(s,e._corners,OY),this._getProjMinMaxOnAxis(s,t._corners,FY),OY[1]<FY[0]||OY[0]>FY[1]){if(o=!1,a)return o;var l=Math.abs(FY[0]-OY[1]),c=Math.abs(OY[0]-FY[1]);Math.min(l,c)>r.len()&&(l<c?sz.scale(r,u,-l*i):sz.scale(r,u,c*i))}else if(n){l=Math.abs(FY[0]-OY[1]),c=Math.abs(OY[0]-FY[1]);Math.min(l,c)<n.len()&&(l<c?sz.scale(n,u,l*i):sz.scale(n,u,-c*i))}}return o},e.prototype._getProjMinMaxOnAxis=function(e,t,n){for(var r=this._axes[e],a=this._origin,i=t[0].dot(r)+a[e],o=i,s=i,u=1;u<t.length;u++){var l=t[u].dot(r)+a[e];o=Math.min(l,o),s=Math.max(l,s)}n[0]=o,n[1]=s},e}(),BY=zY,VY=[],WY=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.notClear=!0,t.incremental=!0,t._displayables=[],t._temporaryDisplayables=[],t._cursor=0,t}return GP(t,e),t.prototype.traverse=function(e,t){e.call(t,this)},t.prototype.useStyle=function(){this.style={}},t.prototype.getCursor=function(){return this._cursor},t.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},t.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},t.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},t.prototype.addDisplayable=function(e,t){t?this._temporaryDisplayables.push(e):this._displayables.push(e),this.markRedraw()},t.prototype.addDisplayables=function(e,t){t=t||!1;for(var n=0;n<e.length;n++)this.addDisplayable(e[n],t)},t.prototype.getDisplayables=function(){return this._displayables},t.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},t.prototype.eachPendingDisplayable=function(e){for(var t=this._cursor;t<this._displayables.length;t++)e&&e(this._displayables[t]);for(t=0;t<this._temporaryDisplayables.length;t++)e&&e(this._temporaryDisplayables[t])},t.prototype.update=function(){this.updateTransform();for(var e=this._cursor;e<this._displayables.length;e++){(t=this._displayables[e]).parent=this,t.update(),t.parent=null}for(e=0;e<this._temporaryDisplayables.length;e++){var t;(t=this._temporaryDisplayables[e]).parent=this,t.update(),t.parent=null}},t.prototype.getBoundingRect=function(){if(!this._rect){for(var e=new gz(1/0,1/0,-1/0,-1/0),t=0;t<this._displayables.length;t++){var n=this._displayables[t],r=n.getBoundingRect().clone();n.needLocalTransform()&&r.applyTransform(n.getLocalTransform(VY)),e.union(r)}this._rect=e}return this._rect},t.prototype.contain=function(e,t){var n=this.transformCoordToLocal(e,t);if(this.getBoundingRect().contain(n[0],n[1]))for(var r=0;r<this._displayables.length;r++){if(this._displayables[r].contain(e,t))return!0}return!1},t}(UV),UY=WY,HY=eH();function GY(e,t,n,r,a){var i;if(t&&t.ecModel){var o=t.ecModel.getUpdatePayload();i=o&&o.animation}var s="update"===e;if(t&&t.isAnimationEnabled()){var u=void 0,l=void 0,c=void 0;return r?(u=pP(r.duration,200),l=pP(r.easing,"cubicOut"),c=0):(u=t.getShallow(s?"animationDurationUpdate":"animationDuration"),l=t.getShallow(s?"animationEasingUpdate":"animationEasing"),c=t.getShallow(s?"animationDelayUpdate":"animationDelay")),i&&(null!=i.duration&&(u=i.duration),null!=i.easing&&(l=i.easing),null!=i.delay&&(c=i.delay)),tP(c)&&(c=c(n,a)),tP(u)&&(u=u(n)),{duration:u||0,delay:c,easing:l}}return null}function jY(e,t,n,r,a,i,o){var s,u=!1;tP(a)?(o=i,i=a,a=null):iP(a)&&(i=a.cb,o=a.during,u=a.isFrom,s=a.removeOpt,a=a.dataIndex);var l="leave"===e;l||t.stopAnimation("leave");var c=GY(e,r,a,l?s||{}:null,r&&r.getAnimationDelayParams?r.getAnimationDelayParams(t,a):null);if(c&&c.duration>0){var h={duration:c.duration,delay:c.delay||0,easing:c.easing,done:i,force:!!i||!!o,setToFinal:!l,scope:e,during:o};u?t.animateFrom(n,h):t.animateTo(n,h)}else t.stopAnimation(),!u&&t.attr(n),o&&o(1),i&&i()}function qY(e,t,n,r,a,i){jY("update",e,t,n,r,a,i)}function XY(e,t,n,r,a,i){jY("enter",e,t,n,r,a,i)}function KY(e){if(!e.__zr)return!0;for(var t=0;t<e.animators.length;t++){if("leave"===e.animators[t].scope)return!0}return!1}function YY(e,t,n,r,a,i){KY(e)||jY("leave",e,t,n,r,a,i)}function ZY(e,t,n,r){e.removeTextContent(),e.removeTextGuideLine(),YY(e,{style:{opacity:0}},t,n,r)}function QY(e,t,n){function r(){e.parent&&e.parent.remove(e)}e.isGroup?e.traverse((function(e){e.isGroup||ZY(e,t,n,r)})):ZY(e,t,n,r)}var $Y=Math.max,JY=Math.min,eZ={};function tZ(e){return GW.extend(e)}var nZ=function(e,t){var n=FK(e,t);return function(e){function t(t){var r=e.call(this,t)||this;return r.applyTransform=n.applyTransform,r.buildPath=n.buildPath,r}return GP(t,e),t}(RK)};function rZ(e,t){return nZ(e,t)}function aZ(e,t){eZ[e]=t}function iZ(e){if(eZ.hasOwnProperty(e))return eZ[e]}function oZ(e,t,n,r){var a=function(e,t){return new RK(FK(e,t))}(e,t);return n&&("center"===r&&(n=uZ(n,a.getBoundingRect())),cZ(a,n)),a}function sZ(e,t,n){var r=new QW({style:{image:e,x:t.x,y:t.y,width:t.width,height:t.height},onload:function(e){if("center"===n){var a={width:e.width,height:e.height};r.setStyle(uZ(t,a))}}});return r}function uZ(e,t){var n,r=t.width/t.height,a=e.height*r;return n=a<=e.width?e.height:(a=e.width)/r,{x:e.x+e.width/2-a/2,y:e.y+e.height/2-n/2,width:a,height:n}}var lZ=function(e,t){for(var n=[],r=e.length,a=0;a<r;a++){var i=e[a];n.push(i.getUpdatedPathProxy(!0))}var o=new GW(t);return o.createPathProxy(),o.buildPath=function(e){if(OK(e)){e.appendPath(n);var t=e.getContext();t&&e.rebuildPath(t,1)}},o};function cZ(e,t){if(e.applyTransform){var n=e.getBoundingRect().calculateTransform(t);e.applyTransform(n)}}function hZ(e){return JW(e.shape,e.shape,e.style),e}function pZ(e){return eU(e.shape,e.shape,e.style),e}var fZ=tU;function dZ(e,t){for(var n=ez([]);e&&e!==t;)nz(n,e.getLocalTransform(),n),e=e.parent;return n}function vZ(e,t,n){return t&&!qL(t)&&(t=uB.getLocalTransform(t)),n&&(t=iz([],t)),Zz([],e,t)}function mZ(e,t,n){var r=0===t[4]||0===t[5]||0===t[0]?1:Math.abs(2*t[4]/t[0]),a=0===t[4]||0===t[5]||0===t[2]?1:Math.abs(2*t[4]/t[2]),i=["left"===e?-r:"right"===e?r:0,"top"===e?-a:"bottom"===e?a:0];return i=vZ(i,t,n),Math.abs(i[0])>Math.abs(i[1])?i[0]>0?"right":"left":i[1]>0?"bottom":"top"}function gZ(e){return!e.isGroup}function yZ(e,t,n){if(e&&t){var r=function(e){var t={};return e.traverse((function(e){gZ(e)&&e.anid&&(t[e.anid]=e)})),t}(e);t.traverse((function(e){if(gZ(e)&&e.anid){var t=r[e.anid];if(t){var i=a(e);e.attr(a(t)),qY(e,i,n,sH(e).dataIndex)}}}))}function a(e){var t={x:e.x,y:e.y,rotation:e.rotation};return function(e){return null!=e.shape}(e)&&(t.shape=UL({},e.shape)),t}}function bZ(e,t){return KL(e,(function(e){var n=e[0];n=$Y(n,t.x),n=JY(n,t.x+t.width);var r=e[1];return r=$Y(r,t.y),[n,r=JY(r,t.y+t.height)]}))}function xZ(e,t){var n=$Y(e.x,t.x),r=JY(e.x+e.width,t.x+t.width),a=$Y(e.y,t.y),i=JY(e.y+e.height,t.y+t.height);if(r>=n&&i>=a)return{x:n,y:a,width:r-n,height:i-a}}function kZ(e,t,n){var r=UL({rectHover:!0},t),a=r.style={strokeNoScale:!0};if(n=n||{x:-1,y:-1,width:2,height:2},e)return 0===e.indexOf("image://")?(a.image=e.slice(8),HL(a,n),new QW(r)):oZ(e.replace("path://",""),r,n,"center")}function wZ(e,t,n,r,a){for(var i=0,o=a[a.length-1];i<a.length;i++){var s=a[i];if(_Z(e,t,n,r,s[0],s[1],o[0],o[1]))return!0;o=s}}function _Z(e,t,n,r,a,i,o,s){var u,l=n-e,c=r-t,h=o-a,p=s-i,f=SZ(h,p,l,c);if((u=f)<=1e-6&&u>=-1e-6)return!1;var d=e-a,v=t-i,m=SZ(d,v,l,c)/f;if(m<0||m>1)return!1;var g=SZ(d,v,h,p)/f;return!(g<0||g>1)}function SZ(e,t,n,r){return e*r-n*t}function IZ(e){var t=e.itemTooltipOption,n=e.componentModel,r=e.itemName,a=nP(t)?{formatter:t}:t,i=n.mainType,o=n.componentIndex,s={componentType:i,name:r,$vars:["name"]};s[i+"Index"]=o;var u=e.formatterParamsExtra;u&&XL(QL(u),(function(e){IP(s,e)||(s[e]=u[e],s.$vars.push(e))}));var l=sH(e.el);l.componentMainType=i,l.componentIndex=o,l.tooltipConfig={name:r,option:HL({content:r,formatterParams:s},a)}}function CZ(e,t){var n;e.isGroup&&(n=t(e)),n||e.traverse(t)}function TZ(e,t){if(e)if(eP(e))for(var n=0;n<e.length;n++)CZ(e[n],t);else CZ(e,t)}aZ("circle",WK),aZ("ellipse",GK),aZ("sector",oY),aZ("ring",lY),aZ("polygon",fY),aZ("polyline",mY),aZ("rect",iU),aZ("line",xY),aZ("bezierCurve",IY),aZ("arc",NY);var NZ=GW.extend({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var n=t.cx,r=t.cy,a=t.width/2,i=t.height/2;e.moveTo(n,r-i),e.lineTo(n+a,r+i),e.lineTo(n-a,r+i),e.closePath()}}),EZ=GW.extend({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var n=t.cx,r=t.cy,a=t.width/2,i=t.height/2;e.moveTo(n,r-i),e.lineTo(n+a,r),e.lineTo(n,r+i),e.lineTo(n-a,r),e.closePath()}}),MZ=GW.extend({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var n=t.x,r=t.y,a=t.width/5*3,i=Math.max(a,t.height),o=a/2,s=o*o/(i-o),u=r-i+o+s,l=Math.asin(s/o),c=Math.cos(l)*o,h=Math.sin(l),p=Math.cos(l),f=.6*o,d=.7*o;e.moveTo(n-c,u+s),e.arc(n,u,o,Math.PI-l,2*Math.PI+l),e.bezierCurveTo(n+c-h*f,u+s+p*f,n,r-d,n,r),e.bezierCurveTo(n,r-d,n-c+h*f,u+s+p*f,n-c,u+s),e.closePath()}}),AZ=GW.extend({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var n=t.height,r=t.width,a=t.x,i=t.y,o=r/3*2;e.moveTo(a,i),e.lineTo(a+o,i+n),e.lineTo(a,i+n/4*3),e.lineTo(a-o,i+n),e.lineTo(a,i),e.closePath()}}),DZ={line:function(e,t,n,r,a){a.x1=e,a.y1=t+r/2,a.x2=e+n,a.y2=t+r/2},rect:function(e,t,n,r,a){a.x=e,a.y=t,a.width=n,a.height=r},roundRect:function(e,t,n,r,a){a.x=e,a.y=t,a.width=n,a.height=r,a.r=Math.min(n,r)/4},square:function(e,t,n,r,a){var i=Math.min(n,r);a.x=e,a.y=t,a.width=i,a.height=i},circle:function(e,t,n,r,a){a.cx=e+n/2,a.cy=t+r/2,a.r=Math.min(n,r)/2},diamond:function(e,t,n,r,a){a.cx=e+n/2,a.cy=t+r/2,a.width=n,a.height=r},pin:function(e,t,n,r,a){a.x=e+n/2,a.y=t+r/2,a.width=n,a.height=r},arrow:function(e,t,n,r,a){a.x=e+n/2,a.y=t+r/2,a.width=n,a.height=r},triangle:function(e,t,n,r,a){a.cx=e+n/2,a.cy=t+r/2,a.width=n,a.height=r}},RZ={};XL({line:xY,rect:iU,roundRect:iU,square:iU,circle:WK,diamond:EZ,pin:MZ,arrow:AZ,triangle:NZ},(function(e,t){RZ[t]=new e}));var OZ=GW.extend({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(e,t,n){var r=Cz(e,t,n),a=this.shape;return a&&"pin"===a.symbolType&&"inside"===t.position&&(r.y=n.y+.4*n.height),r},buildPath:function(e,t,n){var r=t.symbolType;if("none"!==r){var a=RZ[r];a||(a=RZ[r="rect"]),DZ[r](t.x,t.y,t.width,t.height,a.shape),a.buildPath(e,a.shape,n)}}});function FZ(e,t){if("image"!==this.type){var n=this.style;this.__isEmptyBrush?(n.stroke=e,n.fill=t||"#fff",n.lineWidth=2):"line"===this.shape.symbolType?n.stroke=e:n.fill=e,this.markRedraw()}}function LZ(e,t,n,r,a,i,o){var s,u=0===e.indexOf("empty");return u&&(e=e.substr(5,1).toLowerCase()+e.substr(6)),(s=0===e.indexOf("image://")?sZ(e.slice(8),new gz(t,n,r,a),o?"center":"cover"):0===e.indexOf("path://")?oZ(e.slice(7),{},new gz(t,n,r,a),o?"center":"cover"):new OZ({shape:{symbolType:e,x:t,y:n,width:r,height:a}})).__isEmptyBrush=u,s.setColor=FZ,i&&s.setColor(i),s}function PZ(e,t){if(null!=e)return eP(e)||(e=[e,e]),[_U(e[0],t[0])||0,_U(pP(e[1],e[0]),t[1])||0]}var zZ=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.type=t.type,n.hasSymbolVisual=!0,n}return wL(t,e),t.prototype.getInitialData=function(e){return vq(null,this,{useEncodeDefaulter:!0})},t.prototype.getLegendIcon=function(e){var t=new zK,n=LZ("line",0,e.itemHeight/2,e.itemWidth,0,e.lineStyle.stroke,!1);t.add(n),n.setStyle(e.lineStyle);var r=this.getData().getVisual("symbol"),a=this.getData().getVisual("symbolRotate"),i="none"===r?"circle":r,o=.8*e.itemHeight,s=LZ(i,(e.itemWidth-o)/2,(e.itemHeight-o)/2,o,o,e.itemStyle.fill);t.add(s),s.setStyle(e.itemStyle);var u="inherit"===e.iconRotate?a:e.iconRotate||0;return s.rotation=u*Math.PI/180,s.setOrigin([e.itemWidth/2,e.itemHeight/2]),i.indexOf("empty")>-1&&(s.style.stroke=s.style.fill,s.style.fill="#fff",s.style.lineWidth=2),t},t.type="series.line",t.dependencies=["grid","polar"],t.defaultOption={z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},t}(gK),BZ=zZ;function VZ(e,t){var n=e.mapDimensionsAll("defaultedLabel"),r=n.length;if(1===r){var a=yj(e,t,n[0]);return null!=a?a+"":null}if(r){for(var i=[],o=0;o<n.length;o++)i.push(yj(e,t,n[o]));return i.join(" ")}}var WZ=function(e){function t(t,n,r,a){var i=e.call(this)||this;return i.updateData(t,n,r,a),i}return wL(t,e),t.prototype._createSymbol=function(e,t,n,r,a){this.removeAll();var i=LZ(e,-1,-1,2,2,null,a);i.attr({z2:100,culling:!0,scaleX:r[0]/2,scaleY:r[1]/2}),i.drift=UZ,this._symbolType=e,this.add(i)},t.prototype.stopSymbolAnimation=function(e){this.childAt(0).stopAnimation(null,e)},t.prototype.getSymbolType=function(){return this._symbolType},t.prototype.getSymbolPath=function(){return this.childAt(0)},t.prototype.highlight=function(){LH(this.childAt(0))},t.prototype.downplay=function(){PH(this.childAt(0))},t.prototype.setZ=function(e,t){var n=this.childAt(0);n.zlevel=e,n.z=t},t.prototype.setDraggable=function(e){var t=this.childAt(0);t.draggable=e,t.cursor=e?"move":t.cursor},t.prototype.updateData=function(e,n,r,a){this.silent=!1;var i,o=e.getItemVisual(n,"symbol")||"circle",s=e.hostModel,u=t.getSymbolSize(e,n),l=o!==this._symbolType,c=a&&a.disableAnimation;if(l){var h=e.getItemVisual(n,"symbolKeepAspect");this._createSymbol(o,e,n,u,h)}else{(f=this.childAt(0)).silent=!1;var p={scaleX:u[0]/2,scaleY:u[1]/2};c?f.attr(p):qY(f,p,s,n),HY(i=f).oldStyle=i.style}if(this._updateCommon(e,n,u,r,a),l){var f=this.childAt(0);if(!c){p={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:f.style.opacity}};f.scaleX=f.scaleY=0,f.style.opacity=0,XY(f,p,s,n)}}c&&this.childAt(0).stopAnimation("leave")},t.prototype._updateCommon=function(e,t,n,r,a){var i,o,s,u,l,c,h,p,f,d=this.childAt(0),v=e.hostModel;if(r&&(i=r.emphasisItemStyle,o=r.blurItemStyle,s=r.selectItemStyle,u=r.focus,l=r.blurScope,h=r.labelStatesModels,p=r.hoverScale,f=r.cursorStyle,c=r.emphasisDisabled),!r||e.hasItemOption){var m=r&&r.itemModel?r.itemModel:e.getItemModel(t),g=m.getModel("emphasis");i=g.getModel("itemStyle").getItemStyle(),s=m.getModel(["select","itemStyle"]).getItemStyle(),o=m.getModel(["blur","itemStyle"]).getItemStyle(),u=g.get("focus"),l=g.get("blurScope"),c=g.get("disabled"),h=sG(m),p=g.getShallow("scale"),f=m.getShallow("cursor")}var y=e.getItemVisual(t,"symbolRotate");d.attr("rotation",(y||0)*Math.PI/180||0);var b=PZ(e.getItemVisual(t,"symbolOffset"),n);b&&(d.x=b[0],d.y=b[1]),f&&d.attr("cursor",f);var x=e.getItemVisual(t,"style"),k=x.fill;if(d instanceof QW){var w=d.style;d.useStyle(UL({image:w.image,x:w.x,y:w.y,width:w.width,height:w.height},x))}else d.__isEmptyBrush?d.useStyle(UL({},x)):d.useStyle(x),d.style.decal=null,d.setColor(k,a&&a.symbolInnerColor),d.style.strokeNoScale=!0;var _=e.getItemVisual(t,"liftZ"),S=this._z2;null!=_?null==S&&(this._z2=d.z2,d.z2+=_):null!=S&&(d.z2=S,this._z2=null);var I=a&&a.useNameLabel;oG(d,h,{labelFetcher:v,labelDataIndex:t,defaultText:function(t){return I?e.getName(t):VZ(e,t)},inheritColor:k,defaultOpacity:x.opacity}),this._sizeX=n[0]/2,this._sizeY=n[1]/2;var C=d.ensureState("emphasis");if(C.style=i,d.ensureState("select").style=s,d.ensureState("blur").style=o,p){var T=Math.max(aP(p)?p:1.1,3/this._sizeY);C.scaleX=this._sizeX*T,C.scaleY=this._sizeY*T}this.setSymbolScale(1),YH(this,u,l,c)},t.prototype.setSymbolScale=function(e){this.scaleX=this.scaleY=e},t.prototype.fadeOut=function(e,t,n){var r=this.childAt(0),a=sH(this).dataIndex,i=n&&n.animation;if(this.silent=r.silent=!0,n&&n.fadeLabel){var o=r.getTextContent();o&&YY(o,{style:{opacity:0}},t,{dataIndex:a,removeOpt:i,cb:function(){r.removeTextContent()}})}else r.removeTextContent();YY(r,{style:{opacity:0},scaleX:0,scaleY:0},t,{dataIndex:a,cb:e,removeOpt:i})},t.getSymbolSize=function(e,t){return eP(n=e.getItemVisual(t,"symbolSize"))||(n=[+n,+n]),[n[0]||0,n[1]||0];var n},t}(zK);function UZ(e,t){this.parent.drift(e,t)}var HZ=WZ;function GZ(e,t,n,r){return t&&!isNaN(t[0])&&!isNaN(t[1])&&!(r.isIgnore&&r.isIgnore(n))&&!(r.clipShape&&!r.clipShape.contain(t[0],t[1]))&&"none"!==e.getItemVisual(n,"symbol")}function jZ(e){return null==e||iP(e)||(e={isIgnore:e}),e||{}}function qZ(e){var t=e.hostModel,n=t.getModel("emphasis");return{emphasisItemStyle:n.getModel("itemStyle").getItemStyle(),blurItemStyle:t.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:t.getModel(["select","itemStyle"]).getItemStyle(),focus:n.get("focus"),blurScope:n.get("blurScope"),emphasisDisabled:n.get("disabled"),hoverScale:n.get("scale"),labelStatesModels:sG(t),cursorStyle:t.get("cursor")}}var XZ=function(){function e(e){this.group=new zK,this._SymbolCtor=e||HZ}return e.prototype.updateData=function(e,t){this._progressiveEls=null,t=jZ(t);var n=this.group,r=e.hostModel,a=this._data,i=this._SymbolCtor,o=t.disableAnimation,s=qZ(e),u={disableAnimation:o},l=t.getSymbolPoint||function(t){return e.getItemLayout(t)};a||n.removeAll(),e.diff(a).add((function(r){var a=l(r);if(GZ(e,a,r,t)){var o=new i(e,r,s,u);o.setPosition(a),e.setItemGraphicEl(r,o),n.add(o)}})).update((function(c,h){var p=a.getItemGraphicEl(h),f=l(c);if(GZ(e,f,c,t)){var d=e.getItemVisual(c,"symbol")||"circle",v=p&&p.getSymbolType&&p.getSymbolType();if(!p||v&&v!==d)n.remove(p),(p=new i(e,c,s,u)).setPosition(f);else{p.updateData(e,c,s,u);var m={x:f[0],y:f[1]};o?p.attr(m):qY(p,m,r)}n.add(p),e.setItemGraphicEl(c,p)}else n.remove(p)})).remove((function(e){var t=a.getItemGraphicEl(e);t&&t.fadeOut((function(){n.remove(t)}),r)})).execute(),this._getSymbolPoint=l,this._data=e},e.prototype.updateLayout=function(){var e=this,t=this._data;t&&t.eachItemGraphicEl((function(t,n){var r=e._getSymbolPoint(n);t.setPosition(r),t.markRedraw()}))},e.prototype.incrementalPrepareUpdate=function(e){this._seriesScope=qZ(e),this._data=null,this.group.removeAll()},e.prototype.incrementalUpdate=function(e,t,n){function r(e){e.isGroup||(e.incremental=!0,e.ensureState("emphasis").hoverLayer=!0)}this._progressiveEls=[],n=jZ(n);for(var a=e.start;a<e.end;a++){var i=t.getItemLayout(a);if(GZ(t,i,a,n)){var o=new this._SymbolCtor(t,a,this._seriesScope);o.traverse(r),o.setPosition(i),this.group.add(o),t.setItemGraphicEl(a,o),this._progressiveEls.push(o)}}},e.prototype.eachRendered=function(e){TZ(this._progressiveEls||this.group,e)},e.prototype.remove=function(e){var t=this.group,n=this._data;n&&e?n.eachItemGraphicEl((function(e){e.fadeOut((function(){t.remove(e)}),n.hostModel)})):t.removeAll()},e}();function KZ(e,t,n){var r=e.getBaseAxis(),a=e.getOtherAxis(r),i=function(e,t){var n=0,r=e.scale.getExtent();"start"===t?n=r[0]:"end"===t?n=r[1]:aP(t)&&!isNaN(t)?n=t:r[0]>0?n=r[0]:r[1]<0&&(n=r[1]);return n}(a,n),o=r.dim,s=a.dim,u=t.mapDimension(s),l=t.mapDimension(o),c="x"===s||"radius"===s?1:0,h=KL(e.dimensions,(function(e){return t.mapDimension(e)})),p=!1,f=t.getCalculationInfo("stackResultDimension");return dq(t,h[0])&&(p=!0,h[0]=f),dq(t,h[1])&&(p=!0,h[1]=f),{dataDimsForPoint:h,valueStart:i,valueAxisDim:s,baseAxisDim:o,stacked:!!p,valueDim:u,baseDim:l,baseDataOffset:c,stackedOverDimension:t.getCalculationInfo("stackedOverDimension")}}function YZ(e,t,n,r){var a=NaN;e.stacked&&(a=n.get(n.getCalculationInfo("stackedOverDimension"),r)),isNaN(a)&&(a=e.valueStart);var i=e.baseDataOffset,o=[];return o[i]=n.get(e.baseDim,r),o[1-i]=a,t.dataToPoint(o)}var ZZ="undefined"!==typeof Float32Array,QZ=ZZ?Float32Array:Array;function $Z(e){return eP(e)?ZZ?new Float32Array(e):e:new QZ(e)}var JZ=Math.min,eQ=Math.max;function tQ(e,t){return isNaN(e)||isNaN(t)}function nQ(e,t,n,r,a,i,o,s,u){for(var l,c,h,p,f,d,v=n,m=0;m<r;m++){var g=t[2*v],y=t[2*v+1];if(v>=a||v<0)break;if(tQ(g,y)){if(u){v+=i;continue}break}if(v===n)e[i>0?"moveTo":"lineTo"](g,y),h=g,p=y;else{var b=g-l,x=y-c;if(b*b+x*x<.5){v+=i;continue}if(o>0){for(var k=v+i,w=t[2*k],_=t[2*k+1];w===g&&_===y&&m<r;)m++,v+=i,w=t[2*(k+=i)],_=t[2*k+1],b=(g=t[2*v])-l,x=(y=t[2*v+1])-c;var S=m+1;if(u)for(;tQ(w,_)&&S<r;)S++,w=t[2*(k+=i)],_=t[2*k+1];var I=.5,C=0,T=0,N=void 0,E=void 0;if(S>=r||tQ(w,_))f=g,d=y;else{C=w-l,T=_-c;var M=g-l,A=w-g,D=y-c,R=_-y,O=void 0,F=void 0;if("x"===s){var L=C>0?1:-1;f=g-L*(O=Math.abs(M))*o,d=y,N=g+L*(F=Math.abs(A))*o,E=y}else if("y"===s){var P=T>0?1:-1;f=g,d=y-P*(O=Math.abs(D))*o,N=g,E=y+P*(F=Math.abs(R))*o}else O=Math.sqrt(M*M+D*D),f=g-C*o*(1-(I=(F=Math.sqrt(A*A+R*R))/(F+O))),d=y-T*o*(1-I),E=y+T*o*I,N=JZ(N=g+C*o*I,eQ(w,g)),E=JZ(E,eQ(_,y)),N=eQ(N,JZ(w,g)),d=y-(T=(E=eQ(E,JZ(_,y)))-y)*O/F,f=JZ(f=g-(C=N-g)*O/F,eQ(l,g)),d=JZ(d,eQ(c,y)),N=g+(C=g-(f=eQ(f,JZ(l,g))))*F/O,E=y+(T=y-(d=eQ(d,JZ(c,y))))*F/O}e.bezierCurveTo(h,p,f,d,g,y),h=N,p=E}else e.lineTo(g,y)}l=g,c=y,v+=i}return m}var rQ=function(){this.smooth=0,this.smoothConstraint=!0},aQ=function(e){function t(t){var n=e.call(this,t)||this;return n.type="ec-polyline",n}return wL(t,e),t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new rQ},t.prototype.buildPath=function(e,t){var n=t.points,r=0,a=n.length/2;if(t.connectNulls){for(;a>0&&tQ(n[2*a-2],n[2*a-1]);a--);for(;r<a&&tQ(n[2*r],n[2*r+1]);r++);}for(;r<a;)r+=nQ(e,n,r,a,a,1,t.smooth,t.smoothMonotone,t.connectNulls)+1},t.prototype.getPointOn=function(e,t){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var n,r,a=this.path.data,i=wW.CMD,o="x"===t,s=[],u=0;u<a.length;){var l=void 0,c=void 0,h=void 0,p=void 0,f=void 0,d=void 0,v=void 0;switch(a[u++]){case i.M:n=a[u++],r=a[u++];break;case i.L:if(l=a[u++],c=a[u++],(v=o?(e-n)/(l-n):(e-r)/(c-r))<=1&&v>=0){var m=o?(c-r)*v+r:(l-n)*v+n;return o?[e,m]:[m,e]}n=l,r=c;break;case i.C:l=a[u++],c=a[u++],h=a[u++],p=a[u++],f=a[u++],d=a[u++];var g=o?SB(n,l,h,f,e,s):SB(r,c,p,d,e,s);if(g>0)for(var y=0;y<g;y++){var b=s[y];if(b<=1&&b>=0){m=o?wB(r,c,p,d,b):wB(n,l,h,f,b);return o?[e,m]:[m,e]}}n=f,r=d}}},t}(GW),iQ=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return wL(t,e),t}(rQ),oQ=function(e){function t(t){var n=e.call(this,t)||this;return n.type="ec-polygon",n}return wL(t,e),t.prototype.getDefaultShape=function(){return new iQ},t.prototype.buildPath=function(e,t){var n=t.points,r=t.stackedOnPoints,a=0,i=n.length/2,o=t.smoothMonotone;if(t.connectNulls){for(;i>0&&tQ(n[2*i-2],n[2*i-1]);i--);for(;a<i&&tQ(n[2*a],n[2*a+1]);a++);}for(;a<i;){var s=nQ(e,n,a,i,i,1,t.smooth,o,t.connectNulls);nQ(e,r,a+s-1,s,i,-1,t.stackedOnSmooth,o,t.connectNulls),a+=s+1,e.closePath()}},t}(GW);function sQ(){var e=eH();return function(t){var n=e(t),r=t.pipelineContext,a=!!n.large,i=!!n.progressiveRender,o=n.large=!(!r||!r.large),s=n.progressiveRender=!(!r||!r.progressiveRender);return!(a===o&&i===s)&&"reset"}}var uQ=eH(),lQ=sQ(),cQ=function(){function e(){this.group=new zK,this.uid=gq("viewChart"),this.renderTask=DX({plan:fQ,reset:dQ}),this.renderTask.context={view:this}}return e.prototype.init=function(e,t){},e.prototype.render=function(e,t,n,r){0},e.prototype.highlight=function(e,t,n,r){var a=e.getData(r&&r.dataType);a&&pQ(a,r,"emphasis")},e.prototype.downplay=function(e,t,n,r){var a=e.getData(r&&r.dataType);a&&pQ(a,r,"normal")},e.prototype.remove=function(e,t){this.group.removeAll()},e.prototype.dispose=function(e,t){},e.prototype.updateView=function(e,t,n,r){this.render(e,t,n,r)},e.prototype.updateLayout=function(e,t,n,r){this.render(e,t,n,r)},e.prototype.updateVisual=function(e,t,n,r){this.render(e,t,n,r)},e.prototype.eachRendered=function(e){TZ(this.group,e)},e.markUpdateMethod=function(e,t){uQ(e).updateMethod=t},e.protoInitialize=void(e.prototype.type="chart"),e}();function hQ(e,t,n){e&&eG(e)&&("emphasis"===t?LH:PH)(e,n)}function pQ(e,t,n){var r=JU(e,t),a=t&&null!=t.highlightKey?function(e){var t=lH[e];return null==t&&uH<=32&&(t=lH[e]=uH++),t}(t.highlightKey):null;null!=r?XL(UU(r),(function(t){hQ(e.getItemGraphicEl(t),n,a)})):e.eachItemGraphicEl((function(e){hQ(e,n,a)}))}function fQ(e){return lQ(e.model)}function dQ(e){var t=e.model,n=e.ecModel,r=e.api,a=e.payload,i=t.pipelineContext.progressiveRender,o=e.view,s=a&&uQ(a).updateMethod,u=i?"incrementalPrepareRender":s&&o[s]?s:"render";return"render"!==u&&o[u](t,n,r,a),vQ[u]}OP(cQ),BP(cQ);var vQ={incrementalPrepareRender:{progress:function(e,t){t.view.incrementalRender(e,t.model,t.ecModel,t.api,t.payload)}},render:{forceFirstProgress:!0,progress:function(e,t){t.view.render(t.model,t.ecModel,t.api,t.payload)}}},mQ=cQ;function gQ(e,t,n,r,a){var i=e.getArea(),o=i.x,s=i.y,u=i.width,l=i.height,c=n.get(["lineStyle","width"])||2;o-=c/2,s-=c/2,u+=c,l+=c,o=Math.floor(o),u=Math.round(u);var h=new iU({shape:{x:o,y:s,width:u,height:l}});if(t){var p=e.getBaseAxis(),f=p.isHorizontal(),d=p.inverse;f?(d&&(h.shape.x+=u),h.shape.width=0):(d||(h.shape.y+=l),h.shape.height=0);var v=tP(a)?function(e){a(e,h)}:null;XY(h,{shape:{width:u,height:l,x:o,y:s}},n,null,r,v)}return h}function yQ(e,t,n){var r=e.getArea(),a=SU(r.r0,1),i=SU(r.r,1),o=new oY({shape:{cx:SU(e.cx,1),cy:SU(e.cy,1),r0:a,r:i,startAngle:r.startAngle,endAngle:r.endAngle,clockwise:r.clockwise}});t&&("angle"===e.getBaseAxis().dim?o.shape.endAngle=r.startAngle:o.shape.r=a,XY(o,{shape:{endAngle:r.endAngle,r:i}},n));return o}function bQ(e,t){if(e.length===t.length){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return;return!0}}function xQ(e){for(var t=1/0,n=1/0,r=-1/0,a=-1/0,i=0;i<e.length;){var o=e[i++],s=e[i++];isNaN(o)||(t=Math.min(o,t),r=Math.max(o,r)),isNaN(s)||(n=Math.min(s,n),a=Math.max(s,a))}return[[t,n],[r,a]]}function kQ(e,t){var n=xQ(e),r=n[0],a=n[1],i=xQ(t),o=i[0],s=i[1];return Math.max(Math.abs(r[0]-o[0]),Math.abs(r[1]-o[1]),Math.abs(a[0]-s[0]),Math.abs(a[1]-s[1]))}function wQ(e){return aP(e)?e:e?.5:0}function _Q(e,t,n,r){var a=t.getBaseAxis(),i="x"===a.dim||"radius"===a.dim?0:1,o=[],s=0,u=[],l=[],c=[],h=[];if(r){for(s=0;s<e.length;s+=2)isNaN(e[s])||isNaN(e[s+1])||h.push(e[s],e[s+1]);e=h}for(s=0;s<e.length-2;s+=2)switch(c[0]=e[s+2],c[1]=e[s+3],l[0]=e[s],l[1]=e[s+1],o.push(l[0],l[1]),n){case"end":u[i]=c[i],u[1-i]=l[1-i],o.push(u[0],u[1]);break;case"middle":var p=(l[i]+c[i])/2,f=[];u[i]=f[i]=p,u[1-i]=l[1-i],f[1-i]=c[1-i],o.push(u[0],u[1]),o.push(f[0],f[1]);break;default:u[i]=l[i],u[1-i]=c[1-i],o.push(u[0],u[1])}return o.push(e[s++],e[s++]),o}function SQ(e,t,n){var r=e.getVisual("visualMeta");if(r&&r.length&&e.count()&&"cartesian2d"===t.type){for(var a,i,o=r.length-1;o>=0;o--){var s=e.getDimensionInfo(r[o].dimension);if("x"===(a=s&&s.coordDim)||"y"===a){i=r[o];break}}if(i){var u=t.getAxis(a),l=KL(i.stops,(function(e){return{coord:u.toGlobalCoord(u.dataToCoord(e.value)),color:e.color}})),c=l.length,h=i.outerColors.slice();c&&l[0].coord>l[c-1].coord&&(l.reverse(),h.reverse());var p=function(e,t){var n,r,a=[],i=e.length;function o(e,t,n){var r=e.coord;return{coord:n,color:$B((n-r)/(t.coord-r),[e.color,t.color])}}for(var s=0;s<i;s++){var u=e[s],l=u.coord;if(l<0)n=u;else{if(l>t){r?a.push(o(r,u,t)):n&&a.push(o(n,u,0),o(n,u,t));break}n&&(a.push(o(n,u,0)),n=null),a.push(u),r=u}}return a}(l,"x"===a?n.getWidth():n.getHeight()),f=p.length;if(!f&&c)return l[0].coord<0?h[1]?h[1]:l[c-1].color:h[0]?h[0]:l[0].color;var d=p[0].coord-10,v=p[f-1].coord+10,m=v-d;if(m<.001)return"transparent";XL(p,(function(e){e.offset=(e.coord-d)/m})),p.push({offset:f?p[f-1].offset:.5,color:h[1]||"transparent"}),p.unshift({offset:f?p[0].offset:.5,color:h[0]||"transparent"});var g=new DY(0,0,0,0,p,!0);return g[a]=d,g[a+"2"]=v,g}}}function IQ(e,t,n){var r=e.get("showAllSymbol"),a="auto"===r;if(!r||a){var i=n.getAxesByScale("ordinal")[0];if(i&&(!a||!function(e,t){var n=e.getExtent(),r=Math.abs(n[1]-n[0])/e.scale.count();isNaN(r)&&(r=0);for(var a=t.count(),i=Math.max(1,Math.round(a/5)),o=0;o<a;o+=i)if(1.5*HZ.getSymbolSize(t,o)[e.isHorizontal()?1:0]>r)return!1;return!0}(i,t))){var o=t.mapDimension(i.dim),s={};return XL(i.getViewLabels(),(function(e){var t=i.scale.getRawOrdinalNumber(e.tickValue);s[t]=1})),function(e){return!s.hasOwnProperty(t.get(o,e))}}}}function CQ(e,t){return[e[2*t],e[2*t+1]]}function TQ(e){if(e.get(["endLabel","show"]))return!0;for(var t=0;t<pH.length;t++)if(e.get([pH[t],"endLabel","show"]))return!0;return!1}function NQ(e,t,n,r){if(function(e,t){return e.type===t}(t,"cartesian2d")){var a=r.getModel("endLabel"),i=a.get("valueAnimation"),o=r.getData(),s={lastFrameIndex:0},u=TQ(r)?function(n,r){e._endLabelOnDuring(n,r,o,s,i,a,t)}:null,l=t.getBaseAxis().isHorizontal(),c=gQ(t,n,r,(function(){var t=e._endLabel;t&&n&&null!=s.originalX&&t.attr({x:s.originalX,y:s.originalY})}),u);if(!r.get("clip",!0)){var h=c.shape,p=Math.max(h.width,h.height);l?(h.y-=p,h.height+=2*p):(h.x-=p,h.width+=2*p)}return u&&u(1,c),c}return yQ(t,n,r)}var EQ=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return wL(t,e),t.prototype.init=function(){var e=new zK,t=new XZ;this.group.add(t.group),this._symbolDraw=t,this._lineGroup=e},t.prototype.render=function(e,t,n){var r=this,a=e.coordinateSystem,i=this.group,o=e.getData(),s=e.getModel("lineStyle"),u=e.getModel("areaStyle"),l=o.getLayout("points")||[],c="polar"===a.type,h=this._coordSys,p=this._symbolDraw,f=this._polyline,d=this._polygon,v=this._lineGroup,m=e.get("animation"),g=!u.isEmpty(),y=u.get("origin"),b=KZ(a,o,y),x=g&&function(e,t,n){if(!n.valueDim)return[];for(var r=t.count(),a=$Z(2*r),i=0;i<r;i++){var o=YZ(n,e,t,i);a[2*i]=o[0],a[2*i+1]=o[1]}return a}(a,o,b),k=e.get("showSymbol"),w=e.get("connectNulls"),_=k&&!c&&IQ(e,o,a),S=this._data;S&&S.eachItemGraphicEl((function(e,t){e.__temp&&(i.remove(e),S.setItemGraphicEl(t,null))})),k||p.remove(),i.add(v);var I,C=!c&&e.get("step");a&&a.getArea&&e.get("clip",!0)&&(null!=(I=a.getArea()).width?(I.x-=.1,I.y-=.1,I.width+=.2,I.height+=.2):I.r0&&(I.r0-=.5,I.r+=.5)),this._clipShapeForSymbol=I;var T=SQ(o,a,n)||o.getVisual("style")[o.getVisual("drawType")];if(f&&h.type===a.type&&C===this._step){g&&!d?d=this._newPolygon(l,x):d&&!g&&(v.remove(d),d=this._polygon=null),c||this._initOrUpdateEndLabel(e,a,pX(T));var N=v.getClipPath();if(N)XY(N,{shape:NQ(this,a,!1,e).shape},e);else v.setClipPath(NQ(this,a,!0,e));k&&p.updateData(o,{isIgnore:_,clipShape:I,disableAnimation:!0,getSymbolPoint:function(e){return[l[2*e],l[2*e+1]]}}),bQ(this._stackedOnPoints,x)&&bQ(this._points,l)||(m?this._doUpdateAnimation(o,x,a,n,C,y,w):(C&&(l=_Q(l,a,C,w),x&&(x=_Q(x,a,C,w))),f.setShape({points:l}),d&&d.setShape({points:l,stackedOnPoints:x})))}else k&&p.updateData(o,{isIgnore:_,clipShape:I,disableAnimation:!0,getSymbolPoint:function(e){return[l[2*e],l[2*e+1]]}}),m&&this._initSymbolLabelAnimation(o,a,I),C&&(l=_Q(l,a,C,w),x&&(x=_Q(x,a,C,w))),f=this._newPolyline(l),g&&(d=this._newPolygon(l,x)),c||this._initOrUpdateEndLabel(e,a,pX(T)),v.setClipPath(NQ(this,a,!0,e));var E=e.getModel("emphasis"),M=E.get("focus"),A=E.get("blurScope"),D=E.get("disabled");(f.useStyle(HL(s.getLineStyle(),{fill:"none",stroke:T,lineJoin:"bevel"})),$H(f,e,"lineStyle"),f.style.lineWidth>0&&"bolder"===e.get(["emphasis","lineStyle","width"]))&&(f.getState("emphasis").style.lineWidth=+f.style.lineWidth+1);sH(f).seriesIndex=e.seriesIndex,YH(f,M,A,D);var R=wQ(e.get("smooth")),O=e.get("smoothMonotone");if(f.setShape({smooth:R,smoothMonotone:O,connectNulls:w}),d){var F=o.getCalculationInfo("stackedOnSeries"),L=0;d.useStyle(HL(u.getAreaStyle(),{fill:T,opacity:.7,lineJoin:"bevel",decal:o.getVisual("style").decal})),F&&(L=wQ(F.get("smooth"))),d.setShape({smooth:R,stackedOnSmooth:L,smoothMonotone:O,connectNulls:w}),$H(d,e,"areaStyle"),sH(d).seriesIndex=e.seriesIndex,YH(d,M,A,D)}var P=function(e){r._changePolyState(e)};o.eachItemGraphicEl((function(e){e&&(e.onHoverStateChange=P)})),this._polyline.onHoverStateChange=P,this._data=o,this._coordSys=a,this._stackedOnPoints=x,this._points=l,this._step=C,this._valueOrigin=y,e.get("triggerLineEvent")&&(this.packEventData(e,f),d&&this.packEventData(e,d))},t.prototype.packEventData=function(e,t){sH(t).eventData={componentType:"series",componentSubType:"line",componentIndex:e.componentIndex,seriesIndex:e.seriesIndex,seriesName:e.name,seriesType:"line"}},t.prototype.highlight=function(e,t,n,r){var a=e.getData(),i=JU(a,r);if(this._changePolyState("emphasis"),!(i instanceof Array)&&null!=i&&i>=0){var o=a.getLayout("points"),s=a.getItemGraphicEl(i);if(!s){var u=o[2*i],l=o[2*i+1];if(isNaN(u)||isNaN(l))return;if(this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(u,l))return;var c=e.get("zlevel"),h=e.get("z");(s=new HZ(a,i)).x=u,s.y=l,s.setZ(c,h);var p=s.getSymbolPath().getTextContent();p&&(p.zlevel=c,p.z=h,p.z2=this._polyline.z2+1),s.__temp=!0,a.setItemGraphicEl(i,s),s.stopSymbolAnimation(!0),this.group.add(s)}s.highlight()}else mQ.prototype.highlight.call(this,e,t,n,r)},t.prototype.downplay=function(e,t,n,r){var a=e.getData(),i=JU(a,r);if(this._changePolyState("normal"),null!=i&&i>=0){var o=a.getItemGraphicEl(i);o&&(o.__temp?(a.setItemGraphicEl(i,null),this.group.remove(o)):o.downplay())}else mQ.prototype.downplay.call(this,e,t,n,r)},t.prototype._changePolyState=function(e){var t=this._polygon;AH(this._polyline,e),t&&AH(t,e)},t.prototype._newPolyline=function(e){var t=this._polyline;return t&&this._lineGroup.remove(t),t=new aQ({shape:{points:e},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(t),this._polyline=t,t},t.prototype._newPolygon=function(e,t){var n=this._polygon;return n&&this._lineGroup.remove(n),n=new oQ({shape:{points:e,stackedOnPoints:t},segmentIgnoreThreshold:2}),this._lineGroup.add(n),this._polygon=n,n},t.prototype._initSymbolLabelAnimation=function(e,t,n){var r,a,i=t.getBaseAxis(),o=i.inverse;"cartesian2d"===t.type?(r=i.isHorizontal(),a=!1):"polar"===t.type&&(r="angle"===i.dim,a=!0);var s=e.hostModel,u=s.get("animationDuration");tP(u)&&(u=u(null));var l=s.get("animationDelay")||0,c=tP(l)?l(null):l;e.eachItemGraphicEl((function(e,i){var s=e;if(s){var h=[e.x,e.y],p=void 0,f=void 0,d=void 0;if(n)if(a){var v=n,m=t.pointToCoord(h);r?(p=v.startAngle,f=v.endAngle,d=-m[1]/180*Math.PI):(p=v.r0,f=v.r,d=m[0])}else{var g=n;r?(p=g.x,f=g.x+g.width,d=e.x):(p=g.y+g.height,f=g.y,d=e.y)}var y=f===p?0:(d-p)/(f-p);o&&(y=1-y);var b=tP(l)?l(i):u*y+c,x=s.getSymbolPath(),k=x.getTextContent();s.attr({scaleX:0,scaleY:0}),s.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:b}),k&&k.animateFrom({style:{opacity:0}},{duration:300,delay:b}),x.disableLabelAnimation=!0}}))},t.prototype._initOrUpdateEndLabel=function(e,t,n){var r=e.getModel("endLabel");if(TQ(e)){var a=e.getData(),i=this._polyline,o=a.getLayout("points");if(!o)return i.removeTextContent(),void(this._endLabel=null);var s=this._endLabel;s||((s=this._endLabel=new xU({z2:200})).ignoreClip=!0,i.setTextContent(this._endLabel),i.disableLabelAnimation=!0);var u=function(e){for(var t,n,r=e.length/2;r>0&&(t=e[2*r-2],n=e[2*r-1],isNaN(t)||isNaN(n));r--);return r-1}(o);u>=0&&(oG(i,sG(e,"endLabel"),{inheritColor:n,labelFetcher:e,labelDataIndex:u,defaultText:function(e,t,n){return null!=n?function(e,t){var n=e.mapDimensionsAll("defaultedLabel");if(!eP(t))return t+"";for(var r=[],a=0;a<n.length;a++){var i=e.getDimensionIndex(n[a]);i>=0&&r.push(t[i])}return r.join(" ")}(a,n):VZ(a,e)},enableTextSetter:!0},function(e,t){var n=t.getBaseAxis(),r=n.isHorizontal(),a=n.inverse,i=r?a?"right":"left":"center",o=r?"middle":a?"top":"bottom";return{normal:{align:e.get("align")||i,verticalAlign:e.get("verticalAlign")||o}}}(r,t)),i.textConfig.position=null)}else this._endLabel&&(this._polyline.removeTextContent(),this._endLabel=null)},t.prototype._endLabelOnDuring=function(e,t,n,r,a,i,o){var s=this._endLabel,u=this._polyline;if(s){e<1&&null==r.originalX&&(r.originalX=s.x,r.originalY=s.y);var l=n.getLayout("points"),c=n.hostModel,h=c.get("connectNulls"),p=i.get("precision"),f=i.get("distance")||0,d=o.getBaseAxis(),v=d.isHorizontal(),m=d.inverse,g=t.shape,y=m?v?g.x:g.y+g.height:v?g.x+g.width:g.y,b=(v?f:0)*(m?-1:1),x=(v?0:-f)*(m?-1:1),k=v?"x":"y",w=function(e,t,n){for(var r,a,i=e.length/2,o="x"===n?0:1,s=0,u=-1,l=0;l<i;l++)if(a=e[2*l+o],!isNaN(a)&&!isNaN(e[2*l+1-o]))if(0!==l){if(r<=t&&a>=t||r>=t&&a<=t){u=l;break}s=l,r=a}else r=a;return{range:[s,u],t:(t-r)/(a-r)}}(l,y,k),_=w.range,S=_[1]-_[0],I=void 0;if(S>=1){if(S>1&&!h){var C=CQ(l,_[0]);s.attr({x:C[0]+b,y:C[1]+x}),a&&(I=c.getRawValue(_[0]))}else{(C=u.getPointOn(y,k))&&s.attr({x:C[0]+b,y:C[1]+x});var T=c.getRawValue(_[0]),N=c.getRawValue(_[1]);a&&(I=function(e,t,n,r,a){var i=null==t||"auto"===t;if(null==r)return r;if(aP(r))return SU(d=BU(n||0,r,a),i?Math.max(CU(n||0),CU(r)):t);if(nP(r))return a<1?n:r;for(var o=[],s=n,u=r,l=Math.max(s?s.length:0,u.length),c=0;c<l;++c){var h=e.getDimensionInfo(c);if(h&&"ordinal"===h.type)o[c]=(a<1&&s?s:u)[c];else{var p=s&&s[c]?s[c]:0,f=u[c],d=BU(p,f,a);o[c]=SU(d,i?Math.max(CU(p),CU(f)):t)}}return o}(n,p,T,N,w.t))}r.lastFrameIndex=_[0]}else{var E=1===e||r.lastFrameIndex>0?_[0]:0;C=CQ(l,E);a&&(I=c.getRawValue(E)),s.attr({x:C[0]+b,y:C[1]+x})}a&&dG(s).setLabelText(I)}},t.prototype._doUpdateAnimation=function(e,t,n,r,a,i,o){var s=this._polyline,u=this._polygon,l=e.hostModel,c=function(e,t,n,r,a,i,o,s){for(var u=function(e,t){var n=[];return t.diff(e).add((function(e){n.push({cmd:"+",idx:e})})).update((function(e,t){n.push({cmd:"=",idx:t,idx1:e})})).remove((function(e){n.push({cmd:"-",idx:e})})).execute(),n}(e,t),l=[],c=[],h=[],p=[],f=[],d=[],v=[],m=KZ(a,t,o),g=e.getLayout("points")||[],y=t.getLayout("points")||[],b=0;b<u.length;b++){var x=u[b],k=!0,w=void 0,_=void 0;switch(x.cmd){case"=":w=2*x.idx,_=2*x.idx1;var S=g[w],I=g[w+1],C=y[_],T=y[_+1];(isNaN(S)||isNaN(I))&&(S=C,I=T),l.push(S,I),c.push(C,T),h.push(n[w],n[w+1]),p.push(r[_],r[_+1]),v.push(t.getRawIndex(x.idx1));break;case"+":var N=x.idx,E=m.dataDimsForPoint,M=a.dataToPoint([t.get(E[0],N),t.get(E[1],N)]);_=2*N,l.push(M[0],M[1]),c.push(y[_],y[_+1]);var A=YZ(m,a,t,N);h.push(A[0],A[1]),p.push(r[_],r[_+1]),v.push(t.getRawIndex(N));break;case"-":k=!1}k&&(f.push(x),d.push(d.length))}d.sort((function(e,t){return v[e]-v[t]}));var D=l.length,R=$Z(D),O=$Z(D),F=$Z(D),L=$Z(D),P=[];for(b=0;b<d.length;b++){var z=d[b],B=2*b,V=2*z;R[B]=l[V],R[B+1]=l[V+1],O[B]=c[V],O[B+1]=c[V+1],F[B]=h[V],F[B+1]=h[V+1],L[B]=p[V],L[B+1]=p[V+1],P[b]=f[z]}return{current:R,next:O,stackedOnCurrent:F,stackedOnNext:L,status:P}}(this._data,e,this._stackedOnPoints,t,this._coordSys,0,this._valueOrigin),h=c.current,p=c.stackedOnCurrent,f=c.next,d=c.stackedOnNext;if(a&&(h=_Q(c.current,n,a,o),p=_Q(c.stackedOnCurrent,n,a,o),f=_Q(c.next,n,a,o),d=_Q(c.stackedOnNext,n,a,o)),kQ(h,f)>3e3||u&&kQ(p,d)>3e3)return s.stopAnimation(),s.setShape({points:f}),void(u&&(u.stopAnimation(),u.setShape({points:f,stackedOnPoints:d})));s.shape.__points=c.current,s.shape.points=h;var v={shape:{points:f}};c.current!==h&&(v.shape.__points=c.next),s.stopAnimation(),qY(s,v,l),u&&(u.setShape({points:h,stackedOnPoints:p}),u.stopAnimation(),qY(u,{shape:{stackedOnPoints:d}},l),s.shape.points!==u.shape.points&&(u.shape.points=s.shape.points));for(var m=[],g=c.status,y=0;y<g.length;y++){if("="===g[y].cmd){var b=e.getItemGraphicEl(g[y].idx1);b&&m.push({el:b,ptIdx:y})}}s.animators&&s.animators.length&&s.animators[0].during((function(){u&&u.dirtyShape();for(var e=s.shape.__points,t=0;t<m.length;t++){var n=m[t].el,r=2*m[t].ptIdx;n.x=e[r],n.y=e[r+1],n.markRedraw()}}))},t.prototype.remove=function(e){var t=this.group,n=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),n&&n.eachItemGraphicEl((function(e,r){e.__temp&&(t.remove(e),n.setItemGraphicEl(r,null))})),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},t.type="line",t}(mQ),MQ=EQ;var AQ={average:function(e){for(var t=0,n=0,r=0;r<e.length;r++)isNaN(e[r])||(t+=e[r],n++);return 0===n?NaN:t/n},sum:function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n]||0;return t},max:function(e){for(var t=-1/0,n=0;n<e.length;n++)e[n]>t&&(t=e[n]);return isFinite(t)?t:NaN},min:function(e){for(var t=1/0,n=0;n<e.length;n++)e[n]<t&&(t=e[n]);return isFinite(t)?t:NaN},nearest:function(e){return e[0]}},DQ=function(e){return Math.round(e.length/2)};var RQ=function(){function e(){this.group=new zK,this.uid=gq("viewComponent")}return e.prototype.init=function(e,t){},e.prototype.render=function(e,t,n,r){},e.prototype.dispose=function(e,t){},e.prototype.updateView=function(e,t,n,r){},e.prototype.updateLayout=function(e,t,n,r){},e.prototype.updateVisual=function(e,t,n,r){},e.prototype.toggleBlurSeries=function(e,t,n){},e.prototype.eachRendered=function(e){var t=this.group;t&&t.traverse(e)},e}();OP(RQ),BP(RQ);var OQ=RQ,FQ=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.type=t.type,n.layoutMode={type:"box",ignoreSize:!0},n}return wL(t,e),t.type="title",t.defaultOption={z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bold",color:"#464646"},subtextStyle:{fontSize:12,color:"#6E7079"}},t}(IX),LQ=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.type=t.type,n}return wL(t,e),t.prototype.render=function(e,t,n){if(this.group.removeAll(),e.get("show")){var r=this.group,a=e.getModel("textStyle"),i=e.getModel("subtextStyle"),o=e.get("textAlign"),s=pP(e.get("textBaseline"),e.get("textVerticalAlign")),u=new xU({style:uG(a,{text:e.get("text"),fill:a.getTextColor()},{disableBox:!0}),z2:10}),l=u.getBoundingRect(),c=e.get("subtext"),h=new xU({style:uG(i,{text:c,fill:i.getTextColor(),y:l.height+e.get("itemGap"),verticalAlign:"top"},{disableBox:!0}),z2:10}),p=e.get("link"),f=e.get("sublink"),d=e.get("triggerEvent",!0);u.silent=!p&&!d,h.silent=!f&&!d,p&&u.on("click",(function(){fX(p,"_"+e.get("target"))})),f&&h.on("click",(function(){fX(f,"_"+e.get("subtarget"))})),sH(u).eventData=sH(h).eventData=d?{componentType:"title",componentIndex:e.componentIndex}:null,r.add(u),c&&r.add(h);var v=r.getBoundingRect(),m=e.getBoxLayoutParams();m.width=v.width,m.height=v.height;var g=bX(m,{width:n.getWidth(),height:n.getHeight()},e.get("padding"));o||("middle"===(o=e.get("left")||e.get("right"))&&(o="center"),"right"===o?g.x+=g.width:"center"===o&&(g.x+=g.width/2)),s||("center"===(s=e.get("top")||e.get("bottom"))&&(s="middle"),"bottom"===s?g.y+=g.height:"middle"===s&&(g.y+=g.height/2),s=s||"top"),r.x=g.x,r.y=g.y,r.markRedraw();var y={align:o,verticalAlign:s};u.setStyle(y),h.setStyle(y),v=r.getBoundingRect();var b=g.margin,x=e.getItemStyle(["color","opacity"]);x.fill=e.get("backgroundColor");var k=new iU({shape:{x:v.x-b[3],y:v.y-b[0],width:v.width+b[1]+b[3],height:v.height+b[0]+b[2],r:e.get("borderRadius")},style:x,subPixelOptimize:!0,silent:!0});r.add(k)}},t.type="title",t}(OQ);function PQ(e,t){var n={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return function(e,t,n){var r=t.getComponent("tooltip"),a=t.getComponent("axisPointer"),i=a.get("link",!0)||[],o=[];XL(n.getCoordinateSystems(),(function(n){if(n.axisPointerEnabled){var s=UQ(n.model),u=e.coordSysAxesInfo[s]={};e.coordSysMap[s]=n;var l=n.model.getModel("tooltip",r);if(XL(n.getAxes(),JL(f,!1,null)),n.getTooltipAxes&&r&&l.get("show")){var c="axis"===l.get("trigger"),h="cross"===l.get(["axisPointer","type"]),p=n.getTooltipAxes(l.get(["axisPointer","axis"]));(c||h)&&XL(p.baseAxes,JL(f,!h||"cross",c)),h&&XL(p.otherAxes,JL(f,"cross",!1))}}function f(r,s,c){var h=c.model.getModel("axisPointer",a),p=h.get("show");if(p&&("auto"!==p||r||WQ(h))){null==s&&(s=h.get("triggerTooltip")),h=r?function(e,t,n,r,a,i){var o=t.getModel("axisPointer"),s={};XL(["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],(function(e){s[e]=VL(o.get(e))})),s.snap="category"!==e.type&&!!i,"cross"===o.get("type")&&(s.type="line");var u=s.label||(s.label={});if(null==u.show&&(u.show=!1),"cross"===a){var l=o.get(["label","show"]);if(u.show=null==l||l,!i){var c=s.lineStyle=o.get("crossStyle");c&&HL(u,c.textStyle)}}return e.model.getModel("axisPointer",new CG(s,n,r))}(c,l,a,t,r,s):h;var f=h.get("snap"),d=UQ(c.model),v=s||f||"category"===c.type,m=e.axesInfo[d]={key:d,axis:c,coordSys:n,axisPointerModel:h,triggerTooltip:s,involveSeries:v,snap:f,useHandle:WQ(h),seriesModels:[],linkGroup:null};u[d]=m,e.seriesInvolved=e.seriesInvolved||v;var g=function(e,t){for(var n=t.model,r=t.dim,a=0;a<e.length;a++){var i=e[a]||{};if(zQ(i[r+"AxisId"],n.id)||zQ(i[r+"AxisIndex"],n.componentIndex)||zQ(i[r+"AxisName"],n.name))return a}}(i,c);if(null!=g){var y=o[g]||(o[g]={axesInfo:{}});y.axesInfo[d]=m,y.mapper=i[g].mapper,m.linkGroup=y}}}}))}(n,e,t),n.seriesInvolved&&function(e,t){t.eachSeries((function(t){var n=t.coordinateSystem,r=t.get(["tooltip","trigger"],!0),a=t.get(["tooltip","show"],!0);n&&"none"!==r&&!1!==r&&"item"!==r&&!1!==a&&!1!==t.get(["axisPointer","show"],!0)&&XL(e.coordSysAxesInfo[UQ(n.model)],(function(e){var r=e.axis;n.getAxis(r.dim)===r&&(e.seriesModels.push(t),null==e.seriesDataCount&&(e.seriesDataCount=0),e.seriesDataCount+=t.getData().count())}))}))}(n,e),n}function zQ(e,t){return"all"===e||eP(e)&&GL(e,t)>=0||e===t}function BQ(e){var t=VQ(e);if(t){var n=t.axisPointerModel,r=t.axis.scale,a=n.option,i=n.get("status"),o=n.get("value");null!=o&&(o=r.parse(o));var s=WQ(n);null==i&&(a.status=s?"show":"hide");var u=r.getExtent().slice();u[0]>u[1]&&u.reverse(),(null==o||o>u[1])&&(o=u[1]),o<u[0]&&(o=u[0]),a.value=o,s&&(a.status=t.axis.scale.isBlank()?"hide":"show")}}function VQ(e){var t=(e.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return t&&t.axesInfo[UQ(e)]}function WQ(e){return!!e.get(["handle","show"])}function UQ(e){return e.type+"||"+e.id}var HQ={},GQ=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.type=t.type,n}return wL(t,e),t.prototype.render=function(t,n,r,a){this.axisPointerClass&&BQ(t),e.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(t,r,!0)},t.prototype.updateAxisPointer=function(e,t,n,r){this._doUpdateAxisPointerClass(e,n,!1)},t.prototype.remove=function(e,t){var n=this._axisPointer;n&&n.remove(t)},t.prototype.dispose=function(t,n){this._disposeAxisPointer(n),e.prototype.dispose.apply(this,arguments)},t.prototype._doUpdateAxisPointerClass=function(e,n,r){var a=t.getAxisPointerClass(this.axisPointerClass);if(a){var i=function(e){var t=VQ(e);return t&&t.axisPointerModel}(e);i?(this._axisPointer||(this._axisPointer=new a)).render(e,i,n,r):this._disposeAxisPointer(n)}},t.prototype._disposeAxisPointer=function(e){this._axisPointer&&this._axisPointer.dispose(e),this._axisPointer=null},t.registerAxisPointerClass=function(e,t){HQ[e]=t},t.getAxisPointerClass=function(e){return e&&HQ[e]},t.type="axis",t}(OQ),jQ=GQ,qQ=Math.log(2);function XQ(e,t,n,r,a,i){var o=r+"-"+a,s=e.length;if(i.hasOwnProperty(o))return i[o];if(1===t){var u=Math.round(Math.log((1<<s)-1&~a)/qQ);return e[n][u]}for(var l=r|1<<n,c=n+1;r&1<<c;)c++;for(var h=0,p=0,f=0;p<s;p++){var d=1<<p;d&a||(h+=(f%2?-1:1)*e[n][p]*XQ(e,t-1,c,l,a|d,i),f++)}return i[o]=h,h}function KQ(e,t){var n=[[e[0],e[1],1,0,0,0,-t[0]*e[0],-t[0]*e[1]],[0,0,0,e[0],e[1],1,-t[1]*e[0],-t[1]*e[1]],[e[2],e[3],1,0,0,0,-t[2]*e[2],-t[2]*e[3]],[0,0,0,e[2],e[3],1,-t[3]*e[2],-t[3]*e[3]],[e[4],e[5],1,0,0,0,-t[4]*e[4],-t[4]*e[5]],[0,0,0,e[4],e[5],1,-t[5]*e[4],-t[5]*e[5]],[e[6],e[7],1,0,0,0,-t[6]*e[6],-t[6]*e[7]],[0,0,0,e[6],e[7],1,-t[7]*e[6],-t[7]*e[7]]],r={},a=XQ(n,8,0,0,0,r);if(0!==a){for(var i=[],o=0;o<8;o++)for(var s=0;s<8;s++)null==i[s]&&(i[s]=0),i[s]+=((o+s)%2?-1:1)*XQ(n,7,0===o?1:0,1<<o,1<<s,r)/a*t[o];return function(e,t,n){var r=t*i[6]+n*i[7]+1;e[0]=(t*i[0]+n*i[1]+i[2])/r,e[1]=(t*i[3]+n*i[4]+i[5])/r}}}var YQ=[];function ZQ(e,t,n,r,a){if(t.getBoundingClientRect&&MP.domSupported&&!QQ(t)){var i=t.___zrEVENTSAVED||(t.___zrEVENTSAVED={}),o=function(e,t){var n=t.markers;if(n)return n;n=t.markers=[];for(var r=["left","right"],a=["top","bottom"],i=0;i<4;i++){var o=document.createElement("div"),s=i%2,u=(i>>1)%2;o.style.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",r[s]+":0",a[u]+":0",r[1-s]+":auto",a[1-u]+":auto",""].join("!important;"),e.appendChild(o),n.push(o)}return n}(t,i),s=function(e,t,n){for(var r=n?"invTrans":"trans",a=t[r],i=t.srcCoords,o=[],s=[],u=!0,l=0;l<4;l++){var c=e[l].getBoundingClientRect(),h=2*l,p=c.left,f=c.top;o.push(p,f),u=u&&i&&p===i[h]&&f===i[h+1],s.push(e[l].offsetLeft,e[l].offsetTop)}return u&&a?a:(t.srcCoords=o,t[r]=n?KQ(s,o):KQ(o,s))}(o,i,a);if(s)return s(e,n,r),!0}return!1}function QQ(e){return"CANVAS"===e.nodeName.toUpperCase()}var $Q=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,JQ=[],e$=MP.browser.firefox&&+MP.browser.version.split(".")[0]<39;function t$(e,t,n,r){return n=n||{},r?n$(e,t,n):e$&&null!=t.layerX&&t.layerX!==t.offsetX?(n.zrX=t.layerX,n.zrY=t.layerY):null!=t.offsetX?(n.zrX=t.offsetX,n.zrY=t.offsetY):n$(e,t,n),n}function n$(e,t,n){if(MP.domSupported&&e.getBoundingClientRect){var r=t.clientX,a=t.clientY;if(QQ(e)){var i=e.getBoundingClientRect();return n.zrX=r-i.left,void(n.zrY=a-i.top)}if(ZQ(JQ,e,r,a))return n.zrX=JQ[0],void(n.zrY=JQ[1])}n.zrX=n.zrY=0}function r$(e){return e||window.event}function a$(e,t,n){if(null!=(t=r$(t)).zrX)return t;var r=t.type;if(r&&r.indexOf("touch")>=0){var a="touchend"!==r?t.targetTouches[0]:t.changedTouches[0];a&&t$(e,a,t,n)}else{t$(e,t,t,n);var i=function(e){var t=e.wheelDelta;if(t)return t;var n=e.deltaX,r=e.deltaY;if(null==n||null==r)return t;return 3*(0!==r?Math.abs(r):Math.abs(n))*(r>0?-1:r<0?1:n>0?-1:1)}(t);t.zrDelta=i?i/120:-(t.detail||0)/3}var o=t.button;return null==t.which&&void 0!==o&&$Q.test(t.type)&&(t.which=1&o?1:2&o?3:4&o?2:0),t}function i$(e,t,n,r){e.removeEventListener(t,n,r)}var o$=function(e){e.preventDefault(),e.stopPropagation(),e.cancelBubble=!0};var s$="\0__throttleOriginMethod",u$="\0__throttleRate",l$="\0__throttleType";function c$(e,t,n){var r,a,i,o,s,u=0,l=0,c=null;function h(){l=(new Date).getTime(),c=null,e.apply(i,o||[])}t=t||0;var p=function(){for(var e=[],p=0;p<arguments.length;p++)e[p]=arguments[p];r=(new Date).getTime(),i=this,o=e;var f=s||t,d=s||n;s=null,a=r-(d?u:l)-f,clearTimeout(c),d?c=setTimeout(h,f):a>=0?h():c=setTimeout(h,-a),u=r};return p.clear=function(){c&&(clearTimeout(c),c=null)},p.debounceNextCall=function(e){s=e},p}function h$(e,t,n,r){var a=e[t];if(a){var i=a[s$]||a,o=a[l$];if(a[u$]!==n||o!==r){if(null==n||!r)return e[t]=i;(a=e[t]=c$(i,n,"debounce"===r))[s$]=i,a[l$]=r,a[u$]=n}return a}}function p$(e,t){var n=e[t];n&&n[s$]&&(n.clear&&n.clear(),e[t]=n[s$])}var f$=eH(),d$=VL,v$=$L,m$=function(){function e(){this._dragging=!1,this.animationThreshold=15}return e.prototype.render=function(e,t,n,r){var a=t.get("value"),i=t.get("status");if(this._axisModel=e,this._axisPointerModel=t,this._api=n,r||this._lastValue!==a||this._lastStatus!==i){this._lastValue=a,this._lastStatus=i;var o=this._group,s=this._handle;if(!i||"hide"===i)return o&&o.hide(),void(s&&s.hide());o&&o.show(),s&&s.show();var u={};this.makeElOption(u,a,e,t,n);var l=u.graphicKey;l!==this._lastGraphicKey&&this.clear(n),this._lastGraphicKey=l;var c=this._moveAnimation=this.determineAnimation(e,t);if(o){var h=JL(g$,t,c);this.updatePointerEl(o,u,h),this.updateLabelEl(o,u,h,t)}else o=this._group=new zK,this.createPointerEl(o,u,e,t),this.createLabelEl(o,u,e,t),n.getZr().add(o);k$(o,t,!0),this._renderHandle(a)}},e.prototype.remove=function(e){this.clear(e)},e.prototype.dispose=function(e){this.clear(e)},e.prototype.determineAnimation=function(e,t){var n=t.get("animation"),r=e.axis,a="category"===r.type,i=t.get("snap");if(!i&&!a)return!1;if("auto"===n||null==n){var o=this.animationThreshold;if(a&&r.getBandWidth()>o)return!0;if(i){var s=VQ(e).seriesDataCount,u=r.getExtent();return Math.abs(u[0]-u[1])/s>o}return!1}return!0===n},e.prototype.makeElOption=function(e,t,n,r,a){},e.prototype.createPointerEl=function(e,t,n,r){var a=t.pointer;if(a){var i=f$(e).pointerEl=new b[a.type](d$(t.pointer));e.add(i)}},e.prototype.createLabelEl=function(e,t,n,r){if(t.label){var a=f$(e).labelEl=new xU(d$(t.label));e.add(a),b$(a,r)}},e.prototype.updatePointerEl=function(e,t,n){var r=f$(e).pointerEl;r&&t.pointer&&(r.setStyle(t.pointer.style),n(r,{shape:t.pointer.shape}))},e.prototype.updateLabelEl=function(e,t,n,r){var a=f$(e).labelEl;a&&(a.setStyle(t.label.style),n(a,{x:t.label.x,y:t.label.y}),b$(a,r))},e.prototype._renderHandle=function(e){if(!this._dragging&&this.updateHandleTransform){var t,n=this._axisPointerModel,r=this._api.getZr(),a=this._handle,i=n.getModel("handle"),o=n.get("status");if(!i.get("show")||!o||"hide"===o)return a&&r.remove(a),void(this._handle=null);this._handle||(t=!0,a=this._handle=kZ(i.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(e){o$(e.event)},onmousedown:v$(this._onHandleDragMove,this,0,0),drift:v$(this._onHandleDragMove,this),ondragend:v$(this._onHandleDragEnd,this)}),r.add(a)),k$(a,n,!1),a.setStyle(i.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var s=i.get("size");eP(s)||(s=[s,s]),a.scaleX=s[0]/2,a.scaleY=s[1]/2,h$(this,"_doDispatchAxisPointer",i.get("throttle")||0,"fixRate"),this._moveHandleToValue(e,t)}},e.prototype._moveHandleToValue=function(e,t){g$(this._axisPointerModel,!t&&this._moveAnimation,this._handle,x$(this.getHandleTransform(e,this._axisModel,this._axisPointerModel)))},e.prototype._onHandleDragMove=function(e,t){var n=this._handle;if(n){this._dragging=!0;var r=this.updateHandleTransform(x$(n),[e,t],this._axisModel,this._axisPointerModel);this._payloadInfo=r,n.stopAnimation(),n.attr(x$(r)),f$(n).lastProp=null,this._doDispatchAxisPointer()}},e.prototype._doDispatchAxisPointer=function(){if(this._handle){var e=this._payloadInfo,t=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:e.cursorPoint[0],y:e.cursorPoint[1],tooltipOption:e.tooltipOption,axesInfo:[{axisDim:t.axis.dim,axisIndex:t.componentIndex}]})}},e.prototype._onHandleDragEnd=function(){if(this._dragging=!1,this._handle){var e=this._axisPointerModel.get("value");this._moveHandleToValue(e),this._api.dispatchAction({type:"hideTip"})}},e.prototype.clear=function(e){this._lastValue=null,this._lastStatus=null;var t=e.getZr(),n=this._group,r=this._handle;t&&n&&(this._lastGraphicKey=null,n&&t.remove(n),r&&t.remove(r),this._group=null,this._handle=null,this._payloadInfo=null),p$(this,"_doDispatchAxisPointer")},e.prototype.doClear=function(){},e.prototype.buildLabel=function(e,t,n){return{x:e[n=n||0],y:e[1-n],width:t[n],height:t[1-n]}},e}();function g$(e,t,n,r){y$(f$(n).lastProp,r)||(f$(n).lastProp=r,t?qY(n,r,e):(n.stopAnimation(),n.attr(r)))}function y$(e,t){if(iP(e)&&iP(t)){var n=!0;return XL(t,(function(t,r){n=n&&y$(e[r],t)})),!!n}return e===t}function b$(e,t){e[t.get(["label","show"])?"show":"hide"]()}function x$(e){return{x:e.x||0,y:e.y||0,rotation:e.rotation||0}}function k$(e,t,n){var r=t.get("z"),a=t.get("zlevel");e&&e.traverse((function(e){"group"!==e.type&&(null!=r&&(e.z=r),null!=a&&(e.zlevel=a),e.silent=n)}))}var w$=m$,_$=function(){function e(e){this._setting=e||{},this._extent=[1/0,-1/0]}return e.prototype.getSetting=function(e){return this._setting[e]},e.prototype.unionExtent=function(e){var t=this._extent;e[0]<t[0]&&(t[0]=e[0]),e[1]>t[1]&&(t[1]=e[1])},e.prototype.unionExtentFromData=function(e,t){this.unionExtent(e.getApproximateExtent(t))},e.prototype.getExtent=function(){return this._extent.slice()},e.prototype.setExtent=function(e,t){var n=this._extent;isNaN(e)||(n[0]=e),isNaN(t)||(n[1]=t)},e.prototype.isInExtentRange=function(e){return this._extent[0]<=e&&this._extent[1]>=e},e.prototype.isBlank=function(){return this._isBlank},e.prototype.setBlank=function(e){this._isBlank=e},e}();BP(_$);var S$=_$,I$=0;function C$(e){return iP(e)&&null!=e.value?e.value:e+""}var T$=function(){function e(e){this.categories=e.categories||[],this._needCollect=e.needCollect,this._deduplication=e.deduplication,this.uid=++I$}return e.createByAxisModel=function(t){var n=t.option,r=n.data,a=r&&KL(r,C$);return new e({categories:a,needCollect:!a,deduplication:!1!==n.dedplication})},e.prototype.getOrdinal=function(e){return this._getOrCreateMap().get(e)},e.prototype.parseAndCollect=function(e){var t,n=this._needCollect;if(!nP(e)&&!n)return e;if(n&&!this._deduplication)return t=this.categories.length,this.categories[t]=e,t;var r=this._getOrCreateMap();return null==(t=r.get(e))&&(n?(t=this.categories.length,this.categories[t]=e,r.set(e,t)):t=NaN),t},e.prototype._getOrCreateMap=function(){return this._map||(this._map=wP(this.categories))},e}();function N$(e){return"interval"===e.type||"log"===e.type}function E$(e,t,n,r){var a={},i=e[1]-e[0],o=a.interval=RU(i/t,!0);null!=n&&o<n&&(o=a.interval=n),null!=r&&o>r&&(o=a.interval=r);var s=a.intervalPrecision=A$(o);return function(e,t){!isFinite(e[0])&&(e[0]=t[0]),!isFinite(e[1])&&(e[1]=t[1]),D$(e,0,t),D$(e,1,t),e[0]>e[1]&&(e[0]=e[1])}(a.niceTickExtent=[SU(Math.ceil(e[0]/o)*o,s),SU(Math.floor(e[1]/o)*o,s)],e),a}function M$(e){var t=Math.pow(10,DU(e)),n=e/t;return n?2===n?n=3:3===n?n=5:n*=2:n=1,SU(n*t)}function A$(e){return CU(e)+2}function D$(e,t,n){e[t]=Math.max(Math.min(e[t],n[1]),n[0])}function R$(e,t){return e>=t[0]&&e<=t[1]}function O$(e,t){return t[1]===t[0]?.5:(e-t[0])/(t[1]-t[0])}function F$(e,t){return e*(t[1]-t[0])+t[0]}var L$=function(e){function t(t){var n=e.call(this,t)||this;n.type="ordinal";var r=n.getSetting("ordinalMeta");return r||(r=new T$({})),eP(r)&&(r=new T$({categories:KL(r,(function(e){return iP(e)?e.value:e}))})),n._ordinalMeta=r,n._extent=n.getSetting("extent")||[0,r.categories.length-1],n}return wL(t,e),t.prototype.parse=function(e){return null==e?NaN:nP(e)?this._ordinalMeta.getOrdinal(e):Math.round(e)},t.prototype.contain=function(e){return R$(e=this.parse(e),this._extent)&&null!=this._ordinalMeta.categories[e]},t.prototype.normalize=function(e){return O$(e=this._getTickNumber(this.parse(e)),this._extent)},t.prototype.scale=function(e){return e=Math.round(F$(e,this._extent)),this.getRawOrdinalNumber(e)},t.prototype.getTicks=function(){for(var e=[],t=this._extent,n=t[0];n<=t[1];)e.push({value:n}),n++;return e},t.prototype.getMinorTicks=function(e){},t.prototype.setSortInfo=function(e){if(null!=e){for(var t=e.ordinalNumbers,n=this._ordinalNumbersByTick=[],r=this._ticksByOrdinalNumber=[],a=0,i=this._ordinalMeta.categories.length,o=Math.min(i,t.length);a<o;++a){var s=t[a];n[a]=s,r[s]=a}for(var u=0;a<i;++a){for(;null!=r[u];)u++;n.push(u),r[u]=a}}else this._ordinalNumbersByTick=this._ticksByOrdinalNumber=null},t.prototype._getTickNumber=function(e){var t=this._ticksByOrdinalNumber;return t&&e>=0&&e<t.length?t[e]:e},t.prototype.getRawOrdinalNumber=function(e){var t=this._ordinalNumbersByTick;return t&&e>=0&&e<t.length?t[e]:e},t.prototype.getLabel=function(e){if(!this.isBlank()){var t=this.getRawOrdinalNumber(e.value),n=this._ordinalMeta.categories[t];return null==n?"":n+""}},t.prototype.count=function(){return this._extent[1]-this._extent[0]+1},t.prototype.unionExtentFromData=function(e,t){this.unionExtent(e.getApproximateExtent(t))},t.prototype.isInExtentRange=function(e){return e=this._getTickNumber(e),this._extent[0]<=e&&this._extent[1]>=e},t.prototype.getOrdinalMeta=function(){return this._ordinalMeta},t.prototype.calcNiceTicks=function(){},t.prototype.calcNiceExtent=function(){},t.type="ordinal",t}(S$);S$.registerClass(L$);var P$=L$,z$=SU,B$=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="interval",t._interval=0,t._intervalPrecision=2,t}return wL(t,e),t.prototype.parse=function(e){return e},t.prototype.contain=function(e){return R$(e,this._extent)},t.prototype.normalize=function(e){return O$(e,this._extent)},t.prototype.scale=function(e){return F$(e,this._extent)},t.prototype.setExtent=function(e,t){var n=this._extent;isNaN(e)||(n[0]=parseFloat(e)),isNaN(t)||(n[1]=parseFloat(t))},t.prototype.unionExtent=function(e){var t=this._extent;e[0]<t[0]&&(t[0]=e[0]),e[1]>t[1]&&(t[1]=e[1]),this.setExtent(t[0],t[1])},t.prototype.getInterval=function(){return this._interval},t.prototype.setInterval=function(e){this._interval=e,this._niceExtent=this._extent.slice(),this._intervalPrecision=A$(e)},t.prototype.getTicks=function(e){var t=this._interval,n=this._extent,r=this._niceExtent,a=this._intervalPrecision,i=[];if(!t)return i;n[0]<r[0]&&(e?i.push({value:z$(r[0]-t,a)}):i.push({value:n[0]}));for(var o=r[0];o<=r[1]&&(i.push({value:o}),(o=z$(o+t,a))!==i[i.length-1].value);)if(i.length>1e4)return[];var s=i.length?i[i.length-1].value:r[1];return n[1]>s&&(e?i.push({value:z$(s+t,a)}):i.push({value:n[1]})),i},t.prototype.getMinorTicks=function(e){for(var t=this.getTicks(!0),n=[],r=this.getExtent(),a=1;a<t.length;a++){for(var i=t[a],o=t[a-1],s=0,u=[],l=(i.value-o.value)/e;s<e-1;){var c=z$(o.value+(s+1)*l);c>r[0]&&c<r[1]&&u.push(c),s++}n.push(u)}return n},t.prototype.getLabel=function(e,t){if(null==e)return"";var n=t&&t.precision;return null==n?n=CU(e.value)||0:"auto"===n&&(n=this._intervalPrecision),nX(z$(e.value,n,!0))},t.prototype.calcNiceTicks=function(e,t,n){e=e||5;var r=this._extent,a=r[1]-r[0];if(isFinite(a)){a<0&&(a=-a,r.reverse());var i=E$(r,e,t,n);this._intervalPrecision=i.intervalPrecision,this._interval=i.interval,this._niceExtent=i.niceTickExtent}},t.prototype.calcNiceExtent=function(e){var t=this._extent;if(t[0]===t[1])if(0!==t[0]){var n=t[0];e.fixMax||(t[1]+=n/2),t[0]-=n/2}else t[1]=1;var r=t[1]-t[0];isFinite(r)||(t[0]=0,t[1]=1),this.calcNiceTicks(e.splitNumber,e.minInterval,e.maxInterval);var a=this._interval;e.fixMin||(t[0]=z$(Math.floor(t[0]/a)*a)),e.fixMax||(t[1]=z$(Math.ceil(t[1]/a)*a))},t.prototype.setNiceExtent=function(e,t){this._niceExtent=[e,t]},t.type="interval",t}(S$);S$.registerClass(B$);var V$=B$,W$="__ec_stack_";function U$(e){return e.get("stack")||W$+e.seriesIndex}function H$(e){return e.dim+e.index}function G$(e,t){var n=[];return t.eachSeriesByType(e,(function(e){X$(e)&&n.push(e)})),n}function j$(e){var t=function(e){var t={};XL(e,(function(e){var n=e.coordinateSystem.getBaseAxis();if("time"===n.type||"value"===n.type)for(var r=e.getData(),a=n.dim+"_"+n.index,i=r.getDimensionIndex(r.mapDimension(n.dim)),o=r.getStore(),s=0,u=o.count();s<u;++s){var l=o.get(i,s);t[a]?t[a].push(l):t[a]=[l]}}));var n={};for(var r in t)if(t.hasOwnProperty(r)){var a=t[r];if(a){a.sort((function(e,t){return e-t}));for(var i=null,o=1;o<a.length;++o){var s=a[o]-a[o-1];s>0&&(i=null===i?s:Math.min(i,s))}n[r]=i}}return n}(e),n=[];return XL(e,(function(e){var r,a=e.coordinateSystem.getBaseAxis(),i=a.getExtent();if("category"===a.type)r=a.getBandWidth();else if("value"===a.type||"time"===a.type){var o=a.dim+"_"+a.index,s=t[o],u=Math.abs(i[1]-i[0]),l=a.scale.getExtent(),c=Math.abs(l[1]-l[0]);r=s?u/c*s:u}else{var h=e.getData();r=Math.abs(i[1]-i[0])/h.count()}var p=_U(e.get("barWidth"),r),f=_U(e.get("barMaxWidth"),r),d=_U(e.get("barMinWidth")||(K$(e)?.5:1),r),v=e.get("barGap"),m=e.get("barCategoryGap");n.push({bandWidth:r,barWidth:p,barMaxWidth:f,barMinWidth:d,barGap:v,barCategoryGap:m,axisKey:H$(a),stackId:U$(e)})})),q$(n)}function q$(e){var t={};XL(e,(function(e,n){var r=e.axisKey,a=e.bandWidth,i=t[r]||{bandWidth:a,remainedWidth:a,autoWidthCount:0,categoryGap:null,gap:"20%",stacks:{}},o=i.stacks;t[r]=i;var s=e.stackId;o[s]||i.autoWidthCount++,o[s]=o[s]||{width:0,maxWidth:0};var u=e.barWidth;u&&!o[s].width&&(o[s].width=u,u=Math.min(i.remainedWidth,u),i.remainedWidth-=u);var l=e.barMaxWidth;l&&(o[s].maxWidth=l);var c=e.barMinWidth;c&&(o[s].minWidth=c);var h=e.barGap;null!=h&&(i.gap=h);var p=e.barCategoryGap;null!=p&&(i.categoryGap=p)}));var n={};return XL(t,(function(e,t){n[t]={};var r=e.stacks,a=e.bandWidth,i=e.categoryGap;if(null==i){var o=QL(r).length;i=Math.max(35-4*o,15)+"%"}var s=_U(i,a),u=_U(e.gap,1),l=e.remainedWidth,c=e.autoWidthCount,h=(l-s)/(c+(c-1)*u);h=Math.max(h,0),XL(r,(function(e){var t=e.maxWidth,n=e.minWidth;if(e.width){r=e.width;t&&(r=Math.min(r,t)),n&&(r=Math.max(r,n)),e.width=r,l-=r+u*r,c--}else{var r=h;t&&t<r&&(r=Math.min(t,l)),n&&n>r&&(r=n),r!==h&&(e.width=r,l-=r+u*r,c--)}})),h=(l-s)/(c+(c-1)*u),h=Math.max(h,0);var p,f=0;XL(r,(function(e,t){e.width||(e.width=h),p=e,f+=e.width*(1+u)})),p&&(f-=p.width*u);var d=-f/2;XL(r,(function(e,r){n[t][r]=n[t][r]||{bandWidth:a,offset:d,width:e.width},d+=e.width*(1+u)}))})),n}function X$(e){return e.coordinateSystem&&"cartesian2d"===e.coordinateSystem.type}function K$(e){return e.pipelineContext&&e.pipelineContext.large}var Y$=function(e){function t(t){var n=e.call(this,t)||this;return n.type="time",n}return wL(t,e),t.prototype.getLabel=function(e){var t=this.getSetting("useUTC");return Bq(e.value,Rq[function(e){switch(e){case"year":case"month":return"day";case"millisecond":return"millisecond";default:return"second"}}(Pq(this._minLevelUnit))]||Rq.second,t,this.getSetting("locale"))},t.prototype.getFormattedLabel=function(e,t,n){var r=this.getSetting("useUTC");return function(e,t,n,r,a){var i=null;if(nP(n))i=n;else if(tP(n))i=n(e.value,t,{level:e.level});else{var o=UL({},Aq);if(e.level>0)for(var s=0;s<Oq.length;++s)o[Oq[s]]="{primary|"+o[Oq[s]]+"}";var u=n?!1===n.inherit?n:HL(n,o):o,l=Vq(e.value,a);if(u[l])i=u[l];else if(u.inherit){for(s=Fq.indexOf(l)-1;s>=0;--s)if(u[l]){i=u[l];break}i=i||o.none}if(eP(i)){var c=null==e.level?0:e.level>=0?e.level:i.length+e.level;i=i[c=Math.min(c,i.length-1)]}}return Bq(new Date(e.value),i,a,r)}(e,t,n,this.getSetting("locale"),r)},t.prototype.getTicks=function(){var e=this._interval,t=this._extent,n=[];if(!e)return n;n.push({value:t[0],level:0});var r=this.getSetting("useUTC"),a=function(e,t,n,r){var a=1e4,i=Fq,o=0;function s(e,t,n,a,i,o,s){for(var u=new Date(t),l=t,c=u[a]();l<n&&l<=r[1];)s.push({value:l}),c+=e,u[i](c),l=u.getTime();s.push({value:l,notAdd:!0})}function u(e,a,i){var o=[],u=!a.length;if(!function(e,t,n,r){var a=AU(t),i=AU(n),o=function(e){return Wq(a,e,r)===Wq(i,e,r)},s=function(){return o("year")},u=function(){return s()&&o("month")},l=function(){return u()&&o("day")},c=function(){return l()&&o("hour")},h=function(){return c()&&o("minute")},p=function(){return h()&&o("second")},f=function(){return p()&&o("millisecond")};switch(e){case"year":return s();case"month":return u();case"day":return l();case"hour":return c();case"minute":return h();case"second":return p();case"millisecond":return f()}}(Pq(e),r[0],r[1],n)){u&&(a=[{value:nJ(new Date(r[0]),e,n)},{value:r[1]}]);for(var l=0;l<a.length-1;l++){var c=a[l].value,h=a[l+1].value;if(c!==h){var p=void 0,f=void 0,d=void 0,v=!1;switch(e){case"year":p=Math.max(1,Math.round(t/Eq/365)),f=Uq(n),d=Yq(n);break;case"half-year":case"quarter":case"month":p=$$(t),f=Hq(n),d=Zq(n);break;case"week":case"half-week":case"day":p=Q$(t,31),f=Gq(n),d=Qq(n),v=!0;break;case"half-day":case"quarter-day":case"hour":p=J$(t),f=jq(n),d=$q(n);break;case"minute":p=eJ(t,!0),f=qq(n),d=Jq(n);break;case"second":p=eJ(t,!1),f=Xq(n),d=eX(n);break;case"millisecond":p=tJ(t),f=Kq(n),d=tX(n)}s(p,c,h,f,d,v,o),"year"===e&&i.length>1&&0===l&&i.unshift({value:i[0].value-p})}}for(l=0;l<o.length;l++)i.push(o[l]);return o}}for(var l=[],c=[],h=0,p=0,f=0;f<i.length&&o++<a;++f){var d=Pq(i[f]);if(zq(i[f]))if(u(i[f],l[l.length-1]||[],c),d!==(i[f+1]?Pq(i[f+1]):null)){if(c.length){p=h,c.sort((function(e,t){return e.value-t.value}));for(var v=[],m=0;m<c.length;++m){var g=c[m].value;0!==m&&c[m-1].value===g||(v.push(c[m]),g>=r[0]&&g<=r[1]&&h++)}var y=(r[1]-r[0])/t;if(h>1.5*y&&p>y/1.5)break;if(l.push(v),h>y||e===i[f])break}c=[]}}0;var b=ZL(KL(l,(function(e){return ZL(e,(function(e){return e.value>=r[0]&&e.value<=r[1]&&!e.notAdd}))})),(function(e){return e.length>0})),x=[],k=b.length-1;for(f=0;f<b.length;++f)for(var w=b[f],_=0;_<w.length;++_)x.push({value:w[_].value,level:k-f});x.sort((function(e,t){return e.value-t.value}));var S=[];for(f=0;f<x.length;++f)0!==f&&x[f].value===x[f-1].value||S.push(x[f]);return S}(this._minLevelUnit,this._approxInterval,r,t);return(n=n.concat(a)).push({value:t[1],level:0}),n},t.prototype.calcNiceExtent=function(e){var t=this._extent;if(t[0]===t[1]&&(t[0]-=Eq,t[1]+=Eq),t[1]===-1/0&&t[0]===1/0){var n=new Date;t[1]=+new Date(n.getFullYear(),n.getMonth(),n.getDate()),t[0]=t[1]-Eq}this.calcNiceTicks(e.splitNumber,e.minInterval,e.maxInterval)},t.prototype.calcNiceTicks=function(e,t,n){e=e||10;var r=this._extent,a=r[1]-r[0];this._approxInterval=a/e,null!=t&&this._approxInterval<t&&(this._approxInterval=t),null!=n&&this._approxInterval>n&&(this._approxInterval=n);var i=Z$.length,o=Math.min(function(e,t,n,r){for(;n<r;){var a=n+r>>>1;e[a][1]<t?n=a+1:r=a}return n}(Z$,this._approxInterval,0,i),i-1);this._interval=Z$[o][1],this._minLevelUnit=Z$[Math.max(o-1,0)][0]},t.prototype.parse=function(e){return aP(e)?e:+AU(e)},t.prototype.contain=function(e){return R$(this.parse(e),this._extent)},t.prototype.normalize=function(e){return O$(this.parse(e),this._extent)},t.prototype.scale=function(e){return F$(e,this._extent)},t.type="time",t}(V$),Z$=[["second",Cq],["minute",Tq],["hour",Nq],["quarter-day",216e5],["half-day",432e5],["day",10368e4],["half-week",3024e5],["week",6048e5],["month",26784e5],["quarter",8208e6],["half-year",Mq/2],["year",Mq]];function Q$(e,t){return(e/=Eq)>16?16:e>7.5?7:e>3.5?4:e>1.5?2:1}function $$(e){return(e/=2592e6)>6?6:e>3?3:e>2?2:1}function J$(e){return(e/=Nq)>12?12:e>6?6:e>3.5?4:e>2?2:1}function eJ(e,t){return(e/=t?Tq:Cq)>30?30:e>20?20:e>15?15:e>10?10:e>5?5:e>2?2:1}function tJ(e){return RU(e,!0)}function nJ(e,t,n){var r=new Date(e);switch(Pq(t)){case"year":case"month":r[Zq(n)](0);case"day":r[Qq(n)](1);case"hour":r[$q(n)](0);case"minute":r[Jq(n)](0);case"second":r[eX(n)](0),r[tX(n)](0)}return r.getTime()}S$.registerClass(Y$);var rJ=Y$,aJ=S$.prototype,iJ=V$.prototype,oJ=SU,sJ=Math.floor,uJ=Math.ceil,lJ=Math.pow,cJ=Math.log,hJ=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="log",t.base=10,t._originalScale=new V$,t._interval=0,t}return wL(t,e),t.prototype.getTicks=function(e){var t=this._originalScale,n=this._extent,r=t.getExtent();return KL(iJ.getTicks.call(this,e),(function(e){var t=e.value,a=SU(lJ(this.base,t));return a=t===n[0]&&this._fixMin?fJ(a,r[0]):a,{value:a=t===n[1]&&this._fixMax?fJ(a,r[1]):a}}),this)},t.prototype.setExtent=function(e,t){var n=this.base;e=cJ(e)/cJ(n),t=cJ(t)/cJ(n),iJ.setExtent.call(this,e,t)},t.prototype.getExtent=function(){var e=this.base,t=aJ.getExtent.call(this);t[0]=lJ(e,t[0]),t[1]=lJ(e,t[1]);var n=this._originalScale.getExtent();return this._fixMin&&(t[0]=fJ(t[0],n[0])),this._fixMax&&(t[1]=fJ(t[1],n[1])),t},t.prototype.unionExtent=function(e){this._originalScale.unionExtent(e);var t=this.base;e[0]=cJ(e[0])/cJ(t),e[1]=cJ(e[1])/cJ(t),aJ.unionExtent.call(this,e)},t.prototype.unionExtentFromData=function(e,t){this.unionExtent(e.getApproximateExtent(t))},t.prototype.calcNiceTicks=function(e){e=e||10;var t=this._extent,n=t[1]-t[0];if(!(n===1/0||n<=0)){var r,a=(r=n,Math.pow(10,DU(r)));for(e/n*a<=.5&&(a*=10);!isNaN(a)&&Math.abs(a)<1&&Math.abs(a)>0;)a*=10;var i=[SU(uJ(t[0]/a)*a),SU(sJ(t[1]/a)*a)];this._interval=a,this._niceExtent=i}},t.prototype.calcNiceExtent=function(e){iJ.calcNiceExtent.call(this,e),this._fixMin=e.fixMin,this._fixMax=e.fixMax},t.prototype.parse=function(e){return e},t.prototype.contain=function(e){return R$(e=cJ(e)/cJ(this.base),this._extent)},t.prototype.normalize=function(e){return O$(e=cJ(e)/cJ(this.base),this._extent)},t.prototype.scale=function(e){return e=F$(e,this._extent),lJ(this.base,e)},t.type="log",t}(S$),pJ=hJ.prototype;function fJ(e,t){return oJ(e,CU(t))}pJ.getMinorTicks=iJ.getMinorTicks,pJ.getLabel=iJ.getLabel,S$.registerClass(hJ);var dJ=hJ,vJ=function(){function e(e,t,n){this._prepareParams(e,t,n)}return e.prototype._prepareParams=function(e,t,n){n[1]<n[0]&&(n=[NaN,NaN]),this._dataMin=n[0],this._dataMax=n[1];var r=this._isOrdinal="ordinal"===e.type;this._needCrossZero="interval"===e.type&&t.getNeedCrossZero&&t.getNeedCrossZero();var a=this._modelMinRaw=t.get("min",!0);tP(a)?this._modelMinNum=yJ(e,a({min:n[0],max:n[1]})):"dataMin"!==a&&(this._modelMinNum=yJ(e,a));var i=this._modelMaxRaw=t.get("max",!0);if(tP(i)?this._modelMaxNum=yJ(e,i({min:n[0],max:n[1]})):"dataMax"!==i&&(this._modelMaxNum=yJ(e,i)),r)this._axisDataLen=t.getCategories().length;else{var o=t.get("boundaryGap"),s=eP(o)?o:[o||0,o||0];"boolean"===typeof s[0]||"boolean"===typeof s[1]?this._boundaryGapInner=[0,0]:this._boundaryGapInner=[Iz(s[0],1),Iz(s[1],1)]}},e.prototype.calculate=function(){var e=this._isOrdinal,t=this._dataMin,n=this._dataMax,r=this._axisDataLen,a=this._boundaryGapInner,i=e?null:n-t||Math.abs(t),o="dataMin"===this._modelMinRaw?t:this._modelMinNum,s="dataMax"===this._modelMaxRaw?n:this._modelMaxNum,u=null!=o,l=null!=s;null==o&&(o=e?r?0:NaN:t-a[0]*i),null==s&&(s=e?r?r-1:NaN:n+a[1]*i),(null==o||!isFinite(o))&&(o=NaN),(null==s||!isFinite(s))&&(s=NaN);var c=cP(o)||cP(s)||e&&!r;this._needCrossZero&&(o>0&&s>0&&!u&&(o=0),o<0&&s<0&&!l&&(s=0));var h=this._determinedMin,p=this._determinedMax;return null!=h&&(o=h,u=!0),null!=p&&(s=p,l=!0),{min:o,max:s,minFixed:u,maxFixed:l,isBlank:c}},e.prototype.modifyDataMinMax=function(e,t){this[gJ[e]]=t},e.prototype.setDeterminedMinMax=function(e,t){this[mJ[e]]=t},e.prototype.freeze=function(){this.frozen=!0},e}(),mJ={min:"_determinedMin",max:"_determinedMax"},gJ={min:"_dataMin",max:"_dataMax"};function yJ(e,t){return null==t?null:cP(t)?NaN:e.parse(t)}function bJ(e,t){var n=e.type,r=function(e,t,n){var r=e.rawExtentInfo;return r||(r=new vJ(e,t,n),e.rawExtentInfo=r,r)}(e,t,e.getExtent()).calculate();e.setBlank(r.isBlank);var a=r.min,i=r.max,o=t.ecModel;if(o&&"time"===n){var s=G$("bar",o),u=!1;if(XL(s,(function(e){u=u||e.getBaseAxis()===t.axis})),u){var l=j$(s),c=function(e,t,n,r){var a=n.axis.getExtent(),i=a[1]-a[0],o=function(e,t,n){if(e&&t){var r=e[H$(t)];return null!=r&&null!=n?r[U$(n)]:r}}(r,n.axis);if(void 0===o)return{min:e,max:t};var s=1/0;XL(o,(function(e){s=Math.min(e.offset,s)}));var u=-1/0;XL(o,(function(e){u=Math.max(e.offset+e.width,u)})),s=Math.abs(s),u=Math.abs(u);var l=s+u,c=t-e,h=c/(1-(s+u)/i)-c;return{min:e-=h*(s/l),max:t+=h*(u/l)}}(a,i,t,l);a=c.min,i=c.max}}return{extent:[a,i],fixMin:r.minFixed,fixMax:r.maxFixed}}function xJ(e,t){var n=t,r=bJ(e,n),a=r.extent,i=n.get("splitNumber");e instanceof dJ&&(e.base=n.get("logBase"));var o=e.type,s=n.get("interval"),u="interval"===o||"time"===o;e.setExtent(a[0],a[1]),e.calcNiceExtent({splitNumber:i,fixMin:r.fixMin,fixMax:r.fixMax,minInterval:u?n.get("minInterval"):null,maxInterval:u?n.get("maxInterval"):null}),null!=s&&e.setInterval&&e.setInterval(s)}function kJ(e){var t,n,r=e.getLabelModel().get("formatter"),a="category"===e.type?e.scale.getExtent()[0]:null;return"time"===e.scale.type?(n=r,function(t,r){return e.scale.getFormattedLabel(t,r,n)}):nP(r)?function(t){return function(n){var r=e.scale.getLabel(n);return t.replace("{value}",null!=r?r:"")}}(r):tP(r)?(t=r,function(n,r){return null!=a&&(r=n.value-a),t(wJ(e,n),r,null!=n.level?{level:n.level}:null)}):function(t){return e.scale.getLabel(t)}}function wJ(e,t){return"category"===e.type?e.scale.getLabel(t):t.value}function _J(e,t){var n=t*Math.PI/180,r=e.width,a=e.height,i=r*Math.abs(Math.cos(n))+Math.abs(a*Math.sin(n)),o=r*Math.abs(Math.sin(n))+Math.abs(a*Math.cos(n));return new gz(e.x,e.y,i,o)}function SJ(e){var t=e.get("interval");return null==t?"auto":t}function IJ(e){return"category"===e.type&&0===SJ(e.getLabelModel())}function CJ(e,t){var n={};return XL(e.mapDimensionsAll(t),(function(t){n[function(e,t){return dq(e,t)?e.getCalculationInfo("stackResultDimension"):t}(e,t)]=!0})),QL(n)}var TJ=Math.PI,NJ=function(){function e(e,t){this.group=new zK,this.opt=t,this.axisModel=e,HL(t,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0,handleAutoShown:function(){return!0}});var n=new zK({x:t.position[0],y:t.position[1],rotation:t.rotation});n.updateTransform(),this._transformGroup=n}return e.prototype.hasBuilder=function(e){return!!EJ[e]},e.prototype.add=function(e){EJ[e](this.opt,this.axisModel,this.group,this._transformGroup)},e.prototype.getGroup=function(){return this.group},e.innerTextLayout=function(e,t,n){var r,a,i=NU(t-e);return EU(i)?(a=n>0?"top":"bottom",r="center"):EU(i-TJ)?(a=n>0?"bottom":"top",r="center"):(a="middle",r=i>0&&i<TJ?n>0?"right":"left":n>0?"left":"right"),{rotation:i,textAlign:r,textVerticalAlign:a}},e.makeAxisEventDataBase=function(e){var t={componentType:e.mainType,componentIndex:e.componentIndex};return t[e.mainType+"Index"]=e.componentIndex,t},e.isLabelSilent=function(e){var t=e.get("tooltip");return e.get("silent")||!(e.get("triggerEvent")||t&&t.show)},e}(),EJ={axisLine:function(e,t,n,r){var a=t.get(["axisLine","show"]);if("auto"===a&&e.handleAutoShown&&(a=e.handleAutoShown("axisLine")),a){var i=t.axis.getExtent(),o=r.transform,s=[i[0],0],u=[i[1],0];o&&(Zz(s,s,o),Zz(u,u,o));var l=UL({lineCap:"round"},t.getModel(["axisLine","lineStyle"]).getLineStyle()),c=new xY({subPixelOptimize:!0,shape:{x1:s[0],y1:s[1],x2:u[0],y2:u[1]},style:l,strokeContainThreshold:e.strokeContainThreshold||5,silent:!0,z2:1});c.anid="line",n.add(c);var h=t.get(["axisLine","symbol"]);if(null!=h){var p=t.get(["axisLine","symbolSize"]);nP(h)&&(h=[h,h]),(nP(p)||aP(p))&&(p=[p,p]);var f=PZ(t.get(["axisLine","symbolOffset"])||0,p),d=p[0],v=p[1];XL([{rotate:e.rotation+Math.PI/2,offset:f[0],r:0},{rotate:e.rotation-Math.PI/2,offset:f[1],r:Math.sqrt((s[0]-u[0])*(s[0]-u[0])+(s[1]-u[1])*(s[1]-u[1]))}],(function(t,r){if("none"!==h[r]&&null!=h[r]){var a=LZ(h[r],-d/2,-v/2,d,v,l.stroke,!0),i=t.r+t.offset;a.attr({rotation:t.rotate,x:s[0]+i*Math.cos(e.rotation),y:s[1]-i*Math.sin(e.rotation),silent:!0,z2:11}),n.add(a)}}))}}},axisTickLabel:function(e,t,n,r){var a=function(e,t,n,r){var a=n.axis,i=n.getModel("axisTick"),o=i.get("show");"auto"===o&&r.handleAutoShown&&(o=r.handleAutoShown("axisTick"));if(!o||a.scale.isBlank())return;for(var s=i.getModel("lineStyle"),u=r.tickDirection*i.get("length"),l=RJ(a.getTicksCoords(),t.transform,u,HL(s.getLineStyle(),{stroke:n.get(["axisLine","lineStyle","color"])}),"ticks"),c=0;c<l.length;c++)e.add(l[c]);return l}(n,r,t,e),i=function(e,t,n,r){var a=n.axis;if(!hP(r.axisLabelShow,n.get(["axisLabel","show"]))||a.scale.isBlank())return;var i=n.getModel("axisLabel"),o=i.get("margin"),s=a.getViewLabels(),u=(hP(r.labelRotate,i.get("rotate"))||0)*TJ/180,l=NJ.innerTextLayout(r.rotation,u,r.labelDirection),c=n.getCategories&&n.getCategories(!0),h=[],p=NJ.isLabelSilent(n),f=n.get("triggerEvent");return XL(s,(function(s,u){var d="ordinal"===a.scale.type?a.scale.getRawOrdinalNumber(s.tickValue):s.tickValue,v=s.formattedLabel,m=s.rawLabel,g=i;if(c&&c[d]){var y=c[d];iP(y)&&y.textStyle&&(g=new CG(y.textStyle,i,n.ecModel))}var b=g.getTextColor()||n.get(["axisLine","lineStyle","color"]),x=a.dataToCoord(d),k=new xU({x:x,y:r.labelOffset+r.labelDirection*o,rotation:l.rotation,silent:p,z2:10+(s.level||0),style:uG(g,{text:v,align:g.getShallow("align",!0)||l.textAlign,verticalAlign:g.getShallow("verticalAlign",!0)||g.getShallow("baseline",!0)||l.textVerticalAlign,fill:tP(b)?b("category"===a.type?m:"value"===a.type?d+"":d,u):b})});if(k.anid="label_"+d,f){var w=NJ.makeAxisEventDataBase(n);w.targetType="axisLabel",w.value=m,w.tickIndex=u,"category"===a.type&&(w.dataIndex=d),sH(k).eventData=w}t.add(k),k.updateTransform(),h.push(k),e.add(k),k.decomposeTransform()})),h}(n,r,t,e);if(function(e,t,n){if(IJ(e.axis))return;var r=e.get(["axisLabel","showMinLabel"]),a=e.get(["axisLabel","showMaxLabel"]);n=n||[];var i=(t=t||[])[0],o=t[1],s=t[t.length-1],u=t[t.length-2],l=n[0],c=n[1],h=n[n.length-1],p=n[n.length-2];!1===r?(MJ(i),MJ(l)):AJ(i,o)&&(r?(MJ(o),MJ(c)):(MJ(i),MJ(l)));!1===a?(MJ(s),MJ(h)):AJ(u,s)&&(a?(MJ(u),MJ(p)):(MJ(s),MJ(h)))}(t,i,a),function(e,t,n,r){var a=n.axis,i=n.getModel("minorTick");if(!i.get("show")||a.scale.isBlank())return;var o=a.getMinorTicksCoords();if(!o.length)return;for(var s=i.getModel("lineStyle"),u=r*i.get("length"),l=HL(s.getLineStyle(),HL(n.getModel("axisTick").getLineStyle(),{stroke:n.get(["axisLine","lineStyle","color"])})),c=0;c<o.length;c++)for(var h=RJ(o[c],t.transform,u,l,"minorticks_"+c),p=0;p<h.length;p++)e.add(h[p])}(n,r,t,e.tickDirection),t.get(["axisLabel","hideOverlap"])){var o=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];if(!r.defaultAttr.ignore){var a=r.label,i=a.getComputedTransform(),o=a.getBoundingRect(),s=!i||i[1]<1e-5&&i[2]<1e-5,u=a.style.margin||0,l=o.clone();l.applyTransform(i),l.x-=u/2,l.y-=u/2,l.width+=u,l.height+=u;var c=s?new BY(o,i):null;t.push({label:a,labelLine:r.labelLine,rect:l,localRect:o,obb:c,priority:r.priority,defaultAttr:r.defaultAttr,layoutOption:r.computedLayoutOption,axisAligned:s,transform:i})}}return t}(KL(i,(function(e){return{label:e,priority:e.z2,defaultAttr:{ignore:e.ignore}}})));!function(e){var t=[];e.sort((function(e,t){return t.priority-e.priority}));var n=new gz(0,0,0,0);function r(e){if(!e.ignore){var t=e.ensureState("emphasis");null==t.ignore&&(t.ignore=!1)}e.ignore=!0}for(var a=0;a<e.length;a++){var i=e[a],o=i.axisAligned,s=i.localRect,u=i.transform,l=i.label,c=i.labelLine;n.copy(i.rect),n.width-=.1,n.height-=.1,n.x+=.05,n.y+=.05;for(var h=i.obb,p=!1,f=0;f<t.length;f++){var d=t[f];if(n.intersect(d.rect)){if(o&&d.axisAligned){p=!0;break}if(d.obb||(d.obb=new BY(d.localRect,d.transform)),h||(h=new BY(s,u)),h.intersect(d.obb)){p=!0;break}}}p?(r(l),c&&r(c)):(l.attr("ignore",i.defaultAttr.ignore),c&&c.attr("ignore",i.defaultAttr.labelGuideIgnore),t.push(i))}}(o)}},axisName:function(e,t,n,r){var a=hP(e.axisName,t.get("name"));if(a){var i,o,s=t.get("nameLocation"),u=e.nameDirection,l=t.getModel("nameTextStyle"),c=t.get("nameGap")||0,h=t.axis.getExtent(),p=h[0]>h[1]?-1:1,f=["start"===s?h[0]-p*c:"end"===s?h[1]+p*c:(h[0]+h[1])/2,DJ(s)?e.labelOffset+u*c:0],d=t.get("nameRotate");null!=d&&(d=d*TJ/180),DJ(s)?i=NJ.innerTextLayout(e.rotation,null!=d?d:e.rotation,u):(i=function(e,t,n,r){var a,i,o=NU(n-e),s=r[0]>r[1],u="start"===t&&!s||"start"!==t&&s;EU(o-TJ/2)?(i=u?"bottom":"top",a="center"):EU(o-1.5*TJ)?(i=u?"top":"bottom",a="center"):(i="middle",a=o<1.5*TJ&&o>TJ/2?u?"left":"right":u?"right":"left");return{rotation:o,textAlign:a,textVerticalAlign:i}}(e.rotation,s,d||0,h),null!=(o=e.axisNameAvailableWidth)&&(o=Math.abs(o/Math.sin(i.rotation)),!isFinite(o)&&(o=null)));var v=l.getFont(),m=t.get("nameTruncate",!0)||{},g=m.ellipsis,y=hP(e.nameTruncateMaxWidth,m.maxWidth,o),b=new xU({x:f[0],y:f[1],rotation:i.rotation,silent:NJ.isLabelSilent(t),style:uG(l,{text:a,font:v,overflow:"truncate",width:y,ellipsis:g,fill:l.getTextColor()||t.get(["axisLine","lineStyle","color"]),align:l.get("align")||i.textAlign,verticalAlign:l.get("verticalAlign")||i.textVerticalAlign}),z2:1});if(IZ({el:b,componentModel:t,itemName:a}),b.__fullText=a,b.anid="name",t.get("triggerEvent")){var x=NJ.makeAxisEventDataBase(t);x.targetType="axisName",x.name=a,sH(b).eventData=x}r.add(b),b.updateTransform(),n.add(b),b.decomposeTransform()}}};function MJ(e){e&&(e.ignore=!0)}function AJ(e,t){var n=e&&e.getBoundingRect().clone(),r=t&&t.getBoundingRect().clone();if(n&&r){var a=ez([]);return az(a,a,-e.rotation),n.applyTransform(nz([],a,e.getLocalTransform())),r.applyTransform(nz([],a,t.getLocalTransform())),n.intersect(r)}}function DJ(e){return"middle"===e||"center"===e}function RJ(e,t,n,r,a){for(var i=[],o=[],s=[],u=0;u<e.length;u++){var l=e[u].coord;o[0]=l,o[1]=0,s[0]=l,s[1]=n,t&&(Zz(o,o,t),Zz(s,s,t));var c=new xY({subPixelOptimize:!0,shape:{x1:o[0],y1:o[1],x2:s[0],y2:s[1]},style:r,z2:2,autoBatch:!0,silent:!0});c.anid=a+"_"+e[u].tickValue,i.push(c)}return i}var OJ=NJ;function FJ(e,t,n,r,a){var i=LJ(n.get("value"),t.axis,t.ecModel,n.get("seriesDataIndices"),{precision:n.get(["label","precision"]),formatter:n.get(["label","formatter"])}),o=n.getModel("label"),s=aX(o.get("padding")||0),u=o.getFont(),l=kz(i,u),c=a.position,h=l.width+s[1]+s[3],p=l.height+s[0]+s[2],f=a.align;"right"===f&&(c[0]-=h),"center"===f&&(c[0]-=h/2);var d=a.verticalAlign;"bottom"===d&&(c[1]-=p),"middle"===d&&(c[1]-=p/2),function(e,t,n,r){var a=r.getWidth(),i=r.getHeight();e[0]=Math.min(e[0]+t,a)-t,e[1]=Math.min(e[1]+n,i)-n,e[0]=Math.max(e[0],0),e[1]=Math.max(e[1],0)}(c,h,p,r);var v=o.get("backgroundColor");v&&"auto"!==v||(v=t.get(["axisLine","lineStyle","color"])),e.label={x:c[0],y:c[1],style:uG(o,{text:i,font:u,fill:o.getTextColor(),padding:s,backgroundColor:v}),z2:10}}function LJ(e,t,n,r,a){e=t.scale.parse(e);var i=t.scale.getLabel({value:e},{precision:a.precision}),o=a.formatter;if(o){var s={value:wJ(t,{value:e}),axisDimension:t.dim,axisIndex:t.index,seriesData:[]};XL(r,(function(e){var t=n.getSeriesByIndex(e.seriesIndex),r=e.dataIndexInside,a=t&&t.getDataParams(r);a&&s.seriesData.push(a)})),nP(o)?i=o.replace("{value}",i):tP(o)&&(i=o(s))}return i}function PJ(e,t,n){var r=[1,0,0,1,0,0];return az(r,r,n.rotation),rz(r,r,n.position),vZ([e.dataToCoord(t),(n.labelOffset||0)+(n.labelDirection||1)*(n.labelMargin||0)],r)}function zJ(e,t,n){n=n||{};var r=e.coordinateSystem,a=t.axis,i={},o=a.getAxesOnZeroOf()[0],s=a.position,u=o?"onZero":s,l=a.dim,c=r.getRect(),h=[c.x,c.x+c.width,c.y,c.y+c.height],p={left:0,right:1,top:0,bottom:1,onZero:2},f=t.get("offset")||0,d="x"===l?[h[2]-f,h[3]+f]:[h[0]-f,h[1]+f];if(o){var v=o.toGlobalCoord(o.dataToCoord(0));d[p.onZero]=Math.max(Math.min(v,d[1]),d[0])}i.position=["y"===l?d[p[u]]:h[0],"x"===l?d[p[u]]:h[3]],i.rotation=Math.PI/2*("x"===l?0:1);i.labelDirection=i.tickDirection=i.nameDirection={top:-1,bottom:1,left:-1,right:1}[s],i.labelOffset=o?d[p[s]]-d[p.onZero]:0,t.get(["axisTick","inside"])&&(i.tickDirection=-i.tickDirection),hP(n.labelInside,t.get(["axisLabel","inside"]))&&(i.labelDirection=-i.labelDirection);var m=t.get(["axisLabel","rotate"]);return i.labelRotate="top"===u?-m:m,i.z2=1,i}function BJ(e){return"cartesian2d"===e.get("coordinateSystem")}function VJ(e){var t={xAxisModel:null,yAxisModel:null};return XL(t,(function(n,r){var a=r.replace(/Model$/,""),i=e.getReferringComponents(a,aH).models[0];t[r]=i})),t}var WJ=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return wL(t,e),t.prototype.makeElOption=function(e,t,n,r,a){var i=n.axis,o=i.grid,s=r.get("type"),u=UJ(o,i).getOtherAxis(i).getGlobalExtent(),l=i.toGlobalCoord(i.dataToCoord(t,!0));if(s&&"none"!==s){var c=function(e){var t,n=e.get("type"),r=e.getModel(n+"Style");return"line"===n?(t=r.getLineStyle()).fill=null:"shadow"===n&&((t=r.getAreaStyle()).stroke=null),t}(r),h=HJ[s](i,l,u);h.style=c,e.graphicKey=h.type,e.pointer=h}!function(e,t,n,r,a,i){var o=OJ.innerTextLayout(n.rotation,0,n.labelDirection);n.labelMargin=a.get(["label","margin"]),FJ(t,r,a,i,{position:PJ(r.axis,e,n),align:o.textAlign,verticalAlign:o.textVerticalAlign})}(t,e,zJ(o.model,n),n,r,a)},t.prototype.getHandleTransform=function(e,t,n){var r=zJ(t.axis.grid.model,t,{labelInside:!1});r.labelMargin=n.get(["handle","margin"]);var a=PJ(t.axis,e,r);return{x:a[0],y:a[1],rotation:r.rotation+(r.labelDirection<0?Math.PI:0)}},t.prototype.updateHandleTransform=function(e,t,n,r){var a=n.axis,i=a.grid,o=a.getGlobalExtent(!0),s=UJ(i,a).getOtherAxis(a).getGlobalExtent(),u="x"===a.dim?0:1,l=[e.x,e.y];l[u]+=t[u],l[u]=Math.min(o[1],l[u]),l[u]=Math.max(o[0],l[u]);var c=(s[1]+s[0])/2,h=[c,c];h[u]=l[u];return{x:l[0],y:l[1],rotation:e.rotation,cursorPoint:h,tooltipOption:[{verticalAlign:"middle"},{align:"center"}][u]}},t}(w$);function UJ(e,t){var n={};return n[t.dim+"AxisIndex"]=t.index,e.getCartesian(n)}var HJ={line:function(e,t,n){var r,a,i;return{type:"Line",subPixelOptimize:!0,shape:(r=[t,n[0]],a=[t,n[1]],i=GJ(e),{x1:r[i=i||0],y1:r[1-i],x2:a[i],y2:a[1-i]})}},shadow:function(e,t,n){var r,a,i,o=Math.max(1,e.getBandWidth()),s=n[1]-n[0];return{type:"Rect",shape:(r=[t-o/2,n[0]],a=[o,s],i=GJ(e),{x:r[i=i||0],y:r[1-i],width:a[i],height:a[1-i]})}}};function GJ(e){return"x"===e.dim?0:1}var jJ=WJ,qJ=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.type=t.type,n}return wL(t,e),t.type="axisPointer",t.defaultOption={show:"auto",z:50,type:"line",snap:!1,triggerTooltip:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#B9BEC9",width:1,type:"dashed"},shadowStyle:{color:"rgba(210,219,238,0.2)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}},t}(IX),XJ=qJ,KJ=eH(),YJ=XL;function ZJ(e,t,n){if(!MP.node){var r=t.getZr();KJ(r).records||(KJ(r).records={}),function(e,t){if(KJ(e).initialized)return;function n(n,r){e.on(n,(function(n){var a=function(e){var t={showTip:[],hideTip:[]};return{dispatchAction:function n(r){var a=t[r.type];a?a.push(r):(r.dispatchAction=n,e.dispatchAction(r))},pendings:t}}(t);YJ(KJ(e).records,(function(e){e&&r(e,n,a.dispatchAction)})),function(e,t){var n,r=e.showTip.length,a=e.hideTip.length;r?n=e.showTip[r-1]:a&&(n=e.hideTip[a-1]);n&&(n.dispatchAction=null,t.dispatchAction(n))}(a.pendings,t)}))}KJ(e).initialized=!0,n("click",JL($J,"click")),n("mousemove",JL($J,"mousemove")),n("globalout",QJ)}(r,t),(KJ(r).records[e]||(KJ(r).records[e]={})).handler=n}}function QJ(e,t,n){e.handler("leave",null,n)}function $J(e,t,n,r){t.handler(e,n,r)}function JJ(e,t){if(!MP.node){var n=t.getZr();(KJ(n).records||{})[e]&&(KJ(n).records[e]=null)}}var e0=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.type=t.type,n}return wL(t,e),t.prototype.render=function(e,t,n){var r=t.getComponent("tooltip"),a=e.get("triggerOn")||r&&r.get("triggerOn")||"mousemove|click";ZJ("axisPointer",n,(function(e,t,n){"none"!==a&&("leave"===e||a.indexOf(e)>=0)&&n({type:"updateAxisPointer",currTrigger:e,x:t&&t.offsetX,y:t&&t.offsetY})}))},t.prototype.remove=function(e,t){JJ("axisPointer",t)},t.prototype.dispose=function(e,t){JJ("axisPointer",t)},t.type="axisPointer",t}(OQ),t0=e0;function n0(e,t){var n,r=[],a=e.seriesIndex;if(null==a||!(n=t.getSeriesByIndex(a)))return{point:[]};var i=n.getData(),o=JU(i,e);if(null==o||o<0||eP(o))return{point:[]};var s=i.getItemGraphicEl(o),u=n.coordinateSystem;if(n.getTooltipPosition)r=n.getTooltipPosition(o)||[];else if(u&&u.dataToPoint)if(e.isStacked){var l=u.getBaseAxis(),c=u.getOtherAxis(l).dim,h=l.dim,p="x"===c||"radius"===c?1:0,f=i.mapDimension(h),d=[];d[p]=i.get(f,o),d[1-p]=i.get(i.getCalculationInfo("stackResultDimension"),o),r=u.dataToPoint(d)||[]}else r=u.dataToPoint(i.getValues(KL(u.dimensions,(function(e){return i.mapDimension(e)})),o))||[];else if(s){var v=s.getBoundingRect().clone();v.applyTransform(s.transform),r=[v.x+v.width/2,v.y+v.height/2]}return{point:r,el:s}}var r0=eH();function a0(e,t,n){var r=e.currTrigger,a=[e.x,e.y],i=e,o=e.dispatchAction||$L(n.dispatchAction,n),s=t.getComponent("axisPointer").coordSysAxesInfo;if(s){l0(a)&&(a=n0({seriesIndex:i.seriesIndex,dataIndex:i.dataIndex},t).point);var u=l0(a),l=i.axesInfo,c=s.axesInfo,h="leave"===r||l0(a),p={},f={},d={list:[],map:{}},v={showPointer:JL(o0,f),showTooltip:JL(s0,d)};XL(s.coordSysMap,(function(e,t){var n=u||e.containPoint(a);XL(s.coordSysAxesInfo[t],(function(e,t){var r=e.axis,i=function(e,t){for(var n=0;n<(e||[]).length;n++){var r=e[n];if(t.axis.dim===r.axisDim&&t.axis.model.componentIndex===r.axisIndex)return r}}(l,e);if(!h&&n&&(!l||i)){var o=i&&i.value;null!=o||u||(o=r.pointToData(a)),null!=o&&i0(e,o,v,!1,p)}}))}));var m={};return XL(c,(function(e,t){var n=e.linkGroup;n&&!f[t]&&XL(n.axesInfo,(function(t,r){var a=f[r];if(t!==e&&a){var i=a.value;n.mapper&&(i=e.axis.scale.parse(n.mapper(i,u0(t),u0(e)))),m[e.key]=i}}))})),XL(m,(function(e,t){i0(c[t],e,v,!0,p)})),function(e,t,n){var r=n.axesInfo=[];XL(t,(function(t,n){var a=t.axisPointerModel.option,i=e[n];i?(!t.useHandle&&(a.status="show"),a.value=i.value,a.seriesDataIndices=(i.payloadBatch||[]).slice()):!t.useHandle&&(a.status="hide"),"show"===a.status&&r.push({axisDim:t.axis.dim,axisIndex:t.axis.model.componentIndex,value:a.value})}))}(f,c,p),function(e,t,n,r){if(l0(t)||!e.list.length)return void r({type:"hideTip"});var a=((e.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};r({type:"showTip",escapeConnect:!0,x:t[0],y:t[1],tooltipOption:n.tooltipOption,position:n.position,dataIndexInside:a.dataIndexInside,dataIndex:a.dataIndex,seriesIndex:a.seriesIndex,dataByCoordSys:e.list})}(d,a,e,o),function(e,t,n){var r=n.getZr(),a="axisPointerLastHighlights",i=r0(r)[a]||{},o=r0(r)[a]={};XL(e,(function(e,t){var n=e.axisPointerModel.option;"show"===n.status&&XL(n.seriesDataIndices,(function(e){var t=e.seriesIndex+" | "+e.dataIndex;o[t]=e}))}));var s=[],u=[];XL(i,(function(e,t){!o[t]&&u.push(e)})),XL(o,(function(e,t){!i[t]&&s.push(e)})),u.length&&n.dispatchAction({type:"downplay",escapeConnect:!0,notBlur:!0,batch:u}),s.length&&n.dispatchAction({type:"highlight",escapeConnect:!0,notBlur:!0,batch:s})}(c,0,n),p}}function i0(e,t,n,r,a){var i=e.axis;if(!i.scale.isBlank()&&i.containData(t))if(e.involveSeries){var o=function(e,t){var n=t.axis,r=n.dim,a=e,i=[],o=Number.MAX_VALUE,s=-1;return XL(t.seriesModels,(function(t,u){var l,c,h=t.getData().mapDimensionsAll(r);if(t.getAxisTooltipData){var p=t.getAxisTooltipData(h,e,n);c=p.dataIndices,l=p.nestestValue}else{if(!(c=t.getData().indicesOfNearest(h[0],e,"category"===n.type?.5:null)).length)return;l=t.getData().get(h[0],c[0])}if(null!=l&&isFinite(l)){var f=e-l,d=Math.abs(f);d<=o&&((d<o||f>=0&&s<0)&&(o=d,s=f,a=l,i.length=0),XL(c,(function(e){i.push({seriesIndex:t.seriesIndex,dataIndexInside:e,dataIndex:t.getData().getRawIndex(e)})})))}})),{payloadBatch:i,snapToValue:a}}(t,e),s=o.payloadBatch,u=o.snapToValue;s[0]&&null==a.seriesIndex&&UL(a,s[0]),!r&&e.snap&&i.containData(u)&&null!=u&&(t=u),n.showPointer(e,t,s),n.showTooltip(e,o,u)}else n.showPointer(e,t)}function o0(e,t,n,r){e[t.key]={value:n,payloadBatch:r}}function s0(e,t,n,r){var a=n.payloadBatch,i=t.axis,o=i.model,s=t.axisPointerModel;if(t.triggerTooltip&&a.length){var u=t.coordSys.model,l=UQ(u),c=e.map[l];c||(c=e.map[l]={coordSysId:u.id,coordSysIndex:u.componentIndex,coordSysType:u.type,coordSysMainType:u.mainType,dataByAxis:[]},e.list.push(c)),c.dataByAxis.push({axisDim:i.dim,axisIndex:o.componentIndex,axisType:o.type,axisId:o.id,value:r,valueLabelOpt:{precision:s.get(["label","precision"]),formatter:s.get(["label","formatter"])},seriesDataIndices:a.slice()})}}function u0(e){var t=e.axis.model,n={},r=n.axisDim=e.axis.dim;return n.axisIndex=n[r+"AxisIndex"]=t.componentIndex,n.axisName=n[r+"AxisName"]=t.name,n.axisId=n[r+"AxisId"]=t.id,n}function l0(e){return!e||null==e[0]||isNaN(e[0])||null==e[1]||isNaN(e[1])}function c0(e){jQ.registerAxisPointerClass("CartesianAxisPointer",jJ),e.registerComponentModel(XJ),e.registerComponentView(t0),e.registerPreprocessor((function(e){if(e){(!e.axisPointer||0===e.axisPointer.length)&&(e.axisPointer={});var t=e.axisPointer.link;t&&!eP(t)&&(e.axisPointer.link=[t])}})),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,(function(e,t){e.getComponent("axisPointer").coordSysAxesInfo=PQ(e,t)})),e.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},a0)}var h0=function(e,t){this.target=e,this.topTarget=t&&t.topTarget},p0=function(){function e(e){this.handler=e,e.on("mousedown",this._dragStart,this),e.on("mousemove",this._drag,this),e.on("mouseup",this._dragEnd,this)}return e.prototype._dragStart=function(e){for(var t=e.target;t&&!t.draggable;)t=t.parent||t.__hostTarget;t&&(this._draggingTarget=t,t.dragging=!0,this._x=e.offsetX,this._y=e.offsetY,this.handler.dispatchToElement(new h0(t,e),"dragstart",e.event))},e.prototype._drag=function(e){var t=this._draggingTarget;if(t){var n=e.offsetX,r=e.offsetY,a=n-this._x,i=r-this._y;this._x=n,this._y=r,t.drift(a,i,e),this.handler.dispatchToElement(new h0(t,e),"drag",e.event);var o=this.handler.findHover(n,r,t).target,s=this._dropTarget;this._dropTarget=o,t!==o&&(s&&o!==s&&this.handler.dispatchToElement(new h0(s,e),"dragleave",e.event),o&&o!==s&&this.handler.dispatchToElement(new h0(o,e),"dragenter",e.event))}},e.prototype._dragEnd=function(e){var t=this._draggingTarget;t&&(t.dragging=!1),this.handler.dispatchToElement(new h0(t,e),"dragend",e.event),this._dropTarget&&this.handler.dispatchToElement(new h0(this._dropTarget,e),"drop",e.event),this._draggingTarget=null,this._dropTarget=null},e}(),f0=p0,d0=function(){function e(){this._track=[]}return e.prototype.recognize=function(e,t,n){return this._doTrack(e,t,n),this._recognize(e)},e.prototype.clear=function(){return this._track.length=0,this},e.prototype._doTrack=function(e,t,n){var r=e.touches;if(r){for(var a={points:[],touches:[],target:t,event:e},i=0,o=r.length;i<o;i++){var s=r[i],u=t$(n,s,{});a.points.push([u.zrX,u.zrY]),a.touches.push(s)}this._track.push(a)}},e.prototype._recognize=function(e){for(var t in m0)if(m0.hasOwnProperty(t)){var n=m0[t](this._track,e);if(n)return n}},e}();function v0(e){var t=e[1][0]-e[0][0],n=e[1][1]-e[0][1];return Math.sqrt(t*t+n*n)}var m0={pinch:function(e,t){var n=e.length;if(n){var r,a=(e[n-1]||{}).points,i=(e[n-2]||{}).points||a;if(i&&i.length>1&&a&&a.length>1){var o=v0(a)/v0(i);!isFinite(o)&&(o=1),t.pinchScale=o;var s=[((r=a)[0][0]+r[1][0])/2,(r[0][1]+r[1][1])/2];return t.pinchX=s[0],t.pinchY=s[1],{type:"pinch",target:e[0].target,event:t}}}}},g0="silent";function y0(){o$(this.event)}var b0=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handler=null,t}return GP(t,e),t.prototype.dispose=function(){},t.prototype.setCursor=function(){},t}(yV),x0=function(e,t){this.x=e,this.y=t},k0=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],w0=function(e){function t(t,n,r,a){var i=e.call(this)||this;return i._hovered=new x0(0,0),i.storage=t,i.painter=n,i.painterRoot=a,r=r||new b0,i.proxy=null,i.setHandlerProxy(r),i._draggingMgr=new f0(i),i}return GP(t,e),t.prototype.setHandlerProxy=function(e){this.proxy&&this.proxy.dispose(),e&&(XL(k0,(function(t){e.on&&e.on(t,this[t],this)}),this),e.handler=this),this.proxy=e},t.prototype.mousemove=function(e){var t=e.zrX,n=e.zrY,r=S0(this,t,n),a=this._hovered,i=a.target;i&&!i.__zr&&(i=(a=this.findHover(a.x,a.y)).target);var o=this._hovered=r?new x0(t,n):this.findHover(t,n),s=o.target,u=this.proxy;u.setCursor&&u.setCursor(s?s.cursor:"default"),i&&s!==i&&this.dispatchToElement(a,"mouseout",e),this.dispatchToElement(o,"mousemove",e),s&&s!==i&&this.dispatchToElement(o,"mouseover",e)},t.prototype.mouseout=function(e){var t=e.zrEventControl;"only_globalout"!==t&&this.dispatchToElement(this._hovered,"mouseout",e),"no_globalout"!==t&&this.trigger("globalout",{type:"globalout",event:e})},t.prototype.resize=function(){this._hovered=new x0(0,0)},t.prototype.dispatch=function(e,t){var n=this[e];n&&n.call(this,t)},t.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},t.prototype.setCursorStyle=function(e){var t=this.proxy;t.setCursor&&t.setCursor(e)},t.prototype.dispatchToElement=function(e,t,n){var r=(e=e||{}).target;if(!r||!r.silent){for(var a="on"+t,i=function(e,t,n){return{type:e,event:n,target:t.target,topTarget:t.topTarget,cancelBubble:!1,offsetX:n.zrX,offsetY:n.zrY,gestureEvent:n.gestureEvent,pinchX:n.pinchX,pinchY:n.pinchY,pinchScale:n.pinchScale,wheelDelta:n.zrDelta,zrByTouch:n.zrByTouch,which:n.which,stop:y0}}(t,e,n);r&&(r[a]&&(i.cancelBubble=!!r[a].call(r,i)),r.trigger(t,i),r=r.__hostTarget?r.__hostTarget:r.parent,!i.cancelBubble););i.cancelBubble||(this.trigger(t,i),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer((function(e){"function"===typeof e[a]&&e[a].call(e,i),e.trigger&&e.trigger(t,i)})))}},t.prototype.findHover=function(e,t,n){for(var r=this.storage.getDisplayList(),a=new x0(e,t),i=r.length-1;i>=0;i--){var o=void 0;if(r[i]!==n&&!r[i].ignore&&(o=_0(r[i],e,t))&&(!a.topTarget&&(a.topTarget=r[i]),o!==g0)){a.target=r[i];break}}return a},t.prototype.processGesture=function(e,t){this._gestureMgr||(this._gestureMgr=new d0);var n=this._gestureMgr;"start"===t&&n.clear();var r=n.recognize(e,this.findHover(e.zrX,e.zrY,null).target,this.proxy.dom);if("end"===t&&n.clear(),r){var a=r.type;e.gestureEvent=a;var i=new x0;i.target=r.target,this.dispatchToElement(i,a,r.event)}},t}(yV);function _0(e,t,n){if(e[e.rectHover?"rectContain":"contain"](t,n)){for(var r=e,a=void 0,i=!1;r;){if(r.ignoreClip&&(i=!0),!i){var o=r.getClipPath();if(o&&!o.contain(t,n))return!1;r.silent&&(a=!0)}var s=r.__hostTarget;r=s||r.parent}return!a||g0}return!1}function S0(e,t,n){var r=e.painter;return t<0||t>r.getWidth()||n<0||n>r.getHeight()}XL(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],(function(e){w0.prototype[e]=function(t){var n,r,a=t.zrX,i=t.zrY,o=S0(this,a,i);if("mouseup"===e&&o||(r=(n=this.findHover(a,i)).target),"mousedown"===e)this._downEl=r,this._downPoint=[t.zrX,t.zrY],this._upEl=r;else if("mouseup"===e)this._upEl=r;else if("click"===e){if(this._downEl!==this._upEl||!this._downPoint||Xz(this._downPoint,[t.zrX,t.zrY])>4)return;this._downPoint=null}this.dispatchToElement(n,e,t)}}));var I0=w0;function C0(e,t,n,r){var a=t+1;if(a===n)return 1;if(r(e[a++],e[t])<0){for(;a<n&&r(e[a],e[a-1])<0;)a++;!function(e,t,n){n--;for(;t<n;){var r=e[t];e[t++]=e[n],e[n--]=r}}(e,t,a)}else for(;a<n&&r(e[a],e[a-1])>=0;)a++;return a-t}function T0(e,t,n,r,a){for(r===t&&r++;r<n;r++){for(var i,o=e[r],s=t,u=r;s<u;)a(o,e[i=s+u>>>1])<0?u=i:s=i+1;var l=r-s;switch(l){case 3:e[s+3]=e[s+2];case 2:e[s+2]=e[s+1];case 1:e[s+1]=e[s];break;default:for(;l>0;)e[s+l]=e[s+l-1],l--}e[s]=o}}function N0(e,t,n,r,a,i){var o=0,s=0,u=1;if(i(e,t[n+a])>0){for(s=r-a;u<s&&i(e,t[n+a+u])>0;)o=u,(u=1+(u<<1))<=0&&(u=s);u>s&&(u=s),o+=a,u+=a}else{for(s=a+1;u<s&&i(e,t[n+a-u])<=0;)o=u,(u=1+(u<<1))<=0&&(u=s);u>s&&(u=s);var l=o;o=a-u,u=a-l}for(o++;o<u;){var c=o+(u-o>>>1);i(e,t[n+c])>0?o=c+1:u=c}return u}function E0(e,t,n,r,a,i){var o=0,s=0,u=1;if(i(e,t[n+a])<0){for(s=a+1;u<s&&i(e,t[n+a-u])<0;)o=u,(u=1+(u<<1))<=0&&(u=s);u>s&&(u=s);var l=o;o=a-u,u=a-l}else{for(s=r-a;u<s&&i(e,t[n+a+u])>=0;)o=u,(u=1+(u<<1))<=0&&(u=s);u>s&&(u=s),o+=a,u+=a}for(o++;o<u;){var c=o+(u-o>>>1);i(e,t[n+c])<0?u=c:o=c+1}return u}function M0(e,t){var n,r,a,i=7,o=0;n=e.length;var s=[];function u(n){var u=r[n],l=a[n],c=r[n+1],h=a[n+1];a[n]=l+h,n===o-3&&(r[n+1]=r[n+2],a[n+1]=a[n+2]),o--;var p=E0(e[c],e,u,l,0,t);u+=p,0!==(l-=p)&&0!==(h=N0(e[u+l-1],e,c,h,h-1,t))&&(l<=h?function(n,r,a,o){var u=0;for(u=0;u<r;u++)s[u]=e[n+u];var l=0,c=a,h=n;if(e[h++]=e[c++],0===--o){for(u=0;u<r;u++)e[h+u]=s[l+u];return}if(1===r){for(u=0;u<o;u++)e[h+u]=e[c+u];return void(e[h+o]=s[l])}var p,f,d,v=i;for(;;){p=0,f=0,d=!1;do{if(t(e[c],s[l])<0){if(e[h++]=e[c++],f++,p=0,0===--o){d=!0;break}}else if(e[h++]=s[l++],p++,f=0,1===--r){d=!0;break}}while((p|f)<v);if(d)break;do{if(0!==(p=E0(e[c],s,l,r,0,t))){for(u=0;u<p;u++)e[h+u]=s[l+u];if(h+=p,l+=p,(r-=p)<=1){d=!0;break}}if(e[h++]=e[c++],0===--o){d=!0;break}if(0!==(f=N0(s[l],e,c,o,0,t))){for(u=0;u<f;u++)e[h+u]=e[c+u];if(h+=f,c+=f,0===(o-=f)){d=!0;break}}if(e[h++]=s[l++],1===--r){d=!0;break}v--}while(p>=7||f>=7);if(d)break;v<0&&(v=0),v+=2}if((i=v)<1&&(i=1),1===r){for(u=0;u<o;u++)e[h+u]=e[c+u];e[h+o]=s[l]}else{if(0===r)throw new Error;for(u=0;u<r;u++)e[h+u]=s[l+u]}}(u,l,c,h):function(n,r,a,o){var u=0;for(u=0;u<o;u++)s[u]=e[a+u];var l=n+r-1,c=o-1,h=a+o-1,p=0,f=0;if(e[h--]=e[l--],0===--r){for(p=h-(o-1),u=0;u<o;u++)e[p+u]=s[u];return}if(1===o){for(f=(h-=r)+1,p=(l-=r)+1,u=r-1;u>=0;u--)e[f+u]=e[p+u];return void(e[h]=s[c])}var d=i;for(;;){var v=0,m=0,g=!1;do{if(t(s[c],e[l])<0){if(e[h--]=e[l--],v++,m=0,0===--r){g=!0;break}}else if(e[h--]=s[c--],m++,v=0,1===--o){g=!0;break}}while((v|m)<d);if(g)break;do{if(0!==(v=r-E0(s[c],e,n,r,r-1,t))){for(r-=v,f=(h-=v)+1,p=(l-=v)+1,u=v-1;u>=0;u--)e[f+u]=e[p+u];if(0===r){g=!0;break}}if(e[h--]=s[c--],1===--o){g=!0;break}if(0!==(m=o-N0(e[l],s,0,o,o-1,t))){for(o-=m,f=(h-=m)+1,p=(c-=m)+1,u=0;u<m;u++)e[f+u]=s[p+u];if(o<=1){g=!0;break}}if(e[h--]=e[l--],0===--r){g=!0;break}d--}while(v>=7||m>=7);if(g)break;d<0&&(d=0),d+=2}(i=d)<1&&(i=1);if(1===o){for(f=(h-=r)+1,p=(l-=r)+1,u=r-1;u>=0;u--)e[f+u]=e[p+u];e[h]=s[c]}else{if(0===o)throw new Error;for(p=h-(o-1),u=0;u<o;u++)e[p+u]=s[u]}}(u,l,c,h))}return n<120?5:n<1542?10:n<119151?19:40,r=[],a=[],{mergeRuns:function(){for(;o>1;){var e=o-2;if(e>=1&&a[e-1]<=a[e]+a[e+1]||e>=2&&a[e-2]<=a[e]+a[e-1])a[e-1]<a[e+1]&&e--;else if(a[e]>a[e+1])break;u(e)}},forceMergeRuns:function(){for(;o>1;){var e=o-2;e>0&&a[e-1]<a[e+1]&&e--,u(e)}},pushRun:function(e,t){r[o]=e,a[o]=t,o+=1}}}function A0(e,t,n,r){n||(n=0),r||(r=e.length);var a=r-n;if(!(a<2)){var i=0;if(a<32)T0(e,n,r,n+(i=C0(e,n,r,t)),t);else{var o=M0(e,t),s=function(e){for(var t=0;e>=32;)t|=1&e,e>>=1;return e+t}(a);do{if((i=C0(e,n,r,t))<s){var u=a;u>s&&(u=s),T0(e,n,n+u,n+i,t),i=u}o.pushRun(n,i),o.mergeRuns(),a-=i,n+=i}while(0!==a);o.forceMergeRuns()}}}var D0=!1;function R0(){D0||(D0=!0,console.warn("z / z2 / zlevel of displayable is invalid, which may cause unexpected errors"))}function O0(e,t){return e.zlevel===t.zlevel?e.z===t.z?e.z2-t.z2:e.z-t.z:e.zlevel-t.zlevel}var F0,L0=function(){function e(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=O0}return e.prototype.traverse=function(e,t){for(var n=0;n<this._roots.length;n++)this._roots[n].traverse(e,t)},e.prototype.getDisplayList=function(e,t){t=t||!1;var n=this._displayList;return!e&&n.length||this.updateDisplayList(t),n},e.prototype.updateDisplayList=function(e){this._displayListLen=0;for(var t=this._roots,n=this._displayList,r=0,a=t.length;r<a;r++)this._updateAndAddDisplayable(t[r],null,e);n.length=this._displayListLen,A0(n,O0)},e.prototype._updateAndAddDisplayable=function(e,t,n){if(!e.ignore||n){e.beforeUpdate(),e.update(),e.afterUpdate();var r=e.getClipPath();if(e.ignoreClip)t=null;else if(r){t=t?t.slice():[];for(var a=r,i=e;a;)a.parent=i,a.updateTransform(),t.push(a),i=a,a=a.getClipPath()}if(e.childrenRef){for(var o=e.childrenRef(),s=0;s<o.length;s++){var u=o[s];e.__dirty&&(u.__dirty|=1),this._updateAndAddDisplayable(u,t,n)}e.__dirty=0}else{var l=e;t&&t.length?l.__clipPaths=t:l.__clipPaths&&l.__clipPaths.length>0&&(l.__clipPaths=[]),isNaN(l.z)&&(R0(),l.z=0),isNaN(l.z2)&&(R0(),l.z2=0),isNaN(l.zlevel)&&(R0(),l.zlevel=0),this._displayList[this._displayListLen++]=l}var c=e.getDecalElement&&e.getDecalElement();c&&this._updateAndAddDisplayable(c,t,n);var h=e.getTextGuideLine();h&&this._updateAndAddDisplayable(h,t,n);var p=e.getTextContent();p&&this._updateAndAddDisplayable(p,t,n)}},e.prototype.addRoot=function(e){e.__zr&&e.__zr.storage===this||this._roots.push(e)},e.prototype.delRoot=function(e){if(e instanceof Array)for(var t=0,n=e.length;t<n;t++)this.delRoot(e[t]);else{var r=GL(this._roots,e);r>=0&&this._roots.splice(r,1)}},e.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},e.prototype.getRoots=function(){return this._roots},e.prototype.dispose=function(){this._displayList=null,this._roots=null},e}(),P0=L0;F0=MP.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(e){return setTimeout(e,16)};var z0=F0;function B0(){return(new Date).getTime()}var V0=function(e){function t(t){var n=e.call(this)||this;return n._running=!1,n._time=0,n._pausedTime=0,n._pauseStart=0,n._paused=!1,t=t||{},n.stage=t.stage||{},n}return GP(t,e),t.prototype.addClip=function(e){e.animation&&this.removeClip(e),this._head?(this._tail.next=e,e.prev=this._tail,e.next=null,this._tail=e):this._head=this._tail=e,e.animation=this},t.prototype.addAnimator=function(e){e.animation=this;var t=e.getClip();t&&this.addClip(t)},t.prototype.removeClip=function(e){if(e.animation){var t=e.prev,n=e.next;t?t.next=n:this._head=n,n?n.prev=t:this._tail=t,e.next=e.prev=e.animation=null}},t.prototype.removeAnimator=function(e){var t=e.getClip();t&&this.removeClip(t),e.animation=null},t.prototype.update=function(e){for(var t=B0()-this._pausedTime,n=t-this._time,r=this._head;r;){var a=r.next;r.step(t,n)?(r.ondestroy(),this.removeClip(r),r=a):r=a}this._time=t,e||(this.trigger("frame",n),this.stage.update&&this.stage.update())},t.prototype._startLoop=function(){var e=this;this._running=!0,z0((function t(){e._running&&(z0(t),!e._paused&&e.update())}))},t.prototype.start=function(){this._running||(this._time=B0(),this._pausedTime=0,this._startLoop())},t.prototype.stop=function(){this._running=!1},t.prototype.pause=function(){this._paused||(this._pauseStart=B0(),this._paused=!0)},t.prototype.resume=function(){this._paused&&(this._pausedTime+=B0()-this._pauseStart,this._paused=!1)},t.prototype.clear=function(){for(var e=this._head;e;){var t=e.next;e.prev=e.next=e.animation=null,e=t}this._head=this._tail=null},t.prototype.isFinished=function(){return null==this._head},t.prototype.animate=function(e,t){t=t||{},this.start();var n=new mV(e,t.loop);return this.addAnimator(n),n},t}(yV),W0=V0,U0=MP.domSupported,H0=function(){var e=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],t={pointerdown:1,pointerup:1,pointermove:1,pointerout:1};return{mouse:e,touch:["touchstart","touchend","touchmove"],pointer:KL(e,(function(e){var n=e.replace("mouse","pointer");return t.hasOwnProperty(n)?n:e}))}}(),G0=["mousemove","mouseup"],j0=["pointermove","pointerup"],q0=!1;function X0(e){var t=e.pointerType;return"pen"===t||"touch"===t}function K0(e){e&&(e.zrByTouch=!0)}function Y0(e,t){for(var n=t,r=!1;n&&9!==n.nodeType&&!(r=n.domBelongToZr||n!==t&&n===e.painterRoot);)n=n.parentNode;return r}var Z0=function(e,t){this.stopPropagation=CP,this.stopImmediatePropagation=CP,this.preventDefault=CP,this.type=t.type,this.target=this.currentTarget=e.dom,this.pointerType=t.pointerType,this.clientX=t.clientX,this.clientY=t.clientY},Q0={mousedown:function(e){e=a$(this.dom,e),this.__mayPointerCapture=[e.zrX,e.zrY],this.trigger("mousedown",e)},mousemove:function(e){e=a$(this.dom,e);var t=this.__mayPointerCapture;!t||e.zrX===t[0]&&e.zrY===t[1]||this.__togglePointerCapture(!0),this.trigger("mousemove",e)},mouseup:function(e){e=a$(this.dom,e),this.__togglePointerCapture(!1),this.trigger("mouseup",e)},mouseout:function(e){Y0(this,(e=a$(this.dom,e)).toElement||e.relatedTarget)||(this.__pointerCapturing&&(e.zrEventControl="no_globalout"),this.trigger("mouseout",e))},wheel:function(e){q0=!0,e=a$(this.dom,e),this.trigger("mousewheel",e)},mousewheel:function(e){q0||(e=a$(this.dom,e),this.trigger("mousewheel",e))},touchstart:function(e){K0(e=a$(this.dom,e)),this.__lastTouchMoment=new Date,this.handler.processGesture(e,"start"),Q0.mousemove.call(this,e),Q0.mousedown.call(this,e)},touchmove:function(e){K0(e=a$(this.dom,e)),this.handler.processGesture(e,"change"),Q0.mousemove.call(this,e)},touchend:function(e){K0(e=a$(this.dom,e)),this.handler.processGesture(e,"end"),Q0.mouseup.call(this,e),+new Date-+this.__lastTouchMoment<300&&Q0.click.call(this,e)},pointerdown:function(e){Q0.mousedown.call(this,e)},pointermove:function(e){X0(e)||Q0.mousemove.call(this,e)},pointerup:function(e){Q0.mouseup.call(this,e)},pointerout:function(e){X0(e)||Q0.mouseout.call(this,e)}};XL(["click","dblclick","contextmenu"],(function(e){Q0[e]=function(t){t=a$(this.dom,t),this.trigger(e,t)}}));var $0={pointermove:function(e){X0(e)||$0.mousemove.call(this,e)},pointerup:function(e){$0.mouseup.call(this,e)},mousemove:function(e){this.trigger("mousemove",e)},mouseup:function(e){var t=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",e),t&&(e.zrEventControl="only_globalout",this.trigger("mouseout",e))}};function J0(e,t){var n=t.domHandlers;MP.pointerEventsSupported?XL(H0.pointer,(function(r){t1(t,r,(function(t){n[r].call(e,t)}))})):(MP.touchEventsSupported&&XL(H0.touch,(function(r){t1(t,r,(function(a){n[r].call(e,a),function(e){e.touching=!0,null!=e.touchTimer&&(clearTimeout(e.touchTimer),e.touchTimer=null),e.touchTimer=setTimeout((function(){e.touching=!1,e.touchTimer=null}),700)}(t)}))})),XL(H0.mouse,(function(r){t1(t,r,(function(a){a=r$(a),t.touching||n[r].call(e,a)}))})))}function e1(e,t){function n(n){t1(t,n,(function(r){r=r$(r),Y0(e,r.target)||(r=function(e,t){return a$(e.dom,new Z0(e,t),!0)}(e,r),t.domHandlers[n].call(e,r))}),{capture:!0})}MP.pointerEventsSupported?XL(j0,n):MP.touchEventsSupported||XL(G0,n)}function t1(e,t,n,r){e.mounted[t]=n,e.listenerOpts[t]=r,function(e,t,n,r){e.addEventListener(t,n,r)}(e.domTarget,t,n,r)}function n1(e){var t=e.mounted;for(var n in t)t.hasOwnProperty(n)&&i$(e.domTarget,n,t[n],e.listenerOpts[n]);e.mounted={}}var r1=function(e,t){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=e,this.domHandlers=t},a1=function(e){function t(t,n){var r=e.call(this)||this;return r.__pointerCapturing=!1,r.dom=t,r.painterRoot=n,r._localHandlerScope=new r1(t,Q0),U0&&(r._globalHandlerScope=new r1(document,$0)),J0(r,r._localHandlerScope),r}return GP(t,e),t.prototype.dispose=function(){n1(this._localHandlerScope),U0&&n1(this._globalHandlerScope)},t.prototype.setCursor=function(e){this.dom.style&&(this.dom.style.cursor=e||"default")},t.prototype.__togglePointerCapture=function(e){if(this.__mayPointerCapture=null,U0&&+this.__pointerCapturing^+e){this.__pointerCapturing=e;var t=this._globalHandlerScope;e?e1(this,t):n1(t)}},t}(yV),i1={},o1={};var s1=function(){function e(e,t,n){var r=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,n=n||{},this.dom=t,this.id=e;var a=new P0,i=n.renderer||"canvas";i1[i]||(i=QL(i1)[0]),n.useDirtyRect=null!=n.useDirtyRect&&n.useDirtyRect;var o=new i1[i](t,a,n,e),s=n.ssr||o.ssrOnly;this.storage=a,this.painter=o;var u=MP.node||MP.worker||s?null:new a1(o.getViewportRoot(),o.root);this.handler=new I0(a,o,u,o.root),this.animation=new W0({stage:{update:s?null:function(){return r._flush(!0)}}}),s||this.animation.start()}return e.prototype.add=function(e){e&&(this.storage.addRoot(e),e.addSelfToZr(this),this.refresh())},e.prototype.remove=function(e){e&&(this.storage.delRoot(e),e.removeSelfFromZr(this),this.refresh())},e.prototype.configLayer=function(e,t){this.painter.configLayer&&this.painter.configLayer(e,t),this.refresh()},e.prototype.setBackgroundColor=function(e){this.painter.setBackgroundColor&&this.painter.setBackgroundColor(e),this.refresh(),this._backgroundColor=e,this._darkMode=function(e){if(!e)return!1;if("string"===typeof e)return tV(e,1)<.4;if(e.colorStops){for(var t=e.colorStops,n=0,r=t.length,a=0;a<r;a++)n+=tV(t[a].color,1);return(n/=r)<.4}return!1}(e)},e.prototype.getBackgroundColor=function(){return this._backgroundColor},e.prototype.setDarkMode=function(e){this._darkMode=e},e.prototype.isDarkMode=function(){return this._darkMode},e.prototype.refreshImmediately=function(e){e||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1},e.prototype.refresh=function(){this._needsRefresh=!0,this.animation.start()},e.prototype.flush=function(){this._flush(!1)},e.prototype._flush=function(e){var t,n=B0();this._needsRefresh&&(t=!0,this.refreshImmediately(e)),this._needsRefreshHover&&(t=!0,this.refreshHoverImmediately());var r=B0();t?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:r-n})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},e.prototype.setSleepAfterStill=function(e){this._sleepAfterStill=e},e.prototype.wakeUp=function(){this.animation.start(),this._stillFrameAccum=0},e.prototype.refreshHover=function(){this._needsRefreshHover=!0},e.prototype.refreshHoverImmediately=function(){this._needsRefreshHover=!1,this.painter.refreshHover&&"canvas"===this.painter.getType()&&this.painter.refreshHover()},e.prototype.resize=function(e){e=e||{},this.painter.resize(e.width,e.height),this.handler.resize()},e.prototype.clearAnimation=function(){this.animation.clear()},e.prototype.getWidth=function(){return this.painter.getWidth()},e.prototype.getHeight=function(){return this.painter.getHeight()},e.prototype.setCursorStyle=function(e){this.handler.setCursorStyle(e)},e.prototype.findHover=function(e,t){return this.handler.findHover(e,t)},e.prototype.on=function(e,t,n){return this.handler.on(e,t,n),this},e.prototype.off=function(e,t){this.handler.off(e,t)},e.prototype.trigger=function(e,t){this.handler.trigger(e,t)},e.prototype.clear=function(){for(var e=this.storage.getRoots(),t=0;t<e.length;t++)e[t]instanceof zK&&e[t].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()},e.prototype.dispose=function(){var e;this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,e=this.id,delete o1[e]},e}();function u1(e,t){var n=new s1(zL(),e,t);return o1[n.id]=n,n}var l1="";"undefined"!==typeof navigator&&(l1=navigator.platform||"");var c1,h1,p1,f1="rgba(0, 0, 0, 0.2)",d1={darkMode:"auto",colorBy:"series",color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],gradientColor:["#f6efa6","#d88273","#bf444c"],aria:{decal:{decals:[{color:f1,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:f1,symbol:"circle",dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:f1,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:f1,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:f1,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:f1,symbol:"triangle",dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:l1.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,stateAnimation:{duration:300,easing:"cubicOut"},animation:"auto",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1},v1=wP();var m1=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return wL(t,e),t.prototype.init=function(e,t,n,r,a,i){r=r||{},this.option=null,this._theme=new CG(r),this._locale=new CG(a),this._optionManager=i},t.prototype.setOption=function(e,t,n){var r=b1(t);this._optionManager.setOption(e,n,r),this._resetOption(null,r)},t.prototype.resetOption=function(e,t){return this._resetOption(e,b1(t))},t.prototype._resetOption=function(e,t){var n=!1,r=this._optionManager;if(!e||"recreate"===e){var a=r.mountOption("recreate"===e);0,this.option&&"recreate"!==e?(this.restoreData(),this._mergeOption(a,t)):p1(this,a),n=!0}if("timeline"!==e&&"media"!==e||this.restoreData(),!e||"recreate"===e||"timeline"===e){var i=r.getTimelineOption(this);i&&(n=!0,this._mergeOption(i,t))}if(!e||"recreate"===e||"media"===e){var o=r.getMediaOption(this);o.length&&XL(o,(function(e){n=!0,this._mergeOption(e,t)}),this)}return n},t.prototype.mergeOption=function(e){this._mergeOption(e,null)},t.prototype._mergeOption=function(e,t){var n=this.option,r=this._componentsMap,a=this._componentsCount,i=[],o=wP(),s=t&&t.replaceMergeMainTypeMap;HG(this).datasetMap=wP(),XL(e,(function(e,t){null!=e&&(IX.hasClass(t)?t&&(i.push(t),o.set(t,!0)):n[t]=null==n[t]?VL(e):WL(n[t],e,!0))})),s&&s.each((function(e,t){IX.hasClass(t)&&!o.get(t)&&(i.push(t),o.set(t,!0))})),IX.topologicalTravel(i,IX.getAllClassMainTypes(),(function(t){var i=function(e,t,n){var r=v1.get(t);if(!r)return n;var a=r(e);return a?n.concat(a):n}(this,t,UU(e[t])),o=r.get(t),u=o?s&&s.get(t)?"replaceMerge":"normalMerge":"replaceAll",l=XU(o,i,u);(function(e,t,n){XL(e,(function(e){var r=e.newOption;iP(r)&&(e.keyInfo.mainType=t,e.keyInfo.subType=function(e,t,n,r){return t.type?t.type:n?n.subType:r.determineSubType(e,t)}(t,r,e.existing,n))}))})(l,t,IX),n[t]=null,r.set(t,null),a.set(t,0);var c,h=[],p=[],f=0;XL(l,(function(e,n){var r=e.existing,a=e.newOption;if(a){var i="series"===t,o=IX.getClass(t,e.keyInfo.subType,!i);if(!o)return;if("tooltip"===t){if(c)return void 0;c=!0}if(r&&r.constructor===o)r.name=e.keyInfo.name,r.mergeOption(a,this),r.optionUpdated(a,!1);else{var s=UL({componentIndex:n},e.keyInfo);UL(r=new o(a,this,this,s),s),e.brandNew&&(r.__requireNewView=!0),r.init(a,this,this),r.optionUpdated(null,!0)}}else r&&(r.mergeOption({},this),r.optionUpdated({},!1));r?(h.push(r.option),p.push(r),f++):(h.push(void 0),p.push(void 0))}),this),n[t]=h,r.set(t,p),a.set(t,f),"series"===t&&c1(this)}),this),this._seriesIndices||c1(this)},t.prototype.getOption=function(){var e=VL(this.option);return XL(e,(function(t,n){if(IX.hasClass(n)){for(var r=UU(t),a=r.length,i=!1,o=a-1;o>=0;o--)r[o]&&!$U(r[o])?i=!0:(r[o]=null,!i&&a--);r.length=a,e[n]=r}})),delete e["\0_ec_inner"],e},t.prototype.getTheme=function(){return this._theme},t.prototype.getLocaleModel=function(){return this._locale},t.prototype.setUpdatePayload=function(e){this._payload=e},t.prototype.getUpdatePayload=function(){return this._payload},t.prototype.getComponent=function(e,t){var n=this._componentsMap.get(e);if(n){var r=n[t||0];if(r)return r;if(null==t)for(var a=0;a<n.length;a++)if(n[a])return n[a]}},t.prototype.queryComponents=function(e){var t=e.mainType;if(!t)return[];var n,r=e.index,a=e.id,i=e.name,o=this._componentsMap.get(t);return o&&o.length?(null!=r?(n=[],XL(UU(r),(function(e){o[e]&&n.push(o[e])}))):n=null!=a?g1("id",a,o):null!=i?g1("name",i,o):ZL(o,(function(e){return!!e})),y1(n,e)):[]},t.prototype.findComponents=function(e){var t,n=e.query,r=e.mainType,a=function(e){var t=r+"Index",n=r+"Id",a=r+"Name";return!e||null==e[t]&&null==e[n]&&null==e[a]?null:{mainType:r,index:e[t],id:e[n],name:e[a]}}(n),i=a?this.queryComponents(a):ZL(this._componentsMap.get(r),(function(e){return!!e}));return t=y1(i,e),e.filter?ZL(t,e.filter):t},t.prototype.eachComponent=function(e,t,n){var r=this._componentsMap;if(tP(e)){var a=t,i=e;r.each((function(e,t){for(var n=0;e&&n<e.length;n++){var r=e[n];r&&i.call(a,t,r,r.componentIndex)}}))}else for(var o=nP(e)?r.get(e):iP(e)?this.findComponents(e):null,s=0;o&&s<o.length;s++){var u=o[s];u&&t.call(n,u,u.componentIndex)}},t.prototype.getSeriesByName=function(e){var t=ZU(e,null);return ZL(this._componentsMap.get("series"),(function(e){return!!e&&null!=t&&e.name===t}))},t.prototype.getSeriesByIndex=function(e){return this._componentsMap.get("series")[e]},t.prototype.getSeriesByType=function(e){return ZL(this._componentsMap.get("series"),(function(t){return!!t&&t.subType===e}))},t.prototype.getSeries=function(){return ZL(this._componentsMap.get("series"),(function(e){return!!e}))},t.prototype.getSeriesCount=function(){return this._componentsCount.get("series")},t.prototype.eachSeries=function(e,t){h1(this),XL(this._seriesIndices,(function(n){var r=this._componentsMap.get("series")[n];e.call(t,r,n)}),this)},t.prototype.eachRawSeries=function(e,t){XL(this._componentsMap.get("series"),(function(n){n&&e.call(t,n,n.componentIndex)}))},t.prototype.eachSeriesByType=function(e,t,n){h1(this),XL(this._seriesIndices,(function(r){var a=this._componentsMap.get("series")[r];a.subType===e&&t.call(n,a,r)}),this)},t.prototype.eachRawSeriesByType=function(e,t,n){return XL(this.getSeriesByType(e),t,n)},t.prototype.isSeriesFiltered=function(e){return h1(this),null==this._seriesIndicesMap.get(e.componentIndex)},t.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},t.prototype.filterSeries=function(e,t){h1(this);var n=[];XL(this._seriesIndices,(function(r){var a=this._componentsMap.get("series")[r];e.call(t,a,r)&&n.push(r)}),this),this._seriesIndices=n,this._seriesIndicesMap=wP(n)},t.prototype.restoreData=function(e){c1(this);var t=this._componentsMap,n=[];t.each((function(e,t){IX.hasClass(t)&&n.push(t)})),IX.topologicalTravel(n,IX.getAllClassMainTypes(),(function(n){XL(t.get(n),(function(t){!t||"series"===n&&function(e,t){if(t){var n=t.seriesIndex,r=t.seriesId,a=t.seriesName;return null!=n&&e.componentIndex!==n||null!=r&&e.id!==r||null!=a&&e.name!==a}}(t,e)||t.restoreData()}))}))},t.internalField=(c1=function(e){var t=e._seriesIndices=[];XL(e._componentsMap.get("series"),(function(e){e&&t.push(e.componentIndex)})),e._seriesIndicesMap=wP(t)},h1=function(e){},void(p1=function(e,t){e.option={},e.option["\0_ec_inner"]=1,e._componentsMap=wP({series:[]}),e._componentsCount=wP();var n=t.aria;iP(n)&&null==n.enabled&&(n.enabled=!0),function(e,t){var n=e.color&&!e.colorLayer;XL(t,(function(t,r){"colorLayer"===r&&n||IX.hasClass(r)||("object"===typeof t?e[r]=e[r]?WL(e[r],t,!1):VL(t):null==e[r]&&(e[r]=t))}))}(t,e._theme.option),WL(t,d1,!1),e._mergeOption(t,null)})),t}(CG);function g1(e,t,n){if(eP(t)){var r=wP();return XL(t,(function(e){null!=e&&(null!=ZU(e,null)&&r.set(e,!0))})),ZL(n,(function(t){return t&&r.get(t[e])}))}var a=ZU(t,null);return ZL(n,(function(t){return t&&null!=a&&t[e]===a}))}function y1(e,t){return t.hasOwnProperty("subType")?ZL(e,(function(e){return e&&e.subType===t.subType})):e}function b1(e){var t=wP();return e&&XL(UU(e.replaceMerge),(function(e){t.set(e,!0)})),{replaceMergeMainTypeMap:t}}jL(m1,TX);var x1=m1,k1=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isSSR","isDisposed","on","off","getDataURL","getConnectedDataURL","getOption","getId","updateLabelLayout"],w1=function(e){XL(k1,(function(t){this[t]=$L(e[t],e)}),this)},_1=/^(min|max)?(.+)$/,S1=function(){function e(e){this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[],this._api=e}return e.prototype.setOption=function(e,t,n){e&&(XL(UU(e.series),(function(e){e&&e.data&&sP(e.data)&&bP(e.data)})),XL(UU(e.dataset),(function(e){e&&e.source&&sP(e.source)&&bP(e.source)}))),e=VL(e);var r=this._optionBackup,a=function(e,t,n){var r,a,i=[],o=e.baseOption,s=e.timeline,u=e.options,l=e.media,c=!!e.media,h=!!(u||s||o&&o.timeline);o?(a=o).timeline||(a.timeline=s):((h||c)&&(e.options=e.media=null),a=e);c&&eP(l)&&XL(l,(function(e){e&&e.option&&(e.query?i.push(e):r||(r=e))}));function p(e){XL(t,(function(t){t(e,n)}))}return p(a),XL(u,(function(e){return p(e)})),XL(i,(function(e){return p(e.option)})),{baseOption:a,timelineOptions:u||[],mediaDefault:r,mediaList:i}}(e,t,!r);this._newBaseOption=a.baseOption,r?(a.timelineOptions.length&&(r.timelineOptions=a.timelineOptions),a.mediaList.length&&(r.mediaList=a.mediaList),a.mediaDefault&&(r.mediaDefault=a.mediaDefault)):this._optionBackup=a},e.prototype.mountOption=function(e){var t=this._optionBackup;return this._timelineOptions=t.timelineOptions,this._mediaList=t.mediaList,this._mediaDefault=t.mediaDefault,this._currentMediaIndices=[],VL(e?t.baseOption:this._newBaseOption)},e.prototype.getTimelineOption=function(e){var t,n=this._timelineOptions;if(n.length){var r=e.getComponent("timeline");r&&(t=VL(n[r.getCurrentIndex()]))}return t},e.prototype.getMediaOption=function(e){var t,n,r=this._api.getWidth(),a=this._api.getHeight(),i=this._mediaList,o=this._mediaDefault,s=[],u=[];if(!i.length&&!o)return u;for(var l=0,c=i.length;l<c;l++)I1(i[l].query,r,a)&&s.push(l);return!s.length&&o&&(s=[-1]),s.length&&(t=s,n=this._currentMediaIndices,t.join(",")!==n.join(","))&&(u=KL(s,(function(e){return VL(-1===e?o.option:i[e].option)}))),this._currentMediaIndices=s,u},e}();function I1(e,t,n){var r={width:t,height:n,aspectratio:t/n},a=!0;return XL(e,(function(e,t){var n=t.match(_1);if(n&&n[1]&&n[2]){var i=n[1],o=n[2].toLowerCase();(function(e,t,n){return"min"===n?e>=t:"max"===n?e<=t:e===t})(r[o],e,i)||(a=!1)}})),a}var C1=S1,T1=XL,N1=iP,E1=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function M1(e){var t=e&&e.itemStyle;if(t)for(var n=0,r=E1.length;n<r;n++){var a=E1[n],i=t.normal,o=t.emphasis;i&&i[a]&&(e[a]=e[a]||{},e[a].normal?WL(e[a].normal,i[a]):e[a].normal=i[a],i[a]=null),o&&o[a]&&(e[a]=e[a]||{},e[a].emphasis?WL(e[a].emphasis,o[a]):e[a].emphasis=o[a],o[a]=null)}}function A1(e,t,n){if(e&&e[t]&&(e[t].normal||e[t].emphasis)){var r=e[t].normal,a=e[t].emphasis;r&&(n?(e[t].normal=e[t].emphasis=null,HL(e[t],r)):e[t]=r),a&&(e.emphasis=e.emphasis||{},e.emphasis[t]=a,a.focus&&(e.emphasis.focus=a.focus),a.blurScope&&(e.emphasis.blurScope=a.blurScope))}}function D1(e){A1(e,"itemStyle"),A1(e,"lineStyle"),A1(e,"areaStyle"),A1(e,"label"),A1(e,"labelLine"),A1(e,"upperLabel"),A1(e,"edgeLabel")}function R1(e,t){var n=N1(e)&&e[t],r=N1(n)&&n.textStyle;if(r){0;for(var a=0,i=GU.length;a<i;a++){var o=GU[a];r.hasOwnProperty(o)&&(n[o]=r[o])}}}function O1(e){e&&(D1(e),R1(e,"label"),e.emphasis&&R1(e.emphasis,"label"))}function F1(e){return eP(e)?e:e?[e]:[]}function L1(e){return(eP(e)?e[0]:e)||{}}function P1(e,t){T1(F1(e.series),(function(e){N1(e)&&function(e){if(N1(e)){M1(e),D1(e),R1(e,"label"),R1(e,"upperLabel"),R1(e,"edgeLabel"),e.emphasis&&(R1(e.emphasis,"label"),R1(e.emphasis,"upperLabel"),R1(e.emphasis,"edgeLabel"));var t=e.markPoint;t&&(M1(t),O1(t));var n=e.markLine;n&&(M1(n),O1(n));var r=e.markArea;r&&O1(r);var a=e.data;if("graph"===e.type){a=a||e.nodes;var i=e.links||e.edges;if(i&&!sP(i))for(var o=0;o<i.length;o++)O1(i[o]);XL(e.categories,(function(e){D1(e)}))}if(a&&!sP(a))for(o=0;o<a.length;o++)O1(a[o]);if((t=e.markPoint)&&t.data){var s=t.data;for(o=0;o<s.length;o++)O1(s[o])}if((n=e.markLine)&&n.data){var u=n.data;for(o=0;o<u.length;o++)eP(u[o])?(O1(u[o][0]),O1(u[o][1])):O1(u[o])}"gauge"===e.type?(R1(e,"axisLabel"),R1(e,"title"),R1(e,"detail")):"treemap"===e.type?(A1(e.breadcrumb,"itemStyle"),XL(e.levels,(function(e){D1(e)}))):"tree"===e.type&&D1(e.leaves)}}(e)}));var n=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];t&&n.push("valueAxis","categoryAxis","logAxis","timeAxis"),T1(n,(function(t){T1(F1(e[t]),(function(e){e&&(R1(e,"axisLabel"),R1(e.axisPointer,"label"))}))})),T1(F1(e.parallel),(function(e){var t=e&&e.parallelAxisDefault;R1(t,"axisLabel"),R1(t&&t.axisPointer,"label")})),T1(F1(e.calendar),(function(e){A1(e,"itemStyle"),R1(e,"dayLabel"),R1(e,"monthLabel"),R1(e,"yearLabel")})),T1(F1(e.radar),(function(e){R1(e,"name"),e.name&&null==e.axisName&&(e.axisName=e.name,delete e.name),null!=e.nameGap&&null==e.axisNameGap&&(e.axisNameGap=e.nameGap,delete e.nameGap)})),T1(F1(e.geo),(function(e){N1(e)&&(O1(e),T1(F1(e.regions),(function(e){O1(e)})))})),T1(F1(e.timeline),(function(e){O1(e),A1(e,"label"),A1(e,"itemStyle"),A1(e,"controlStyle",!0);var t=e.data;eP(t)&&XL(t,(function(e){iP(e)&&(A1(e,"label"),A1(e,"itemStyle"))}))})),T1(F1(e.toolbox),(function(e){A1(e,"iconStyle"),T1(e.feature,(function(e){A1(e,"iconStyle")}))})),R1(L1(e.axisPointer),"label"),R1(L1(e.tooltip).axisPointer,"label")}function z1(e){e&&XL(B1,(function(t){t[0]in e&&!(t[1]in e)&&(e[t[1]]=e[t[0]])}))}var B1=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],V1=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],W1=[["borderRadius","barBorderRadius"],["borderColor","barBorderColor"],["borderWidth","barBorderWidth"]];function U1(e){var t=e&&e.itemStyle;if(t)for(var n=0;n<W1.length;n++){var r=W1[n][1],a=W1[n][0];null!=t[r]&&(t[a]=t[r])}}function H1(e){e&&"edge"===e.alignTo&&null!=e.margin&&null==e.edgeDistance&&(e.edgeDistance=e.margin)}function G1(e){e&&e.downplay&&!e.blur&&(e.blur=e.downplay)}function j1(e,t){if(e)for(var n=0;n<e.length;n++)t(e[n]),e[n]&&j1(e[n].children,t)}function q1(e,t){P1(e,t),e.series=UU(e.series),XL(e.series,(function(e){if(iP(e)){var t=e.type;if("line"===t)null!=e.clipOverflow&&(e.clip=e.clipOverflow);else if("pie"===t||"gauge"===t){if(null!=e.clockWise&&(e.clockwise=e.clockWise),H1(e.label),(a=e.data)&&!sP(a))for(var n=0;n<a.length;n++)H1(a[n]);null!=e.hoverOffset&&(e.emphasis=e.emphasis||{},(e.emphasis.scaleSize=null)&&(e.emphasis.scaleSize=e.hoverOffset))}else if("gauge"===t){var r=function(e,t){for(var n=t.split(","),r=e,a=0;a<n.length&&null!=(r=r&&r[n[a]]);a++);return r}(e,"pointer.color");null!=r&&function(e,t,n,r){for(var a,i=t.split(","),o=e,s=0;s<i.length-1;s++)null==o[a=i[s]]&&(o[a]={}),o=o[a];(r||null==o[i[s]])&&(o[i[s]]=n)}(e,"itemStyle.color",r)}else if("bar"===t){var a;if(U1(e),U1(e.backgroundStyle),U1(e.emphasis),(a=e.data)&&!sP(a))for(n=0;n<a.length;n++)"object"===typeof a[n]&&(U1(a[n]),U1(a[n]&&a[n].emphasis))}else if("sunburst"===t){var i=e.highlightPolicy;i&&(e.emphasis=e.emphasis||{},e.emphasis.focus||(e.emphasis.focus=i)),G1(e),j1(e.data,G1)}else"graph"===t||"sankey"===t?function(e){e&&null!=e.focusNodeAdjacency&&(e.emphasis=e.emphasis||{},null==e.emphasis.focus&&(e.emphasis.focus="adjacency"))}(e):"map"===t&&(e.mapType&&!e.map&&(e.map=e.mapType),e.mapLocation&&HL(e,e.mapLocation));null!=e.hoverAnimation&&(e.emphasis=e.emphasis||{},e.emphasis&&null==e.emphasis.scale&&(e.emphasis.scale=e.hoverAnimation)),z1(e)}})),e.dataRange&&(e.visualMap=e.dataRange),XL(V1,(function(t){var n=e[t];n&&(eP(n)||(n=[n]),XL(n,(function(e){z1(e)})))}))}function X1(e){XL(e,(function(t,n){var r=[],a=[NaN,NaN],i=[t.stackResultDimension,t.stackedOverDimension],o=t.data,s=t.isStackedByIndex;o.modify(i,(function(i,u,l){var c,h,p=o.get(t.stackedDimension,l);if(isNaN(p))return a;s?h=o.getRawIndex(l):c=o.get(t.stackedByDimension,l);for(var f=NaN,d=n-1;d>=0;d--){var v=e[d];if(s||(h=v.data.rawIndexOf(v.stackedByDimension,c)),h>=0){var m=v.data.getByRawIndex(v.stackResultDimension,h);if(p>=0&&m>0||p<=0&&m<0){p=TU(p,m),f=m;break}}}return r[0]=p,r[1]=f,r}))}))}var K1=eH(),Y1={itemStyle:VP(wG,!0),lineStyle:VP(bG,!0)},Z1={lineStyle:"stroke",itemStyle:"fill"};function Q1(e,t){var n=e.visualStyleMapper||Y1[t];return n||(console.warn("Unkown style type '"+t+"'."),Y1.itemStyle)}function $1(e,t){var n=e.visualDrawType||Z1[t];return n||(console.warn("Unkown style type '"+t+"'."),"fill")}var J1={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){var n=e.getData(),r=e.visualStyleAccessPath||"itemStyle",a=e.getModel(r),i=Q1(e,r)(a),o=a.getShallow("decal");o&&(n.setVisual("decal",o),o.dirty=!0);var s=$1(e,r),u=i[s],l=tP(u)?u:null,c="auto"===i.fill||"auto"===i.stroke;if(!i[s]||l||c){var h=e.getColorFromPalette(e.name,null,t.getSeriesCount());i[s]||(i[s]=h,n.setVisual("colorFromPalette",!0)),i.fill="auto"===i.fill||tP(i.fill)?h:i.fill,i.stroke="auto"===i.stroke||tP(i.stroke)?h:i.stroke}if(n.setVisual("style",i),n.setVisual("drawType",s),!t.isSeriesFiltered(e)&&l)return n.setVisual("colorFromPalette",!1),{dataEach:function(t,n){var r=e.getDataParams(n),a=UL({},i);a[s]=l(r),t.setItemVisual(n,"style",a)}}}},e2=new CG,t2={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){if(!e.ignoreStyleOnData&&!t.isSeriesFiltered(e)){var n=e.getData(),r=e.visualStyleAccessPath||"itemStyle",a=Q1(e,r),i=n.getVisual("drawType");return{dataEach:n.hasItemOption?function(e,t){var n=e.getRawDataItem(t);if(n&&n[r]){e2.option=n[r];var o=a(e2);UL(e.ensureUniqueItemVisual(t,"style"),o),e2.option.decal&&(e.setItemVisual(t,"decal",e2.option.decal),e2.option.decal.dirty=!0),i in o&&e.setItemVisual(t,"colorFromPalette",!1)}}:null}}}},n2={performRawSeries:!0,overallReset:function(e){var t=wP();e.eachSeries((function(e){var n=e.getColorBy();if(!e.isColorBySeries()){var r=e.type+"-"+n,a=t.get(r);a||(a={},t.set(r,a)),K1(e).scope=a}})),e.eachSeries((function(t){if(!t.isColorBySeries()&&!e.isSeriesFiltered(t)){var n=t.getRawData(),r={},a=t.getData(),i=K1(t).scope,o=t.visualStyleAccessPath||"itemStyle",s=$1(t,o);a.each((function(e){var t=a.getRawIndex(e);r[t]=e})),n.each((function(e){var o=r[e];if(a.getItemVisual(o,"colorFromPalette")){var u=a.ensureUniqueItemVisual(o,"style"),l=n.getName(e)||e+"",c=n.count();u[s]=t.getColorFromPalette(l,i,c)}}))}}))}},r2=Math.PI;var a2=function(){function e(e,t,n,r){this._stageTaskMap=wP(),this.ecInstance=e,this.api=t,n=this._dataProcessorHandlers=n.slice(),r=this._visualHandlers=r.slice(),this._allHandlers=n.concat(r)}return e.prototype.restoreData=function(e,t){e.restoreData(t),this._stageTaskMap.each((function(e){var t=e.overallTask;t&&t.dirty()}))},e.prototype.getPerformArgs=function(e,t){if(e.__pipeline){var n=this._pipelineMap.get(e.__pipeline.id),r=n.context,a=!t&&n.progressiveEnabled&&(!r||r.progressiveRender)&&e.__idxInPipeline>n.blockIndex?n.step:null,i=r&&r.modDataCount;return{step:a,modBy:null!=i?Math.ceil(i/a):null,modDataCount:i}}},e.prototype.getPipeline=function(e){return this._pipelineMap.get(e)},e.prototype.updateStreamModes=function(e,t){var n=this._pipelineMap.get(e.uid),r=e.getData().count(),a=n.progressiveEnabled&&t.incrementalPrepareRender&&r>=n.threshold,i=e.get("large")&&r>=e.get("largeThreshold"),o="mod"===e.get("progressiveChunkMode")?r:null;e.pipelineContext=n.context={progressiveRender:a,modDataCount:o,large:i}},e.prototype.restorePipelines=function(e){var t=this,n=t._pipelineMap=wP();e.eachSeries((function(e){var r=e.getProgressive(),a=e.uid;n.set(a,{id:a,head:null,tail:null,threshold:e.getProgressiveThreshold(),progressiveEnabled:r&&!(e.preventIncremental&&e.preventIncremental()),blockIndex:-1,step:Math.round(r||700),count:0}),t._pipe(e,e.dataTask)}))},e.prototype.prepareStageTasks=function(){var e=this._stageTaskMap,t=this.api.getModel(),n=this.api;XL(this._allHandlers,(function(r){var a=e.get(r.uid)||e.set(r.uid,{});mP(!(r.reset&&r.overallReset),""),r.reset&&this._createSeriesStageTask(r,a,t,n),r.overallReset&&this._createOverallStageTask(r,a,t,n)}),this)},e.prototype.prepareView=function(e,t,n,r){var a=e.renderTask,i=a.context;i.model=t,i.ecModel=n,i.api=r,a.__block=!e.incrementalPrepareRender,this._pipe(t,a)},e.prototype.performDataProcessorTasks=function(e,t){this._performStageTasks(this._dataProcessorHandlers,e,t,{block:!0})},e.prototype.performVisualTasks=function(e,t,n){this._performStageTasks(this._visualHandlers,e,t,n)},e.prototype._performStageTasks=function(e,t,n,r){r=r||{};var a=!1,i=this;function o(e,t){return e.setDirty&&(!e.dirtyMap||e.dirtyMap.get(t.__pipeline.id))}XL(e,(function(e,s){if(!r.visualType||r.visualType===e.visualType){var u=i._stageTaskMap.get(e.uid),l=u.seriesTaskMap,c=u.overallTask;if(c){var h,p=c.agentStubMap;p.each((function(e){o(r,e)&&(e.dirty(),h=!0)})),h&&c.dirty(),i.updatePayload(c,n);var f=i.getPerformArgs(c,r.block);p.each((function(e){e.perform(f)})),c.perform(f)&&(a=!0)}else l&&l.each((function(s,u){o(r,s)&&s.dirty();var l=i.getPerformArgs(s,r.block);l.skip=!e.performRawSeries&&t.isSeriesFiltered(s.context.model),i.updatePayload(s,n),s.perform(l)&&(a=!0)}))}})),this.unfinished=a||this.unfinished},e.prototype.performSeriesTasks=function(e){var t;e.eachSeries((function(e){t=e.dataTask.perform()||t})),this.unfinished=t||this.unfinished},e.prototype.plan=function(){this._pipelineMap.each((function(e){var t=e.tail;do{if(t.__block){e.blockIndex=t.__idxInPipeline;break}t=t.getUpstream()}while(t)}))},e.prototype.updatePayload=function(e,t){"remain"!==t&&(e.context.payload=t)},e.prototype._createSeriesStageTask=function(e,t,n,r){var a=this,i=t.seriesTaskMap,o=t.seriesTaskMap=wP(),s=e.seriesType,u=e.getTargetSeries;function l(t){var s=t.uid,u=o.set(s,i&&i.get(s)||DX({plan:l2,reset:c2,count:f2}));u.context={model:t,ecModel:n,api:r,useClearVisual:e.isVisual&&!e.isLayout,plan:e.plan,reset:e.reset,scheduler:a},a._pipe(t,u)}e.createOnAllSeries?n.eachRawSeries(l):s?n.eachRawSeriesByType(s,l):u&&u(n,r).each(l)},e.prototype._createOverallStageTask=function(e,t,n,r){var a=this,i=t.overallTask=t.overallTask||DX({reset:i2});i.context={ecModel:n,api:r,overallReset:e.overallReset,scheduler:a};var o=i.agentStubMap,s=i.agentStubMap=wP(),u=e.seriesType,l=e.getTargetSeries,c=!0,h=!1;function p(e){var t=e.uid,n=s.set(t,o&&o.get(t)||(h=!0,DX({reset:o2,onDirty:u2})));n.context={model:e,overallProgress:c},n.agent=i,n.__block=c,a._pipe(e,n)}mP(!e.createOnAllSeries,""),u?n.eachRawSeriesByType(u,p):l?l(n,r).each(p):(c=!1,XL(n.getSeries(),p)),h&&i.dirty()},e.prototype._pipe=function(e,t){var n=e.uid,r=this._pipelineMap.get(n);!r.head&&(r.head=t),r.tail&&r.tail.pipe(t),r.tail=t,t.__idxInPipeline=r.count++,t.__pipeline=r},e.wrapStageHandler=function(e,t){return tP(e)&&(e={overallReset:e,seriesType:d2(e)}),e.uid=gq("stageHandler"),t&&(e.visualType=t),e},e}();function i2(e){e.overallReset(e.ecModel,e.api,e.payload)}function o2(e){return e.overallProgress&&s2}function s2(){this.agent.dirty(),this.getDownstream().dirty()}function u2(){this.agent&&this.agent.dirty()}function l2(e){return e.plan?e.plan(e.model,e.ecModel,e.api,e.payload):null}function c2(e){e.useClearVisual&&e.data.clearAllVisual();var t=e.resetDefines=UU(e.reset(e.model,e.ecModel,e.api,e.payload));return t.length>1?KL(t,(function(e,t){return p2(t)})):h2}var h2=p2(0);function p2(e){return function(t,n){var r=n.data,a=n.resetDefines[e];if(a&&a.dataEach)for(var i=t.start;i<t.end;i++)a.dataEach(r,i);else a&&a.progress&&a.progress(t,r)}}function f2(e){return e.data.count()}function d2(e){v2=null;try{e(m2,g2)}catch(tY){}return v2}var v2,m2={},g2={};function y2(e,t){for(var n in t.prototype)e[n]=CP}y2(m2,x1),y2(g2,w1),m2.eachSeriesByType=m2.eachRawSeriesByType=function(e){v2=e},m2.eachComponent=function(e){"series"===e.mainType&&e.subType&&(v2=e.subType)};var b2=a2,x2=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"],k2={color:x2,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],x2]},w2="#B9B8CE",_2="#100C2A",S2=function(){return{axisLine:{lineStyle:{color:w2}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}}},I2=["#4992ff","#7cffb2","#fddd60","#ff6e76","#58d9f9","#05c091","#ff8a45","#8d48e3","#dd79ff"],C2={darkMode:!0,color:I2,backgroundColor:_2,axisPointer:{lineStyle:{color:"#817f91"},crossStyle:{color:"#817f91"},label:{color:"#fff"}},legend:{textStyle:{color:w2}},textStyle:{color:w2},title:{textStyle:{color:"#EEF1FA"},subtextStyle:{color:"#B9B8CE"}},toolbox:{iconStyle:{borderColor:w2}},dataZoom:{borderColor:"#71708A",textStyle:{color:w2},brushStyle:{color:"rgba(135,163,206,0.3)"},handleStyle:{color:"#353450",borderColor:"#C5CBE3"},moveHandleStyle:{color:"#B0B6C3",opacity:.3},fillerColor:"rgba(135,163,206,0.2)",emphasis:{handleStyle:{borderColor:"#91B7F2",color:"#4D587D"},moveHandleStyle:{color:"#636D9A",opacity:.7}},dataBackground:{lineStyle:{color:"#71708A",width:1},areaStyle:{color:"#71708A"}},selectedDataBackground:{lineStyle:{color:"#87A3CE"},areaStyle:{color:"#87A3CE"}}},visualMap:{textStyle:{color:w2}},timeline:{lineStyle:{color:w2},label:{color:w2},controlStyle:{color:w2,borderColor:w2}},calendar:{itemStyle:{color:_2},dayLabel:{color:w2},monthLabel:{color:w2},yearLabel:{color:w2}},timeAxis:S2(),logAxis:S2(),valueAxis:S2(),categoryAxis:S2(),line:{symbol:"circle"},graph:{color:I2},gauge:{title:{color:w2},axisLine:{lineStyle:{color:[[1,"rgba(207,212,219,0.2)"]]}},axisLabel:{color:w2},detail:{color:"#EEF1FA"}},candlestick:{itemStyle:{color:"#f64e56",color0:"#54ea92",borderColor:"#f64e56",borderColor0:"#54ea92"}}};C2.categoryAxis.splitLine.show=!1;var T2=C2,N2=function(){function e(){}return e.prototype.normalizeQuery=function(e){var t={},n={},r={};if(nP(e)){var a=RP(e);t.mainType=a.main||null,t.subType=a.sub||null}else{var i=["Index","Name","Id"],o={name:1,dataIndex:1,dataType:1};XL(e,(function(e,a){for(var s=!1,u=0;u<i.length;u++){var l=i[u],c=a.lastIndexOf(l);if(c>0&&c===a.length-l.length){var h=a.slice(0,c);"data"!==h&&(t.mainType=h,t[l.toLowerCase()]=e,s=!0)}}o.hasOwnProperty(a)&&(n[a]=e,s=!0),s||(r[a]=e)}))}return{cptQuery:t,dataQuery:n,otherQuery:r}},e.prototype.filter=function(e,t){var n=this.eventInfo;if(!n)return!0;var r=n.targetEl,a=n.packedEvent,i=n.model,o=n.view;if(!i||!o)return!0;var s=t.cptQuery,u=t.dataQuery;return l(s,i,"mainType")&&l(s,i,"subType")&&l(s,i,"index","componentIndex")&&l(s,i,"name")&&l(s,i,"id")&&l(u,a,"name")&&l(u,a,"dataIndex")&&l(u,a,"dataType")&&(!o.filterForExposedEvent||o.filterForExposedEvent(e,t.otherQuery,r,a));function l(e,t,n,r){return null==e[n]||t[r||n]===e[n]}},e.prototype.afterTrigger=function(){this.eventInfo=null},e}(),E2=["symbol","symbolSize","symbolRotate","symbolOffset"],M2=E2.concat(["symbolKeepAspect"]),A2={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){var n=e.getData();if(e.legendIcon&&n.setVisual("legendIcon",e.legendIcon),e.hasSymbolVisual){for(var r={},a={},i=!1,o=0;o<E2.length;o++){var s=E2[o],u=e.get(s);tP(u)?(i=!0,a[s]=u):r[s]=u}if(r.symbol=r.symbol||e.defaultSymbol,n.setVisual(UL({legendIcon:e.legendIcon||r.symbol,symbolKeepAspect:e.get("symbolKeepAspect")},r)),!t.isSeriesFiltered(e)){var l=QL(a);return{dataEach:i?function(t,n){for(var r=e.getRawValue(n),i=e.getDataParams(n),o=0;o<l.length;o++){var s=l[o];t.setItemVisual(n,s,a[s](r,i))}}:null}}}}},D2={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){if(e.hasSymbolVisual&&!t.isSeriesFiltered(e))return{dataEach:e.getData().hasItemOption?function(e,t){for(var n=e.getItemModel(t),r=0;r<M2.length;r++){var a=M2[r],i=n.getShallow(a,!0);null!=i&&e.setItemVisual(t,a,i)}}:null}}};function R2(e,t,n){switch(n){case"color":return e.getItemVisual(t,"style")[e.getVisual("drawType")];case"opacity":return e.getItemVisual(t,"style").opacity;case"symbol":case"symbolSize":case"liftZ":return e.getItemVisual(t,n)}}function O2(e,t){switch(t){case"color":return e.getVisual("style")[e.getVisual("drawType")];case"opacity":return e.getVisual("style").opacity;case"symbol":case"symbolSize":case"liftZ":return e.getVisual(t)}}function F2(e,t,n,r,a){var i=e+t;n.isSilent(i)||r.eachComponent({mainType:"series",subType:"pie"},(function(e){for(var t=e.seriesIndex,r=e.option.selectedMap,o=a.selected,s=0;s<o.length;s++)if(o[s].seriesIndex===t){var u=e.getData(),l=JU(u,a.fromActionPayload);n.trigger(i,{type:i,seriesId:e.id,name:eP(l)?u.getName(l[0]):u.getName(l),selected:nP(r)?r:UL({},r)})}}))}function L2(e,t,n){for(var r;e&&(!t(e)||(r=e,!n));)e=e.__hostTarget||e.parent;return r}var P2=Math.round(9*Math.random()),z2="function"===typeof Object.defineProperty,B2=function(){function e(){this._id="__ec_inner_"+P2++}return e.prototype.get=function(e){return this._guard(e)[this._id]},e.prototype.set=function(e,t){var n=this._guard(e);return z2?Object.defineProperty(n,this._id,{value:t,enumerable:!1,configurable:!0}):n[this._id]=t,this},e.prototype.delete=function(e){return!!this.has(e)&&(delete this._guard(e)[this._id],!0)},e.prototype.has=function(e){return!!this._guard(e)[this._id]},e.prototype._guard=function(e){if(e!==Object(e))throw TypeError("Value of WeakMap is not a non-null object.");return e},e}();function V2(e,t,n){for(var r="radial"===t.type?function(e,t,n){var r=n.width,a=n.height,i=Math.min(r,a),o=null==t.x?.5:t.x,s=null==t.y?.5:t.y,u=null==t.r?.5:t.r;return t.global||(o=o*r+n.x,s=s*a+n.y,u*=i),e.createRadialGradient(o,s,0,o,s,u)}(e,t,n):function(e,t,n){var r=null==t.x?0:t.x,a=null==t.x2?1:t.x2,i=null==t.y?0:t.y,o=null==t.y2?0:t.y2;return t.global||(r=r*n.width+n.x,a=a*n.width+n.x,i=i*n.height+n.y,o=o*n.height+n.y),r=isNaN(r)?0:r,a=isNaN(a)?1:a,i=isNaN(i)?0:i,o=isNaN(o)?0:o,e.createLinearGradient(r,i,a,o)}(e,t,n),a=t.colorStops,i=0;i<a.length;i++)r.addColorStop(a[i].offset,a[i].color);return r}function W2(e){return parseInt(e,10)}function U2(e,t,n){var r=["width","height"][t],a=["clientWidth","clientHeight"][t],i=["paddingLeft","paddingTop"][t],o=["paddingRight","paddingBottom"][t];if(null!=n[r]&&"auto"!==n[r])return parseFloat(n[r]);var s=document.defaultView.getComputedStyle(e);return(e[a]||W2(s[r])||W2(e.style[r]))-(W2(s[i])||0)-(W2(s[o])||0)|0}function H2(e){var t,n,r=e.style,a=r.lineDash&&r.lineWidth>0&&(t=r.lineDash,n=r.lineWidth,t&&"solid"!==t&&n>0?"dashed"===t?[4*n,2*n]:"dotted"===t?[n]:aP(t)?[t]:eP(t)?t:null:null),i=r.lineDashOffset;if(a){var o=r.strokeNoScale&&e.getLineScale?e.getLineScale():1;o&&1!==o&&(a=KL(a,(function(e){return e/o})),i/=o)}return[a,i]}var G2=new wW(!0);function j2(e){var t=e.stroke;return!(null==t||"none"===t||!(e.lineWidth>0))}function q2(e){return"string"===typeof e&&"none"!==e}function X2(e){var t=e.fill;return null!=t&&"none"!==t}function K2(e,t){if(null!=t.fillOpacity&&1!==t.fillOpacity){var n=e.globalAlpha;e.globalAlpha=t.fillOpacity*t.opacity,e.fill(),e.globalAlpha=n}else e.fill()}function Y2(e,t){if(null!=t.strokeOpacity&&1!==t.strokeOpacity){var n=e.globalAlpha;e.globalAlpha=t.strokeOpacity*t.opacity,e.stroke(),e.globalAlpha=n}else e.stroke()}function Z2(e,t,n){var r=QP(t.image,t.__image,n);if(JP(r)){var a=e.createPattern(r,t.repeat||"repeat");if("function"===typeof DOMMatrix&&a&&a.setTransform){var i=new DOMMatrix;i.translateSelf(t.x||0,t.y||0),i.rotateSelf(0,0,(t.rotation||0)*TP),i.scaleSelf(t.scaleX||1,t.scaleY||1),a.setTransform(i)}return a}}var Q2=["shadowBlur","shadowOffsetX","shadowOffsetY"],$2=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function J2(e,t,n,r,a){var i=!1;if(!r&&t===(n=n||{}))return!1;if(r||t.opacity!==n.opacity){n3(e,a),i=!0;var o=Math.max(Math.min(t.opacity,1),0);e.globalAlpha=isNaN(o)?FV.opacity:o}(r||t.blend!==n.blend)&&(i||(n3(e,a),i=!0),e.globalCompositeOperation=t.blend||FV.blend);for(var s=0;s<Q2.length;s++){var u=Q2[s];(r||t[u]!==n[u])&&(i||(n3(e,a),i=!0),e[u]=e.dpr*(t[u]||0))}return(r||t.shadowColor!==n.shadowColor)&&(i||(n3(e,a),i=!0),e.shadowColor=t.shadowColor||FV.shadowColor),i}function e3(e,t,n,r,a){var i=r3(t,a.inHover),o=r?null:n&&r3(n,a.inHover)||{};if(i===o)return!1;var s=J2(e,i,o,r,a);if((r||i.fill!==o.fill)&&(s||(n3(e,a),s=!0),q2(i.fill)&&(e.fillStyle=i.fill)),(r||i.stroke!==o.stroke)&&(s||(n3(e,a),s=!0),q2(i.stroke)&&(e.strokeStyle=i.stroke)),(r||i.opacity!==o.opacity)&&(s||(n3(e,a),s=!0),e.globalAlpha=null==i.opacity?1:i.opacity),t.hasStroke()){var u=i.lineWidth/(i.strokeNoScale&&t.getLineScale?t.getLineScale():1);e.lineWidth!==u&&(s||(n3(e,a),s=!0),e.lineWidth=u)}for(var l=0;l<$2.length;l++){var c=$2[l],h=c[0];(r||i[h]!==o[h])&&(s||(n3(e,a),s=!0),e[h]=i[h]||c[1])}return s}function t3(e,t){var n=t.transform,r=e.dpr||1;n?e.setTransform(r*n[0],r*n[1],r*n[2],r*n[3],r*n[4],r*n[5]):e.setTransform(r,0,0,r,0,0)}function n3(e,t){t.batchFill&&e.fill(),t.batchStroke&&e.stroke(),t.batchFill="",t.batchStroke=""}function r3(e,t){return t&&e.__hoverStyle||e.style}function a3(e,t){i3(e,t,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function i3(e,t,n,r){var a=t.transform;if(!t.shouldBePainted(n.viewWidth,n.viewHeight,!1,!1))return t.__dirty&=-2,void(t.__isRendered=!1);var i=t.__clipPaths,o=n.prevElClipPaths,s=!1,u=!1;if(o&&!function(e,t){if(e===t||!e&&!t)return!1;if(!e||!t||e.length!==t.length)return!0;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!0;return!1}(i,o)||(o&&o.length&&(n3(e,n),e.restore(),u=s=!0,n.prevElClipPaths=null,n.allClipped=!1,n.prevEl=null),i&&i.length&&(n3(e,n),e.save(),function(e,t,n){for(var r=!1,a=0;a<e.length;a++){var i=e[a];r=r||i.isZeroArea(),t3(t,i),t.beginPath(),i.buildPath(t,i.shape),t.clip()}n.allClipped=r}(i,e,n),s=!0),n.prevElClipPaths=i),n.allClipped)t.__isRendered=!1;else{t.beforeBrush&&t.beforeBrush(),t.innerBeforeBrush();var l=n.prevEl;l||(u=s=!0);var c,h,p=t instanceof GW&&t.autoBatch&&function(e){var t=X2(e),n=j2(e);return!(e.lineDash||!(+t^+n)||t&&"string"!==typeof e.fill||n&&"string"!==typeof e.stroke||e.strokePercent<1||e.strokeOpacity<1||e.fillOpacity<1)}(t.style);s||(c=a,h=l.transform,c&&h?c[0]!==h[0]||c[1]!==h[1]||c[2]!==h[2]||c[3]!==h[3]||c[4]!==h[4]||c[5]!==h[5]:c||h)?(n3(e,n),t3(e,t)):p||n3(e,n);var f=r3(t,n.inHover);t instanceof GW?(1!==n.lastDrawType&&(u=!0,n.lastDrawType=1),e3(e,t,l,u,n),p&&(n.batchFill||n.batchStroke)||e.beginPath(),function(e,t,n,r){var a,i=j2(n),o=X2(n),s=n.strokePercent,u=s<1,l=!t.path;t.silent&&!u||!l||t.createPathProxy();var c=t.path||G2,h=t.__dirty;if(!r){var p=n.fill,f=n.stroke,d=o&&!!p.colorStops,v=i&&!!f.colorStops,m=o&&!!p.image,g=i&&!!f.image,y=void 0,b=void 0,x=void 0,k=void 0,w=void 0;(d||v)&&(w=t.getBoundingRect()),d&&(y=h?V2(e,p,w):t.__canvasFillGradient,t.__canvasFillGradient=y),v&&(b=h?V2(e,f,w):t.__canvasStrokeGradient,t.__canvasStrokeGradient=b),m&&(x=h||!t.__canvasFillPattern?Z2(e,p,t):t.__canvasFillPattern,t.__canvasFillPattern=x),g&&(k=h||!t.__canvasStrokePattern?Z2(e,f,t):t.__canvasStrokePattern,t.__canvasStrokePattern=x),d?e.fillStyle=y:m&&(x?e.fillStyle=x:o=!1),v?e.strokeStyle=b:g&&(k?e.strokeStyle=k:i=!1)}var _,S,I=t.getGlobalScale();c.setScale(I[0],I[1],t.segmentIgnoreThreshold),e.setLineDash&&n.lineDash&&(_=(a=H2(t))[0],S=a[1]);var C=!0;(l||4&h)&&(c.setDPR(e.dpr),u?c.setContext(null):(c.setContext(e),C=!1),c.reset(),t.buildPath(c,t.shape,r),c.toStatic(),t.pathUpdated()),C&&c.rebuildPath(e,u?s:1),_&&(e.setLineDash(_),e.lineDashOffset=S),r||(n.strokeFirst?(i&&Y2(e,n),o&&K2(e,n)):(o&&K2(e,n),i&&Y2(e,n))),_&&e.setLineDash([])}(e,t,f,p),p&&(n.batchFill=f.fill||"",n.batchStroke=f.stroke||"")):t instanceof XW?(3!==n.lastDrawType&&(u=!0,n.lastDrawType=3),e3(e,t,l,u,n),function(e,t,n){var r,a=n.text;if(null!=a&&(a+=""),a){e.font=n.font||_L,e.textAlign=n.textAlign,e.textBaseline=n.textBaseline;var i=void 0,o=void 0;e.setLineDash&&n.lineDash&&(i=(r=H2(t))[0],o=r[1]),i&&(e.setLineDash(i),e.lineDashOffset=o),n.strokeFirst?(j2(n)&&e.strokeText(a,n.x,n.y),X2(n)&&e.fillText(a,n.x,n.y)):(X2(n)&&e.fillText(a,n.x,n.y),j2(n)&&e.strokeText(a,n.x,n.y)),i&&e.setLineDash([])}}(e,t,f)):t instanceof QW?(2!==n.lastDrawType&&(u=!0,n.lastDrawType=2),function(e,t,n,r,a){J2(e,r3(t,a.inHover),n&&r3(n,a.inHover),r,a)}(e,t,l,u,n),function(e,t,n){var r=t.__image=QP(n.image,t.__image,t,t.onload);if(r&&JP(r)){var a=n.x||0,i=n.y||0,o=t.getWidth(),s=t.getHeight(),u=r.width/r.height;if(null==o&&null!=s?o=s*u:null==s&&null!=o?s=o/u:null==o&&null==s&&(o=r.width,s=r.height),n.sWidth&&n.sHeight){var l=n.sx||0,c=n.sy||0;e.drawImage(r,l,c,n.sWidth,n.sHeight,a,i,o,s)}else if(n.sx&&n.sy){var h=o-(l=n.sx),p=s-(c=n.sy);e.drawImage(r,l,c,h,p,a,i,o,s)}else e.drawImage(r,a,i,o,s)}}(e,t,f)):t.getTemporalDisplayables&&(4!==n.lastDrawType&&(u=!0,n.lastDrawType=4),function(e,t,n){var r=t.getDisplayables(),a=t.getTemporalDisplayables();e.save();var i,o,s={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:n.viewWidth,viewHeight:n.viewHeight,inHover:n.inHover};for(i=t.getCursor(),o=r.length;i<o;i++){(c=r[i]).beforeBrush&&c.beforeBrush(),c.innerBeforeBrush(),i3(e,c,s,i===o-1),c.innerAfterBrush(),c.afterBrush&&c.afterBrush(),s.prevEl=c}for(var u=0,l=a.length;u<l;u++){var c;(c=a[u]).beforeBrush&&c.beforeBrush(),c.innerBeforeBrush(),i3(e,c,s,u===l-1),c.innerAfterBrush(),c.afterBrush&&c.afterBrush(),s.prevEl=c}t.clearTemporalDisplayables(),t.notClear=!0,e.restore()}(e,t,n)),p&&r&&n3(e,n),t.innerAfterBrush(),t.afterBrush&&t.afterBrush(),n.prevEl=t,t.__dirty=0,t.__isRendered=!0}}var o3=new B2,s3=new KP(100),u3=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function l3(e,t){if("none"===e)return null;var n=t.getDevicePixelRatio(),r=t.getZr(),a="svg"===r.painter.type;e.dirty&&o3.delete(e);var i=o3.get(e);if(i)return i;var o=HL(e,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});"none"===o.backgroundColor&&(o.backgroundColor=null);var s={repeat:"repeat"};return function(e){for(var t,i=[n],s=!0,u=0;u<u3.length;++u){var l=o[u3[u]];if(null!=l&&!eP(l)&&!nP(l)&&!aP(l)&&"boolean"!==typeof l){s=!1;break}i.push(l)}if(s){t=i.join(",")+(a?"-svg":"");var c=s3.get(t);c&&(a?e.svgElement=c:e.image=c)}var h,p=h3(o.dashArrayX),f=function(e){if(!e||"object"===typeof e&&0===e.length)return[0,0];if(aP(e)){var t=Math.ceil(e);return[t,t]}var n=KL(e,(function(e){return Math.ceil(e)}));return e.length%2?n.concat(n):n}(o.dashArrayY),d=c3(o.symbol),v=(x=p,KL(x,(function(e){return p3(e)}))),m=p3(f),g=!a&&IL.createCanvas(),y=a&&{tag:"g",attrs:{},key:"dcl",children:[]},b=function(){for(var e=1,t=0,n=v.length;t<n;++t)e=zU(e,v[t]);var r=1;for(t=0,n=d.length;t<n;++t)r=zU(r,d[t].length);e*=r;var a=m*v.length*d.length;0;return{width:Math.max(1,Math.min(e,o.maxTileWidth)),height:Math.max(1,Math.min(a,o.maxTileHeight))}}();var x;g&&(g.width=b.width*n,g.height=b.height*n,h=g.getContext("2d"));(function(){h&&(h.clearRect(0,0,g.width,g.height),o.backgroundColor&&(h.fillStyle=o.backgroundColor,h.fillRect(0,0,g.width,g.height)));for(var e=0,t=0;t<f.length;++t)e+=f[t];if(e<=0)return;var i=-m,s=0,u=0,l=0;for(;i<b.height;){if(s%2===0){for(var c=u/2%d.length,v=0,x=0,k=0;v<2*b.width;){var w=0;for(t=0;t<p[l].length;++t)w+=p[l][t];if(w<=0)break;if(x%2===0){var _=.5*(1-o.symbolSize),S=v+p[l][x]*_,I=i+f[s]*_,C=p[l][x]*o.symbolSize,T=f[s]*o.symbolSize,N=k/2%d[c].length;E(S,I,C,T,d[c][N])}v+=p[l][x],++k,++x===p[l].length&&(x=0)}++l===p.length&&(l=0)}i+=f[s],++u,++s===f.length&&(s=0)}function E(e,t,i,s,u){var l=a?1:n,c=LZ(u,e*l,t*l,i*l,s*l,o.color,o.symbolKeepAspect);if(a){var p=r.painter.renderOneToVNode(c);p&&y.children.push(p)}else a3(h,c)}})(),s&&s3.put(t,g||y);e.image=g,e.svgElement=y,e.svgWidth=b.width,e.svgHeight=b.height}(s),s.rotation=o.rotation,s.scaleX=s.scaleY=a?1:1/n,o3.set(e,s),e.dirty=!1,s}function c3(e){if(!e||0===e.length)return[["rect"]];if(nP(e))return[[e]];for(var t=!0,n=0;n<e.length;++n)if(!nP(e[n])){t=!1;break}if(t)return c3([e]);var r=[];for(n=0;n<e.length;++n)nP(e[n])?r.push([e[n]]):r.push(e[n]);return r}function h3(e){if(!e||0===e.length)return[[0,0]];if(aP(e))return[[a=Math.ceil(e),a]];for(var t=!0,n=0;n<e.length;++n)if(!aP(e[n])){t=!1;break}if(t)return h3([e]);var r=[];for(n=0;n<e.length;++n)if(aP(e[n])){var a=Math.ceil(e[n]);r.push([a,a])}else{(a=KL(e[n],(function(e){return Math.ceil(e)}))).length%2===1?r.push(a.concat(a)):r.push(a)}return r}function p3(e){for(var t=0,n=0;n<e.length;++n)t+=e[n];return e.length%2===1?2*t:t}var f3=new yV,d3={};var v3="undefined"!==typeof window,m3=2e3,g3=4500,y3={PROCESSOR:{FILTER:1e3,SERIES_FILTER:800,STATISTIC:5e3},VISUAL:{LAYOUT:1e3,PROGRESSIVE_LAYOUT:1100,GLOBAL:m3,CHART:3e3,POST_CHART_LAYOUT:4600,COMPONENT:4e3,BRUSH:5e3,CHART_ITEM:g3,ARIA:6e3,DECAL:7e3}},b3=/^[a-zA-Z0-9_]+$/,x3="__connectUpdateStatus";function k3(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(!this.isDisposed())return _3(this,e,t);X3(this.id)}}function w3(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return _3(this,e,t)}}function _3(e,t,n){return n[0]=n[0]&&n[0].toLowerCase(),yV.prototype[t].apply(e,n)}var S3,I3,C3,T3,N3,E3,M3,A3,D3,R3,O3,F3,L3,P3,z3,B3,V3,W3,U3=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return wL(t,e),t}(yV),H3=U3.prototype;H3.on=w3("on"),H3.off=w3("off");var G3=function(e){function t(t,n,r){var a=e.call(this,new N2)||this;a._chartsViews=[],a._chartsMap={},a._componentsViews=[],a._componentsMap={},a._pendingActions=[],r=r||{},nP(n)&&(n=J3[n]),a._dom=t;var i=a._zr=u1(t,{renderer:r.renderer||"canvas",devicePixelRatio:r.devicePixelRatio,width:r.width,height:r.height,ssr:r.ssr,useDirtyRect:null!=r.useDirtyRect&&r.useDirtyRect});a._ssr=r.ssr,a._throttledZrFlush=c$($L(i.flush,i),17),(n=VL(n))&&q1(n,!0),a._theme=n,a._locale=function(e){if(nP(e)){var t=wq[e.toUpperCase()]||{};return e===bq||e===xq?VL(t):WL(VL(t),VL(wq.EN),!1)}return WL(VL(e),VL(wq.EN),!1)}(r.locale||Sq),a._coordSysMgr=new lq;var o=a._api=z3(a);function s(e,t){return e.__prio-t.__prio}return A0($3,s),A0(Z3,s),a._scheduler=new b2(a,o,Z3,$3),a._messageCenter=new U3,a._initEvents(),a.resize=$L(a.resize,a),i.animation.on("frame",a._onframe,a),R3(i,a),O3(i,a),bP(a),a}return wL(t,e),t.prototype._onframe=function(){if(!this._disposed){W3(this);var e=this._scheduler;if(this.__pendingUpdate){var t=this.__pendingUpdate.silent;this.__flagInMainProcess=!0;try{S3(this),T3.update.call(this,null,this.__pendingUpdate.updateParams)}catch(tY){throw this.__flagInMainProcess=!1,this.__pendingUpdate=null,tY}this._zr.flush(),this.__flagInMainProcess=!1,this.__pendingUpdate=null,A3.call(this,t),D3.call(this,t)}else if(e.unfinished){var n=1,r=this._model,a=this._api;e.unfinished=!1;do{var i=+new Date;e.performSeriesTasks(r),e.performDataProcessorTasks(r),E3(this,r),e.performVisualTasks(r),P3(this,this._model,a,"remain",{}),n-=+new Date-i}while(n>0&&e.unfinished);e.unfinished||this._zr.flush()}}},t.prototype.getDom=function(){return this._dom},t.prototype.getId=function(){return this.id},t.prototype.getZr=function(){return this._zr},t.prototype.isSSR=function(){return this._ssr},t.prototype.setOption=function(e,t,n){if(!this.__flagInMainProcess)if(this._disposed)X3(this.id);else{var r,a,i;if(iP(t)&&(n=t.lazyUpdate,r=t.silent,a=t.replaceMerge,i=t.transition,t=t.notMerge),this.__flagInMainProcess=!0,!this._model||t){var o=new C1(this._api),s=this._theme,u=this._model=new x1;u.scheduler=this._scheduler,u.ssr=this._ssr,u.init(null,null,null,s,this._locale,o)}this._model.setOption(e,{replaceMerge:a},Q3);var l={seriesTransition:i,optionChanged:!0};if(n)this.__pendingUpdate={silent:r,updateParams:l},this.__flagInMainProcess=!1,this.getZr().wakeUp();else{try{S3(this),T3.update.call(this,null,l)}catch(tY){throw this.__pendingUpdate=null,this.__flagInMainProcess=!1,tY}this._ssr||this._zr.flush(),this.__pendingUpdate=null,this.__flagInMainProcess=!1,A3.call(this,r),D3.call(this,r)}}},t.prototype.setTheme=function(){wj()},t.prototype.getModel=function(){return this._model},t.prototype.getOption=function(){return this._model&&this._model.getOption()},t.prototype.getWidth=function(){return this._zr.getWidth()},t.prototype.getHeight=function(){return this._zr.getHeight()},t.prototype.getDevicePixelRatio=function(){return this._zr.painter.dpr||v3&&window.devicePixelRatio||1},t.prototype.getRenderedCanvas=function(e){return this.renderToCanvas(e)},t.prototype.renderToCanvas=function(e){return e=e||{},this._zr.painter.getRenderedCanvas({backgroundColor:e.backgroundColor||this._model.get("backgroundColor"),pixelRatio:e.pixelRatio||this.getDevicePixelRatio()})},t.prototype.renderToSVGString=function(e){return e=e||{},this._zr.painter.renderToString({useViewBox:e.useViewBox})},t.prototype.getSvgDataURL=function(){if(MP.svgSupported){var e=this._zr;return XL(e.storage.getDisplayList(),(function(e){e.stopAnimation(null,!0)})),e.painter.toDataURL()}},t.prototype.getDataURL=function(e){if(!this._disposed){var t=(e=e||{}).excludeComponents,n=this._model,r=[],a=this;XL(t,(function(e){n.eachComponent({mainType:e},(function(e){var t=a._componentsMap[e.__viewId];t.group.ignore||(r.push(t),t.group.ignore=!0)}))}));var i="svg"===this._zr.painter.getType()?this.getSvgDataURL():this.renderToCanvas(e).toDataURL("image/"+(e&&e.type||"png"));return XL(r,(function(e){e.group.ignore=!1})),i}X3(this.id)},t.prototype.getConnectedDataURL=function(e){if(!this._disposed){var t="svg"===e.type,n=this.group,r=Math.min,a=Math.max,i=1/0;if(n4[n]){var o=i,s=i,u=-1/0,l=-1/0,c=[],h=e&&e.pixelRatio||this.getDevicePixelRatio();XL(t4,(function(i,h){if(i.group===n){var p=t?i.getZr().painter.getSvgDom().innerHTML:i.renderToCanvas(VL(e)),f=i.getDom().getBoundingClientRect();o=r(f.left,o),s=r(f.top,s),u=a(f.right,u),l=a(f.bottom,l),c.push({dom:p,left:f.left,top:f.top})}}));var p=(u*=h)-(o*=h),f=(l*=h)-(s*=h),d=IL.createCanvas(),v=u1(d,{renderer:t?"svg":"canvas"});if(v.resize({width:p,height:f}),t){var m="";return XL(c,(function(e){var t=e.left-o,n=e.top-s;m+='<g transform="translate('+t+","+n+')">'+e.dom+"</g>"})),v.painter.getSvgRoot().innerHTML=m,e.connectedBackgroundColor&&v.painter.setBackgroundColor(e.connectedBackgroundColor),v.refreshImmediately(),v.painter.toDataURL()}return e.connectedBackgroundColor&&v.add(new iU({shape:{x:0,y:0,width:p,height:f},style:{fill:e.connectedBackgroundColor}})),XL(c,(function(e){var t=new QW({style:{x:e.left*h-o,y:e.top*h-s,image:e.dom}});v.add(t)})),v.refreshImmediately(),d.toDataURL("image/"+(e&&e.type||"png"))}return this.getDataURL(e)}X3(this.id)},t.prototype.convertToPixel=function(e,t){return N3(this,"convertToPixel",e,t)},t.prototype.convertFromPixel=function(e,t){return N3(this,"convertFromPixel",e,t)},t.prototype.containPixel=function(e,t){var n;if(!this._disposed)return XL(nH(this._model,e),(function(e,r){r.indexOf("Models")>=0&&XL(e,(function(e){var a=e.coordinateSystem;if(a&&a.containPoint)n=n||!!a.containPoint(t);else if("seriesModels"===r){var i=this._chartsMap[e.__viewId];i&&i.containPoint&&(n=n||i.containPoint(t,e))}else 0}),this)}),this),!!n;X3(this.id)},t.prototype.getVisual=function(e,t){var n=nH(this._model,e,{defaultMainType:"series"});var r=n.seriesModel.getData(),a=n.hasOwnProperty("dataIndexInside")?n.dataIndexInside:n.hasOwnProperty("dataIndex")?r.indexOfRawIndex(n.dataIndex):null;return null!=a?R2(r,a,t):O2(r,t)},t.prototype.getViewOfComponentModel=function(e){return this._componentsMap[e.__viewId]},t.prototype.getViewOfSeriesModel=function(e){return this._chartsMap[e.__viewId]},t.prototype._initEvents=function(){var e,t,n,r=this;XL(q3,(function(e){var t=function(t){var n,a=r.getModel(),i=t.target;if("globalout"===e?n={}:i&&L2(i,(function(e){var t=sH(e);if(t&&null!=t.dataIndex){var r=t.dataModel||a.getSeriesByIndex(t.seriesIndex);return n=r&&r.getDataParams(t.dataIndex,t.dataType)||{},!0}if(t.eventData)return n=UL({},t.eventData),!0}),!0),n){var o=n.componentType,s=n.componentIndex;"markLine"!==o&&"markPoint"!==o&&"markArea"!==o||(o="series",s=n.seriesIndex);var u=o&&null!=s&&a.getComponent(o,s),l=u&&r["series"===u.mainType?"_chartsMap":"_componentsMap"][u.__viewId];0,n.event=t,n.type=e,r._$eventProcessor.eventInfo={targetEl:i,packedEvent:n,model:u,view:l},r.trigger(e,n)}};t.zrEventfulCallAtLast=!0,r._zr.on(e,t,r)})),XL(Y3,(function(e,t){r._messageCenter.on(t,(function(e){this.trigger(t,e)}),r)})),XL(["selectchanged"],(function(e){r._messageCenter.on(e,(function(t){this.trigger(e,t)}),r)})),e=this._messageCenter,t=this,n=this._api,e.on("selectchanged",(function(e){var r=n.getModel();e.isFromClick?(F2("map","selectchanged",t,r,e),F2("pie","selectchanged",t,r,e)):"select"===e.fromAction?(F2("map","selected",t,r,e),F2("pie","selected",t,r,e)):"unselect"===e.fromAction&&(F2("map","unselected",t,r,e),F2("pie","unselected",t,r,e))}))},t.prototype.isDisposed=function(){return this._disposed},t.prototype.clear=function(){this._disposed?X3(this.id):this.setOption({series:[]},!0)},t.prototype.dispose=function(){if(this._disposed)X3(this.id);else{this._disposed=!0,this.getDom()&&oH(this.getDom(),a4,"");var e=this,t=e._api,n=e._model;XL(e._componentsViews,(function(e){e.dispose(n,t)})),XL(e._chartsViews,(function(e){e.dispose(n,t)})),e._zr.dispose(),e._dom=e._model=e._chartsMap=e._componentsMap=e._chartsViews=e._componentsViews=e._scheduler=e._api=e._zr=e._throttledZrFlush=e._theme=e._coordSysMgr=e._messageCenter=null,delete t4[e.id]}},t.prototype.resize=function(e){if(!this.__flagInMainProcess)if(this._disposed)X3(this.id);else{this._zr.resize(e);var t=this._model;if(this._loadingFX&&this._loadingFX.resize(),t){var n=t.resetOption("media"),r=e&&e.silent;this.__pendingUpdate&&(null==r&&(r=this.__pendingUpdate.silent),n=!0,this.__pendingUpdate=null),this.__flagInMainProcess=!0;try{n&&S3(this),T3.update.call(this,{type:"resize",animation:UL({duration:0},e&&e.animation)})}catch(tY){throw this.__flagInMainProcess=!1,tY}this.__flagInMainProcess=!1,A3.call(this,r),D3.call(this,r)}}},t.prototype.showLoading=function(e,t){if(this._disposed)X3(this.id);else if(iP(e)&&(t=e,e=""),e=e||"default",this.hideLoading(),e4[e]){var n=e4[e](this._api,t),r=this._zr;this._loadingFX=n,r.add(n)}},t.prototype.hideLoading=function(){this._disposed?X3(this.id):(this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null)},t.prototype.makeActionFromEvent=function(e){var t=UL({},e);return t.type=Y3[e.type],t},t.prototype.dispatchAction=function(e,t){if(this._disposed)X3(this.id);else if(iP(t)||(t={silent:!!t}),K3[e.type]&&this._model)if(this.__flagInMainProcess)this._pendingActions.push(e);else{var n=t.silent;M3.call(this,e,n);var r=t.flush;r?this._zr.flush():!1!==r&&MP.browser.weChat&&this._throttledZrFlush(),A3.call(this,n),D3.call(this,n)}},t.prototype.updateLabelLayout=function(){f3.trigger("series:layoutlabels",this._model,this._api,{updatedSeries:[]})},t.prototype.appendData=function(e){if(this._disposed)X3(this.id);else{var t=e.seriesIndex;0,this.getModel().getSeriesByIndex(t).appendData(e),this._scheduler.unfinished=!0,this.getZr().wakeUp()}},t.internalField=function(){function e(e){e.clearColorPalette(),e.eachSeries((function(e){e.clearColorPalette()}))}function t(e){for(var t=[],n=e.currentStates,r=0;r<n.length;r++){var a=n[r];"emphasis"!==a&&"blur"!==a&&"select"!==a&&t.push(a)}e.selected&&e.states.select&&t.push("select"),2===e.hoverState&&e.states.emphasis?t.push("emphasis"):1===e.hoverState&&e.states.blur&&t.push("blur"),e.useStates(t)}function n(e,t){if(!e.preventAutoZ){var n=e.get("z")||0,a=e.get("zlevel")||0;t.eachRendered((function(e){return r(e,n,a,-1/0),!0}))}}function r(e,t,n,a){var i=e.getTextContent(),o=e.getTextGuideLine();if(e.isGroup)for(var s=e.childrenRef(),u=0;u<s.length;u++)a=Math.max(r(s[u],t,n,a),a);else e.z=t,e.zlevel=n,a=Math.max(e.z2,a);if(i&&(i.z=t,i.zlevel=n,isFinite(a)&&(i.z2=a+2)),o){var l=e.textGuideLineConfig;o.z=t,o.zlevel=n,isFinite(a)&&(o.z2=a+(l&&l.showAbove?1:-1))}return a}function a(e,t){t.eachRendered((function(e){if(!KY(e)){var t=e.getTextContent(),n=e.getTextGuideLine();e.stateTransition&&(e.stateTransition=null),t&&t.stateTransition&&(t.stateTransition=null),n&&n.stateTransition&&(n.stateTransition=null),e.hasState()?(e.prevStates=e.currentStates,e.clearStates()):e.prevStates&&(e.prevStates=null)}}))}function i(e,n){var r=e.getModel("stateAnimation"),a=e.isAnimationEnabled(),i=r.get("duration"),o=i>0?{duration:i,delay:r.get("delay"),easing:r.get("easing")}:null;n.eachRendered((function(e){if(e.states&&e.states.emphasis){if(KY(e))return;if(e instanceof GW&&function(e){var t=cH(e);t.normalFill=e.style.fill,t.normalStroke=e.style.stroke;var n=e.states.select||{};t.selectFill=n.style&&n.style.fill||null,t.selectStroke=n.style&&n.style.stroke||null}(e),e.__dirty){var n=e.prevStates;n&&e.useStates(n)}if(a){e.stateTransition=o;var r=e.getTextContent(),i=e.getTextGuideLine();r&&(r.stateTransition=o),i&&(i.stateTransition=o)}e.__dirty&&t(e)}}))}S3=function(e){var t=e._scheduler;t.restorePipelines(e._model),t.prepareStageTasks(),I3(e,!0),I3(e,!1),t.plan()},I3=function(e,t){for(var n=e._model,r=e._scheduler,a=t?e._componentsViews:e._chartsViews,i=t?e._componentsMap:e._chartsMap,o=e._zr,s=e._api,u=0;u<a.length;u++)a[u].__alive=!1;function l(e){var u=e.__requireNewView;e.__requireNewView=!1;var l="_ec_"+e.id+"_"+e.type,c=!u&&i[l];if(!c){var h=RP(e.type);0,(c=new(t?OQ.getClass(h.main,h.sub):mQ.getClass(h.sub))).init(n,s),i[l]=c,a.push(c),o.add(c.group)}e.__viewId=c.__id=l,c.__alive=!0,c.__model=e,c.group.__ecComponentInfo={mainType:e.mainType,index:e.componentIndex},!t&&r.prepareView(c,e,n,s)}t?n.eachComponent((function(e,t){"series"!==e&&l(t)})):n.eachSeries(l);for(u=0;u<a.length;){var c=a[u];c.__alive?u++:(!t&&c.renderTask.dispose(),o.remove(c.group),c.dispose(n,s),a.splice(u,1),i[c.__id]===c&&delete i[c.__id],c.__id=c.group.__ecComponentInfo=null)}},C3=function(e,t,n,r,a){var i=e._model;if(i.setUpdatePayload(n),r){var o={};o[r+"Id"]=n[r+"Id"],o[r+"Index"]=n[r+"Index"],o[r+"Name"]=n[r+"Name"];var s={mainType:r,query:o};a&&(s.subType=a);var u,l=n.excludeSeriesId;null!=l&&(u=wP(),XL(UU(l),(function(e){var t=ZU(e,null);null!=t&&u.set(t,!0)}))),i&&i.eachComponent(s,(function(t){if(!(u&&null!==u.get(t.id)))if(nG(n))if(t instanceof gK)n.type!==dH||n.notBlur||t.get(["emphasis","disabled"])||function(e,t,n){var r=e.seriesIndex,a=e.getData(t.dataType);if(a){var i=JU(a,t);i=(eP(i)?i[0]:i)||0;var o=a.getItemGraphicEl(i);if(!o)for(var s=a.count(),u=0;!o&&u<s;)o=a.getItemGraphicEl(u++);if(o){var l=sH(o);HH(r,l.focus,l.blurScope,n)}else{var c=e.get(["emphasis","focus"]),h=e.get(["emphasis","blurScope"]);null!=c&&HH(r,c,h,n)}}}(t,n,e._api);else{var r=jH(t.mainType,t.componentIndex,n.name,e._api),a=r.focusSelf,i=r.dispatchers;n.type===dH&&a&&!n.notBlur&&GH(t.mainType,t.componentIndex,e._api),i&&XL(i,(function(e){n.type===dH?LH(e):PH(e)}))}else tG(n)&&t instanceof gK&&(!function(e,t,n){if(tG(t)){var r=t.dataType,a=JU(e.getData(r),t);eP(a)||(a=[a]),e[t.type===yH?"toggleSelect":t.type===mH?"select":"unselect"](a,r)}}(t,n,e._api),qH(t),V3(e))}),e),i&&i.eachComponent(s,(function(t){u&&null!==u.get(t.id)||c(e["series"===r?"_chartsMap":"_componentsMap"][t.__viewId])}),e)}else XL([].concat(e._componentsViews).concat(e._chartsViews),c);function c(r){r&&r.__alive&&r[t]&&r[t](r.__model,i,e._api,n)}},T3={prepareAndUpdate:function(e){S3(this),T3.update.call(this,e,{optionChanged:null!=e.newOption})},update:function(t,n){var r=this._model,a=this._api,i=this._zr,o=this._coordSysMgr,s=this._scheduler;if(r){r.setUpdatePayload(t),s.restoreData(r,t),s.performSeriesTasks(r),o.create(r,a),s.performDataProcessorTasks(r,t),E3(this,r),o.update(r,a),e(r),s.performVisualTasks(r,t),F3(this,r,a,t,n);var u=r.get("backgroundColor")||"transparent",l=r.get("darkMode");i.setBackgroundColor(u),null!=l&&"auto"!==l&&i.setDarkMode(l),f3.trigger("afterupdate",r,a)}},updateTransform:function(t){var n=this,r=this._model,a=this._api;if(r){r.setUpdatePayload(t);var i=[];r.eachComponent((function(e,o){if("series"!==e){var s=n.getViewOfComponentModel(o);if(s&&s.__alive)if(s.updateTransform){var u=s.updateTransform(o,r,a,t);u&&u.update&&i.push(s)}else i.push(s)}}));var o=wP();r.eachSeries((function(e){var i=n._chartsMap[e.__viewId];if(i.updateTransform){var s=i.updateTransform(e,r,a,t);s&&s.update&&o.set(e.uid,1)}else o.set(e.uid,1)})),e(r),this._scheduler.performVisualTasks(r,t,{setDirty:!0,dirtyMap:o}),P3(this,r,a,t,{},o),f3.trigger("afterupdate",r,a)}},updateView:function(t){var n=this._model;n&&(n.setUpdatePayload(t),mQ.markUpdateMethod(t,"updateView"),e(n),this._scheduler.performVisualTasks(n,t,{setDirty:!0}),F3(this,n,this._api,t,{}),f3.trigger("afterupdate",n,this._api))},updateVisual:function(t){var n=this,r=this._model;r&&(r.setUpdatePayload(t),r.eachSeries((function(e){e.getData().clearAllVisual()})),mQ.markUpdateMethod(t,"updateVisual"),e(r),this._scheduler.performVisualTasks(r,t,{visualType:"visual",setDirty:!0}),r.eachComponent((function(e,a){if("series"!==e){var i=n.getViewOfComponentModel(a);i&&i.__alive&&i.updateVisual(a,r,n._api,t)}})),r.eachSeries((function(e){n._chartsMap[e.__viewId].updateVisual(e,r,n._api,t)})),f3.trigger("afterupdate",r,this._api))},updateLayout:function(e){T3.update.call(this,e)}},N3=function(e,t,n,r){if(e._disposed)X3(e.id);else{for(var a,i=e._model,o=e._coordSysMgr.getCoordinateSystems(),s=nH(i,n),u=0;u<o.length;u++){var l=o[u];if(l[t]&&null!=(a=l[t](i,s,r)))return a}0}},E3=function(e,t){var n=e._chartsMap,r=e._scheduler;t.eachSeries((function(e){r.updateStreamModes(e,n[e.__viewId])}))},M3=function(e,t){var n=this,r=this.getModel(),a=e.type,i=e.escapeConnect,o=K3[a],s=o.actionInfo,u=(s.update||"update").split(":"),l=u.pop(),c=null!=u[0]&&RP(u[0]);this.__flagInMainProcess=!0;var h=[e],p=!1;e.batch&&(p=!0,h=KL(e.batch,(function(t){return(t=HL(UL({},t),e)).batch=null,t})));var f,d=[],v=tG(e),m=nG(e);if(m&&UH(this._api),XL(h,(function(t){if((f=(f=o.action(t,n._model,n._api))||UL({},t)).type=s.event||f.type,d.push(f),m){var r=rH(e),a=r.queryOptionMap,i=r.mainTypeSpecified?a.keys()[0]:"series";C3(n,l,t,i),V3(n)}else v?(C3(n,l,t,"series"),V3(n)):c&&C3(n,l,t,c.main,c.sub)})),"none"!==l&&!m&&!v&&!c)try{this.__pendingUpdate?(S3(this),T3.update.call(this,e),this.__pendingUpdate=null):T3[l].call(this,e)}catch(tY){throw this.__flagInMainProcess=!1,tY}if(f=p?{type:s.event||a,escapeConnect:i,batch:d}:d[0],this.__flagInMainProcess=!1,!t){var g=this._messageCenter;if(g.trigger(f.type,f),v){var y={type:"selectchanged",escapeConnect:i,selected:XH(r),isFromClick:e.isFromClick||!1,fromAction:e.type,fromActionPayload:e};g.trigger(y.type,y)}}},A3=function(e){for(var t=this._pendingActions;t.length;){var n=t.shift();M3.call(this,n,e)}},D3=function(e){!e&&this.trigger("updated")},R3=function(e,t){e.on("rendered",(function(n){t.trigger("rendered",n),!e.animation.isFinished()||t.__pendingUpdate||t._scheduler.unfinished||t._pendingActions.length||t.trigger("finished")}))},O3=function(e,t){e.on("mouseover",(function(e){var n=L2(e.target,eG);n&&(!function(e,t,n){var r=sH(e),a=jH(r.componentMainType,r.componentIndex,r.componentHighDownName,n),i=a.dispatchers,o=a.focusSelf;i?(o&&GH(r.componentMainType,r.componentIndex,n),XL(i,(function(e){return OH(e,t)}))):(HH(r.seriesIndex,r.focus,r.blurScope,n),"self"===r.focus&&GH(r.componentMainType,r.componentIndex,n),OH(e,t))}(n,e,t._api),V3(t))})).on("mouseout",(function(e){var n=L2(e.target,eG);n&&(!function(e,t,n){UH(n);var r=sH(e),a=jH(r.componentMainType,r.componentIndex,r.componentHighDownName,n).dispatchers;a?XL(a,(function(e){return FH(e,t)})):FH(e,t)}(n,e,t._api),V3(t))})).on("click",(function(e){var n=L2(e.target,(function(e){return null!=sH(e).dataIndex}),!0);if(n){var r=n.selected?"unselect":"select",a=sH(n);t._api.dispatchAction({type:r,dataType:a.dataType,dataIndexInside:a.dataIndex,seriesIndex:a.seriesIndex,isFromClick:!0})}}))},F3=function(e,t,n,r,a){!function(e){var t=[],n=[],r=!1;if(e.eachComponent((function(e,a){var i=a.get("zlevel")||0,o=a.get("z")||0,s=a.getZLevelKey();r=r||!!s,("series"===e?n:t).push({zlevel:i,z:o,idx:a.componentIndex,type:e,key:s})})),r){var a,i,o=t.concat(n);A0(o,(function(e,t){return e.zlevel===t.zlevel?e.z-t.z:e.zlevel-t.zlevel})),XL(o,(function(t){var n=e.getComponent(t.type,t.idx),r=t.zlevel,o=t.key;null!=a&&(r=Math.max(a,r)),o?(r===a&&o!==i&&r++,i=o):i&&(r===a&&r++,i=""),a=r,n.setZLevel(r)}))}}(t),L3(e,t,n,r,a),XL(e._chartsViews,(function(e){e.__alive=!1})),P3(e,t,n,r,a),XL(e._chartsViews,(function(e){e.__alive||e.remove(t,n)}))},L3=function(e,t,r,o,s,u){XL(u||e._componentsViews,(function(e){var s=e.__model;a(s,e),e.render(s,t,r,o),n(s,e),i(s,e)}))},P3=function(e,t,r,o,s,u){var l=e._scheduler;s=UL(s||{},{updatedSeries:t.getSeries()}),f3.trigger("series:beforeupdate",t,r,s);var c=!1;t.eachSeries((function(t){var n=e._chartsMap[t.__viewId];n.__alive=!0;var r=n.renderTask;l.updatePayload(r,o),a(t,n),u&&u.get(t.uid)&&r.dirty(),r.perform(l.getPerformArgs(r))&&(c=!0),n.group.silent=!!t.get("silent"),function(e,t){var n=e.get("blendMode")||null;t.eachRendered((function(e){e.isGroup||(e.style.blend=n)}))}(t,n),qH(t)})),l.unfinished=c||l.unfinished,f3.trigger("series:layoutlabels",t,r,s),f3.trigger("series:transition",t,r,s),t.eachSeries((function(t){var r=e._chartsMap[t.__viewId];n(t,r),i(t,r)})),function(e,t){var n=e._zr.storage,r=0;n.traverse((function(e){e.isGroup||r++})),r>t.get("hoverLayerThreshold")&&!MP.node&&!MP.worker&&t.eachSeries((function(t){if(!t.preventUsingHoverLayer){var n=e._chartsMap[t.__viewId];n.__alive&&n.eachRendered((function(e){e.states.emphasis&&(e.states.emphasis.hoverLayer=!0)}))}}))}(e,t),f3.trigger("series:afterupdate",t,r,s)},V3=function(e){e.__needsUpdateStatus=!0,e.getZr().wakeUp()},W3=function(e){e.__needsUpdateStatus&&(e.getZr().storage.traverse((function(e){KY(e)||t(e)})),e.__needsUpdateStatus=!1)},z3=function(e){return new(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return wL(n,t),n.prototype.getCoordinateSystems=function(){return e._coordSysMgr.getCoordinateSystems()},n.prototype.getComponentByElement=function(t){for(;t;){var n=t.__ecComponentInfo;if(null!=n)return e._model.getComponent(n.mainType,n.index);t=t.parent}},n.prototype.enterEmphasis=function(t,n){LH(t,n),V3(e)},n.prototype.leaveEmphasis=function(t,n){PH(t,n),V3(e)},n.prototype.enterBlur=function(t){!function(e){MH(e,IH)}(t),V3(e)},n.prototype.leaveBlur=function(t){zH(t),V3(e)},n.prototype.enterSelect=function(t){BH(t),V3(e)},n.prototype.leaveSelect=function(t){VH(t),V3(e)},n.prototype.getModel=function(){return e.getModel()},n.prototype.getViewOfComponentModel=function(t){return e.getViewOfComponentModel(t)},n.prototype.getViewOfSeriesModel=function(t){return e.getViewOfSeriesModel(t)},n}(w1))(e)},B3=function(e){function t(e,t){for(var n=0;n<e.length;n++){e[n][x3]=t}}XL(Y3,(function(n,r){e._messageCenter.on(r,(function(n){if(n4[e.group]&&0!==e[x3]){if(n&&n.escapeConnect)return;var r=e.makeActionFromEvent(n),a=[];XL(t4,(function(t){t!==e&&t.group===e.group&&a.push(t)})),t(a,0),XL(a,(function(e){1!==e[x3]&&e.dispatchAction(r)})),t(a,2)}}))}))}}(),t}(yV),j3=G3.prototype;j3.on=k3("on"),j3.off=k3("off"),j3.one=function(e,t,n){var r=this;wj(),this.on.call(this,e,(function n(){for(var a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];t&&t.apply&&t.apply(this,a),r.off(e,n)}),n)};var q3=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];function X3(e){0}var K3={},Y3={},Z3=[],Q3=[],$3=[],J3={},e4={},t4={},n4={},r4=+new Date-0,a4=(new Date,"_echarts_instance_");function i4(e){return t4[function(e,t){return e.getAttribute?e.getAttribute(t):e[t]}(e,a4)]}function o4(e,t){J3[e]=t}function s4(e){GL(Q3,e)<0&&Q3.push(e)}function u4(e,t){f4(Z3,e,t,2e3)}function l4(e,t){f3.on(e,t)}function c4(e,t,n){tP(t)&&(n=t,t="");var r=iP(e)?e.type:[e,e={event:t}][0];e.event=(e.event||r).toLowerCase(),t=e.event,Y3[t]||(mP(b3.test(r)&&b3.test(t)),K3[r]||(K3[r]={action:n,actionInfo:e}),Y3[t]=r)}function h4(e,t){f4($3,e,t,3e3,"visual")}var p4=[];function f4(e,t,n,r,a){if((tP(t)||iP(t))&&(n=t,t=r),!(GL(p4,n)>=0)){p4.push(n);var i=b2.wrapStageHandler(n,a);i.__prio=t,i.__raw=n,e.push(i)}}function d4(e,t){e4[e]=t}var v4=function(e){var t=(e=VL(e)).type;t||_j("");var n=t.split(":");2!==n.length&&_j("");var r=!1;"echarts"===n[0]&&(t=n[1],r=!0),e.__isBuiltIn=r,VX.set(t,e)};h4(m3,J1),h4(g3,t2),h4(g3,n2),h4(m3,A2),h4(g3,D2),h4(7e3,(function(e,t){e.eachRawSeries((function(n){if(!e.isSeriesFiltered(n)){var r=n.getData();r.hasItemVisual()&&r.each((function(e){var n=r.getItemVisual(e,"decal");n&&(r.ensureUniqueItemVisual(e,"style").decal=l3(n,t))}));var a=r.getVisual("decal");if(a)r.getVisual("style").decal=l3(a,t)}}))})),s4(q1),u4(900,(function(e){var t=wP();e.eachSeries((function(e){var n=e.get("stack");if(n){var r=t.get(n)||t.set(n,[]),a=e.getData(),i={stackResultDimension:a.getCalculationInfo("stackResultDimension"),stackedOverDimension:a.getCalculationInfo("stackedOverDimension"),stackedDimension:a.getCalculationInfo("stackedDimension"),stackedByDimension:a.getCalculationInfo("stackedByDimension"),isStackedByIndex:a.getCalculationInfo("isStackedByIndex"),data:a,seriesModel:e};if(!i.stackedDimension||!i.isStackedByIndex&&!i.stackedByDimension)return;r.length&&a.setCalculationInfo("stackedOnSeries",r[r.length-1].seriesModel),r.push(i)}})),t.each(X1)})),d4("default",(function(e,t){HL(t=t||{},{text:"loading",textColor:"#000",fontSize:12,fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",maskColor:"rgba(255, 255, 255, 0.8)",showSpinner:!0,color:"#5470c6",spinnerRadius:10,lineWidth:5,zlevel:0});var n=new zK,r=new iU({style:{fill:t.maskColor},zlevel:t.zlevel,z:1e4});n.add(r);var a,i=new xU({style:{text:t.text,fill:t.textColor,fontSize:t.fontSize,fontWeight:t.fontWeight,fontStyle:t.fontStyle,fontFamily:t.fontFamily},zlevel:t.zlevel,z:10001}),o=new iU({style:{fill:"none"},textContent:i,textConfig:{position:"right",distance:10},zlevel:t.zlevel,z:10001});return n.add(o),t.showSpinner&&((a=new NY({shape:{startAngle:-r2/2,endAngle:-r2/2+.1,r:t.spinnerRadius},style:{stroke:t.color,lineCap:"round",lineWidth:t.lineWidth},zlevel:t.zlevel,z:10001})).animateShape(!0).when(1e3,{endAngle:3*r2/2}).start("circularInOut"),a.animateShape(!0).when(1e3,{startAngle:3*r2/2}).delay(300).start("circularInOut"),n.add(a)),n.resize=function(){var n=i.getBoundingRect().width,s=t.showSpinner?t.spinnerRadius:0,u=(e.getWidth()-2*s-(t.showSpinner&&n?10:0)-n)/2-(t.showSpinner&&n?0:5+n/2)+(t.showSpinner?0:n/2)+(n?0:s),l=e.getHeight()/2;t.showSpinner&&a.setShape({cx:u,cy:l}),o.setShape({x:u-s,y:l-s,width:2*s,height:2*s}),r.setShape({x:0,y:0,width:e.getWidth(),height:e.getHeight()})},n.resize(),n})),c4({type:dH,event:dH,update:dH},CP),c4({type:vH,event:vH,update:vH},CP),c4({type:mH,event:mH,update:mH},CP),c4({type:gH,event:gH,update:gH},CP),c4({type:yH,event:yH,update:yH},CP),o4("light",k2),o4("dark",T2);var m4=[],g4={registerPreprocessor:s4,registerProcessor:u4,registerPostInit:function(e){l4("afterinit",e)},registerPostUpdate:function(e){l4("afterupdate",e)},registerUpdateLifecycle:l4,registerAction:c4,registerCoordinateSystem:function(e,t){lq.register(e,t)},registerLayout:function(e,t){f4($3,e,t,1e3,"layout")},registerVisual:h4,registerTransform:v4,registerLoading:d4,registerMap:function(e,t,n){var r=d3["registerMap"];r&&r(e,t,n)},registerImpl:function(e,t){d3[e]=t},PRIORITY:y3,ComponentModel:IX,ComponentView:OQ,SeriesModel:gK,ChartView:mQ,registerComponentModel:function(e){IX.registerClass(e)},registerComponentView:function(e){OQ.registerClass(e)},registerSeriesModel:function(e){gK.registerClass(e)},registerChartView:function(e){mQ.registerClass(e)},registerSubTypeDefaulter:function(e,t){IX.registerSubTypeDefaulter(e,t)},registerPainter:function(e,t){var n;n=t,i1[e]=n}};function y4(e){eP(e)?XL(e,(function(e){y4(e)})):GL(m4,e)>=0||(m4.push(e),tP(e)&&(e={install:e}),e.install(g4))}var b4=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.type=t.type,n}return wL(t,e),t.type="tooltip",t.dependencies=["axisPointer"],t.defaultOption={z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"#fff",shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#666",fontSize:14}},t}(IX),x4=b4;function k4(e){var t=e.get("confine");return null!=t?!!t:"richText"===e.get("renderMode")}function w4(e){if(MP.domSupported)for(var t=document.documentElement.style,n=0,r=e.length;n<r;n++)if(e[n]in t)return e[n]}var _4=w4(["transform","webkitTransform","OTransform","MozTransform","msTransform"]);function S4(e,t){if(!e)return t;t=rX(t,!0);var n=e.indexOf(t);return(e=-1===n?t:"-"+e.slice(0,n)+"-"+t).toLowerCase()}var I4=S4(w4(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),"transition"),C4=S4(_4,"transform"),T4="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(MP.transform3dSupported?"will-change:transform;":"");function N4(e,t,n){var r=e.toFixed(0)+"px",a=t.toFixed(0)+"px";if(!MP.transformSupported)return n?"top:"+a+";left:"+r+";":[["top",a],["left",r]];var i=MP.transform3dSupported,o="translate"+(i?"3d":"")+"("+r+","+a+(i?",0":"")+")";return n?"top:0;left:0;"+C4+":"+o+";":[["top",0],["left",0],[_4,o]]}function E4(e,t,n){var r=[],a=e.get("transitionDuration"),i=e.get("backgroundColor"),o=e.get("shadowBlur"),s=e.get("shadowColor"),u=e.get("shadowOffsetX"),l=e.get("shadowOffsetY"),c=e.getModel("textStyle"),h=aK(e,"html"),p=u+"px "+l+"px "+o+"px "+s;return r.push("box-shadow:"+p),t&&a&&r.push(function(e,t){var n="cubic-bezier(0.23,1,0.32,1)",r=" "+e/2+"s "+n,a="opacity"+r+",visibility"+r;return t||(r=" "+e+"s "+n,a+=MP.transformSupported?","+C4+r:",left"+r+",top"+r),I4+":"+a}(a,n)),i&&r.push("background-color:"+i),XL(["width","color","radius"],(function(t){var n="border-"+t,a=rX(n),i=e.get(a);null!=i&&r.push(n+":"+i+("color"===t?"":"px"))})),r.push(function(e){var t=[],n=e.get("fontSize"),r=e.getTextColor();r&&t.push("color:"+r),t.push("font:"+e.getFont()),n&&t.push("line-height:"+Math.round(3*n/2)+"px");var a=e.get("textShadowColor"),i=e.get("textShadowBlur")||0,o=e.get("textShadowOffsetX")||0,s=e.get("textShadowOffsetY")||0;return a&&i&&t.push("text-shadow:"+o+"px "+s+"px "+i+"px "+a),XL(["decoration","align"],(function(n){var r=e.get(n);r&&t.push("text-"+n+":"+r)})),t.join(";")}(c)),null!=h&&r.push("padding:"+aX(h).join("px ")+"px"),r.join(";")+";"}function M4(e,t,n,r,a){var i=t&&t.painter;if(n){var o=i&&i.getViewportRoot();o&&function(e,t,n,r,a){ZQ(YQ,t,r,a,!0)&&ZQ(e,n,YQ[0],YQ[1])}(e,o,document.body,r,a)}else{e[0]=r,e[1]=a;var s=i&&i.getViewportRootOffset();s&&(e[0]+=s.offsetLeft,e[1]+=s.offsetTop)}e[2]=e[0]/t.getWidth(),e[3]=e[1]/t.getHeight()}var A4=function(){function e(e,t,n){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._firstShow=!0,this._longHide=!0,MP.wxa)return null;var r=document.createElement("div");r.domBelongToZr=!0,this.el=r;var a=this._zr=t.getZr(),i=this._appendToBody=n&&n.appendToBody;M4(this._styleCoord,a,i,t.getWidth()/2,t.getHeight()/2),i?document.body.appendChild(r):e.appendChild(r),this._container=e;var o=this;r.onmouseenter=function(){o._enterable&&(clearTimeout(o._hideTimeout),o._show=!0),o._inContent=!0},r.onmousemove=function(e){if(e=e||window.event,!o._enterable){var t=a.handler;a$(a.painter.getViewportRoot(),e,!0),t.dispatch("mousemove",e)}},r.onmouseleave=function(){o._inContent=!1,o._enterable&&o._show&&o.hideLater(o._hideDelay)}}return e.prototype.update=function(e){var t=this._container,n=function(e,t){var n=e.currentStyle||document.defaultView&&document.defaultView.getComputedStyle(e);return n?t?n[t]:n:null}(t,"position"),r=t.style;"absolute"!==r.position&&"absolute"!==n&&(r.position="relative"),e.get("alwaysShowContent")&&this._moveIfResized(),this.el.className=e.get("className")||""},e.prototype.show=function(e,t){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var n=this.el,r=n.style,a=this._styleCoord;n.innerHTML?r.cssText=T4+E4(e,!this._firstShow,this._longHide)+N4(a[0],a[1],!0)+"border-color:"+pX(t)+";"+(e.get("extraCssText")||"")+";pointer-events:"+(this._enterable?"auto":"none"):r.display="none",this._show=!0,this._firstShow=!1,this._longHide=!1},e.prototype.setContent=function(e,t,n,r,a){var i=this.el;if(null!=e){var o="";if(nP(a)&&"item"===n.get("trigger")&&!k4(n)&&(o=function(e,t,n){if(!nP(n)||"inside"===n)return"";var r=e.get("backgroundColor"),a=e.get("borderWidth");t=pX(t);var i,o,s="left"===(i=n)?"right":"right"===i?"left":"top"===i?"bottom":"top",u=Math.max(1.5*Math.round(a),6),l="",c=C4+":";GL(["left","right"],s)>-1?(l+="top:50%",c+="translateY(-50%) rotate("+(o="left"===s?-225:-45)+"deg)"):(l+="left:50%",c+="translateX(-50%) rotate("+(o="top"===s?225:45)+"deg)");var h=o*Math.PI/180,p=u+a,f=p*Math.abs(Math.cos(h))+p*Math.abs(Math.sin(h)),d=t+" solid "+a+"px;";return'<div style="'+["position:absolute;width:"+u+"px;height:"+u+"px;",(l+=";"+s+":-"+Math.round(100*((f-Math.SQRT2*a)/2+Math.SQRT2*a-(f-p)/2))/100+"px")+";"+c+";","border-bottom:"+d,"border-right:"+d,"background-color:"+r+";"].join("")+'"></div>'}(n,r,a)),nP(e))i.innerHTML=e+o;else if(e){i.innerHTML="",eP(e)||(e=[e]);for(var s=0;s<e.length;s++)uP(e[s])&&e[s].parentNode!==i&&i.appendChild(e[s]);if(o&&i.childNodes.length){var u=document.createElement("div");u.innerHTML=o,i.appendChild(u)}}}else i.innerHTML=""},e.prototype.setEnterable=function(e){this._enterable=e},e.prototype.getSize=function(){var e=this.el;return[e.offsetWidth,e.offsetHeight]},e.prototype.moveTo=function(e,t){var n=this._styleCoord;if(M4(n,this._zr,this._appendToBody,e,t),null!=n[0]&&null!=n[1]){var r=this.el.style;XL(N4(n[0],n[1]),(function(e){r[e[0]]=e[1]}))}},e.prototype._moveIfResized=function(){var e=this._styleCoord[2],t=this._styleCoord[3];this.moveTo(e*this._zr.getWidth(),t*this._zr.getHeight())},e.prototype.hide=function(){var e=this,t=this.el.style;t.visibility="hidden",t.opacity="0",MP.transform3dSupported&&(t.willChange=""),this._show=!1,this._longHideTimeout=setTimeout((function(){return e._longHide=!0}),500)},e.prototype.hideLater=function(e){!this._show||this._inContent&&this._enterable||(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout($L(this.hide,this),e)):this.hide())},e.prototype.isShow=function(){return this._show},e.prototype.dispose=function(){this.el.parentNode.removeChild(this.el)},e}(),D4=A4,R4=function(){function e(e){this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._zr=e.getZr(),L4(this._styleCoord,this._zr,e.getWidth()/2,e.getHeight()/2)}return e.prototype.update=function(e){e.get("alwaysShowContent")&&this._moveIfResized()},e.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},e.prototype.setContent=function(e,t,n,r,a){var i=this;iP(e)&&_j(""),this.el&&this._zr.remove(this.el);var o=n.getModel("textStyle");this.el=new xU({style:{rich:t.richTextStyles,text:e,lineHeight:22,borderWidth:1,borderColor:r,textShadowColor:o.get("textShadowColor"),fill:n.get(["textStyle","color"]),padding:aK(n,"richText"),verticalAlign:"top",align:"left"},z:n.get("z")}),XL(["backgroundColor","borderRadius","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],(function(e){i.el.style[e]=n.get(e)})),XL(["textShadowBlur","textShadowOffsetX","textShadowOffsetY"],(function(e){i.el.style[e]=o.get(e)||0})),this._zr.add(this.el);var s=this;this.el.on("mouseover",(function(){s._enterable&&(clearTimeout(s._hideTimeout),s._show=!0),s._inContent=!0})),this.el.on("mouseout",(function(){s._enterable&&s._show&&s.hideLater(s._hideDelay),s._inContent=!1}))},e.prototype.setEnterable=function(e){this._enterable=e},e.prototype.getSize=function(){var e=this.el,t=this.el.getBoundingRect(),n=F4(e.style);return[t.width+n.left+n.right,t.height+n.top+n.bottom]},e.prototype.moveTo=function(e,t){var n=this.el;if(n){var r=this._styleCoord;L4(r,this._zr,e,t),e=r[0],t=r[1];var a=n.style,i=O4(a.borderWidth||0),o=F4(a);n.x=e+i+o.left,n.y=t+i+o.top,n.markRedraw()}},e.prototype._moveIfResized=function(){var e=this._styleCoord[2],t=this._styleCoord[3];this.moveTo(e*this._zr.getWidth(),t*this._zr.getHeight())},e.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},e.prototype.hideLater=function(e){!this._show||this._inContent&&this._enterable||(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout($L(this.hide,this),e)):this.hide())},e.prototype.isShow=function(){return this._show},e.prototype.dispose=function(){this._zr.remove(this.el)},e}();function O4(e){return Math.max(0,e)}function F4(e){var t=O4(e.shadowBlur||0),n=O4(e.shadowOffsetX||0),r=O4(e.shadowOffsetY||0);return{left:O4(t-n),right:O4(t+n),top:O4(t-r),bottom:O4(t+r)}}function L4(e,t,n,r){e[0]=n,e[1]=r,e[2]=e[0]/t.getWidth(),e[3]=e[1]/t.getHeight()}var P4=R4,z4=new iU({shape:{x:-1,y:-1,width:2,height:2}}),B4=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.type=t.type,n}return wL(t,e),t.prototype.init=function(e,t){if(!MP.node&&t.getDom()){var n,r=e.getComponent("tooltip"),a=this._renderMode="auto"===(n=r.get("renderMode"))?MP.domSupported?"html":"richText":n||"html";this._tooltipContent="richText"===a?new P4(t):new D4(t.getDom(),t,{appendToBody:r.get("appendToBody",!0)})}},t.prototype.render=function(e,t,n){if(!MP.node&&n.getDom()){this.group.removeAll(),this._tooltipModel=e,this._ecModel=t,this._api=n,this._alwaysShowContent=e.get("alwaysShowContent");var r=this._tooltipContent;r.update(e),r.setEnterable(e.get("enterable")),this._initGlobalListener(),this._keepShow(),"richText"!==this._renderMode&&e.get("transitionDuration")?h$(this,"_updatePosition",50,"fixRate"):p$(this,"_updatePosition")}},t.prototype._initGlobalListener=function(){var e=this._tooltipModel.get("triggerOn");ZJ("itemTooltip",this._api,$L((function(t,n,r){"none"!==e&&(e.indexOf(t)>=0?this._tryShow(n,r):"leave"===t&&this._hide(r))}),this))},t.prototype._keepShow=function(){var e=this._tooltipModel,t=this._ecModel,n=this._api;if(null!=this._lastX&&null!=this._lastY&&"none"!==e.get("triggerOn")){var r=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout((function(){!n.isDisposed()&&r.manuallyShowTip(e,t,n,{x:r._lastX,y:r._lastY,dataByCoordSys:r._lastDataByCoordSys})}))}},t.prototype.manuallyShowTip=function(e,t,n,r){if(r.from!==this.uid&&!MP.node&&n.getDom()){var a=W4(r,n);this._ticket="";var i=r.dataByCoordSys,o=function(e,t,n){var r=rH(e).queryOptionMap,a=r.keys()[0];if(!a||"series"===a)return;var i,o=iH(t,a,r.get(a),{useDefault:!1,enableAll:!1,enableNone:!1}).models[0];if(!o)return;if(n.getViewOfComponentModel(o).group.traverse((function(t){var n=sH(t).tooltipConfig;if(n&&n.name===e.name)return i=t,!0})),i)return{componentMainType:a,componentIndex:o.componentIndex,el:i}}(r,t,n);if(o){var s=o.el.getBoundingRect().clone();s.applyTransform(o.el.transform),this._tryShow({offsetX:s.x+s.width/2,offsetY:s.y+s.height/2,target:o.el,position:r.position,positionDefault:"bottom"},a)}else if(r.tooltip&&null!=r.x&&null!=r.y){var u=z4;u.x=r.x,u.y=r.y,u.update(),sH(u).tooltipConfig={name:null,option:r.tooltip},this._tryShow({offsetX:r.x,offsetY:r.y,target:u},a)}else if(i)this._tryShow({offsetX:r.x,offsetY:r.y,position:r.position,dataByCoordSys:i,tooltipOption:r.tooltipOption},a);else if(null!=r.seriesIndex){if(this._manuallyAxisShowTip(e,t,n,r))return;var l=n0(r,t),c=l.point[0],h=l.point[1];null!=c&&null!=h&&this._tryShow({offsetX:c,offsetY:h,target:l.el,position:r.position,positionDefault:"bottom"},a)}else null!=r.x&&null!=r.y&&(n.dispatchAction({type:"updateAxisPointer",x:r.x,y:r.y}),this._tryShow({offsetX:r.x,offsetY:r.y,position:r.position,target:n.getZr().findHover(r.x,r.y).target},a))}},t.prototype.manuallyHideTip=function(e,t,n,r){var a=this._tooltipContent;!this._alwaysShowContent&&this._tooltipModel&&a.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=this._lastDataByCoordSys=null,r.from!==this.uid&&this._hide(W4(r,n))},t.prototype._manuallyAxisShowTip=function(e,t,n,r){var a=r.seriesIndex,i=r.dataIndex,o=t.getComponent("axisPointer").coordSysAxesInfo;if(null!=a&&null!=i&&null!=o){var s=t.getSeriesByIndex(a);if(s)if("axis"===V4([s.getData().getItemModel(i),s,(s.coordinateSystem||{}).model],this._tooltipModel).get("trigger"))return n.dispatchAction({type:"updateAxisPointer",seriesIndex:a,dataIndex:i,position:r.position}),!0}},t.prototype._tryShow=function(e,t){var n=e.target;if(this._tooltipModel){this._lastX=e.offsetX,this._lastY=e.offsetY;var r=e.dataByCoordSys;if(r&&r.length)this._showAxisTooltip(r,e);else if(n){var a,i;this._lastDataByCoordSys=null,L2(n,(function(e){return null!=sH(e).dataIndex?(a=e,!0):null!=sH(e).tooltipConfig?(i=e,!0):void 0}),!0),a?this._showSeriesItemTooltip(e,a,t):i?this._showComponentItemTooltip(e,i,t):this._hide(t)}else this._lastDataByCoordSys=null,this._hide(t)}},t.prototype._showOrMove=function(e,t){var n=e.get("showDelay");t=$L(t,this),clearTimeout(this._showTimout),n>0?this._showTimout=setTimeout(t,n):t()},t.prototype._showAxisTooltip=function(e,t){var n=this._ecModel,r=this._tooltipModel,a=[t.offsetX,t.offsetY],i=V4([t.tooltipOption],r),o=this._renderMode,s=[],u=YX("section",{blocks:[],noHeader:!0}),l=[],c=new iK;XL(e,(function(e){XL(e.dataByAxis,(function(e){var t=n.getComponent(e.axisDim+"Axis",e.axisIndex),a=e.value;if(t&&null!=a){var i=LJ(a,t.axis,n,e.seriesDataIndices,e.valueLabelOpt),h=YX("section",{header:i,noHeader:!gP(i),sortBlocks:!0,blocks:[]});u.blocks.push(h),XL(e.seriesDataIndices,(function(u){var p=n.getSeriesByIndex(u.seriesIndex),f=u.dataIndexInside,d=p.getDataParams(f);if(!(d.dataIndex<0)){d.axisDim=e.axisDim,d.axisIndex=e.axisIndex,d.axisType=e.axisType,d.axisId=e.axisId,d.axisValue=wJ(t.axis,{value:a}),d.axisValueLabel=i,d.marker=c.makeTooltipMarker("item",pX(d.color),o);var v=AX(p.formatTooltip(f,!0,null)),m=v.frag;if(m){var g=V4([p],r).get("valueFormatter");h.blocks.push(g?UL({valueFormatter:g},m):m)}v.text&&l.push(v.text),s.push(d)}}))}}))})),u.blocks.reverse(),l.reverse();var h=t.position,p=i.get("order"),f=tK(u,c,o,p,n.get("useUTC"),i.get("textStyle"));f&&l.unshift(f);var d="richText"===o?"\n\n":"<br/>",v=l.join(d);this._showOrMove(i,(function(){this._updateContentNotChangedOnAxis(e,s)?this._updatePosition(i,h,a[0],a[1],this._tooltipContent,s):this._showTooltipContent(i,v,s,Math.random()+"",a[0],a[1],h,null,c)}))},t.prototype._showSeriesItemTooltip=function(e,t,n){var r=this._ecModel,a=sH(t),i=a.seriesIndex,o=r.getSeriesByIndex(i),s=a.dataModel||o,u=a.dataIndex,l=a.dataType,c=s.getData(l),h=this._renderMode,p=e.positionDefault,f=V4([c.getItemModel(u),s,o&&(o.coordinateSystem||{}).model],this._tooltipModel,p?{position:p}:null),d=f.get("trigger");if(null==d||"item"===d){var v=s.getDataParams(u,l),m=new iK;v.marker=m.makeTooltipMarker("item",pX(v.color),h);var g=AX(s.formatTooltip(u,!1,l)),y=f.get("order"),b=f.get("valueFormatter"),x=g.frag,k=x?tK(b?UL({valueFormatter:b},x):x,m,h,y,r.get("useUTC"),f.get("textStyle")):g.text,w="item_"+s.name+"_"+u;this._showOrMove(f,(function(){this._showTooltipContent(f,k,v,w,e.offsetX,e.offsetY,e.position,e.target,m)})),n({type:"showTip",dataIndexInside:u,dataIndex:c.getRawIndex(u),seriesIndex:i,from:this.uid})}},t.prototype._showComponentItemTooltip=function(e,t,n){var r=sH(t),a=r.tooltipConfig.option||{};if(nP(a)){a={content:a,formatter:a}}var i=[a],o=this._ecModel.getComponent(r.componentMainType,r.componentIndex);o&&i.push(o),i.push({formatter:a.content});var s=e.positionDefault,u=V4(i,this._tooltipModel,s?{position:s}:null),l=u.get("content"),c=Math.random()+"",h=new iK;this._showOrMove(u,(function(){var n=VL(u.get("formatterParams")||{});this._showTooltipContent(u,l,n,c,e.offsetX,e.offsetY,e.position,t,h)})),n({type:"showTip",from:this.uid})},t.prototype._showTooltipContent=function(e,t,n,r,a,i,o,s,u){if(this._ticket="",e.get("showContent")&&e.get("show")){var l=this._tooltipContent;l.setEnterable(e.get("enterable"));var c=e.get("formatter");o=o||e.get("position");var h=t,p=this._getNearestPoint([a,i],n,e.get("trigger"),e.get("borderColor")).color;if(c)if(nP(c)){var f=e.ecModel.get("useUTC"),d=eP(n)?n[0]:n;h=c,d&&d.axisType&&d.axisType.indexOf("time")>=0&&(h=Bq(d.axisValue,h,f)),h=hX(h,n,!0)}else if(tP(c)){var v=$L((function(t,r){t===this._ticket&&(l.setContent(r,u,e,p,o),this._updatePosition(e,o,a,i,l,n,s))}),this);this._ticket=r,h=c(n,r,v)}else h=c;l.setContent(h,u,e,p,o),l.show(e,p),this._updatePosition(e,o,a,i,l,n,s)}},t.prototype._getNearestPoint=function(e,t,n,r){return"axis"===n||eP(t)?{color:r||("html"===this._renderMode?"#fff":"none")}:eP(t)?void 0:{color:r||t.color||t.borderColor}},t.prototype._updatePosition=function(e,t,n,r,a,i,o){var s=this._api.getWidth(),u=this._api.getHeight();t=t||e.get("position");var l=a.getSize(),c=e.get("align"),h=e.get("verticalAlign"),p=o&&o.getBoundingRect().clone();if(o&&p.applyTransform(o.transform),tP(t)&&(t=t([n,r],i,a.el,p,{viewSize:[s,u],contentSize:l.slice()})),eP(t))n=_U(t[0],s),r=_U(t[1],u);else if(iP(t)){var f=t;f.width=l[0],f.height=l[1];var d=bX(f,{width:s,height:u});n=d.x,r=d.y,c=null,h=null}else if(nP(t)&&o){var v=function(e,t,n,r){var a=n[0],i=n[1],o=Math.ceil(Math.SQRT2*r)+8,s=0,u=0,l=t.width,c=t.height;switch(e){case"inside":s=t.x+l/2-a/2,u=t.y+c/2-i/2;break;case"top":s=t.x+l/2-a/2,u=t.y-i-o;break;case"bottom":s=t.x+l/2-a/2,u=t.y+c+o;break;case"left":s=t.x-a-o,u=t.y+c/2-i/2;break;case"right":s=t.x+l+o,u=t.y+c/2-i/2}return[s,u]}(t,p,l,e.get("borderWidth"));n=v[0],r=v[1]}else{v=function(e,t,n,r,a,i,o){var s=n.getSize(),u=s[0],l=s[1];null!=i&&(e+u+i+2>r?e-=u+i:e+=i);null!=o&&(t+l+o>a?t-=l+o:t+=o);return[e,t]}(n,r,a,s,u,c?null:20,h?null:20);n=v[0],r=v[1]}if(c&&(n-=U4(c)?l[0]/2:"right"===c?l[0]:0),h&&(r-=U4(h)?l[1]/2:"bottom"===h?l[1]:0),k4(e)){v=function(e,t,n,r,a){var i=n.getSize(),o=i[0],s=i[1];return e=Math.min(e+o,r)-o,t=Math.min(t+s,a)-s,e=Math.max(e,0),t=Math.max(t,0),[e,t]}(n,r,a,s,u);n=v[0],r=v[1]}a.moveTo(n,r)},t.prototype._updateContentNotChangedOnAxis=function(e,t){var n=this._lastDataByCoordSys,r=this._cbParamsList,a=!!n&&n.length===e.length;return a&&XL(n,(function(n,i){var o=n.dataByAxis||[],s=(e[i]||{}).dataByAxis||[];(a=a&&o.length===s.length)&&XL(o,(function(e,n){var i=s[n]||{},o=e.seriesDataIndices||[],u=i.seriesDataIndices||[];(a=a&&e.value===i.value&&e.axisType===i.axisType&&e.axisId===i.axisId&&o.length===u.length)&&XL(o,(function(e,t){var n=u[t];a=a&&e.seriesIndex===n.seriesIndex&&e.dataIndex===n.dataIndex})),r&&XL(e.seriesDataIndices,(function(e){var n=e.seriesIndex,i=t[n],o=r[n];i&&o&&o.data!==i.data&&(a=!1)}))}))})),this._lastDataByCoordSys=e,this._cbParamsList=t,!!a},t.prototype._hide=function(e){this._lastDataByCoordSys=null,e({type:"hideTip",from:this.uid})},t.prototype.dispose=function(e,t){!MP.node&&t.getDom()&&(p$(this,"_updatePosition"),this._tooltipContent.dispose(),JJ("itemTooltip",t))},t.type="tooltip",t}(OQ);function V4(e,t,n){var r,a=t.ecModel;n?(r=new CG(n,a,a),r=new CG(t.option,r,a)):r=t;for(var i=e.length-1;i>=0;i--){var o=e[i];o&&(o instanceof CG&&(o=o.get("tooltip",!0)),nP(o)&&(o={formatter:o}),o&&(r=new CG(o,r,a)))}return r}function W4(e,t){return e.dispatchAction||$L(t.dispatchAction,t)}function U4(e){return"center"===e||"middle"===e}var H4=B4;var G4=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return wL(t,e),t.type="grid",t.dependencies=["xAxis","yAxis"],t.layoutMode="box",t.defaultOption={show:!1,z:0,left:"10%",top:60,right:"10%",bottom:70,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"},t}(IX),j4=G4,q4=function(){function e(){}return e.prototype.getNeedCrossZero=function(){return!this.option.scale},e.prototype.getCoordSysModel=function(){},e}(),X4=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return wL(t,e),t.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",aH).models[0]},t.type="cartesian2dAxis",t}(IX);jL(X4,q4);var K4={show:!0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#6E7079",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,lineStyle:{color:["#E0E6F1"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(210,219,238,0.2)"]}}},Y4=WL({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},K4),Z4=WL({boundaryGap:[0,0],axisLine:{show:"auto"},axisTick:{show:"auto"},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#F4F7FD",width:1}}},K4),Q4={category:Y4,value:Z4,time:WL({splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:"bold"}}},splitLine:{show:!1}},Z4),log:HL({logBase:10},Z4)},$4={value:1,category:1,time:1,log:1};function J4(e,t,n,r){XL($4,(function(a,i){var o=WL(WL({},Q4[i],!0),r,!0),s=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.type=t+"Axis."+i,n}return wL(n,e),n.prototype.mergeDefaultAndTheme=function(e,t){var n=xX(this),r=n?wX(e):{};WL(e,t.getTheme().get(i+"Axis")),WL(e,this.getDefaultOption()),e.type=e5(e),n&&kX(e,r,n)},n.prototype.optionUpdated=function(){"category"===this.option.type&&(this.__ordinalMeta=T$.createByAxisModel(this))},n.prototype.getCategories=function(e){var t=this.option;if("category"===t.type)return e?t.data:this.__ordinalMeta.categories},n.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},n.type=t+"Axis."+i,n.defaultOption=o,n}(n);e.registerComponentModel(s)})),e.registerSubTypeDefaulter(t+"Axis",e5)}function e5(e){return e.type||(e.data?"category":"value")}var t5=function(){function e(e){this.type="cartesian",this._dimList=[],this._axes={},this.name=e||""}return e.prototype.getAxis=function(e){return this._axes[e]},e.prototype.getAxes=function(){return KL(this._dimList,(function(e){return this._axes[e]}),this)},e.prototype.getAxesByScale=function(e){return e=e.toLowerCase(),ZL(this.getAxes(),(function(t){return t.scale.type===e}))},e.prototype.addAxis=function(e){var t=e.dim;this._axes[t]=e,this._dimList.push(t)},e}(),n5=["x","y"];function r5(e){return"interval"===e.type||"time"===e.type}var a5=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="cartesian2d",t.dimensions=n5,t}return wL(t,e),t.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var e=this.getAxis("x").scale,t=this.getAxis("y").scale;if(r5(e)&&r5(t)){var n=e.getExtent(),r=t.getExtent(),a=this.dataToPoint([n[0],r[0]]),i=this.dataToPoint([n[1],r[1]]),o=n[1]-n[0],s=r[1]-r[0];if(o&&s){var u=(i[0]-a[0])/o,l=(i[1]-a[1])/s,c=a[0]-n[0]*u,h=a[1]-r[0]*l,p=this._transform=[u,0,0,l,c,h];this._invTransform=iz([],p)}}},t.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},t.prototype.containPoint=function(e){var t=this.getAxis("x"),n=this.getAxis("y");return t.contain(t.toLocalCoord(e[0]))&&n.contain(n.toLocalCoord(e[1]))},t.prototype.containData=function(e){return this.getAxis("x").containData(e[0])&&this.getAxis("y").containData(e[1])},t.prototype.dataToPoint=function(e,t,n){n=n||[];var r=e[0],a=e[1];if(this._transform&&null!=r&&isFinite(r)&&null!=a&&isFinite(a))return Zz(n,e,this._transform);var i=this.getAxis("x"),o=this.getAxis("y");return n[0]=i.toGlobalCoord(i.dataToCoord(r,t)),n[1]=o.toGlobalCoord(o.dataToCoord(a,t)),n},t.prototype.clampData=function(e,t){var n=this.getAxis("x").scale,r=this.getAxis("y").scale,a=n.getExtent(),i=r.getExtent(),o=n.parse(e[0]),s=r.parse(e[1]);return(t=t||[])[0]=Math.min(Math.max(Math.min(a[0],a[1]),o),Math.max(a[0],a[1])),t[1]=Math.min(Math.max(Math.min(i[0],i[1]),s),Math.max(i[0],i[1])),t},t.prototype.pointToData=function(e,t){var n=[];if(this._invTransform)return Zz(n,e,this._invTransform);var r=this.getAxis("x"),a=this.getAxis("y");return n[0]=r.coordToData(r.toLocalCoord(e[0]),t),n[1]=a.coordToData(a.toLocalCoord(e[1]),t),n},t.prototype.getOtherAxis=function(e){return this.getAxis("x"===e.dim?"y":"x")},t.prototype.getArea=function(){var e=this.getAxis("x").getGlobalExtent(),t=this.getAxis("y").getGlobalExtent(),n=Math.min(e[0],e[1]),r=Math.min(t[0],t[1]),a=Math.max(e[0],e[1])-n,i=Math.max(t[0],t[1])-r;return new gz(n,r,a,i)},t}(t5),i5=a5,o5=eH();function s5(e){return"category"===e.type?function(e){var t=e.getLabelModel(),n=l5(e,t);return!t.get("show")||e.scale.isBlank()?{labels:[],labelCategoryInterval:n.labelCategoryInterval}:n}(e):function(e){var t=e.scale.getTicks(),n=kJ(e);return{labels:KL(t,(function(t,r){return{level:t.level,formattedLabel:n(t,r),rawLabel:e.scale.getLabel(t),tickValue:t.value}}))}}(e)}function u5(e,t){return"category"===e.type?function(e,t){var n,r,a=c5(e,"ticks"),i=SJ(t),o=h5(a,i);if(o)return o;t.get("show")&&!e.scale.isBlank()||(n=[]);if(tP(i))n=d5(e,i,!0);else if("auto"===i){var s=l5(e,e.getLabelModel());r=s.labelCategoryInterval,n=KL(s.labels,(function(e){return e.tickValue}))}else n=f5(e,r=i,!0);return p5(a,i,{ticks:n,tickCategoryInterval:r})}(e,t):{ticks:KL(e.scale.getTicks(),(function(e){return e.value}))}}function l5(e,t){var n,r,a=c5(e,"labels"),i=SJ(t),o=h5(a,i);return o||(tP(i)?n=d5(e,i):(r="auto"===i?function(e){var t=o5(e).autoInterval;return null!=t?t:o5(e).autoInterval=e.calculateCategoryInterval()}(e):i,n=f5(e,r)),p5(a,i,{labels:n,labelCategoryInterval:r}))}function c5(e,t){return o5(e)[t]||(o5(e)[t]=[])}function h5(e,t){for(var n=0;n<e.length;n++)if(e[n].key===t)return e[n].value}function p5(e,t,n){return e.push({key:t,value:n}),n}function f5(e,t,n){var r=kJ(e),a=e.scale,i=a.getExtent(),o=e.getLabelModel(),s=[],u=Math.max((t||0)+1,1),l=i[0],c=a.count();0!==l&&u>1&&c/u>2&&(l=Math.round(Math.ceil(l/u)*u));var h=IJ(e),p=o.get("showMinLabel")||h,f=o.get("showMaxLabel")||h;p&&l!==i[0]&&v(i[0]);for(var d=l;d<=i[1];d+=u)v(d);function v(e){var t={value:e};s.push(n?e:{formattedLabel:r(t),rawLabel:a.getLabel(t),tickValue:e})}return f&&d-u!==i[1]&&v(i[1]),s}function d5(e,t,n){var r=e.scale,a=kJ(e),i=[];return XL(r.getTicks(),(function(e){var o=r.getLabel(e),s=e.value;t(e.value,o)&&i.push(n?s:{formattedLabel:a(e),rawLabel:o,tickValue:s})})),i}var v5=[0,1],m5=function(){function e(e,t,n){this.onBand=!1,this.inverse=!1,this.dim=e,this.scale=t,this._extent=n||[0,0]}return e.prototype.contain=function(e){var t=this._extent,n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]);return e>=n&&e<=r},e.prototype.containData=function(e){return this.scale.contain(e)},e.prototype.getExtent=function(){return this._extent.slice()},e.prototype.getPixelPrecision=function(e){return function(e,t){var n=Math.log,r=Math.LN10,a=Math.floor(n(e[1]-e[0])/r),i=Math.round(n(Math.abs(t[1]-t[0]))/r),o=Math.min(Math.max(-a+i,0),20);return isFinite(o)?o:20}(e||this.scale.getExtent(),this._extent)},e.prototype.setExtent=function(e,t){var n=this._extent;n[0]=e,n[1]=t},e.prototype.dataToCoord=function(e,t){var n=this._extent,r=this.scale;return e=r.normalize(e),this.onBand&&"ordinal"===r.type&&g5(n=n.slice(),r.count()),wU(e,v5,n,t)},e.prototype.coordToData=function(e,t){var n=this._extent,r=this.scale;this.onBand&&"ordinal"===r.type&&g5(n=n.slice(),r.count());var a=wU(e,n,v5,t);return this.scale.scale(a)},e.prototype.pointToData=function(e,t){},e.prototype.getTicksCoords=function(e){var t=(e=e||{}).tickModel||this.getTickModel(),n=KL(u5(this,t).ticks,(function(e){return{coord:this.dataToCoord("ordinal"===this.scale.type?this.scale.getRawOrdinalNumber(e):e),tickValue:e}}),this);return function(e,t,n,r){var a=t.length;if(!e.onBand||n||!a)return;var i,o,s=e.getExtent();if(1===a)t[0].coord=s[0],i=t[1]={coord:s[0]};else{var u=t[a-1].tickValue-t[0].tickValue,l=(t[a-1].coord-t[0].coord)/u;XL(t,(function(e){e.coord-=l/2})),o=1+e.scale.getExtent()[1]-t[a-1].tickValue,i={coord:t[a-1].coord+l*o},t.push(i)}var c=s[0]>s[1];h(t[0].coord,s[0])&&(r?t[0].coord=s[0]:t.shift());r&&h(s[0],t[0].coord)&&t.unshift({coord:s[0]});h(s[1],i.coord)&&(r?i.coord=s[1]:t.pop());r&&h(i.coord,s[1])&&t.push({coord:s[1]});function h(e,t){return e=SU(e),t=SU(t),c?e>t:e<t}}(this,n,t.get("alignWithLabel"),e.clamp),n},e.prototype.getMinorTicksCoords=function(){if("ordinal"===this.scale.type)return[];var e=this.model.getModel("minorTick").get("splitNumber");return e>0&&e<100||(e=5),KL(this.scale.getMinorTicks(e),(function(e){return KL(e,(function(e){return{coord:this.dataToCoord(e),tickValue:e}}),this)}),this)},e.prototype.getViewLabels=function(){return s5(this).labels},e.prototype.getLabelModel=function(){return this.model.getModel("axisLabel")},e.prototype.getTickModel=function(){return this.model.getModel("axisTick")},e.prototype.getBandWidth=function(){var e=this._extent,t=this.scale.getExtent(),n=t[1]-t[0]+(this.onBand?1:0);0===n&&(n=1);var r=Math.abs(e[1]-e[0]);return Math.abs(r)/n},e.prototype.calculateCategoryInterval=function(){return function(e){var t=function(e){var t=e.getLabelModel();return{axisRotate:e.getRotate?e.getRotate():e.isHorizontal&&!e.isHorizontal()?90:0,labelRotate:t.get("rotate")||0,font:t.getFont()}}(e),n=kJ(e),r=(t.axisRotate-t.labelRotate)/180*Math.PI,a=e.scale,i=a.getExtent(),o=a.count();if(i[1]-i[0]<1)return 0;var s=1;o>40&&(s=Math.max(1,Math.floor(o/40)));for(var u=i[0],l=e.dataToCoord(u+1)-e.dataToCoord(u),c=Math.abs(l*Math.cos(r)),h=Math.abs(l*Math.sin(r)),p=0,f=0;u<=i[1];u+=s){var d,v,m=kz(n({value:u}),t.font,"center","top");d=1.3*m.width,v=1.3*m.height,p=Math.max(p,d,7),f=Math.max(f,v,7)}var g=p/c,y=f/h;isNaN(g)&&(g=1/0),isNaN(y)&&(y=1/0);var b=Math.max(0,Math.floor(Math.min(g,y))),x=o5(e.model),k=e.getExtent(),w=x.lastAutoInterval,_=x.lastTickCount;return null!=w&&null!=_&&Math.abs(w-b)<=1&&Math.abs(_-o)<=1&&w>b&&x.axisExtent0===k[0]&&x.axisExtent1===k[1]?b=w:(x.lastTickCount=o,x.lastAutoInterval=b,x.axisExtent0=k[0],x.axisExtent1=k[1]),b}(this)},e}();function g5(e,t){var n=(e[1]-e[0])/t/2;e[0]+=n,e[1]-=n}var y5=function(e){function t(t,n,r,a,i){var o=e.call(this,t,n,r)||this;return o.index=0,o.type=a||"value",o.position=i||"bottom",o}return wL(t,e),t.prototype.isHorizontal=function(){var e=this.position;return"top"===e||"bottom"===e},t.prototype.getGlobalExtent=function(e){var t=this.getExtent();return t[0]=this.toGlobalCoord(t[0]),t[1]=this.toGlobalCoord(t[1]),e&&t[0]>t[1]&&t.reverse(),t},t.prototype.pointToData=function(e,t){return this.coordToData(this.toLocalCoord(e["x"===this.dim?0:1]),t)},t.prototype.setCategorySortInfo=function(e){if("category"!==this.type)return!1;this.model.option.categorySortInfo=e,this.scale.setSortInfo(e)},t}(m5),b5=y5,x5=Math.log;var k5=function(){function e(e,t,n){this.type="grid",this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=n5,this._initCartesian(e,t,n),this.model=e}return e.prototype.getRect=function(){return this._rect},e.prototype.update=function(e,t){var n=this._axesMap;function r(e){var t,n=QL(e),r=n.length;if(r){for(var a=[],i=r-1;i>=0;i--){var o=e[+n[i]],s=o.model,u=o.scale;N$(u)&&s.get("alignTicks")&&null==s.get("interval")?a.push(o):(xJ(u,s),N$(u)&&(t=o))}a.length&&(t||xJ((t=a.pop()).scale,t.model),XL(a,(function(e){!function(e,t,n){var r=V$.prototype,a=r.getTicks.call(n),i=r.getTicks.call(n,!0),o=a.length-1,s=r.getInterval.call(n),u=bJ(e,t),l=u.extent,c=u.fixMin,h=u.fixMax;if("log"===e.type){var p=x5(e.base);l=[x5(l[0])/p,x5(l[1])/p]}e.setExtent(l[0],l[1]),e.calcNiceExtent({splitNumber:o,fixMin:c,fixMax:h});var f=r.getExtent.call(e);c&&(l[0]=f[0]),h&&(l[1]=f[1]);var d=r.getInterval.call(e),v=l[0],m=l[1];if(c&&h)d=(m-v)/o;else if(c)for(m=l[0]+d*o;m<l[1]&&isFinite(m)&&isFinite(l[1]);)d=M$(d),m=l[0]+d*o;else if(h)for(v=l[1]-d*o;v>l[0]&&isFinite(v)&&isFinite(l[0]);)d=M$(d),v=l[1]-d*o;else{e.getTicks().length-1>o&&(d=M$(d));var g=d*o;(v=SU((m=Math.ceil(l[1]/d)*d)-g))<0&&l[0]>=0?(v=0,m=SU(g)):m>0&&l[1]<=0&&(m=0,v=-SU(g))}var y=(a[0].value-i[0].value)/s,b=(a[o].value-i[o].value)/s;r.setExtent.call(e,v+d*y,m+d*b),r.setInterval.call(e,d),(y||b)&&r.setNiceExtent.call(e,v+d,m-d)}(e.scale,e.model,t.scale)})))}}this._updateScale(e,this.model),r(n.x),r(n.y);var a={};XL(n.x,(function(e){_5(n,"y",e,a)})),XL(n.y,(function(e){_5(n,"x",e,a)})),this.resize(this.model,t)},e.prototype.resize=function(e,t,n){var r=e.getBoxLayoutParams(),a=!n&&e.get("containLabel"),i=bX(r,{width:t.getWidth(),height:t.getHeight()});this._rect=i;var o=this._axesList;function s(){XL(o,(function(e){var t=e.isHorizontal(),n=t?[0,i.width]:[0,i.height],r=e.inverse?1:0;e.setExtent(n[r],n[1-r]),function(e,t){var n=e.getExtent(),r=n[0]+n[1];e.toGlobalCoord="x"===e.dim?function(e){return e+t}:function(e){return r-e+t},e.toLocalCoord="x"===e.dim?function(e){return e-t}:function(e){return r-e+t}}(e,t?i.x:i.y)}))}s(),a&&(XL(o,(function(e){if(!e.model.get(["axisLabel","inside"])){var t=function(e){var t=e.model,n=e.scale;if(t.get(["axisLabel","show"])&&!n.isBlank()){var r,a,i=n.getExtent();a=n instanceof P$?n.count():(r=n.getTicks()).length;var o,s=e.getLabelModel(),u=kJ(e),l=1;a>40&&(l=Math.ceil(a/40));for(var c=0;c<a;c+=l){var h=u(r?r[c]:{value:i[0]+c},c),p=_J(s.getTextRect(h),s.get("rotate")||0);o?o.union(p):o=p}return o}}(e);if(t){var n=e.isHorizontal()?"height":"width",r=e.model.get(["axisLabel","margin"]);i[n]-=t[n]+r,"top"===e.position?i.y+=t.height+r:"left"===e.position&&(i.x+=t.width+r)}}})),s()),XL(this._coordsList,(function(e){e.calcAffineTransform()}))},e.prototype.getAxis=function(e,t){var n=this._axesMap[e];if(null!=n)return n[t||0]},e.prototype.getAxes=function(){return this._axesList.slice()},e.prototype.getCartesian=function(e,t){if(null!=e&&null!=t){var n="x"+e+"y"+t;return this._coordsMap[n]}iP(e)&&(t=e.yAxisIndex,e=e.xAxisIndex);for(var r=0,a=this._coordsList;r<a.length;r++)if(a[r].getAxis("x").index===e||a[r].getAxis("y").index===t)return a[r]},e.prototype.getCartesians=function(){return this._coordsList.slice()},e.prototype.convertToPixel=function(e,t,n){var r=this._findConvertTarget(t);return r.cartesian?r.cartesian.dataToPoint(n):r.axis?r.axis.toGlobalCoord(r.axis.dataToCoord(n)):null},e.prototype.convertFromPixel=function(e,t,n){var r=this._findConvertTarget(t);return r.cartesian?r.cartesian.pointToData(n):r.axis?r.axis.coordToData(r.axis.toLocalCoord(n)):null},e.prototype._findConvertTarget=function(e){var t,n,r=e.seriesModel,a=e.xAxisModel||r&&r.getReferringComponents("xAxis",aH).models[0],i=e.yAxisModel||r&&r.getReferringComponents("yAxis",aH).models[0],o=e.gridModel,s=this._coordsList;if(r)GL(s,t=r.coordinateSystem)<0&&(t=null);else if(a&&i)t=this.getCartesian(a.componentIndex,i.componentIndex);else if(a)n=this.getAxis("x",a.componentIndex);else if(i)n=this.getAxis("y",i.componentIndex);else if(o){o.coordinateSystem===this&&(t=this._coordsList[0])}return{cartesian:t,axis:n}},e.prototype.containPoint=function(e){var t=this._coordsList[0];if(t)return t.containPoint(e)},e.prototype._initCartesian=function(e,t,n){var r=this,a=this,i={left:!1,right:!1,top:!1,bottom:!1},o={x:{},y:{}},s={x:0,y:0};if(t.eachComponent("xAxis",u("x"),this),t.eachComponent("yAxis",u("y"),this),!s.x||!s.y)return this._axesMap={},void(this._axesList=[]);function u(t){return function(n,r){if(w5(n,e)){var u=n.get("position");"x"===t?"top"!==u&&"bottom"!==u&&(u=i.bottom?"top":"bottom"):"left"!==u&&"right"!==u&&(u=i.left?"right":"left"),i[u]=!0;var l=new b5(t,function(e,t){if(t=t||e.get("type"))switch(t){case"category":return new P$({ordinalMeta:e.getOrdinalMeta?e.getOrdinalMeta():e.getCategories(),extent:[1/0,-1/0]});case"time":return new rJ({locale:e.ecModel.getLocaleModel(),useUTC:e.ecModel.get("useUTC")});default:return new(S$.getClass(t)||V$)}}(n),[0,0],n.get("type"),u),c="category"===l.type;l.onBand=c&&n.get("boundaryGap"),l.inverse=n.get("inverse"),n.axis=l,l.model=n,l.grid=a,l.index=r,a._axesList.push(l),o[t][r]=l,s[t]++}}}this._axesMap=o,XL(o.x,(function(t,n){XL(o.y,(function(a,i){var o="x"+n+"y"+i,s=new i5(o);s.master=r,s.model=e,r._coordsMap[o]=s,r._coordsList.push(s),s.addAxis(t),s.addAxis(a)}))}))},e.prototype._updateScale=function(e,t){function n(e,t){XL(CJ(e,t.dim),(function(n){t.scale.unionExtentFromData(e,n)}))}XL(this._axesList,(function(e){if(e.scale.setExtent(1/0,-1/0),"category"===e.type){var t=e.model.get("categorySortInfo");e.scale.setSortInfo(t)}})),e.eachSeries((function(e){if(BJ(e)){var r=VJ(e),a=r.xAxisModel,i=r.yAxisModel;if(!w5(a,t)||!w5(i,t))return;var o=this.getCartesian(a.componentIndex,i.componentIndex),s=e.getData(),u=o.getAxis("x"),l=o.getAxis("y");n(s,u),n(s,l)}}),this)},e.prototype.getTooltipAxes=function(e){var t=[],n=[];return XL(this.getCartesians(),(function(r){var a=null!=e&&"auto"!==e?r.getAxis(e):r.getBaseAxis(),i=r.getOtherAxis(a);GL(t,a)<0&&t.push(a),GL(n,i)<0&&n.push(i)})),{baseAxes:t,otherAxes:n}},e.create=function(t,n){var r=[];return t.eachComponent("grid",(function(a,i){var o=new e(a,t,n);o.name="grid_"+i,o.resize(a,n,!0),a.coordinateSystem=o,r.push(o)})),t.eachSeries((function(e){if(BJ(e)){var t=VJ(e),n=t.xAxisModel,r=t.yAxisModel;0;var a=n.getCoordSysModel().coordinateSystem;e.coordinateSystem=a.getCartesian(n.componentIndex,r.componentIndex)}})),r},e.dimensions=n5,e}();function w5(e,t){return e.getCoordSysModel()===t}function _5(e,t,n,r){n.getAxesOnZeroOf=function(){return a?[a]:[]};var a,i=e[t],o=n.model,s=o.get(["axisLine","onZero"]),u=o.get(["axisLine","onZeroAxisIndex"]);if(s){if(null!=u)S5(i[u])&&(a=i[u]);else for(var l in i)if(i.hasOwnProperty(l)&&S5(i[l])&&!r[c(i[l])]){a=i[l];break}a&&(r[c(a)]=!0)}function c(e){return e.dim+"_"+e.index}}function S5(e){return e&&"category"!==e.type&&"time"!==e.type&&function(e){var t=e.scale.getExtent(),n=t[0],r=t[1];return!(n>0&&r>0||n<0&&r<0)}(e)}var I5=k5,C5=eH();var T5=["axisLine","axisTickLabel","axisName"],N5=["splitArea","splitLine","minorSplitLine"],E5=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.type=t.type,n.axisPointerClass="CartesianAxisPointer",n}return wL(t,e),t.prototype.render=function(t,n,r,a){this.group.removeAll();var i=this._axisGroup;if(this._axisGroup=new zK,this.group.add(this._axisGroup),t.get("show")){var o=t.getCoordSysModel(),s=zJ(o,t),u=new OJ(t,UL({handleAutoShown:function(e){for(var n=o.coordinateSystem.getCartesians(),r=0;r<n.length;r++)if(N$(n[r].getOtherAxis(t.axis).scale))return!0;return!1}},s));XL(T5,u.add,u),this._axisGroup.add(u.getGroup()),XL(N5,(function(e){t.get([e,"show"])&&M5[e](this,this._axisGroup,t,o)}),this),a&&"changeAxisOrder"===a.type&&a.isInitSort||yZ(i,this._axisGroup,t),e.prototype.render.call(this,t,n,r,a)}},t.prototype.remove=function(){C5(this).splitAreaColors=null},t.type="cartesianAxis",t}(jQ),M5={splitLine:function(e,t,n,r){var a=n.axis;if(!a.scale.isBlank()){var i=n.getModel("splitLine"),o=i.getModel("lineStyle"),s=o.get("color");s=eP(s)?s:[s];for(var u=r.coordinateSystem.getRect(),l=a.isHorizontal(),c=0,h=a.getTicksCoords({tickModel:i}),p=[],f=[],d=o.getLineStyle(),v=0;v<h.length;v++){var m=a.toGlobalCoord(h[v].coord);l?(p[0]=m,p[1]=u.y,f[0]=m,f[1]=u.y+u.height):(p[0]=u.x,p[1]=m,f[0]=u.x+u.width,f[1]=m);var g=c++%s.length,y=h[v].tickValue;t.add(new xY({anid:null!=y?"line_"+h[v].tickValue:null,subPixelOptimize:!0,autoBatch:!0,shape:{x1:p[0],y1:p[1],x2:f[0],y2:f[1]},style:HL({stroke:s[g]},d),silent:!0}))}}},minorSplitLine:function(e,t,n,r){var a=n.axis,i=n.getModel("minorSplitLine").getModel("lineStyle"),o=r.coordinateSystem.getRect(),s=a.isHorizontal(),u=a.getMinorTicksCoords();if(u.length)for(var l=[],c=[],h=i.getLineStyle(),p=0;p<u.length;p++)for(var f=0;f<u[p].length;f++){var d=a.toGlobalCoord(u[p][f].coord);s?(l[0]=d,l[1]=o.y,c[0]=d,c[1]=o.y+o.height):(l[0]=o.x,l[1]=d,c[0]=o.x+o.width,c[1]=d),t.add(new xY({anid:"minor_line_"+u[p][f].tickValue,subPixelOptimize:!0,autoBatch:!0,shape:{x1:l[0],y1:l[1],x2:c[0],y2:c[1]},style:h,silent:!0}))}},splitArea:function(e,t,n,r){!function(e,t,n,r){var a=n.axis;if(!a.scale.isBlank()){var i=n.getModel("splitArea"),o=i.getModel("areaStyle"),s=o.get("color"),u=r.coordinateSystem.getRect(),l=a.getTicksCoords({tickModel:i,clamp:!0});if(l.length){var c=s.length,h=C5(e).splitAreaColors,p=wP(),f=0;if(h)for(var d=0;d<l.length;d++){var v=h.get(l[d].tickValue);if(null!=v){f=(v+(c-1)*d)%c;break}}var m=a.toGlobalCoord(l[0].coord),g=o.getAreaStyle();for(s=eP(s)?s:[s],d=1;d<l.length;d++){var y=a.toGlobalCoord(l[d].coord),b=void 0,x=void 0,k=void 0,w=void 0;a.isHorizontal()?(b=m,x=u.y,k=y-b,w=u.height,m=b+k):(b=u.x,x=m,k=u.width,m=x+(w=y-x));var _=l[d-1].tickValue;null!=_&&p.set(_,f),t.add(new iU({anid:null!=_?"area_"+_:null,shape:{x:b,y:x,width:k,height:w},style:HL({fill:s[f]},g),autoBatch:!0,silent:!0})),f=(f+1)%c}C5(e).splitAreaColors=p}}}(e,t,n,r)}},A5=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.type=t.type,n}return wL(t,e),t.type="xAxis",t}(E5),D5=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=A5.type,t}return wL(t,e),t.type="yAxis",t}(E5),R5=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="grid",t}return wL(t,e),t.prototype.render=function(e,t){this.group.removeAll(),e.get("show")&&this.group.add(new iU({shape:e.coordinateSystem.getRect(),style:HL({fill:e.get("backgroundColor")},e.getItemStyle()),silent:!0,z2:-1}))},t.type="grid",t}(OQ),O5={offset:0};function F5(e){e.registerComponentView(R5),e.registerComponentModel(j4),e.registerCoordinateSystem("cartesian2d",I5),J4(e,"x",X4,O5),J4(e,"y",X4,O5),e.registerComponentView(A5),e.registerComponentView(D5),e.registerPreprocessor((function(e){e.xAxis&&e.yAxis&&!e.grid&&(e.grid={})}))}var L5={get:function(e,t,n){var r=VL((P5[e]||{})[t]);return n&&eP(r)?r[r.length-1]:r}},P5={color:{active:["#006edd","#e0ffff"],inactive:["rgba(0,0,0,0)"]},colorHue:{active:[0,360],inactive:[0,0]},colorSaturation:{active:[.3,1],inactive:[0,0]},colorLightness:{active:[.9,.5],inactive:[0,0]},colorAlpha:{active:[.3,1],inactive:[0,0]},opacity:{active:[.3,1],inactive:[0,0]},symbol:{active:["circle","roundRect","diamond"],inactive:["none"]},symbolSize:{active:[10,50],inactive:[0,0]}},z5=L5,B5=XL,V5=iP,W5=-1,U5=function(){function e(t){var n=t.mappingMethod,r=t.type,a=this.option=VL(t);this.type=r,this.mappingMethod=n,this._normalizeData=$5[n];var i=e.visualHandlers[r];this.applyVisual=i.applyVisual,this.getColorMapper=i.getColorMapper,this._normalizedToVisual=i._normalizedToVisual[n],"piecewise"===n?(H5(a),function(e){var t=e.pieceList;e.hasSpecialVisual=!1,XL(t,(function(t,n){t.originIndex=n,null!=t.visual&&(e.hasSpecialVisual=!0)}))}(a)):"category"===n?a.categories?function(e){var t=e.categories,n=e.categoryMap={},r=e.visual;if(B5(t,(function(e,t){n[e]=t})),!eP(r)){var a=[];iP(r)?B5(r,(function(e,t){var r=n[t];a[null!=r?r:W5]=e})):a[-1]=r,r=Q5(e,a)}for(var i=t.length-1;i>=0;i--)null==r[i]&&(delete n[t[i]],t.pop())}(a):H5(a,!0):(mP("linear"!==n||a.dataExtent),H5(a))}return e.prototype.mapValueToVisual=function(e){var t=this._normalizeData(e);return this._normalizedToVisual(t,e)},e.prototype.getNormalizer=function(){return $L(this._normalizeData,this)},e.listVisualTypes=function(){return QL(e.visualHandlers)},e.isValidType=function(t){return e.visualHandlers.hasOwnProperty(t)},e.eachVisual=function(e,t,n){iP(e)?XL(e,t,n):t.call(n,e)},e.mapVisual=function(t,n,r){var a,i=eP(t)?[]:iP(t)?{}:(a=!0,null);return e.eachVisual(t,(function(e,t){var o=n.call(r,e,t);a?i=o:i[t]=o})),i},e.retrieveVisuals=function(t){var n,r={};return t&&B5(e.visualHandlers,(function(e,a){t.hasOwnProperty(a)&&(r[a]=t[a],n=!0)})),n?r:null},e.prepareVisualTypes=function(e){if(eP(e))e=e.slice();else{if(!V5(e))return[];var t=[];B5(e,(function(e,n){t.push(n)})),e=t}return e.sort((function(e,t){return"color"===t&&"color"!==e&&0===e.indexOf("color")?1:-1})),e},e.dependsOn=function(e,t){return"color"===t?!(!e||0!==e.indexOf(t)):e===t},e.findPieceIndex=function(e,t,n){for(var r,a=1/0,i=0,o=t.length;i<o;i++){var s=t[i].value;if(null!=s){if(s===e||nP(s)&&s===e+"")return i;n&&h(s,i)}}for(i=0,o=t.length;i<o;i++){var u=t[i],l=u.interval,c=u.close;if(l){if(l[0]===-1/0){if(J5(c[1],e,l[1]))return i}else if(l[1]===1/0){if(J5(c[0],l[0],e))return i}else if(J5(c[0],l[0],e)&&J5(c[1],e,l[1]))return i;n&&h(l[0],i),n&&h(l[1],i)}}if(n)return e===1/0?t.length-1:e===-1/0?0:r;function h(t,n){var i=Math.abs(t-e);i<a&&(a=i,r=n)}},e.visualHandlers={color:{applyVisual:q5("color"),getColorMapper:function(){var e=this.option;return $L("category"===e.mappingMethod?function(e,t){return!t&&(e=this._normalizeData(e)),X5.call(this,e)}:function(t,n,r){var a=!!r;return!n&&(t=this._normalizeData(t)),r=QB(t,e.parsedVisual,r),a?r:eV(r,"rgba")},this)},_normalizedToVisual:{linear:function(e){return eV(QB(e,this.option.parsedVisual),"rgba")},category:X5,piecewise:function(e,t){var n=Z5.call(this,t);return null==n&&(n=eV(QB(e,this.option.parsedVisual),"rgba")),n},fixed:K5}},colorHue:G5((function(e,t){return JB(e,t)})),colorSaturation:G5((function(e,t){return JB(e,null,t)})),colorLightness:G5((function(e,t){return JB(e,null,null,t)})),colorAlpha:G5((function(e,t){return function(e,t){var n=KB(e);if(n&&null!=t)return n[3]=zB(t),eV(n,"rgba")}(e,t)})),decal:{applyVisual:q5("decal"),_normalizedToVisual:{linear:null,category:X5,piecewise:null,fixed:null}},opacity:{applyVisual:q5("opacity"),_normalizedToVisual:Y5([0,1])},liftZ:{applyVisual:q5("liftZ"),_normalizedToVisual:{linear:K5,category:K5,piecewise:K5,fixed:K5}},symbol:{applyVisual:function(e,t,n){n("symbol",this.mapValueToVisual(e))},_normalizedToVisual:{linear:j5,category:X5,piecewise:function(e,t){var n=Z5.call(this,t);return null==n&&(n=j5.call(this,e)),n},fixed:K5}},symbolSize:{applyVisual:q5("symbolSize"),_normalizedToVisual:Y5([0,1])}},e}();function H5(e,t){var n=e.visual,r=[];iP(n)?B5(n,(function(e){r.push(e)})):null!=n&&r.push(n);t||1!==r.length||{color:1,symbol:1}.hasOwnProperty(e.type)||(r[1]=r[0]),Q5(e,r)}function G5(e){return{applyVisual:function(t,n,r){var a=this.mapValueToVisual(t);r("color",e(n("color"),a))},_normalizedToVisual:Y5([0,1])}}function j5(e){var t=this.option.visual;return t[Math.round(wU(e,[0,1],[0,t.length-1],!0))]||{}}function q5(e){return function(t,n,r){r(e,this.mapValueToVisual(t))}}function X5(e){var t=this.option.visual;return t[this.option.loop&&e!==W5?e%t.length:e]}function K5(){return this.option.visual[0]}function Y5(e){return{linear:function(t){return wU(t,e,this.option.visual,!0)},category:X5,piecewise:function(t,n){var r=Z5.call(this,n);return null==r&&(r=wU(t,e,this.option.visual,!0)),r},fixed:K5}}function Z5(e){var t=this.option,n=t.pieceList;if(t.hasSpecialVisual){var r=n[U5.findPieceIndex(e,n)];if(r&&r.visual)return r.visual[this.type]}}function Q5(e,t){return e.visual=t,"color"===e.type&&(e.parsedVisual=KL(t,(function(e){var t=KB(e);return t||[0,0,0,1]}))),t}var $5={linear:function(e){return wU(e,this.option.dataExtent,[0,1],!0)},piecewise:function(e){var t=this.option.pieceList,n=U5.findPieceIndex(e,t,!0);if(null!=n)return wU(n,[0,t.length-1],[0,1],!0)},category:function(e){var t=this.option.categories?this.option.categoryMap[e]:e;return null==t?W5:t},fixed:CP};function J5(e,t,n){return e?t<=n:t<n}var e6=U5,t6=XL;function n6(e){if(e)for(var t in e)if(e.hasOwnProperty(t))return!0}function r6(e,t,n){var r={};return t6(t,(function(t){var a=r[t]=function(){var e=function(){};return e.prototype.__hidden=e.prototype,new e}();t6(e[t],(function(e,r){if(e6.isValidType(r)){var i={type:r,visual:e};n&&n(i,t),a[r]=new e6(i),"opacity"===r&&((i=VL(i)).type="colorAlpha",a.__hidden.__alphaForOpacity=new e6(i))}}))})),r}var a6=e6.mapVisual,i6=e6.eachVisual,o6=eP,s6=XL,u6=IU,l6=wU,c6=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.type=t.type,n.stateList=["inRange","outOfRange"],n.replacableOptionKeys=["inRange","outOfRange","target","controller","color"],n.layoutMode={type:"box",ignoreSize:!0},n.dataBound=[-1/0,1/0],n.targetVisuals={},n.controllerVisuals={},n}return wL(t,e),t.prototype.init=function(e,t,n){this.mergeDefaultAndTheme(e,n)},t.prototype.optionUpdated=function(e,t){var n=this.option;!t&&function(e,t,n){var r;XL(n,(function(e){t.hasOwnProperty(e)&&n6(t[e])&&(r=!0)})),r&&XL(n,(function(n){t.hasOwnProperty(n)&&n6(t[n])?e[n]=VL(t[n]):delete e[n]}))}(n,e,this.replacableOptionKeys),this.textStyleModel=this.getModel("textStyle"),this.resetItemSize(),this.completeVisualOption()},t.prototype.resetVisual=function(e){var t=this.stateList;e=$L(e,this),this.controllerVisuals=r6(this.option.controller,t,e),this.targetVisuals=r6(this.option.target,t,e)},t.prototype.getItemSymbol=function(){return null},t.prototype.getTargetSeriesIndices=function(){var e=this.option.seriesIndex,t=[];return null==e||"all"===e?this.ecModel.eachSeries((function(e,n){t.push(n)})):t=UU(e),t},t.prototype.eachTargetSeries=function(e,t){XL(this.getTargetSeriesIndices(),(function(n){var r=this.ecModel.getSeriesByIndex(n);r&&e.call(t,r)}),this)},t.prototype.isTargetSeries=function(e){var t=!1;return this.eachTargetSeries((function(n){n===e&&(t=!0)})),t},t.prototype.formatValueText=function(e,t,n){var r,a=this.option,i=a.precision,o=this.dataBound,s=a.formatter;n=n||["<",">"],eP(e)&&(e=e.slice(),r=!0);var u=t?e:r?[l(e[0]),l(e[1])]:l(e);return nP(s)?s.replace("{value}",r?u[0]:u).replace("{value2}",r?u[1]:u):tP(s)?r?s(e[0],e[1]):s(e):r?e[0]===o[0]?n[0]+" "+u[1]:e[1]===o[1]?n[1]+" "+u[0]:u[0]+" - "+u[1]:u;function l(e){return e===o[0]?"min":e===o[1]?"max":(+e).toFixed(Math.min(i,20))}},t.prototype.resetExtent=function(){var e=this.option,t=u6([e.min,e.max]);this._dataExtent=t},t.prototype.getDataDimensionIndex=function(e){var t=this.option.dimension;if(null!=t)return e.getDimensionIndex(t);for(var n=e.dimensions,r=n.length-1;r>=0;r--){var a=n[r],i=e.getDimensionInfo(a);if(!i.isCalculationCoord)return i.storeDimIndex}},t.prototype.getExtent=function(){return this._dataExtent.slice()},t.prototype.completeVisualOption=function(){var e=this.ecModel,t=this.option,n={inRange:t.inRange,outOfRange:t.outOfRange},r=t.target||(t.target={}),a=t.controller||(t.controller={});WL(r,n),WL(a,n);var i=this.isCategory();function o(n){o6(t.color)&&!n.inRange&&(n.inRange={color:t.color.slice().reverse()}),n.inRange=n.inRange||{color:e.get("gradientColor")}}o.call(this,r),o.call(this,a),function(e,t,n){var r=e[t],a=e[n];r&&!a&&(a=e[n]={},s6(r,(function(e,t){if(e6.isValidType(t)){var n=z5.get(t,"inactive",i);null!=n&&(a[t]=n,"color"!==t||a.hasOwnProperty("opacity")||a.hasOwnProperty("colorAlpha")||(a.opacity=[0,0]))}})))}.call(this,r,"inRange","outOfRange"),function(e){var t=(e.inRange||{}).symbol||(e.outOfRange||{}).symbol,n=(e.inRange||{}).symbolSize||(e.outOfRange||{}).symbolSize,r=this.get("inactiveColor"),a=this.getItemSymbol()||"roundRect";s6(this.stateList,(function(o){var s=this.itemSize,u=e[o];u||(u=e[o]={color:i?r:[r]}),null==u.symbol&&(u.symbol=t&&VL(t)||(i?a:[a])),null==u.symbolSize&&(u.symbolSize=n&&VL(n)||(i?s[0]:[s[0],s[0]])),u.symbol=a6(u.symbol,(function(e){return"none"===e?a:e}));var l=u.symbolSize;if(null!=l){var c=-1/0;i6(l,(function(e){e>c&&(c=e)})),u.symbolSize=a6(l,(function(e){return l6(e,[0,c],[0,s[0]],!0)}))}}),this)}.call(this,a)},t.prototype.resetItemSize=function(){this.itemSize=[parseFloat(this.get("itemWidth")),parseFloat(this.get("itemHeight"))]},t.prototype.isCategory=function(){return!!this.option.categories},t.prototype.setSelected=function(e){},t.prototype.getSelected=function(){return null},t.prototype.getValueState=function(e){return null},t.prototype.getVisualMeta=function(e){return null},t.type="visualMap",t.dependencies=["series"],t.defaultOption={show:!0,z:4,seriesIndex:"all",min:0,max:200,left:0,right:null,top:null,bottom:0,itemWidth:null,itemHeight:null,inverse:!1,orient:"vertical",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",contentColor:"#5793f3",inactiveColor:"#aaa",borderWidth:0,padding:5,textGap:10,precision:0,textStyle:{color:"#333"}},t}(IX),h6=c6,p6=[20,140],f6=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.type=t.type,n}return wL(t,e),t.prototype.optionUpdated=function(t,n){e.prototype.optionUpdated.apply(this,arguments),this.resetExtent(),this.resetVisual((function(e){e.mappingMethod="linear",e.dataExtent=this.getExtent()})),this._resetRange()},t.prototype.resetItemSize=function(){e.prototype.resetItemSize.apply(this,arguments);var t=this.itemSize;(null==t[0]||isNaN(t[0]))&&(t[0]=p6[0]),(null==t[1]||isNaN(t[1]))&&(t[1]=p6[1])},t.prototype._resetRange=function(){var e=this.getExtent(),t=this.option.range;!t||t.auto?(e.auto=1,this.option.range=e):eP(t)&&(t[0]>t[1]&&t.reverse(),t[0]=Math.max(t[0],e[0]),t[1]=Math.min(t[1],e[1]))},t.prototype.completeVisualOption=function(){e.prototype.completeVisualOption.apply(this,arguments),XL(this.stateList,(function(e){var t=this.option.controller[e].symbolSize;t&&t[0]!==t[1]&&(t[0]=t[1]/3)}),this)},t.prototype.setSelected=function(e){this.option.range=e.slice(),this._resetRange()},t.prototype.getSelected=function(){var e=this.getExtent(),t=IU((this.get("range")||[]).slice());return t[0]>e[1]&&(t[0]=e[1]),t[1]>e[1]&&(t[1]=e[1]),t[0]<e[0]&&(t[0]=e[0]),t[1]<e[0]&&(t[1]=e[0]),t},t.prototype.getValueState=function(e){var t=this.option.range,n=this.getExtent();return(t[0]<=n[0]||t[0]<=e)&&(t[1]>=n[1]||e<=t[1])?"inRange":"outOfRange"},t.prototype.findTargetDataIndices=function(e){var t=[];return this.eachTargetSeries((function(n){var r=[],a=n.getData();a.each(this.getDataDimensionIndex(a),(function(t,n){e[0]<=t&&t<=e[1]&&r.push(n)}),this),t.push({seriesId:n.id,dataIndex:r})}),this),t},t.prototype.getVisualMeta=function(e){var t=d6(this,"outOfRange",this.getExtent()),n=d6(this,"inRange",this.option.range.slice()),r=[];function a(t,n){r.push({value:t,color:e(t,n)})}for(var i=0,o=0,s=n.length,u=t.length;o<u&&(!n.length||t[o]<=n[0]);o++)t[o]<n[i]&&a(t[o],"outOfRange");for(var l=1;i<s;i++,l=0)l&&r.length&&a(n[i],"outOfRange"),a(n[i],"inRange");for(l=1;o<u;o++)(!n.length||n[n.length-1]<t[o])&&(l&&(r.length&&a(r[r.length-1].value,"outOfRange"),l=0),a(t[o],"outOfRange"));var c=r.length;return{stops:r,outerColors:[c?r[0].color:"transparent",c?r[c-1].color:"transparent"]}},t.type="visualMap.continuous",t.defaultOption=yq(h6.defaultOption,{align:"auto",calculable:!1,hoverLink:!0,realtime:!0,handleIcon:"path://M-11.39,9.77h0a3.5,3.5,0,0,1-3.5,3.5h-22a3.5,3.5,0,0,1-3.5-3.5h0a3.5,3.5,0,0,1,3.5-3.5h22A3.5,3.5,0,0,1-11.39,9.77Z",handleSize:"120%",handleStyle:{borderColor:"#fff",borderWidth:1},indicatorIcon:"circle",indicatorSize:"50%",indicatorStyle:{borderColor:"#fff",borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0,0,0,0.2)"}}),t}(h6);function d6(e,t,n){if(n[0]===n[1])return n.slice();for(var r=(n[1]-n[0])/200,a=n[0],i=[],o=0;o<=200&&a<n[1];o++)i.push(a),a+=r;return i.push(n[1]),i}var v6=f6,m6=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.type=t.type,n.autoPositionValues={left:1,right:1,top:1,bottom:1},n}return wL(t,e),t.prototype.init=function(e,t){this.ecModel=e,this.api=t},t.prototype.render=function(e,t,n,r){this.visualMapModel=e,!1!==e.get("show")?this.doRender(e,t,n,r):this.group.removeAll()},t.prototype.renderBackground=function(e){var t=this.visualMapModel,n=aX(t.get("padding")||0),r=e.getBoundingRect();e.add(new iU({z2:-1,silent:!0,shape:{x:r.x-n[3],y:r.y-n[0],width:r.width+n[3]+n[1],height:r.height+n[0]+n[2]},style:{fill:t.get("backgroundColor"),stroke:t.get("borderColor"),lineWidth:t.get("borderWidth")}}))},t.prototype.getControllerVisual=function(e,t,n){var r=(n=n||{}).forceState,a=this.visualMapModel,i={};if("color"===t){var o=a.get("contentColor");i.color=o}function s(e){return i[e]}function u(e,t){i[e]=t}var l=a.controllerVisuals[r||a.getValueState(e)];return XL(e6.prepareVisualTypes(l),(function(r){var a=l[r];n.convertOpacityToAlpha&&"opacity"===r&&(r="colorAlpha",a=l.__alphaForOpacity),e6.dependsOn(r,t)&&a&&a.applyVisual(e,s,u)})),i[t]},t.prototype.positionGroup=function(e){var t=this.visualMapModel,n=this.api;!function(e,t,n,r,a,i){var o,s=!a||!a.hv||a.hv[0],u=!a||!a.hv||a.hv[1],l=a&&a.boundingMode||"all";if((i=i||e).x=e.x,i.y=e.y,!s&&!u)return!1;if("raw"===l)o="group"===e.type?new gz(0,0,+t.width||0,+t.height||0):e.getBoundingRect();else if(o=e.getBoundingRect(),e.needLocalTransform()){var c=e.getLocalTransform();(o=o.clone()).applyTransform(c)}var h=bX(HL({width:o.width,height:o.height},t),n,r),p=s?h.x-o.x:0,f=u?h.y-o.y:0;"raw"===l?(i.x=p,i.y=f):(i.x+=p,i.y+=f),i===e&&e.markRedraw()}(e,t.getBoxLayoutParams(),{width:n.getWidth(),height:n.getHeight()})},t.prototype.doRender=function(e,t,n,r){},t.type="visualMap",t}(OQ),g6=m6;function y6(e,t){var n=e[t]-e[1-t];return{span:Math.abs(n),sign:n>0?-1:n<0?1:t?-1:1}}function b6(e,t){return Math.min(null!=t[1]?t[1]:1/0,Math.max(null!=t[0]?t[0]:-1/0,e))}var x6=[["left","right","width"],["top","bottom","height"]];function k6(e,t,n){var r=e.option,a=r.align;if(null!=a&&"auto"!==a)return a;for(var i={width:t.getWidth(),height:t.getHeight()},o="horizontal"===r.orient?1:0,s=x6[o],u=[0,null,10],l={},c=0;c<3;c++)l[x6[1-o][c]]=u[c],l[s[c]]=2===c?n[0]:r[s[c]];var h=[["x","width",3],["y","height",0]][o],p=bX(l,i,r.padding);return s[(p.margin[h[2]]||0)+p[h[0]]+.5*p[h[1]]<.5*i[h[1]]?0:1]}function w6(e,t){return XL(e||[],(function(e){null!=e.dataIndex&&(e.dataIndexInside=e.dataIndex,e.dataIndex=null),e.highlightKey="visualMap"+(t?t.componentIndex:"")})),e}var _6=wU,S6=XL,I6=Math.min,C6=Math.max,T6=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.type=t.type,n._shapes={},n._dataInterval=[],n._handleEnds=[],n._hoverLinkDataIndices=[],n}return wL(t,e),t.prototype.doRender=function(e,t,n,r){this._api=n,r&&"selectDataRange"===r.type&&r.from===this.uid||this._buildView()},t.prototype._buildView=function(){this.group.removeAll();var e=this.visualMapModel,t=this.group;this._orient=e.get("orient"),this._useHandle=e.get("calculable"),this._resetInterval(),this._renderBar(t);var n=e.get("text");this._renderEndsText(t,n,0),this._renderEndsText(t,n,1),this._updateView(!0),this.renderBackground(t),this._updateView(),this._enableHoverLinkToSeries(),this._enableHoverLinkFromSeries(),this.positionGroup(t)},t.prototype._renderEndsText=function(e,t,n){if(t){var r=t[1-n];r=null!=r?r+"":"";var a=this.visualMapModel,i=a.get("textGap"),o=a.itemSize,s=this._shapes.mainGroup,u=this._applyTransform([o[0]/2,0===n?-i:o[1]+i],s),l=this._applyTransform(0===n?"bottom":"top",s),c=this._orient,h=this.visualMapModel.textStyleModel;this.group.add(new xU({style:uG(h,{x:u[0],y:u[1],verticalAlign:"horizontal"===c?"middle":l,align:"horizontal"===c?l:"center",text:r})}))}},t.prototype._renderBar=function(e){var t=this.visualMapModel,n=this._shapes,r=t.itemSize,a=this._orient,i=this._useHandle,o=k6(t,this.api,r),s=n.mainGroup=this._createBarGroup(o),u=new zK;s.add(u),u.add(n.outOfRange=N6()),u.add(n.inRange=N6(null,i?M6(this._orient):null,$L(this._dragHandle,this,"all",!1),$L(this._dragHandle,this,"all",!0))),u.setClipPath(new iU({shape:{x:0,y:0,width:r[0],height:r[1],r:3}}));var l=t.textStyleModel.getTextRect("\u56fd"),c=C6(l.width,l.height);i&&(n.handleThumbs=[],n.handleLabels=[],n.handleLabelPoints=[],this._createHandle(t,s,0,r,c,a),this._createHandle(t,s,1,r,c,a)),this._createIndicator(t,s,r,c,a),e.add(s)},t.prototype._createHandle=function(e,t,n,r,a,i){var o=$L(this._dragHandle,this,n,!1),s=$L(this._dragHandle,this,n,!0),u=Iz(e.get("handleSize"),r[0]),l=LZ(e.get("handleIcon"),-u/2,-u/2,u,u,null,!0),c=M6(this._orient);l.attr({cursor:c,draggable:!0,drift:o,ondragend:s,onmousemove:function(e){o$(e.event)}}),l.x=r[0]/2,l.useStyle(e.getModel("handleStyle").getItemStyle()),l.setStyle({strokeNoScale:!0,strokeFirst:!0}),l.style.lineWidth*=2,l.ensureState("emphasis").style=e.getModel(["emphasis","handleStyle"]).getItemStyle(),JH(l,!0),t.add(l);var h=this.visualMapModel.textStyleModel,p=new xU({cursor:c,draggable:!0,drift:o,onmousemove:function(e){o$(e.event)},ondragend:s,style:uG(h,{x:0,y:0,text:""})});p.ensureState("blur").style={opacity:.1},p.stateTransition={duration:200},this.group.add(p);var f=[u,0],d=this._shapes;d.handleThumbs[n]=l,d.handleLabelPoints[n]=f,d.handleLabels[n]=p},t.prototype._createIndicator=function(e,t,n,r,a){var i=Iz(e.get("indicatorSize"),n[0]),o=LZ(e.get("indicatorIcon"),-i/2,-i/2,i,i,null,!0);o.attr({cursor:"move",invisible:!0,silent:!0,x:n[0]/2});var s=e.getModel("indicatorStyle").getItemStyle();if(o instanceof QW){var u=o.style;o.useStyle(UL({image:u.image,x:u.x,y:u.y,width:u.width,height:u.height},s))}else o.useStyle(s);t.add(o);var l=this.visualMapModel.textStyleModel,c=new xU({silent:!0,invisible:!0,style:uG(l,{x:0,y:0,text:""})});this.group.add(c);var h=[("horizontal"===a?r/2:6)+n[0]/2,0],p=this._shapes;p.indicator=o,p.indicatorLabel=c,p.indicatorLabelPoint=h,this._firstShowIndicator=!0},t.prototype._dragHandle=function(e,t,n,r){if(this._useHandle){if(this._dragging=!t,!t){var a=this._applyTransform([n,r],this._shapes.mainGroup,!0);this._updateInterval(e,a[1]),this._hideIndicator(),this._updateView()}t===!this.visualMapModel.get("realtime")&&this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:this._dataInterval.slice()}),t?!this._hovering&&this._clearHoverLinkToSeries():E6(this.visualMapModel)&&this._doHoverLinkToSeries(this._handleEnds[e],!1)}},t.prototype._resetInterval=function(){var e=this.visualMapModel,t=this._dataInterval=e.getSelected(),n=e.getExtent(),r=[0,e.itemSize[1]];this._handleEnds=[_6(t[0],n,r,!0),_6(t[1],n,r,!0)]},t.prototype._updateInterval=function(e,t){t=t||0;var n=this.visualMapModel,r=this._handleEnds,a=[0,n.itemSize[1]];!function(e,t,n,r,a,i){e=e||0;var o=n[1]-n[0];if(null!=a&&(a=b6(a,[0,o])),null!=i&&(i=Math.max(i,null!=a?a:0)),"all"===r){var s=Math.abs(t[1]-t[0]);s=b6(s,[0,o]),a=i=b6(s,[a,i]),r=0}t[0]=b6(t[0],n),t[1]=b6(t[1],n);var u=y6(t,r);t[r]+=e;var l,c=a||0,h=n.slice();u.sign<0?h[0]+=c:h[1]-=c,t[r]=b6(t[r],h),l=y6(t,r),null!=a&&(l.sign!==u.sign||l.span<a)&&(t[1-r]=t[r]+u.sign*a),l=y6(t,r),null!=i&&l.span>i&&(t[1-r]=t[r]+l.sign*i)}(t,r,a,e,0);var i=n.getExtent();this._dataInterval=[_6(r[0],a,i,!0),_6(r[1],a,i,!0)]},t.prototype._updateView=function(e){var t=this.visualMapModel,n=t.getExtent(),r=this._shapes,a=[0,t.itemSize[1]],i=e?a:this._handleEnds,o=this._createBarVisual(this._dataInterval,n,i,"inRange"),s=this._createBarVisual(n,n,a,"outOfRange");r.inRange.setStyle({fill:o.barColor}).setShape("points",o.barPoints),r.outOfRange.setStyle({fill:s.barColor}).setShape("points",s.barPoints),this._updateHandle(i,o)},t.prototype._createBarVisual=function(e,t,n,r){var a={forceState:r,convertOpacityToAlpha:!0},i=this._makeColorGradient(e,a),o=[this.getControllerVisual(e[0],"symbolSize",a),this.getControllerVisual(e[1],"symbolSize",a)],s=this._createBarPoints(n,o);return{barColor:new DY(0,0,0,1,i),barPoints:s,handlesColor:[i[0].color,i[i.length-1].color]}},t.prototype._makeColorGradient=function(e,t){var n=[],r=(e[1]-e[0])/100;n.push({color:this.getControllerVisual(e[0],"color",t),offset:0});for(var a=1;a<100;a++){var i=e[0]+r*a;if(i>e[1])break;n.push({color:this.getControllerVisual(i,"color",t),offset:a/100})}return n.push({color:this.getControllerVisual(e[1],"color",t),offset:1}),n},t.prototype._createBarPoints=function(e,t){var n=this.visualMapModel.itemSize;return[[n[0]-t[0],e[0]],[n[0],e[0]],[n[0],e[1]],[n[0]-t[1],e[1]]]},t.prototype._createBarGroup=function(e){var t=this._orient,n=this.visualMapModel.get("inverse");return new zK("horizontal"!==t||n?"horizontal"===t&&n?{scaleX:"bottom"===e?-1:1,rotation:-Math.PI/2}:"vertical"!==t||n?{scaleX:"left"===e?1:-1}:{scaleX:"left"===e?1:-1,scaleY:-1}:{scaleX:"bottom"===e?1:-1,rotation:Math.PI/2})},t.prototype._updateHandle=function(e,t){if(this._useHandle){var n=this._shapes,r=this.visualMapModel,a=n.handleThumbs,i=n.handleLabels,o=r.itemSize,s=r.getExtent();S6([0,1],(function(u){var l=a[u];l.setStyle("fill",t.handlesColor[u]),l.y=e[u];var c=_6(e[u],[0,o[1]],s,!0),h=this.getControllerVisual(c,"symbolSize");l.scaleX=l.scaleY=h/o[0],l.x=o[0]-h/2;var p=vZ(n.handleLabelPoints[u],dZ(l,this.group));i[u].setStyle({x:p[0],y:p[1],text:r.formatValueText(this._dataInterval[u]),verticalAlign:"middle",align:"vertical"===this._orient?this._applyTransform("left",n.mainGroup):"center"})}),this)}},t.prototype._showIndicator=function(e,t,n,r){var a=this.visualMapModel,i=a.getExtent(),o=a.itemSize,s=[0,o[1]],u=this._shapes,l=u.indicator;if(l){l.attr("invisible",!1);var c=this.getControllerVisual(e,"color",{convertOpacityToAlpha:!0}),h=this.getControllerVisual(e,"symbolSize"),p=_6(e,i,s,!0),f=o[0]-h/2,d={x:l.x,y:l.y};l.y=p,l.x=f;var v=vZ(u.indicatorLabelPoint,dZ(l,this.group)),m=u.indicatorLabel;m.attr("invisible",!1);var g=this._applyTransform("left",u.mainGroup),y="horizontal"===this._orient;m.setStyle({text:(n||"")+a.formatValueText(t),verticalAlign:y?g:"middle",align:y?"center":g});var b={x:f,y:p,style:{fill:c}},x={style:{x:v[0],y:v[1]}};if(a.ecModel.isAnimationEnabled()&&!this._firstShowIndicator){var k={duration:100,easing:"cubicInOut",additive:!0};l.x=d.x,l.y=d.y,l.animateTo(b,k),m.animateTo(x,k)}else l.attr(b),m.attr(x);this._firstShowIndicator=!1;var w=this._shapes.handleLabels;if(w)for(var _=0;_<w.length;_++)this._api.enterBlur(w[_])}},t.prototype._enableHoverLinkToSeries=function(){var e=this;this._shapes.mainGroup.on("mousemove",(function(t){if(e._hovering=!0,!e._dragging){var n=e.visualMapModel.itemSize,r=e._applyTransform([t.offsetX,t.offsetY],e._shapes.mainGroup,!0,!0);r[1]=I6(C6(0,r[1]),n[1]),e._doHoverLinkToSeries(r[1],0<=r[0]&&r[0]<=n[0])}})).on("mouseout",(function(){e._hovering=!1,!e._dragging&&e._clearHoverLinkToSeries()}))},t.prototype._enableHoverLinkFromSeries=function(){var e=this.api.getZr();this.visualMapModel.option.hoverLink?(e.on("mouseover",this._hoverLinkFromSeriesMouseOver,this),e.on("mouseout",this._hideIndicator,this)):this._clearHoverLinkFromSeries()},t.prototype._doHoverLinkToSeries=function(e,t){var n=this.visualMapModel,r=n.itemSize;if(n.option.hoverLink){var a=[0,r[1]],i=n.getExtent();e=I6(C6(a[0],e),a[1]);var o=function(e,t,n){var r=6,a=e.get("hoverLinkDataSize");a&&(r=_6(a,t,n,!0)/2);return r}(n,i,a),s=[e-o,e+o],u=_6(e,a,i,!0),l=[_6(s[0],a,i,!0),_6(s[1],a,i,!0)];s[0]<a[0]&&(l[0]=-1/0),s[1]>a[1]&&(l[1]=1/0),t&&(l[0]===-1/0?this._showIndicator(u,l[1],"< ",o):l[1]===1/0?this._showIndicator(u,l[0],"> ",o):this._showIndicator(u,u,"\u2248 ",o));var c=this._hoverLinkDataIndices,h=[];(t||E6(n))&&(h=this._hoverLinkDataIndices=n.findTargetDataIndices(l));var p=function(e,t){var n={},r={};return a(e||[],n),a(t||[],r,n),[i(n),i(r)];function a(e,t,n){for(var r=0,a=e.length;r<a;r++){var i=ZU(e[r].seriesId,null);if(null==i)return;for(var o=UU(e[r].dataIndex),s=n&&n[i],u=0,l=o.length;u<l;u++){var c=o[u];s&&s[c]?s[c]=null:(t[i]||(t[i]={}))[c]=1}}}function i(e,t){var n=[];for(var r in e)if(e.hasOwnProperty(r)&&null!=e[r])if(t)n.push(+r);else{var a=i(e[r],!0);a.length&&n.push({seriesId:r,dataIndex:a})}return n}}(c,h);this._dispatchHighDown("downplay",w6(p[0],n)),this._dispatchHighDown("highlight",w6(p[1],n))}},t.prototype._hoverLinkFromSeriesMouseOver=function(e){var t=e.target,n=this.visualMapModel;if(t&&null!=sH(t).dataIndex){var r=sH(t),a=this.ecModel.getSeriesByIndex(r.seriesIndex);if(n.isTargetSeries(a)){var i=a.getData(r.dataType),o=i.getStore().get(n.getDataDimensionIndex(i),r.dataIndex);isNaN(o)||this._showIndicator(o,o)}}},t.prototype._hideIndicator=function(){var e=this._shapes;e.indicator&&e.indicator.attr("invisible",!0),e.indicatorLabel&&e.indicatorLabel.attr("invisible",!0);var t=this._shapes.handleLabels;if(t)for(var n=0;n<t.length;n++)this._api.leaveBlur(t[n])},t.prototype._clearHoverLinkToSeries=function(){this._hideIndicator();var e=this._hoverLinkDataIndices;this._dispatchHighDown("downplay",w6(e,this.visualMapModel)),e.length=0},t.prototype._clearHoverLinkFromSeries=function(){this._hideIndicator();var e=this.api.getZr();e.off("mouseover",this._hoverLinkFromSeriesMouseOver),e.off("mouseout",this._hideIndicator)},t.prototype._applyTransform=function(e,t,n,r){var a=dZ(t,r?null:this.group);return eP(e)?vZ(e,a,n):mZ(e,a,n)},t.prototype._dispatchHighDown=function(e,t){t&&t.length&&this.api.dispatchAction({type:e,batch:t})},t.prototype.dispose=function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()},t.prototype.remove=function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()},t.type="visualMap.continuous",t}(g6);function N6(e,t,n,r){return new fY({shape:{points:e},draggable:!!n,cursor:t,drift:n,onmousemove:function(e){o$(e.event)},ondragend:r})}function E6(e){var t=e.get("hoverLinkOnHandle");return!!(null==t?e.get("realtime"):t)}function M6(e){return"vertical"===e?"ns-resize":"ew-resize"}var A6=T6,D6={type:"selectDataRange",event:"dataRangeSelected",update:"update"},R6=function(e,t){t.eachComponent({mainType:"visualMap",query:e},(function(t){t.setSelected(e.selected)}))},O6=[{createOnAllSeries:!0,reset:function(e,t){var n=[];return t.eachComponent("visualMap",(function(t){var r=e.pipelineContext;!t.isTargetSeries(e)||r&&r.large||n.push(function(e,t,n,r){var a={};return XL(e,(function(e){var n=e6.prepareVisualTypes(t[e]);a[e]=n})),{progress:function(e,i){var o,s;function u(e){return R2(i,s,e)}function l(e,t){!function(e,t,n,r){switch(n){case"color":e.ensureUniqueItemVisual(t,"style")[e.getVisual("drawType")]=r,e.setItemVisual(t,"colorFromPalette",!1);break;case"opacity":e.ensureUniqueItemVisual(t,"style").opacity=r;break;case"symbol":case"symbolSize":case"liftZ":e.setItemVisual(t,n,r)}}(i,s,e,t)}null!=r&&(o=i.getDimensionIndex(r));for(var c=i.getStore();null!=(s=e.next());){var h=i.getRawDataItem(s);if(!h||!1!==h.visualMap)for(var p=null!=r?c.get(o,s):s,f=n(p),d=t[f],v=a[f],m=0,g=v.length;m<g;m++){var y=v[m];d[y]&&d[y].applyVisual(p,u,l)}}}}}(t.stateList,t.targetVisuals,$L(t.getValueState,t),t.getDataDimensionIndex(e.getData())))})),n}},{createOnAllSeries:!0,reset:function(e,t){var n=e.getData(),r=[];t.eachComponent("visualMap",(function(t){if(t.isTargetSeries(e)){var a=t.getVisualMeta($L(F6,null,e,t))||{stops:[],outerColors:[]},i=t.getDataDimensionIndex(n);i>=0&&(a.dimension=i,r.push(a))}})),e.getData().setVisual("visualMeta",r)}}];function F6(e,t,n,r){for(var a=t.targetVisuals[r],i=e6.prepareVisualTypes(a),o={color:O2(e.getData(),"color")},s=0,u=i.length;s<u;s++){var l=i[s],c=a["opacity"===l?"__alphaForOpacity":l];c&&c.applyVisual(n,h,p)}return o.color;function h(e){return o[e]}function p(e,t){o[e]=t}}var L6=XL;function P6(e){var t=e&&e.visualMap;eP(t)||(t=t?[t]:[]),L6(t,(function(e){if(e){z6(e,"splitList")&&!z6(e,"pieces")&&(e.pieces=e.splitList,delete e.splitList);var t=e.pieces;t&&eP(t)&&L6(t,(function(e){iP(e)&&(z6(e,"start")&&!z6(e,"min")&&(e.min=e.start),z6(e,"end")&&!z6(e,"max")&&(e.max=e.end))}))}}))}function z6(e,t){return e&&e.hasOwnProperty&&e.hasOwnProperty(t)}var B6=!1;function V6(e){B6||(B6=!0,e.registerSubTypeDefaulter("visualMap",(function(e){return e.categories||(e.pieces?e.pieces.length>0:e.splitNumber>0)&&!e.calculable?"piecewise":"continuous"})),e.registerAction(D6,R6),XL(O6,(function(t){e.registerVisual(e.PRIORITY.VISUAL.COMPONENT,t)})),e.registerPreprocessor(P6))}function W6(e){e.registerComponentModel(v6),e.registerComponentView(A6),V6(e)}var U6=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.type=t.type,n._pieceList=[],n}return wL(t,e),t.prototype.optionUpdated=function(t,n){e.prototype.optionUpdated.apply(this,arguments),this.resetExtent();var r=this._mode=this._determineMode();this._pieceList=[],H6[this._mode].call(this,this._pieceList),this._resetSelected(t,n);var a=this.option.categories;this.resetVisual((function(e,t){"categories"===r?(e.mappingMethod="category",e.categories=VL(a)):(e.dataExtent=this.getExtent(),e.mappingMethod="piecewise",e.pieceList=KL(this._pieceList,(function(e){return e=VL(e),"inRange"!==t&&(e.visual=null),e})))}))},t.prototype.completeVisualOption=function(){var t=this.option,n={},r=e6.listVisualTypes(),a=this.isCategory();function i(e,t,n){return e&&e[t]&&e[t].hasOwnProperty(n)}XL(t.pieces,(function(e){XL(r,(function(t){e.hasOwnProperty(t)&&(n[t]=1)}))})),XL(n,(function(e,n){var r=!1;XL(this.stateList,(function(e){r=r||i(t,e,n)||i(t.target,e,n)}),this),!r&&XL(this.stateList,(function(e){(t[e]||(t[e]={}))[n]=z5.get(n,"inRange"===e?"active":"inactive",a)}))}),this),e.prototype.completeVisualOption.apply(this,arguments)},t.prototype._resetSelected=function(e,t){var n=this.option,r=this._pieceList,a=(t?n:e).selected||{};if(n.selected=a,XL(r,(function(e,t){var n=this.getSelectedMapKey(e);a.hasOwnProperty(n)||(a[n]=!0)}),this),"single"===n.selectedMode){var i=!1;XL(r,(function(e,t){var n=this.getSelectedMapKey(e);a[n]&&(i?a[n]=!1:i=!0)}),this)}},t.prototype.getItemSymbol=function(){return this.get("itemSymbol")},t.prototype.getSelectedMapKey=function(e){return"categories"===this._mode?e.value+"":e.index+""},t.prototype.getPieceList=function(){return this._pieceList},t.prototype._determineMode=function(){var e=this.option;return e.pieces&&e.pieces.length>0?"pieces":this.option.categories?"categories":"splitNumber"},t.prototype.setSelected=function(e){this.option.selected=VL(e)},t.prototype.getValueState=function(e){var t=e6.findPieceIndex(e,this._pieceList);return null!=t&&this.option.selected[this.getSelectedMapKey(this._pieceList[t])]?"inRange":"outOfRange"},t.prototype.findTargetDataIndices=function(e){var t=[],n=this._pieceList;return this.eachTargetSeries((function(r){var a=[],i=r.getData();i.each(this.getDataDimensionIndex(i),(function(t,r){e6.findPieceIndex(t,n)===e&&a.push(r)}),this),t.push({seriesId:r.id,dataIndex:a})}),this),t},t.prototype.getRepresentValue=function(e){var t;if(this.isCategory())t=e.value;else if(null!=e.value)t=e.value;else{var n=e.interval||[];t=n[0]===-1/0&&n[1]===1/0?0:(n[0]+n[1])/2}return t},t.prototype.getVisualMeta=function(e){if(!this.isCategory()){var t=[],n=["",""],r=this,a=this._pieceList.slice();if(a.length){var i=a[0].interval[0];i!==-1/0&&a.unshift({interval:[-1/0,i]}),(i=a[a.length-1].interval[1])!==1/0&&a.push({interval:[i,1/0]})}else a.push({interval:[-1/0,1/0]});var o=-1/0;return XL(a,(function(e){var t=e.interval;t&&(t[0]>o&&s([o,t[0]],"outOfRange"),s(t.slice()),o=t[1])}),this),{stops:t,outerColors:n}}function s(a,i){var o=r.getRepresentValue({interval:a});i||(i=r.getValueState(o));var s=e(o,i);a[0]===-1/0?n[0]=s:a[1]===1/0?n[1]=s:t.push({value:a[0],color:s},{value:a[1],color:s})}},t.type="visualMap.piecewise",t.defaultOption=yq(h6.defaultOption,{selected:null,minOpen:!1,maxOpen:!1,align:"auto",itemWidth:20,itemHeight:14,itemSymbol:"roundRect",pieces:null,categories:null,splitNumber:5,selectedMode:"multiple",itemGap:10,hoverLink:!0}),t}(h6),H6={splitNumber:function(e){var t=this.option,n=Math.min(t.precision,20),r=this.getExtent(),a=t.splitNumber;a=Math.max(parseInt(a,10),1),t.splitNumber=a;for(var i=(r[1]-r[0])/a;+i.toFixed(n)!==i&&n<5;)n++;t.precision=n,i=+i.toFixed(n),t.minOpen&&e.push({interval:[-1/0,r[0]],close:[0,0]});for(var o=0,s=r[0];o<a;s+=i,o++){var u=o===a-1?r[1]:s+i;e.push({interval:[s,u],close:[1,1]})}t.maxOpen&&e.push({interval:[r[1],1/0],close:[0,0]}),OU(e),XL(e,(function(e,t){e.index=t,e.text=this.formatValueText(e.interval)}),this)},categories:function(e){var t=this.option;XL(t.categories,(function(t){e.push({text:this.formatValueText(t,!0),value:t})}),this),G6(t,e)},pieces:function(e){var t=this.option;XL(t.pieces,(function(t,n){iP(t)||(t={value:t});var r={text:"",index:n};if(null!=t.label&&(r.text=t.label),t.hasOwnProperty("value")){var a=r.value=t.value;r.interval=[a,a],r.close=[1,1]}else{for(var i=r.interval=[],o=r.close=[0,0],s=[1,0,1],u=[-1/0,1/0],l=[],c=0;c<2;c++){for(var h=[["gte","gt","min"],["lte","lt","max"]][c],p=0;p<3&&null==i[c];p++)i[c]=t[h[p]],o[c]=s[p],l[c]=2===p;null==i[c]&&(i[c]=u[c])}l[0]&&i[1]===1/0&&(o[0]=0),l[1]&&i[0]===-1/0&&(o[1]=0),i[0]===i[1]&&o[0]&&o[1]&&(r.value=i[0])}r.visual=e6.retrieveVisuals(t),e.push(r)}),this),G6(t,e),OU(e),XL(e,(function(e){var t=e.close,n=[["<","\u2264"][t[1]],[">","\u2265"][t[0]]];e.text=e.text||this.formatValueText(null!=e.value?e.value:e.interval,!1,n)}),this)}};function G6(e,t){var n=e.inverse;("vertical"===e.orient?!n:n)&&t.reverse()}var j6=U6,q6=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.type=t.type,n}return wL(t,e),t.prototype.doRender=function(){var e=this.group;e.removeAll();var t=this.visualMapModel,n=t.get("textGap"),r=t.textStyleModel,a=r.getFont(),i=r.getTextColor(),o=this._getItemAlign(),s=t.itemSize,u=this._getViewData(),l=u.endsText,c=hP(t.get("showLabel",!0),!l);l&&this._renderEndsText(e,l[0],s,c,o),XL(u.viewPieceList,(function(r){var u=r.piece,l=new zK;l.onclick=$L(this._onItemClick,this,u),this._enableHoverLink(l,r.indexInModelPieceList);var h=t.getRepresentValue(u);if(this._createItemSymbol(l,h,[0,0,s[0],s[1]]),c){var p=this.visualMapModel.getValueState(h);l.add(new xU({style:{x:"right"===o?-n:s[0]+n,y:s[1]/2,text:u.text,verticalAlign:"middle",align:o,font:a,fill:i,opacity:"outOfRange"===p?.5:1}}))}e.add(l)}),this),l&&this._renderEndsText(e,l[1],s,c,o),yX(t.get("orient"),e,t.get("itemGap")),this.renderBackground(e),this.positionGroup(e)},t.prototype._enableHoverLink=function(e,t){var n=this;e.on("mouseover",(function(){return r("highlight")})).on("mouseout",(function(){return r("downplay")}));var r=function(e){var r=n.visualMapModel;r.option.hoverLink&&n.api.dispatchAction({type:e,batch:w6(r.findTargetDataIndices(t),r)})}},t.prototype._getItemAlign=function(){var e=this.visualMapModel,t=e.option;if("vertical"===t.orient)return k6(e,this.api,e.itemSize);var n=t.align;return n&&"auto"!==n||(n="left"),n},t.prototype._renderEndsText=function(e,t,n,r,a){if(t){var i=new zK,o=this.visualMapModel.textStyleModel;i.add(new xU({style:uG(o,{x:r?"right"===a?n[0]:0:n[0]/2,y:n[1]/2,verticalAlign:"middle",align:r?a:"center",text:t})})),e.add(i)}},t.prototype._getViewData=function(){var e=this.visualMapModel,t=KL(e.getPieceList(),(function(e,t){return{piece:e,indexInModelPieceList:t}})),n=e.get("text"),r=e.get("orient"),a=e.get("inverse");return("horizontal"===r?a:!a)?t.reverse():n&&(n=n.slice().reverse()),{viewPieceList:t,endsText:n}},t.prototype._createItemSymbol=function(e,t,n){e.add(LZ(this.getControllerVisual(t,"symbol"),n[0],n[1],n[2],n[3],this.getControllerVisual(t,"color")))},t.prototype._onItemClick=function(e){var t=this.visualMapModel,n=t.option,r=VL(n.selected),a=t.getSelectedMapKey(e);"single"===n.selectedMode?(r[a]=!0,XL(r,(function(e,t){r[t]=t===a}))):r[a]=!r[a],this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:r})},t.type="visualMap.piecewise",t}(g6),X6=q6;function K6(e){e.registerComponentModel(j6),e.registerComponentView(X6),V6(e)}var Y6=wW.CMD;function Z6(e,t){return Math.abs(e-t)<1e-5}function Q6(e){var t,n,r,a,i,o=e.data,s=e.len(),u=[],l=0,c=0,h=0,p=0;function f(e,n){t&&t.length>2&&u.push(t),t=[e,n]}function d(e,n,r,a){Z6(e,r)&&Z6(n,a)||t.push(e,n,r,a,r,a)}function v(e,n,r,a,i,o){var s=Math.abs(n-e),u=4*Math.tan(s/4)/3,l=n<e?-1:1,c=Math.cos(e),h=Math.sin(e),p=Math.cos(n),f=Math.sin(n),d=c*i+r,v=h*o+a,m=p*i+r,g=f*o+a,y=i*u*l,b=o*u*l;t.push(d-y*h,v+b*c,m+y*f,g-b*p,m,g)}for(var m=0;m<s;){var g=o[m++],y=1===m;switch(y&&(h=l=o[m],p=c=o[m+1],g!==Y6.L&&g!==Y6.C&&g!==Y6.Q||(t=[h,p])),g){case Y6.M:l=h=o[m++],c=p=o[m++],f(h,p);break;case Y6.L:d(l,c,n=o[m++],r=o[m++]),l=n,c=r;break;case Y6.C:t.push(o[m++],o[m++],o[m++],o[m++],l=o[m++],c=o[m++]);break;case Y6.Q:n=o[m++],r=o[m++],a=o[m++],i=o[m++],t.push(l+2/3*(n-l),c+2/3*(r-c),a+2/3*(n-a),i+2/3*(r-i),a,i),l=a,c=i;break;case Y6.A:var b=o[m++],x=o[m++],k=o[m++],w=o[m++],_=o[m++],S=o[m++]+_;m+=1;var I=!o[m++];n=Math.cos(_)*k+b,r=Math.sin(_)*w+x,y?f(h=n,p=r):d(l,c,n,r),l=Math.cos(S)*k+b,c=Math.sin(S)*w+x;for(var C=(I?-1:1)*Math.PI/2,T=_;I?T>S:T<S;T+=C){v(T,I?Math.max(T+C,S):Math.min(T+C,S),b,x,k,w)}break;case Y6.R:h=l=o[m++],p=c=o[m++],n=h+o[m++],r=p+o[m++],f(n,p),d(n,p,n,r),d(n,r,h,r),d(h,r,h,p),d(h,p,n,p);break;case Y6.Z:t&&d(l,c,h,p),l=h,c=p}}return t&&t.length>2&&u.push(t),u}function $6(e,t,n,r,a,i,o,s,u,l){if(Z6(e,n)&&Z6(t,r)&&Z6(a,o)&&Z6(i,s))u.push(o,s);else{var c=2/l,h=c*c,p=o-e,f=s-t,d=Math.sqrt(p*p+f*f);p/=d,f/=d;var v=n-e,m=r-t,g=a-o,y=i-s,b=v*v+m*m,x=g*g+y*y;if(b<h&&x<h)u.push(o,s);else{var k=p*v+f*m,w=-p*g-f*y;if(b-k*k<h&&k>=0&&x-w*w<h&&w>=0)u.push(o,s);else{var _=[],S=[];CB(e,n,a,o,.5,_),CB(t,r,i,s,.5,S),$6(_[0],S[0],_[1],S[1],_[2],S[2],_[3],S[3],u,l),$6(_[4],S[4],_[5],S[5],_[6],S[6],_[7],S[7],u,l)}}}}function J6(e,t,n){var r=e[t],a=e[1-t],i=Math.abs(r/a),o=Math.ceil(Math.sqrt(i*n)),s=Math.floor(n/o);0===s&&(s=1,o=n);for(var u=[],l=0;l<o;l++)u.push(s);var c=n-o*s;if(c>0)for(l=0;l<c;l++)u[l%o]+=1;return u}function e8(e,t,n){for(var r=e.r0,a=e.r,i=e.startAngle,o=e.endAngle,s=Math.abs(o-i),u=s*a,l=a-r,c=u>Math.abs(l),h=J6([u,l],c?0:1,t),p=(c?s:l)/h.length,f=0;f<h.length;f++)for(var d=(c?l:s)/h[f],v=0;v<h[f];v++){var m={};c?(m.startAngle=i+p*f,m.endAngle=i+p*(f+1),m.r0=r+d*v,m.r=r+d*(v+1)):(m.startAngle=i+d*v,m.endAngle=i+d*(v+1),m.r0=r+p*f,m.r=r+p*(f+1)),m.clockwise=e.clockwise,m.cx=e.cx,m.cy=e.cy,n.push(m)}}function t8(e,t,n,r){return e*r-n*t}function n8(e,t,n,r,a,i,o,s){var u=n-e,l=r-t,c=o-a,h=s-i,p=t8(c,h,u,l);if(Math.abs(p)<1e-6)return null;var f=t8(e-a,t-i,c,h)/p;return f<0||f>1?null:new sz(f*u+e,f*l+t)}function r8(e,t,n){var r=new sz;sz.sub(r,n,t),r.normalize();var a=new sz;return sz.sub(a,e,t),a.dot(r)}function a8(e,t){var n=e[e.length-1];n&&n[0]===t[0]&&n[1]===t[1]||e.push(t)}function i8(e){var t=e.points,n=[],r=[];QV(t,n,r);var a=new gz(n[0],n[1],r[0]-n[0],r[1]-n[1]),i=a.width,o=a.height,s=a.x,u=a.y,l=new sz,c=new sz;return i>o?(l.x=c.x=s+i/2,l.y=u,c.y=u+o):(l.y=c.y=u+o/2,l.x=s,c.x=s+i),function(e,t,n){for(var r=e.length,a=[],i=0;i<r;i++){var o=e[i],s=e[(i+1)%r],u=n8(o[0],o[1],s[0],s[1],t.x,t.y,n.x,n.y);u&&a.push({projPt:r8(u,t,n),pt:u,idx:i})}if(a.length<2)return[{points:e},{points:e}];a.sort((function(e,t){return e.projPt-t.projPt}));var l=a[0],c=a[a.length-1];if(c.idx<l.idx){var h=l;l=c,c=h}var p=[l.pt.x,l.pt.y],f=[c.pt.x,c.pt.y],d=[p],v=[f];for(i=l.idx+1;i<=c.idx;i++)a8(d,e[i].slice());for(a8(d,f),a8(d,p),i=c.idx+1;i<=l.idx+r;i++)a8(v,e[i%r].slice());return a8(v,p),a8(v,f),[{points:d},{points:v}]}(t,l,c)}function o8(e,t,n,r){if(1===n)r.push(t);else{var a=Math.floor(n/2),i=e(t);o8(e,i[0],a,r),o8(e,i[1],n-a,r)}return r}function s8(e,t){var n,r=[],a=e.shape;switch(e.type){case"rect":!function(e,t,n){for(var r=e.width,a=e.height,i=r>a,o=J6([r,a],i?0:1,t),s=i?"width":"height",u=i?"height":"width",l=i?"x":"y",c=i?"y":"x",h=e[s]/o.length,p=0;p<o.length;p++)for(var f=e[u]/o[p],d=0;d<o[p];d++){var v={};v[l]=p*h,v[c]=d*f,v[s]=h,v[u]=f,v.x+=e.x,v.y+=e.y,n.push(v)}}(a,t,r),n=iU;break;case"sector":e8(a,t,r),n=oY;break;case"circle":e8({r0:0,r:a.r,startAngle:0,endAngle:2*Math.PI,cx:a.cx,cy:a.cy},t,r),n=oY;break;default:var i=e.getComputedTransform(),o=i?Math.sqrt(Math.max(i[0]*i[0]+i[1]*i[1],i[2]*i[2]+i[3]*i[3])):1,s=KL(function(e,t){var n=Q6(e),r=[];t=t||1;for(var a=0;a<n.length;a++){var i=n[a],o=[],s=i[0],u=i[1];o.push(s,u);for(var l=2;l<i.length;){var c=i[l++],h=i[l++],p=i[l++],f=i[l++],d=i[l++],v=i[l++];$6(s,u,c,h,p,f,d,v,o,t),s=d,u=v}r.push(o)}return r}(e.getUpdatedPathProxy(),o),(function(e){return function(e){for(var t=[],n=0;n<e.length;)t.push([e[n++],e[n++]]);return t}(e)})),u=s.length;if(0===u)o8(i8,{points:s[0]},t,r);else if(u===t)for(var l=0;l<u;l++)r.push({points:s[l]});else{var c=0,h=KL(s,(function(e){var t=[],n=[];QV(e,t,n);var r=(n[1]-t[1])*(n[0]-t[0]);return c+=r,{poly:e,area:r}}));h.sort((function(e,t){return t.area-e.area}));var p=t;for(l=0;l<u;l++){var f=h[l];if(p<=0)break;var d=l===u-1?p:Math.ceil(f.area/c*t);d<0||(o8(i8,{points:f.poly},d,r),p-=d)}}n=fY}if(!n)return function(e,t){for(var n=[],r=0;r<t;r++)n.push(LK(e));return n}(e,t);var v,m,g=[];for(l=0;l<r.length;l++){var y=new n;y.setShape(r[l]),v=e,(m=y).setStyle(v.style),m.z=v.z,m.z2=v.z2,m.zlevel=v.zlevel,g.push(y)}return g}function u8(e,t){var n=e.length,r=t.length;if(n===r)return[e,t];for(var a=[],i=[],o=n<r?e:t,s=Math.min(n,r),u=Math.abs(r-n)/6,l=(s-2)/6,c=Math.ceil(u/l)+1,h=[o[0],o[1]],p=u,f=2;f<s;){var d=o[f-2],v=o[f-1],m=o[f++],g=o[f++],y=o[f++],b=o[f++],x=o[f++],k=o[f++];if(p<=0)h.push(m,g,y,b,x,k);else{for(var w=Math.min(p,c-1)+1,_=1;_<=w;_++){var S=_/w;CB(d,m,y,x,S,a),CB(v,g,b,k,S,i),d=a[3],v=i[3],h.push(a[1],i[1],a[2],i[2],d,v),m=a[5],g=i[5],y=a[6],b=i[6]}p-=w-1}}return o===e?[h,t]:[e,h]}function l8(e,t){for(var n=e.length,r=e[n-2],a=e[n-1],i=[],o=0;o<t.length;)i[o++]=r,i[o++]=a;return i}function c8(e){for(var t=0,n=0,r=0,a=e.length,i=0,o=a-2;i<a;o=i,i+=2){var s=e[o],u=e[o+1],l=e[i],c=e[i+1],h=s*c-l*u;t+=h,n+=(s+l)*h,r+=(u+c)*h}return 0===t?[e[0]||0,e[1]||0]:[n/t/3,r/t/3,t]}function h8(e,t,n,r){for(var a=(e.length-2)/6,i=1/0,o=0,s=e.length,u=s-2,l=0;l<a;l++){for(var c=6*l,h=0,p=0;p<s;p+=2){var f=0===p?c:(c+p-2)%u+2,d=e[f]-n[0],v=e[f+1]-n[1],m=t[p]-r[0]-d,g=t[p+1]-r[1]-v;h+=m*m+g*g}h<i&&(i=h,o=l)}return o}function p8(e){for(var t=[],n=e.length,r=0;r<n;r+=2)t[r]=e[n-r-2],t[r+1]=e[n-r-1];return t}function f8(e){return e.__isCombineMorphing}var d8="__mOriginal_";function v8(e,t,n){var r=d8+t,a=e[r]||e[t];e[r]||(e[r]=e[t]);var i=n.replace,o=n.after,s=n.before;e[t]=function(){var e,t=arguments;return s&&s.apply(this,t),e=i?i.apply(this,t):a.apply(this,t),o&&o.apply(this,t),e}}function m8(e,t){var n=d8+t;e[n]&&(e[t]=e[n],e[n]=null)}function g8(e,t){for(var n=0;n<e.length;n++)for(var r=e[n],a=0;a<r.length;){var i=r[a],o=r[a+1];r[a++]=t[0]*i+t[2]*o+t[4],r[a++]=t[1]*i+t[3]*o+t[5]}}function y8(e,t){var n=e.getUpdatedPathProxy(),r=t.getUpdatedPathProxy(),a=function(e,t){for(var n,r,a,i=[],o=[],s=0;s<Math.max(e.length,t.length);s++){var u=e[s],l=t[s],c=void 0,h=void 0;u?l?(r=c=(n=u8(u,l))[0],a=h=n[1]):(h=l8(a||u,u),c=u):(c=l8(r||l,l),h=l),i.push(c),o.push(h)}return[i,o]}(Q6(n),Q6(r)),i=a[0],o=a[1],s=e.getComputedTransform(),u=t.getComputedTransform();s&&g8(i,s),u&&g8(o,u),v8(t,"updateTransform",{replace:function(){this.transform=null}}),t.transform=null;var l=function(e,t,n,r){for(var a,i=[],o=0;o<e.length;o++){var s=e[o],u=t[o],l=c8(s),c=c8(u);null==a&&(a=l[2]<0!==c[2]<0);var h=[],p=[],f=0,d=1/0,v=[],m=s.length;a&&(s=p8(s));for(var g=6*h8(s,u,l,c),y=m-2,b=0;b<y;b+=2){var x=(g+b)%y+2;h[b+2]=s[x]-l[0],h[b+3]=s[x+1]-l[1]}if(h[0]=s[g]-l[0],h[1]=s[g+1]-l[1],n>0)for(var k=r/n,w=-r/2;w<=r/2;w+=k){var _=Math.sin(w),S=Math.cos(w),I=0;for(b=0;b<s.length;b+=2){var C=h[b],T=h[b+1],N=u[b]-c[0],E=u[b+1]-c[1],M=N*S-E*_,A=N*_+E*S;v[b]=M,v[b+1]=A;var D=M-C,R=A-T;I+=D*D+R*R}if(I<d){d=I,f=w;for(var O=0;O<v.length;O++)p[O]=v[O]}}else for(var F=0;F<m;F+=2)p[F]=u[F]-c[0],p[F+1]=u[F+1]-c[1];i.push({from:h,to:p,fromCp:l,toCp:c,rotation:-f})}return i}(i,o,10,Math.PI),c=[];v8(t,"buildPath",{replace:function(e){for(var n=t.__morphT,r=1-n,a=[],i=0;i<l.length;i++){var o=l[i],s=o.from,u=o.to,h=o.rotation*n,p=o.fromCp,f=o.toCp,d=Math.sin(h),v=Math.cos(h);Yz(a,p,f,n);for(var m=0;m<s.length;m+=2){var g=s[m],y=s[m+1],b=g*r+(_=u[m])*n,x=y*r+(S=u[m+1])*n;c[m]=b*v-x*d+a[0],c[m+1]=b*d+x*v+a[1]}var k=c[0],w=c[1];e.moveTo(k,w);for(m=2;m<s.length;){var _=c[m++],S=c[m++],I=c[m++],C=c[m++],T=c[m++],N=c[m++];k===_&&w===S&&I===T&&C===N?e.lineTo(T,N):e.bezierCurveTo(_,S,I,C,T,N),k=T,w=N}}}})}function b8(e,t,n){if(!e||!t)return t;var r=n.done,a=n.during;return y8(e,t),t.__morphT=0,t.animateTo({__morphT:1},HL({during:function(e){t.dirtyShape(),a&&a(e)},done:function(){m8(t,"buildPath"),m8(t,"updateTransform"),t.__morphT=-1,t.createPathProxy(),t.dirtyShape(),r&&r()}},n)),t}function x8(e,t,n,r,a,i){e=a===n?0:Math.round(32767*(e-n)/(a-n)),t=i===r?0:Math.round(32767*(t-r)/(i-r));for(var o,s=0,u=32768;u>0;u/=2){var l=0,c=0;(e&u)>0&&(l=1),(t&u)>0&&(c=1),s+=u*u*(3*l^c),0===c&&(1===l&&(e=u-1-e,t=u-1-t),o=e,e=t,t=o)}return s}function k8(e){var t=1/0,n=1/0,r=-1/0,a=-1/0,i=KL(e,(function(e){var i=e.getBoundingRect(),o=e.getComputedTransform(),s=i.x+i.width/2+(o?o[4]:0),u=i.y+i.height/2+(o?o[5]:0);return t=Math.min(s,t),n=Math.min(u,n),r=Math.max(s,r),a=Math.max(u,a),[s,u]}));return KL(i,(function(i,o){return{cp:i,z:x8(i[0],i[1],t,n,r,a),path:e[o]}})).sort((function(e,t){return e.z-t.z})).map((function(e){return e.path}))}function w8(e){return s8(e.path,e.count)}function _8(e){return eP(e[0])}function S8(e,t){for(var n=[],r=e.length,a=0;a<r;a++)n.push({one:e[a],many:[]});for(a=0;a<t.length;a++){var i=t[a].length,o=void 0;for(o=0;o<i;o++)n[o%r].many.push(t[a][o])}var s=0;for(a=r-1;a>=0;a--)if(!n[a].many.length){var u=n[s].many;if(u.length<=1){if(!s)return n;s=0}i=u.length;var l=Math.ceil(i/2);n[a].many=u.slice(l,i),n[s].many=u.slice(0,l),s++}return n}var I8={clone:function(e){for(var t=[],n=1-Math.pow(1-e.path.style.opacity,1/e.count),r=0;r<e.count;r++){var a=LK(e.path);a.setStyle("opacity",n),t.push(a)}return t},split:null};function C8(e,t,n,r,a,i){if(e.length&&t.length){var o=GY("update",r,a);if(o&&o.duration>0){var s,u,l=r.getModel("universalTransition").get("delay"),c=Object.assign({setToFinal:!0},o);_8(e)&&(s=e,u=t),_8(t)&&(s=t,u=e);for(var h=s?s===e:e.length>t.length,p=s?S8(u,s):S8(h?t:e,[h?e:t]),f=0,d=0;d<p.length;d++)f+=p[d].many.length;var v=0;for(d=0;d<p.length;d++)m(p[d],h,v,f),v+=p[d].many.length}}function m(e,t,r,a,o){var s=e.many,u=e.one;if(1!==s.length||o)for(var h=HL({dividePath:I8[n],individualDelay:l&&function(e,t,n,i){return l(e+r,a)}},c),p=t?function(e,t,n){var r=[];!function e(t){for(var n=0;n<t.length;n++){var a=t[n];f8(a)?e(a.childrenRef()):a instanceof GW&&r.push(a)}}(e);var a=r.length;if(!a)return{fromIndividuals:[],toIndividuals:[],count:0};var i=(n.dividePath||w8)({path:t,count:a});if(i.length!==a)return console.error("Invalid morphing: unmatched splitted path"),{fromIndividuals:[],toIndividuals:[],count:0};r=k8(r),i=k8(i);for(var o=n.done,s=n.during,u=n.individualDelay,l=new uB,c=0;c<a;c++){var h=r[c],p=i[c];p.parent=t,p.copyTransform(l),u||y8(h,p)}function f(e){for(var t=0;t<i.length;t++)i[t].addSelfToZr(e)}function d(){t.__isCombineMorphing=!1,t.__morphT=-1,t.childrenRef=null,m8(t,"addSelfToZr"),m8(t,"removeSelfFromZr")}t.__isCombineMorphing=!0,t.childrenRef=function(){return i},v8(t,"addSelfToZr",{after:function(e){f(e)}}),v8(t,"removeSelfFromZr",{after:function(e){for(var t=0;t<i.length;t++)i[t].removeSelfFromZr(e)}});var v=i.length;if(u){var m=v,g=function(){0===--m&&(d(),o&&o())};for(c=0;c<v;c++){var y=u?HL({delay:(n.delay||0)+u(c,v,r[c],i[c]),done:g},n):n;b8(r[c],i[c],y)}}else t.__morphT=0,t.animateTo({__morphT:1},HL({during:function(e){for(var n=0;n<v;n++){var r=i[n];r.__morphT=t.__morphT,r.dirtyShape()}s&&s(e)},done:function(){d();for(var t=0;t<e.length;t++)m8(e[t],"updateTransform");o&&o()}},n));return t.__zr&&f(t.__zr),{fromIndividuals:r,toIndividuals:i,count:v}}(s,u,h):function(e,t,n){var r=t.length,a=[],i=n.dividePath||w8;if(f8(e)){!function e(t){for(var n=0;n<t.length;n++){var r=t[n];f8(r)?e(r.childrenRef()):r instanceof GW&&a.push(r)}}(e.childrenRef());var o=a.length;if(o<r)for(var s=0,u=o;u<r;u++)a.push(LK(a[s++%o]));a.length=r}else{a=i({path:e,count:r});var l=e.getComputedTransform();for(u=0;u<a.length;u++)a[u].setLocalTransform(l);if(a.length!==r)return console.error("Invalid morphing: unmatched splitted path"),{fromIndividuals:[],toIndividuals:[],count:0}}a=k8(a),t=k8(t);var c=n.individualDelay;for(u=0;u<r;u++){var h=c?HL({delay:(n.delay||0)+c(u,r,a[u],t[u])},n):n;b8(a[u],t[u],h)}return{fromIndividuals:a,toIndividuals:t,count:t.length}}(u,s,h),f=p.fromIndividuals,d=p.toIndividuals,v=f.length,g=0;g<v;g++){y=l?HL({delay:l(g,v)},c):c;i(f[g],d[g],t?s[g]:e.one,t?e.one:s[g],y)}else{var y,b=t?s[0]:u,x=t?u:s[0];if(f8(b))m({many:[b],one:x},!0,r,a,!0);else b8(b,x,y=l?HL({delay:l(r,a)},c):c),i(b,x,b,x,y)}}}function T8(e){if(!e)return[];if(eP(e)){for(var t=[],n=0;n<e.length;n++)t.push(T8(e[n]));return t}var r=[];return e.traverse((function(e){e instanceof GW&&!e.disableMorphing&&!e.invisible&&!e.ignore&&r.push(e)})),r}var N8=eH();function E8(e){var t=[];return XL(e,(function(e){var n=e.data;if(!(n.count()>1e4))for(var r=n.getIndices(),a=function(e){for(var t=e.dimensions,n=0;n<t.length;n++){var r=e.getDimensionInfo(t[n]);if(r&&0===r.otherDims.itemGroupId)return t[n]}}(n),i=0;i<r.length;i++)t.push({data:n,dim:e.dim||a,divide:e.divide,dataIndex:i})})),t}function M8(e,t,n){e.traverse((function(e){e instanceof GW&&XY(e,{style:{opacity:0}},t,{dataIndex:n,isFrom:!0})}))}function A8(e){if(e.parent){var t=e.getComputedTransform();e.setLocalTransform(t),e.parent.remove(e)}}function D8(e){e.stopAnimation(),e.isGroup&&e.traverse((function(e){e.stopAnimation()}))}function R8(e,t,n){var r=GY("update",n,t);r&&e.traverse((function(e){if(e instanceof UV){var t=function(e){return HY(e).oldStyle}(e);t&&e.animateFrom({style:t},r)}}))}function O8(e,t,n){var r=E8(e),a=E8(t);function i(e,t,n,r,a){(n||e)&&t.animateFrom({style:n&&n!==e?UL(UL({},n.style),e.style):e.style},a)}function o(e){for(var t=0;t<e.length;t++)if(e[t].dim)return e[t].dim}var s=o(r),u=o(a),l=!1;function c(e,t){return function(n){var r=n.data,a=n.dataIndex;if(t)return r.getId(a);var i=r.hostModel&&r.hostModel.get("dataGroupId"),o=e?s||u:u||s,l=o&&r.getDimensionInfo(o),c=l&&l.ordinalMeta;if(l){var h=r.get(l.name,a);return c&&c.categories[h]||h+""}var p=r.getRawDataItem(a);return p&&p.groupId?p.groupId+"":i||r.getId(a)}}var h=function(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++){var a=e[r],i=t[r];if(a.data.getId(a.dataIndex)!==i.data.getId(i.dataIndex))return!1}return!0}(r,a),p={};if(!h)for(var f=0;f<a.length;f++){var d=a[f],v=d.data.getItemGraphicEl(d.dataIndex);v&&(p[v.id]=!0)}function m(e,t){var n=r[t],o=a[e],s=o.data.hostModel,u=n.data.getItemGraphicEl(n.dataIndex),c=o.data.getItemGraphicEl(o.dataIndex);u!==c?u&&p[u.id]||c&&(D8(c),u?(D8(u),A8(u),l=!0,C8(T8(u),T8(c),o.divide,s,e,i)):M8(c,s,e)):c&&R8(c,o.dataIndex,s)}new MG(r,a,c(!0,h),c(!1,h),null,"multiple").update(m).updateManyToOne((function(e,t){var n=a[e],o=n.data,s=o.hostModel,u=o.getItemGraphicEl(n.dataIndex),c=ZL(KL(t,(function(e){return r[e].data.getItemGraphicEl(r[e].dataIndex)})),(function(e){return e&&e!==u&&!p[e.id]}));u&&(D8(u),c.length?(XL(c,(function(e){D8(e),A8(e)})),l=!0,C8(T8(c),T8(u),n.divide,s,e,i)):M8(u,s,n.dataIndex))})).updateOneToMany((function(e,t){var n=r[t],o=n.data.getItemGraphicEl(n.dataIndex);if(!o||!p[o.id]){var s=ZL(KL(e,(function(e){return a[e].data.getItemGraphicEl(a[e].dataIndex)})),(function(e){return e&&e!==o})),u=a[e[0]].data.hostModel;s.length&&(XL(s,(function(e){return D8(e)})),o?(D8(o),A8(o),l=!0,C8(T8(o),T8(s),n.divide,u,e[0],i)):XL(s,(function(t){return M8(t,u,e[0])})))}})).updateManyToMany((function(e,t){new MG(t,e,(function(e){return r[e].data.getId(r[e].dataIndex)}),(function(e){return a[e].data.getId(a[e].dataIndex)})).update((function(n,r){m(e[n],t[r])})).execute()})).execute(),l&&XL(t,(function(e){var t=e.data.hostModel,r=t&&n.getViewOfSeriesModel(t),a=GY("update",t,0);r&&t.isAnimationEnabled()&&a&&a.duration>0&&r.group.traverse((function(e){e instanceof GW&&!e.animators.length&&e.animateFrom({style:{opacity:0}},a)}))}))}function F8(e){var t=e.getModel("universalTransition").get("seriesKey");return t||e.id}function L8(e){return eP(e)?e.sort().join(","):e}function P8(e){if(e.hostModel)return e.hostModel.getModel("universalTransition").get("divideShape")}function z8(e,t){var n=wP(),r=wP(),a=wP();return XL(e.oldSeries,(function(t,n){var i=e.oldData[n],o=F8(t),s=L8(o);r.set(s,i),eP(o)&&XL(o,(function(e){a.set(e,{data:i,key:s})}))})),XL(t.updatedSeries,(function(e){if(e.isUniversalTransitionEnabled()&&e.isAnimationEnabled()){var t=e.getData(),i=F8(e),o=L8(i),s=r.get(o);if(s)n.set(o,{oldSeries:[{divide:P8(s),data:s}],newSeries:[{divide:P8(t),data:t}]});else if(eP(i)){0;var u=[];XL(i,(function(e){var t=r.get(e);t&&u.push({divide:P8(t),data:t})})),u.length&&n.set(o,{oldSeries:u,newSeries:[{data:t,divide:P8(t)}]})}else{var l=a.get(i);if(l){var c=n.get(l.key);c||(c={oldSeries:[{data:l.data,divide:P8(l.data)}],newSeries:[]},n.set(l.key,c)),c.newSeries.push({data:t,divide:P8(t)})}}}})),n}function B8(e,t){for(var n=0;n<e.length;n++){if(null!=t.seriesIndex&&t.seriesIndex===e[n].seriesIndex||null!=t.seriesId&&t.seriesId===e[n].id)return n}}function V8(e,t,n){var r=IL.createCanvas(),a=t.getWidth(),i=t.getHeight(),o=r.style;return o&&(o.position="absolute",o.left="0",o.top="0",o.width=a+"px",o.height=i+"px",r.setAttribute("data-zr-dom-id",e)),r.width=a*n,r.height=i*n,r}var W8=function(e){function t(t,n,r){var a,i=e.call(this)||this;i.motionBlur=!1,i.lastFrameAlpha=.7,i.dpr=1,i.virtual=!1,i.config={},i.incremental=!1,i.zlevel=0,i.maxRepaintRectCount=5,i.__dirty=!0,i.__firstTimePaint=!0,i.__used=!1,i.__drawIndex=0,i.__startIndex=0,i.__endIndex=0,i.__prevStartIndex=null,i.__prevEndIndex=null,r=r||xV,"string"===typeof t?a=V8(t,n,r):iP(t)&&(t=(a=t).id),i.id=t,i.dom=a;var o=a.style;return o&&(SP(a),a.onselectstart=function(){return!1},o.padding="0",o.margin="0",o.borderWidth="0"),i.painter=n,i.dpr=r,i}return GP(t,e),t.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},t.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},t.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},t.prototype.setUnpainted=function(){this.__firstTimePaint=!0},t.prototype.createBackBuffer=function(){var e=this.dpr;this.domBack=V8("back-"+this.id,this.painter,e),this.ctxBack=this.domBack.getContext("2d"),1!==e&&this.ctxBack.scale(e,e)},t.prototype.createRepaintRects=function(e,t,n,r){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var a,i=[],o=this.maxRepaintRectCount,s=!1,u=new gz(0,0,0,0);function l(e){if(e.isFinite()&&!e.isZero())if(0===i.length){(t=new gz(0,0,0,0)).copy(e),i.push(t)}else{for(var t,n=!1,r=1/0,a=0,l=0;l<i.length;++l){var c=i[l];if(c.intersect(e)){var h=new gz(0,0,0,0);h.copy(c),h.union(e),i[l]=h,n=!0;break}if(s){u.copy(e),u.union(c);var p=e.width*e.height,f=c.width*c.height,d=u.width*u.height-p-f;d<r&&(r=d,a=l)}}if(s&&(i[a].union(e),n=!0),!n)(t=new gz(0,0,0,0)).copy(e),i.push(t);s||(s=i.length>=o)}}for(var c=this.__startIndex;c<this.__endIndex;++c){if(f=e[c]){var h=f.shouldBePainted(n,r,!0,!0);(d=f.__isRendered&&(1&f.__dirty||!h)?f.getPrevPaintRect():null)&&l(d);var p=h&&(1&f.__dirty||!f.__isRendered)?f.getPaintRect():null;p&&l(p)}}for(c=this.__prevStartIndex;c<this.__prevEndIndex;++c){var f,d;h=(f=t[c]).shouldBePainted(n,r,!0,!0);if(f&&(!h||!f.__zr)&&f.__isRendered)(d=f.getPrevPaintRect())&&l(d)}do{a=!1;for(c=0;c<i.length;)if(i[c].isZero())i.splice(c,1);else{for(var v=c+1;v<i.length;)i[c].intersect(i[v])?(a=!0,i[c].union(i[v]),i.splice(v,1)):v++;c++}}while(a);return this._paintRects=i,i},t.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},t.prototype.resize=function(e,t){var n=this.dpr,r=this.dom,a=r.style,i=this.domBack;a&&(a.width=e+"px",a.height=t+"px"),r.width=e*n,r.height=t*n,i&&(i.width=e*n,i.height=t*n,1!==n&&this.ctxBack.scale(n,n))},t.prototype.clear=function(e,t,n){var r=this.dom,a=this.ctx,i=r.width,o=r.height;t=t||this.clearColor;var s=this.motionBlur&&!e,u=this.lastFrameAlpha,l=this.dpr,c=this;s&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(r,0,0,i/l,o/l));var h=this.domBack;function p(e,n,r,i){if(a.clearRect(e,n,r,i),t&&"transparent"!==t){var o=void 0;lP(t)?(o=t.__canvasGradient||V2(a,t,{x:0,y:0,width:r,height:i}),t.__canvasGradient=o):null!=t.image&&(o=Z2(a,t,{dirty:function(){c.setUnpainted(),c.__painter.refresh()}})),a.save(),a.fillStyle=o||t,a.fillRect(e,n,r,i),a.restore()}s&&(a.save(),a.globalAlpha=u,a.drawImage(h,e,n,r,i),a.restore())}!n||s?p(0,0,i,o):n.length&&XL(n,(function(e){p(e.x*l,e.y*l,e.width*l,e.height*l)}))},t}(yV),U8=W8,H8=1e5,G8=314159,j8=.01;var q8=function(){function e(e,t,n,r){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var a=!e.nodeName||"CANVAS"===e.nodeName.toUpperCase();this._opts=n=UL({},n||{}),this.dpr=n.devicePixelRatio||xV,this._singleCanvas=a,this.root=e,e.style&&(SP(e),e.innerHTML=""),this.storage=t;var i=this._zlevelList;this._prevDisplayList=[];var o=this._layers;if(a){var s=e,u=s.width,l=s.height;null!=n.width&&(u=n.width),null!=n.height&&(l=n.height),this.dpr=n.devicePixelRatio||1,s.width=u*this.dpr,s.height=l*this.dpr,this._width=u,this._height=l;var c=new U8(s,this,this.dpr);c.__builtin__=!0,c.initContext(),o[314159]=c,c.zlevel=G8,i.push(G8),this._domRoot=e}else{this._width=U2(e,0,n),this._height=U2(e,1,n);var h=this._domRoot=function(e,t){var n=document.createElement("div");return n.style.cssText=["position:relative","width:"+e+"px","height:"+t+"px","padding:0","margin:0","border-width:0"].join(";")+";",n}(this._width,this._height);e.appendChild(h)}}return e.prototype.getType=function(){return"canvas"},e.prototype.isSingleCanvas=function(){return this._singleCanvas},e.prototype.getViewportRoot=function(){return this._domRoot},e.prototype.getViewportRootOffset=function(){var e=this.getViewportRoot();if(e)return{offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}},e.prototype.refresh=function(e){var t=this.storage.getDisplayList(!0),n=this._prevDisplayList,r=this._zlevelList;this._redrawId=Math.random(),this._paintList(t,n,e,this._redrawId);for(var a=0;a<r.length;a++){var i=r[a],o=this._layers[i];if(!o.__builtin__&&o.refresh){var s=0===a?this._backgroundColor:null;o.refresh(s)}}return this._opts.useDirtyRect&&(this._prevDisplayList=t.slice()),this},e.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},e.prototype._paintHoverList=function(e){var t=e.length,n=this._hoverlayer;if(n&&n.clear(),t){for(var r,a={inHover:!0,viewWidth:this._width,viewHeight:this._height},i=0;i<t;i++){var o=e[i];o.__inHover&&(n||(n=this._hoverlayer=this.getLayer(H8)),r||(r=n.ctx).save(),i3(r,o,a,i===t-1))}r&&r.restore()}},e.prototype.getHoverLayer=function(){return this.getLayer(H8)},e.prototype.paintOne=function(e,t){a3(e,t)},e.prototype._paintList=function(e,t,n,r){if(this._redrawId===r){n=n||!1,this._updateLayerStatus(e);var a=this._doPaintList(e,t,n),i=a.finished,o=a.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),o&&this._paintHoverList(e),i)this.eachLayer((function(e){e.afterBrush&&e.afterBrush()}));else{var s=this;z0((function(){s._paintList(e,t,n,r)}))}}},e.prototype._compositeManually=function(){var e=this.getLayer(G8).ctx,t=this._domRoot.width,n=this._domRoot.height;e.clearRect(0,0,t,n),this.eachBuiltinLayer((function(r){r.virtual&&e.drawImage(r.dom,0,0,t,n)}))},e.prototype._doPaintList=function(e,t,n){for(var r=this,a=[],i=this._opts.useDirtyRect,o=0;o<this._zlevelList.length;o++){var s=this._zlevelList[o],u=this._layers[s];u.__builtin__&&u!==this._hoverlayer&&(u.__dirty||n)&&a.push(u)}for(var l=!0,c=!1,h=function(o){var s,u=a[o],h=u.ctx,f=i&&u.createRepaintRects(e,t,p._width,p._height),d=n?u.__startIndex:u.__drawIndex,v=!n&&u.incremental&&Date.now,m=v&&Date.now(),g=u.zlevel===p._zlevelList[0]?p._backgroundColor:null;if(u.__startIndex===u.__endIndex)u.clear(!1,g,f);else if(d===u.__startIndex){var y=e[d];y.incremental&&y.notClear&&!n||u.clear(!1,g,f)}-1===d&&(console.error("For some unknown reason. drawIndex is -1"),d=u.__startIndex);var b=function(t){var n={inHover:!1,allClipped:!1,prevEl:null,viewWidth:r._width,viewHeight:r._height};for(s=d;s<u.__endIndex;s++){var a=e[s];if(a.__inHover&&(c=!0),r._doPaintEl(a,u,i,t,n,s===u.__endIndex-1),v)if(Date.now()-m>15)break}n.prevElClipPaths&&h.restore()};if(f)if(0===f.length)s=u.__endIndex;else for(var x=p.dpr,k=0;k<f.length;++k){var w=f[k];h.save(),h.beginPath(),h.rect(w.x*x,w.y*x,w.width*x,w.height*x),h.clip(),b(w),h.restore()}else h.save(),b(),h.restore();u.__drawIndex=s,u.__drawIndex<u.__endIndex&&(l=!1)},p=this,f=0;f<a.length;f++)h(f);return MP.wxa&&XL(this._layers,(function(e){e&&e.ctx&&e.ctx.draw&&e.ctx.draw()})),{finished:l,needsRefreshHover:c}},e.prototype._doPaintEl=function(e,t,n,r,a,i){var o=t.ctx;if(n){var s=e.getPaintRect();(!r||s&&s.intersect(r))&&(i3(o,e,a,i),e.setPrevPaintRect(s))}else i3(o,e,a,i)},e.prototype.getLayer=function(e,t){this._singleCanvas&&!this._needsManuallyCompositing&&(e=G8);var n=this._layers[e];return n||((n=new U8("zr_"+e,this,this.dpr)).zlevel=e,n.__builtin__=!0,this._layerConfig[e]?WL(n,this._layerConfig[e],!0):this._layerConfig[e-j8]&&WL(n,this._layerConfig[e-j8],!0),t&&(n.virtual=t),this.insertLayer(e,n),n.initContext()),n},e.prototype.insertLayer=function(e,t){var n=this._layers,r=this._zlevelList,a=r.length,i=this._domRoot,o=null,s=-1;if(!n[e]&&function(e){return!!e&&(!!e.__builtin__||"function"===typeof e.resize&&"function"===typeof e.refresh)}(t)){if(a>0&&e>r[0]){for(s=0;s<a-1&&!(r[s]<e&&r[s+1]>e);s++);o=n[r[s]]}if(r.splice(s+1,0,e),n[e]=t,!t.virtual)if(o){var u=o.dom;u.nextSibling?i.insertBefore(t.dom,u.nextSibling):i.appendChild(t.dom)}else i.firstChild?i.insertBefore(t.dom,i.firstChild):i.appendChild(t.dom);t.__painter=this}},e.prototype.eachLayer=function(e,t){for(var n=this._zlevelList,r=0;r<n.length;r++){var a=n[r];e.call(t,this._layers[a],a)}},e.prototype.eachBuiltinLayer=function(e,t){for(var n=this._zlevelList,r=0;r<n.length;r++){var a=n[r],i=this._layers[a];i.__builtin__&&e.call(t,i,a)}},e.prototype.eachOtherLayer=function(e,t){for(var n=this._zlevelList,r=0;r<n.length;r++){var a=n[r],i=this._layers[a];i.__builtin__||e.call(t,i,a)}},e.prototype.getLayers=function(){return this._layers},e.prototype._updateLayerStatus=function(e){function t(e){i&&(i.__endIndex!==e&&(i.__dirty=!0),i.__endIndex=e)}if(this.eachBuiltinLayer((function(e,t){e.__dirty=e.__used=!1})),this._singleCanvas)for(var n=1;n<e.length;n++){if((s=e[n]).zlevel!==e[n-1].zlevel||s.incremental){this._needsManuallyCompositing=!0;break}}var r,a,i=null,o=0;for(a=0;a<e.length;a++){var s,u=(s=e[a]).zlevel,l=void 0;r!==u&&(r=u,o=0),s.incremental?((l=this.getLayer(u+.001,this._needsManuallyCompositing)).incremental=!0,o=1):l=this.getLayer(u+(o>0?j8:0),this._needsManuallyCompositing),l.__builtin__||BL("ZLevel "+u+" has been used by unkown layer "+l.id),l!==i&&(l.__used=!0,l.__startIndex!==a&&(l.__dirty=!0),l.__startIndex=a,l.incremental?l.__drawIndex=-1:l.__drawIndex=a,t(a),i=l),1&s.__dirty&&!s.__inHover&&(l.__dirty=!0,l.incremental&&l.__drawIndex<0&&(l.__drawIndex=a))}t(a),this.eachBuiltinLayer((function(e,t){!e.__used&&e.getElementCount()>0&&(e.__dirty=!0,e.__startIndex=e.__endIndex=e.__drawIndex=0),e.__dirty&&e.__drawIndex<0&&(e.__drawIndex=e.__startIndex)}))},e.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},e.prototype._clearLayer=function(e){e.clear()},e.prototype.setBackgroundColor=function(e){this._backgroundColor=e,XL(this._layers,(function(e){e.setUnpainted()}))},e.prototype.configLayer=function(e,t){if(t){var n=this._layerConfig;n[e]?WL(n[e],t,!0):n[e]=t;for(var r=0;r<this._zlevelList.length;r++){var a=this._zlevelList[r];if(a===e||a===e+j8)WL(this._layers[a],n[e],!0)}}},e.prototype.delLayer=function(e){var t=this._layers,n=this._zlevelList,r=t[e];r&&(r.dom.parentNode.removeChild(r.dom),delete t[e],n.splice(GL(n,e),1))},e.prototype.resize=function(e,t){if(this._domRoot.style){var n=this._domRoot;n.style.display="none";var r=this._opts,a=this.root;if(null!=e&&(r.width=e),null!=t&&(r.height=t),e=U2(a,0,r),t=U2(a,1,r),n.style.display="",this._width!==e||t!==this._height){for(var i in n.style.width=e+"px",n.style.height=t+"px",this._layers)this._layers.hasOwnProperty(i)&&this._layers[i].resize(e,t);this.refresh(!0)}this._width=e,this._height=t}else{if(null==e||null==t)return;this._width=e,this._height=t,this.getLayer(G8).resize(e,t)}return this},e.prototype.clearLayer=function(e){var t=this._layers[e];t&&t.clear()},e.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},e.prototype.getRenderedCanvas=function(e){if(e=e||{},this._singleCanvas&&!this._compositeManually)return this._layers[314159].dom;var t=new U8("image",this,e.pixelRatio||this.dpr);t.initContext(),t.clear(!1,e.backgroundColor||this._backgroundColor);var n=t.ctx;if(e.pixelRatio<=this.dpr){this.refresh();var r=t.dom.width,a=t.dom.height;this.eachLayer((function(e){e.__builtin__?n.drawImage(e.dom,0,0,r,a):e.renderToCanvas&&(n.save(),e.renderToCanvas(n),n.restore())}))}else for(var i={inHover:!1,viewWidth:this._width,viewHeight:this._height},o=this.storage.getDisplayList(!0),s=0,u=o.length;s<u;s++){var l=o[s];i3(n,l,i,s===u-1)}return t.dom},e.prototype.getWidth=function(){return this._width},e.prototype.getHeight=function(){return this._height},e}(),X8=q8;y4([function(e){e.registerComponentModel(FQ),e.registerComponentView(LQ)},function(e){y4(c0),e.registerComponentModel(x4),e.registerComponentView(H4),e.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},CP),e.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},CP)},function(e){y4(F5),y4(c0)},function(e){e.registerChartView(MQ),e.registerSeriesModel(BZ),e.registerLayout(function(e,t){return{seriesType:e,plan:sQ(),reset:function(e){var n=e.getData(),r=e.coordinateSystem,a=e.pipelineContext,i=t||a.large;if(r){var o=KL(r.dimensions,(function(e){return n.mapDimension(e)})).slice(0,2),s=o.length,u=n.getCalculationInfo("stackResultDimension");dq(n,o[0])&&(o[0]=u),dq(n,o[1])&&(o[1]=u);var l=n.getStore(),c=n.getDimensionIndex(o[0]),h=n.getDimensionIndex(o[1]);return s&&{progress:function(e,t){for(var n=e.end-e.start,a=i&&$Z(n*s),o=[],u=[],p=e.start,f=0;p<e.end;p++){var d=void 0;if(1===s){var v=l.get(c,p);d=r.dataToPoint(v,null,u)}else o[0]=l.get(c,p),o[1]=l.get(h,p),d=r.dataToPoint(o,null,u);i?(a[f++]=d[0],a[f++]=d[1]):t.setItemLayout(p,d.slice())}i&&t.setLayout("points",a)}}}}}}("line",!0)),e.registerVisual({seriesType:"line",reset:function(e){var t=e.getData(),n=e.getModel("lineStyle").getLineStyle();n&&!n.stroke&&(n.stroke=t.getVisual("style").fill),t.setVisual("legendLineStyle",n)}}),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,function(e){return{seriesType:e,reset:function(e,t,n){var r=e.getData(),a=e.get("sampling"),i=e.coordinateSystem,o=r.count();if(o>10&&"cartesian2d"===i.type&&a){var s=i.getBaseAxis(),u=i.getOtherAxis(s),l=s.getExtent(),c=n.getDevicePixelRatio(),h=Math.abs(l[1]-l[0])*(c||1),p=Math.round(o/h);if(isFinite(p)&&p>1){"lttb"===a&&e.setData(r.lttbDownSample(r.mapDimension(u.dim),1/p));var f=void 0;nP(a)?f=AQ[a]:tP(a)&&(f=a),f&&e.setData(r.downSample(r.mapDimension(u.dim),1/p,f,DQ))}}}}}("line"))},function(e){y4(W6),y4(K6)},function(e){e.registerPainter("canvas",X8)},function(e){e.registerUpdateLifecycle("series:beforeupdate",(function(e,t,n){XL(UU(n.seriesTransition),(function(e){XL(UU(e.to),(function(e){for(var t=n.updatedSeries,r=0;r<t.length;r++)(null!=e.seriesIndex&&e.seriesIndex===t[r].seriesIndex||null!=e.seriesId&&e.seriesId===t[r].id)&&(t[r].__universalTransitionEnabled=!0)}))}))})),e.registerUpdateLifecycle("series:transition",(function(e,t,n){var r=N8(t);if(r.oldSeries&&n.updatedSeries&&n.optionChanged){var a=n.seriesTransition;if(a)XL(UU(a),(function(e){!function(e,t,n,r){var a=[],i=[];XL(UU(e.from),(function(e){var n=B8(t.oldSeries,e);n>=0&&a.push({data:t.oldData[n],divide:P8(t.oldData[n]),dim:e.dimension})})),XL(UU(e.to),(function(e){var t=B8(n.updatedSeries,e);if(t>=0){var r=n.updatedSeries[t].getData();i.push({data:r,divide:P8(r),dim:e.dimension})}})),a.length>0&&i.length>0&&O8(a,i,r)}(e,r,n,t)}));else{var i=z8(r,n);XL(i.keys(),(function(e){var n=i.get(e);O8(n.oldSeries,n.newSeries,t)}))}XL(n.updatedSeries,(function(e){e.__universalTransitionEnabled&&(e.__universalTransitionEnabled=!1)}))}for(var o=e.getSeries(),s=r.oldSeries=[],u=r.oldData=[],l=0;l<o.length;l++){var c=o[l].getData();c.count()<1e4&&(s.push(o[l]),u.push(c))}}))}]);var K8=function(e){var t={visualMap:[{seriesIndex:1,show:!1,pieces:[{lte:1.1,gt:0,color:"#93CE07"},{lte:0,gt:-1.1,color:"#93CE07"}],outOfRange:{color:"red"}}],title:[{left:"center",text:"Position"},{top:"55%",left:"center",text:"Speed"}],xAxis:[{type:"time",axisLabel:{show:!1},interval:1e3,splitLine:{show:!1}},{type:"time",gridIndex:1,axisLabel:{show:!1},interval:1e3,splitLine:{show:!1}}],yAxis:[{type:"value",boundaryGap:[0,"100%"],splitLine:{show:!1}},{type:"value",gridIndex:1,boundaryGap:[0,"100%"],interval:.5,max:2.5,min:-2.5}],grid:[{bottom:"60%",left:0,right:0},{top:"60%",left:0,right:0}],series:[{name:"Positional",type:"line",showSymbol:!1,smooth:!0,data:[]},{name:"ROC",type:"line",showSymbol:!1,smooth:!0,data:[],xAxisIndex:1,yAxisIndex:1}]},n=(0,x.useRef)(null),r=(0,x.useRef)(null),a=N((0,x.useState)(null),2),i=a[0],o=a[1],s=N((0,x.useState)([]),2),u=s[0],l=s[1],c=N((0,x.useState)([]),2),h=c[0],p=c[1];return(0,x.useEffect)((function(){window.addEventListener("resize",(function(){null!=i&&void 0!==i&&i.resize()}))})),(0,x.useEffect)((function(){var e=function(e,t,n){var r=!(n&&n.ssr);if(r){var a=i4(e);if(a)return a}var i=new G3(e,t,n);return i.id="ec_"+r4++,t4[i.id]=i,r&&oH(e,a4,i.id),B3(i),f3.trigger("afterinit",i),i}(n.current,null,{renderer:"canvas",useDirtyRect:!1});o(e)}),[]),(0,x.useEffect)((function(){i&&i.setOption(t);var e=new Date,n=[{name:e.toString(),value:[e.getTime(),0]}],r=[{name:e.toString(),value:[e.getTime(),0]}];l([].concat(n)),p([].concat(r)),i&&i.setOption({series:[{data:r},{data:n}]})}),[i]),(0,x.useEffect)((function(){return r.current=setInterval((function(){if(u.length){var t=u,n=h,r=new Date(+new Date(u[u.length-1].name)+1e3),a={name:r.toString(),value:[r.getTime(),e.roc]},o={name:r.toString(),value:[r.getTime(),e.midPoint]};t.push(a),n.push(o),t.length>=100&&t.shift(),n.length>=100&&n.shift(),l(I(t)),p(I(n)),i&&i.setOption({series:[{data:n},{data:t}]})}}),e.interval),function(){return clearInterval(r.current)}}),[u]),(0,bL.jsx)("div",{ref:n,id:"chart-container"})};var Y8=function(e){return(0,bL.jsxs)("div",{className:"switch",children:[(0,bL.jsxs)("span",{children:[(0,bL.jsx)("input",{type:"checkbox",id:"toggleInput",disabled:e.disabled,checked:e.checked,onChange:function(t){return e.onChange(t.target.checked)}}),(0,bL.jsx)("button",{className:"slider",type:"button",disabled:e.disabled,onClick:function(){return e.onChange(!e.checked)}})]}),(0,bL.jsx)("label",{className:"slider-label",htmlFor:"toggleInput",children:e.title})]})},Z8=["#E6B333","#3366E6","#B34D4D","#80B300","#809900","#E6B3B3","#6680B3","#66991A","#FF99E6","#CCFF1A","#FF1A66","#E6331A","#33FFCC","#66994D","#B366CC","#4D8000","#B33300","#CC80CC","#66664D","#991AFF","#E666FF","#4DB3FF","#1AB399","#E666B3","#33991A","#CC9999","#B3B31A","#00E680","#4D8066","#809980","#E6FF80","#1AFF33","#999933","#FF3380","#CCCC00","#66E64D","#4D80CC","#9900B3","#E64D66","#4DB380","#FF4D4D","#99E6E6","#6666FF"];var Q8=function(){var e=N((0,x.useState)(null),2),t=e[0],n=e[1],r=N((0,x.useState)(!1),2),a=r[0],i=r[1],o=N((0,x.useState)(!1),2),s=o[0],u=o[1],l=N((0,x.useState)({val:0,time:0}),2),c=l[0],h=l[1],p=function(e){var t=(0,x.useRef)();return(0,x.useEffect)((function(){t.current=e}),[e]),t.current}(c),f=N((0,x.useState)(0),2),d=f[0],v=f[1],m=N((0,x.useState)(0),2),g=m[0],y=m[1],b=N((0,x.useState)(0),2),k=b[0],w=b[1],_={flipHorizontal:!0,maxNumBoxes:2,iouThreshold:.5,scoreThreshold:.75},S=(0,x.useRef)(null),C=(0,x.useRef)(null),T=(0,x.useRef)(null);return(0,x.useEffect)((function(){if(c.val){var e=(c.val-p.val)/(c.time-p.time);y(e),Math.abs(e)>1.1&&(console.log(e),v(e))}}),[c]),(0,x.useEffect)((function(){w((function(e){var t=d>0?e-1:e+1;return 4===t?0:t<0?3:t}))}),[d]),(0,x.useEffect)((function(){return S.current=setInterval((function(){return s&&void t.detect(C.current).then((function(e){t.renderPredictions(e,T.current,T.current.getContext("2d"),C.current);var n=I(e).find((function(e){return"point"===e.label}));if(n){var r=n.bbox,a=r[0]+r[2]/2;h({val:a,time:(new Date).getTime()})}}))}),33),function(){return clearInterval(S.current)}}),[s]),(0,x.useEffect)((function(){var e;a?(e=C.current,new Promise((function(t,n){e||t({status:!1,msg:"please provide a valid video element"}),e.width=e.width||640,e.height=e.width*(e.videoHeight/e.videoWidth),e.style.height="20px",navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user"}}).then((function(n){window.localStream=n,e.srcObject=n,e.onloadedmetadata=function(){e.height=e.width*(e.videoHeight/e.videoWidth),e.style.height=parseInt(e.style.width)*(e.videoHeight/e.videoWidth).toFixed(2)+"px",e.play(),t({status:!0,msg:"webcam successfully initiated."})}})).catch((function(e){t({status:!1,msg:e})}))}))).then((function(e){return u(!0)})):(u(!1),function(){fL.apply(this,arguments)}(C.current))}),[a]),(0,x.useEffect)((function(){(function(e){return pL.apply(this,arguments)})(_).then((function(e){return n(e)}))}),[]),(0,bL.jsxs)("div",{className:"App",children:[(0,bL.jsxs)("header",{children:[(0,bL.jsx)("h1",{children:"Wavy Carousel \ud83c\udfa0"}),(0,bL.jsx)(Y8,{title:"Start Video",checked:a,onChange:i,disabled:!t})]}),(0,bL.jsxs)("main",{children:[(0,bL.jsx)(xL,{slideIndex:k,children:I(Array(4).keys()).map((function(e){return(0,bL.jsxs)("div",{style:{background:Z8[e]},className:"carousel-item",children:["slide ",e]},e)}))}),(0,bL.jsxs)("div",{className:"video-container",children:[(0,bL.jsx)("canvas",{id:"video-canvas",ref:T,className:"d-none"}),(0,bL.jsx)(K8,{roc:g,midPoint:c.val,interval:33})]}),(0,bL.jsx)("video",{id:"webcam",ref:C,autoPlay:!0,style:{display:"none"}})]})]})};k.createRoot(document.getElementById("root")).render((0,bL.jsx)(x.StrictMode,{children:(0,bL.jsx)(Q8,{})}))}()}();
//# sourceMappingURL=main.7672ba73.js.map